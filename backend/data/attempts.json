{
  "attempts": [
    {
      "attemptId": "81408d23-6bcf-449f-92da-d6a35b644383",
      "userId": "dev-user-001",
      "examCode": "SCS-C03",
      "examVersion": null,
      "attemptSchemaVersion": 1,
      "startedAt": "2026-02-16T15:36:05.548Z",
      "finishedAt": "2026-02-16T15:37:13.977Z",
      "score": 13,
      "answers": [
        {
          "questionId": "SCS-C03-0004",
          "selectedChoiceId": "c1",
          "selectedChoiceIds": null,
          "selectedIndex": null,
          "selectedIndices": null,
          "correct": true,
          "timeMs": 0,
          "showTip": false,
          "createdAt": "2026-02-16T15:36:56.970Z"
        },
        {
          "questionId": "SCS-C03-0012",
          "selectedChoiceId": "c3",
          "selectedChoiceIds": null,
          "selectedIndex": null,
          "selectedIndices": null,
          "correct": false,
          "timeMs": 0,
          "showTip": false,
          "createdAt": "2026-02-16T15:36:38.660Z"
        },
        {
          "questionId": "SCS-C03-0006",
          "selectedChoiceId": null,
          "selectedChoiceIds": [
            "c1",
            "c2"
          ],
          "selectedIndex": null,
          "selectedIndices": null,
          "correct": true,
          "timeMs": 0,
          "showTip": false,
          "createdAt": "2026-02-16T15:37:09.046Z"
        }
      ],
      "metadata": {
        "serviceKeywords": [],
        "domains": [],
        "services": []
      },
      "questions": [
        {
          "id": "SCS-C03-0004",
          "question": "Which feature helps enforce least privilege by providing temporary credentials?",
          "choices": [
            {
              "id": "c4",
              "text": "Amazon Cognito",
              "isCorrect": false,
              "explanation": "Amazon Cognito provides user identity for apps, but the core mechanism for temporary AWS credentials is STS with roles."
            },
            {
              "id": "c3",
              "text": "Security Groups",
              "isCorrect": false,
              "explanation": "Security Groups are network controls, not credential mechanisms."
            },
            {
              "id": "c2",
              "text": "IAM Users with long-term access keys",
              "isCorrect": false,
              "explanation": "IAM Users with long-term keys are not recommended for least-privilege patterns."
            },
            {
              "id": "c1",
              "text": "IAM Roles with STS",
              "isCorrect": true,
              "explanation": "IAM Roles with STS allow issuance of temporary credentials for short-term access."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Identity and Access Management",
          "services": [
            "IAM",
            "STS",
            "Cognito"
          ],
          "docs": "https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles.html",
          "tip": "Temporary credentials reduce the risk from long-lived keys.",
          "explanation": "IAM Roles combined with AWS STS issue temporary credentials that automatically expire, reducing blast radius if leaked."
        },
        {
          "id": "SCS-C03-0010",
          "question": "A security architect needs to prevent any account in the organisation from launching EC2 instances outside of eu-west-1 and eu-west-2, regardless of the IAM permissions granted within those accounts. Which approach should they use?",
          "choices": [
            {
              "id": "c3",
              "text": "Deploy an AWS Config rule that evaluates EC2 instances and flags any launched outside the allowed regions as non-compliant",
              "isCorrect": false,
              "explanation": "Config rules are detective, not preventive - the instance would already be running before Config flags it."
            },
            {
              "id": "c2",
              "text": "Create an IAM policy in each account that denies ec2:RunInstances outside eu-west-1 and eu-west-2, and attach it to every IAM user and role",
              "isCorrect": false,
              "explanation": "Per-account IAM policies can be removed by local administrators, and new users or roles might not receive the policy."
            },
            {
              "id": "c4",
              "text": "Use a CloudFormation StackSet with a hook that blocks ec2:RunInstances in disallowed regions",
              "isCorrect": false,
              "explanation": "CloudFormation hooks validate CloudFormation-managed resources only, not direct API calls or console launches."
            },
            {
              "id": "c1",
              "text": "Attach a Service Control Policy (SCP) to the organisation root or target OUs that denies ec2:RunInstances unless the aws:RequestedRegion condition matches eu-west-1 or eu-west-2",
              "isCorrect": true,
              "explanation": "SCPs set maximum permission boundaries across all accounts in an OU or organisation, overriding any IAM policy within those accounts."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Identity and Access Management",
          "services": [
            "Organizations",
            "IAM",
            "Config",
            "CloudFormation"
          ],
          "docs": "https://docs.aws.amazon.com/organizations/latest/userguide/orgs_manage_policies_scps.html",
          "tip": "You need a preventive control that applies across all accounts regardless of each account's local IAM policies.",
          "explanation": "Service Control Policies (SCPs) in AWS Organizations act as guardrails that define the maximum permissions available to all principals in member accounts."
        },
        {
          "id": "SCS-C03-0002",
          "question": "During an incident, which service lets you run investigative notebooks and analyze data?",
          "choices": [
            {
              "id": "c4",
              "text": "AWS CloudTrail",
              "isCorrect": false,
              "explanation": "CloudTrail records API activity and is useful for forensics, but Detective provides investigative workflows."
            },
            {
              "id": "c2",
              "text": "Amazon Detective",
              "isCorrect": true,
              "explanation": "Amazon Detective is designed to analyze, visualize, and conduct investigations into potential security issues."
            },
            {
              "id": "c3",
              "text": "AWS Shield",
              "isCorrect": false,
              "explanation": "AWS Shield provides DDoS protections, not forensic investigation tools."
            },
            {
              "id": "c1",
              "text": "AWS Systems Manager",
              "isCorrect": false,
              "explanation": "Systems Manager helps manage instances but is not focused on security investigation notebooks."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Incident Response",
          "services": [
            "Detective",
            "Systems Manager",
            "Shield",
            "CloudTrail"
          ],
          "docs": "https://docs.aws.amazon.com/detective/latest/adminguide/what-is.html",
          "tip": "This service helps visualize and investigate security issues by linking related findings and activity.",
          "explanation": "Amazon Detective automatically collects log data from VPC Flow Logs, CloudTrail, and GuardDuty, then builds a graph model that links related events so analysts can visually trace activity."
        },
        {
          "id": "SCS-C03-0003",
          "question": "To restrict traffic at the network edge for HTTP endpoints, which service should you combine with CloudFront?",
          "choices": [
            {
              "id": "c2",
              "text": "Security Groups",
              "isCorrect": false,
              "explanation": "Security Groups control traffic to EC2 at the instance level, not the CloudFront edge."
            },
            {
              "id": "c1",
              "text": "AWS WAF",
              "isCorrect": true,
              "explanation": "AWS WAF is the web application firewall used with CloudFront to filter HTTP(S) traffic."
            },
            {
              "id": "c4",
              "text": "AWS KMS",
              "isCorrect": false,
              "explanation": "AWS KMS is for key management and encryption, not traffic filtering."
            },
            {
              "id": "c3",
              "text": "VPC Endpoint",
              "isCorrect": false,
              "explanation": "VPC Endpoints provide private connectivity to services within a VPC, not edge HTTP filtering."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Infrastructure Security",
          "services": [
            "WAF",
            "CloudFront",
            "Security Groups"
          ],
          "docs": "https://docs.aws.amazon.com/waf/latest/developerguide/waf-chapter.html",
          "tip": "Think web application protection rules that block common attack patterns at the edge.",
          "explanation": "AWS WAF integrates natively with CloudFront, ALB, and API Gateway to inspect and filter HTTP(S) requests using rules such as rate limiting and SQL injection detection."
        },
        {
          "id": "SCS-C03-0005",
          "question": "Which service provides managed encryption keys that you can use to encrypt data at rest?",
          "choices": [
            {
              "id": "c3",
              "text": "AWS Shield",
              "isCorrect": false,
              "explanation": "AWS Shield protects against DDoS attacks, not key management."
            },
            {
              "id": "c4",
              "text": "AWS WAF",
              "isCorrect": false,
              "explanation": "AWS WAF is a web application firewall, not key management."
            },
            {
              "id": "c2",
              "text": "AWS IAM",
              "isCorrect": false,
              "explanation": "AWS IAM handles identity and permissions, not key storage or encryption primitives."
            },
            {
              "id": "c1",
              "text": "AWS KMS",
              "isCorrect": true,
              "explanation": "AWS KMS is the managed service for creating and controlling encryption keys."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Data Protection",
          "services": [
            "KMS",
            "IAM",
            "Shield",
            "WAF"
          ],
          "docs": "https://docs.aws.amazon.com/kms/latest/developerguide/overview.html",
          "tip": "Key management service with envelope encryption support.",
          "explanation": "AWS KMS provides centralized creation, rotation, and access control of encryption keys used to protect data at rest across services like S3, EBS, and RDS."
        },
        {
          "id": "SCS-C03-0013",
          "question": "An organisation wants to automatically isolate an EC2 instance when GuardDuty detects cryptocurrency mining activity. Which architecture achieves automated remediation with the least operational overhead?",
          "choices": [
            {
              "id": "c4",
              "text": "Use Systems Manager Automation runbooks triggered by a CPU alarm to stop instances",
              "isCorrect": false,
              "explanation": "CPU alarms are generic and can cause false positives."
            },
            {
              "id": "c3",
              "text": "Schedule a Lambda to poll GuardDuty every five minutes and isolate flagged instances",
              "isCorrect": false,
              "explanation": "Polling introduces delay and extra maintenance."
            },
            {
              "id": "c1",
              "text": "Configure GuardDuty findings to flow into EventBridge and trigger a Lambda that isolates the instance",
              "isCorrect": true,
              "explanation": "EventBridge rules can filter GuardDuty finding types and invoke Lambda for automated remediation."
            },
            {
              "id": "c2",
              "text": "Enable Security Hub automated response playbooks to quarantine instances",
              "isCorrect": false,
              "explanation": "Security Hub aggregates findings but does not have built-in quarantine playbooks."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Incident Response",
          "services": [
            "GuardDuty",
            "Security Hub",
            "EventBridge",
            "Lambda",
            "Systems Manager"
          ],
          "docs": "https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_finding-types-ec2.html",
          "tip": "The key is event-driven, near-real-time response with minimal ongoing maintenance.",
          "explanation": "GuardDuty publishes findings to EventBridge in near-real-time, enabling immediate Lambda-driven remediation."
        },
        {
          "id": "SCS-C03-0014",
          "question": "A data lake team manages a single S3 bucket accessed by multiple applications across different VPCs. They need to enforce that each application can only reach the bucket from its own VPC and can only access objects under its designated prefix. Which approach provides the strongest isolation with the least policy complexity?",
          "choices": [
            {
              "id": "c1",
              "text": "Create a separate S3 Access Point for each application",
              "isCorrect": true,
              "explanation": "S3 Access Points allow per-application network and permission scoping against a shared bucket."
            },
            {
              "id": "c4",
              "text": "Replicate data into separate per-application buckets",
              "isCorrect": false,
              "explanation": "Replication increases cost and complexity."
            },
            {
              "id": "c2",
              "text": "Write a single S3 bucket policy with separate statements per application",
              "isCorrect": false,
              "explanation": "A single bucket policy becomes difficult to manage and has size limits."
            },
            {
              "id": "c3",
              "text": "Create one VPC endpoint per VPC and use endpoint policies",
              "isCorrect": false,
              "explanation": "Endpoint policies are coarse for prefix-level scoping."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Data Protection",
          "services": [
            "S3",
            "IAM",
            "VPC",
            "PrivateLink"
          ],
          "docs": "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-points.html",
          "tip": "Consider a feature that lets you create named network-scoped entry points to a single bucket.",
          "explanation": "S3 Access Points provide named, per-application entry points to a bucket, each with its own policy and optional VPC restriction."
        },
        {
          "id": "SCS-C03-0009",
          "question": "A company stores customer PII in S3 and needs to automatically discover and classify sensitive data across hundreds of buckets. Which service should they enable?",
          "choices": [
            {
              "id": "c3",
              "text": "Amazon Inspector",
              "isCorrect": false,
              "explanation": "Inspector focuses on vulnerability scanning for compute workloads, not data classification in S3."
            },
            {
              "id": "c2",
              "text": "Amazon GuardDuty",
              "isCorrect": false,
              "explanation": "GuardDuty detects threats like unusual API calls to S3 but does not inspect object contents for sensitive data."
            },
            {
              "id": "c1",
              "text": "Amazon Macie",
              "isCorrect": true,
              "explanation": "Macie scans S3 objects for PII, financial data, and credentials using ML-powered classifiers and managed data identifiers."
            },
            {
              "id": "c4",
              "text": "AWS Trusted Advisor",
              "isCorrect": false,
              "explanation": "Trusted Advisor provides account-level checks like open security groups, but does not scan S3 object contents."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Data Protection",
          "services": [
            "Macie",
            "GuardDuty",
            "Inspector",
            "Trusted Advisor"
          ],
          "docs": "https://docs.aws.amazon.com/macie/latest/user/what-is-macie.html",
          "tip": "This service is purpose-built for finding sensitive data like credit card numbers and passport IDs inside S3 objects.",
          "explanation": "Amazon Macie is designed to scan S3 objects and classify sensitive content such as PII and PHI using managed data identifiers."
        },
        {
          "id": "SCS-C03-0006",
          "question": "A security team needs to centrally manage findings from multiple AWS security services and ensure encryption of sensitive data at rest. Which TWO services should they use together? (Select TWO)",
          "choices": [
            {
              "id": "c3",
              "text": "Amazon SQS",
              "isCorrect": false,
              "explanation": "SQS is a message queuing service, not related to security findings or encryption."
            },
            {
              "id": "c2",
              "text": "AWS KMS",
              "isCorrect": true,
              "explanation": "KMS provides centralized encryption key management for encrypting data at rest."
            },
            {
              "id": "c1",
              "text": "AWS Security Hub",
              "isCorrect": true,
              "explanation": "Security Hub provides a comprehensive view of security alerts and compliance status across accounts."
            },
            {
              "id": "c4",
              "text": "AWS CloudFormation",
              "isCorrect": false,
              "explanation": "CloudFormation is an infrastructure-as-code service, not a security findings tool."
            },
            {
              "id": "c5",
              "text": "Amazon EC2",
              "isCorrect": false,
              "explanation": "EC2 provides virtual machines, not security findings management."
            }
          ],
          "selectCount": 2,
          "format": "text",
          "domain": "Detection",
          "services": [
            "Security Hub",
            "KMS",
            "SQS",
            "CloudFormation",
            "EC2"
          ],
          "docs": "https://docs.aws.amazon.com/securityhub/latest/userguide/what-is-securityhub.html",
          "tip": "Think about centralized findings aggregation and key management.",
          "explanation": "Security Hub aggregates and normalizes findings and KMS provides the keys to encrypt sensitive data."
        },
        {
          "id": "SCS-C03-0001",
          "question": "Which AWS service helps aggregate and analyze security findings across accounts?",
          "choices": [
            {
              "id": "c2",
              "text": "AWS Config",
              "isCorrect": false,
              "explanation": "AWS Config tracks resource configuration and compliance, not threat detection."
            },
            {
              "id": "c1",
              "text": "Amazon GuardDuty",
              "isCorrect": true,
              "explanation": "GuardDuty is a threat detection service that continuously monitors for malicious activity and unauthorized behavior."
            },
            {
              "id": "c4",
              "text": "Amazon SNS",
              "isCorrect": false,
              "explanation": "Amazon SNS is a notification service, not a security findings aggregator."
            },
            {
              "id": "c3",
              "text": "AWS WAF",
              "isCorrect": false,
              "explanation": "AWS WAF is a web application firewall focused on HTTP(S) protections."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Detection",
          "services": [
            "GuardDuty",
            "Config",
            "WAF",
            "SNS"
          ],
          "docs": "https://docs.aws.amazon.com/guardduty/latest/ug/what-is-guardduty.html",
          "tip": "Think of a service that detects threats across your account using machine learning and threat intelligence.",
          "explanation": "Amazon GuardDuty uses ML models and threat intelligence feeds to continuously detect threats across accounts. The closest wrong answer is AWS Config, which evaluates resource configuration compliance, whereas GuardDuty detects active threats."
        },
        {
          "id": "SCS-C03-0007",
          "question": "A security engineer needs to restrict an IAM role so it can only access a specific S3 bucket from a particular VPC endpoint. Which policy condition block should be added?",
          "choices": [
            {
              "id": "c4",
              "text": "Attach a security group to the IAM role that only allows traffic from the VPC",
              "isCorrect": false,
              "explanation": "Security groups are network-level controls for ENIs - they cannot be attached to IAM roles."
            },
            {
              "id": "c3",
              "text": "Add the VPC endpoint ID to the IAM role's trust policy as a Principal",
              "isCorrect": false,
              "explanation": "VPC endpoints are not IAM principals and cannot appear in a trust policy's Principal element."
            },
            {
              "id": "c1",
              "text": "{\"Condition\": {\"StringEquals\": {\"aws:sourceVpce\": \"vpce-1a2b3c4d\"}}}",
              "isCorrect": true,
              "explanation": "aws:sourceVpce condition restricts the policy to requests through the specified VPC endpoint."
            },
            {
              "id": "c2",
              "text": "{\"Condition\": {\"IpAddress\": {\"aws:SourceIp\": \"10.0.0.0/16\"}}}",
              "isCorrect": false,
              "explanation": "IpAddress/SourceIp restricts by IP range, not by VPC endpoint identity."
            }
          ],
          "selectCount": 1,
          "format": "json",
          "domain": "Identity and Access Management",
          "services": [
            "IAM",
            "S3"
          ],
          "docs": "https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies.html",
          "tip": "VPC endpoint restrictions in IAM use the aws:sourceVpce condition key with StringEquals.",
          "explanation": "The aws:sourceVpce condition key with StringEquals restricts access to requests that traverse a specific VPC endpoint."
        },
        {
          "id": "SCS-C03-0008",
          "question": "A security team wants to use AWS Config to detect S3 buckets that have public read access. Which CloudFormation resource snippet correctly defines this managed Config rule?",
          "choices": [
            {
              "id": "c4",
              "text": "Enable S3 Block Public Access at the account level - this replaces the need for Config rules",
              "isCorrect": false,
              "explanation": "Block Public Access is preventive - it does not detect existing violations like a Config rule does."
            },
            {
              "id": "c1",
              "text": "Type: AWS::Config::ConfigRule\nProperties:\n  ConfigRuleName: s3-bucket-public-read-prohibited\n  Source:\n    Owner: AWS\n    SourceIdentifier: S3_BUCKET_PUBLIC_READ_PROHIBITED",
              "isCorrect": true,
              "explanation": "AWS managed Config rule using Owner: AWS and the standard S3 public read detection identifier."
            },
            {
              "id": "c2",
              "text": "Type: AWS::Config::ConfigRule\nProperties:\n  ConfigRuleName: s3-bucket-public-read-prohibited\n  Source:\n    Owner: CUSTOM\n    SourceIdentifier: S3_BUCKET_PUBLIC_READ_PROHIBITED",
              "isCorrect": false,
              "explanation": "Owner: CUSTOM is for custom rules backed by Lambda functions, not AWS managed rules."
            },
            {
              "id": "c3",
              "text": "Use AWS CloudTrail to monitor S3:GetBucketPolicy API calls and alert when public access is detected",
              "isCorrect": false,
              "explanation": "CloudTrail monitors API calls but does not provide continuous compliance evaluation like AWS Config."
            }
          ],
          "selectCount": 1,
          "format": "yaml",
          "domain": "Detection",
          "services": [
            "Config",
            "CloudFormation",
            "S3"
          ],
          "docs": "https://docs.aws.amazon.com/config/latest/developerguide/WhatIsConfig.html",
          "tip": "AWS Config managed rules use Owner: AWS with a predefined SourceIdentifier.",
          "explanation": "AWS Config managed rules are pre-built by AWS and referenced with Owner: AWS plus a SourceIdentifier like S3_BUCKET_PUBLIC_READ_PROHIBITED."
        },
        {
          "id": "SCS-C03-0015",
          "question": "A security team needs to provide shell access to EC2 instances in private subnets without opening SSH ports or managing bastion hosts, while maintaining a full audit trail of every command executed. Which solution meets these requirements?",
          "choices": [
            {
              "id": "c3",
              "text": "EC2 Instance Connect",
              "isCorrect": false,
              "explanation": "Instance Connect still requires port 22 and does not natively log full session content."
            },
            {
              "id": "c1",
              "text": "Systems Manager Session Manager",
              "isCorrect": true,
              "explanation": "Session Manager establishes encrypted sessions through the SSM agent without opening inbound ports and can log sessions to S3 or CloudWatch Logs."
            },
            {
              "id": "c2",
              "text": "Deploy a bastion host with SSH key-based authentication",
              "isCorrect": false,
              "explanation": "Bastion hosts require open SSH ports and add operational burden."
            },
            {
              "id": "c4",
              "text": "VPN to the private subnet and SSH",
              "isCorrect": false,
              "explanation": "VPN plus SSH captures metadata but not command-level audit content."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Infrastructure Security",
          "services": [
            "Systems Manager",
            "EC2",
            "IAM",
            "CloudTrail"
          ],
          "docs": "https://docs.aws.amazon.com/systems-manager/latest/userguide/session-manager.html",
          "tip": "Look for a service that provides shell access through an agent, not through network-level connectivity.",
          "explanation": "Session Manager uses the SSM agent to create encrypted, IAM-authenticated sessions without inbound security group rules and logs session output for auditing."
        },
        {
          "id": "SCS-C03-0011",
          "question": "A compliance requirement mandates that all CloudWatch Logs log groups must be encrypted at rest with a customer-managed KMS key and that the key policy must allow the CloudWatch Logs service principal to use it. Which combination of steps achieves this?",
          "choices": [
            {
              "id": "c2",
              "text": "Enable SSE-S3 default encryption on the S3 bucket where CloudWatch Logs exports data and reference that bucket in each log group's settings",
              "isCorrect": false,
              "explanation": "S3 encryption applies only to exported log data in S3, not to log data stored within the CloudWatch Logs service itself."
            },
            {
              "id": "c3",
              "text": "Enable CloudTrail log file encryption with a KMS key and configure CloudWatch Logs as a CloudTrail destination",
              "isCorrect": false,
              "explanation": "CloudTrail encryption covers CloudTrail's own log files delivered to S3, not arbitrary CloudWatch Logs log groups."
            },
            {
              "id": "c1",
              "text": "Create a customer-managed KMS key with a key policy granting logs.<region>.amazonaws.com the kms:Encrypt, kms:Decrypt, kms:GenerateDataKey, and kms:DescribeKey actions, then associate the key with each log group",
              "isCorrect": true,
              "explanation": "CloudWatch Logs requires these four KMS actions in the key policy for the regional service principal to encrypt and decrypt log data."
            },
            {
              "id": "c4",
              "text": "Create an AWS-managed KMS key (alias aws/logs) and it will automatically encrypt all new log groups without any key policy changes",
              "isCorrect": false,
              "explanation": "CloudWatch Logs does not have an AWS-managed key. You must create and configure a customer-managed key explicitly."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Data Protection",
          "services": [
            "CloudWatch Logs",
            "KMS",
            "S3",
            "CloudTrail"
          ],
          "docs": "https://docs.aws.amazon.com/AmazonCloudWatch/latest/logs/encrypt-log-data-kms.html",
          "tip": "CloudWatch Logs encryption requires a customer-managed CMK - there is no AWS-managed key option for this service.",
          "explanation": "CloudWatch Logs supports encryption at rest only with customer-managed KMS keys. You must explicitly grant the regional service principal permission to use the key."
        },
        {
          "id": "SCS-C03-0012",
          "question": "A platform team wants to allow developers to create their own IAM roles for Lambda functions, but ensure those roles can never have permissions beyond what the platform team defines. Which mechanism should they use?",
          "choices": [
            {
              "id": "c1",
              "text": "Require developers to attach a permissions boundary to every role they create",
              "isCorrect": true,
              "explanation": "Permissions boundaries cap the maximum permissions a role can have, even if the role's identity policy grants broader access."
            },
            {
              "id": "c3",
              "text": "Create a single shared Lambda execution role managed by the platform team",
              "isCorrect": false,
              "explanation": "A shared role works but violates least privilege because all functions share the same permissions regardless of their needs."
            },
            {
              "id": "c4",
              "text": "Use an SCP to deny iam:CreateRole for all developers and have the platform team create roles on request",
              "isCorrect": false,
              "explanation": "This removes developer self-service entirely, creating operational bottlenecks without enabling delegation."
            },
            {
              "id": "c2",
              "text": "Grant developers iam:CreateRole but restrict the role's trust policy to lambda.amazonaws.com only",
              "isCorrect": false,
              "explanation": "Restricting the trust policy limits who can assume the role, but does not limit what permissions the role itself can have."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Identity and Access Management",
          "services": [
            "IAM",
            "Organizations",
            "STS"
          ],
          "docs": "https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies_boundaries.html",
          "tip": "You need a mechanism that caps maximum permissions while still allowing developers to create and manage their own roles.",
          "explanation": "IAM permissions boundaries act as a ceiling on the effective permissions of a role or user."
        }
      ],
      "perDomain": {
        "Identity and Access Management": {
          "total": 4,
          "correct": 1,
          "score": 25
        },
        "Incident Response": {
          "total": 2,
          "correct": 0,
          "score": 0
        },
        "Infrastructure Security": {
          "total": 2,
          "correct": 0,
          "score": 0
        },
        "Data Protection": {
          "total": 4,
          "correct": 0,
          "score": 0
        },
        "Detection": {
          "total": 3,
          "correct": 1,
          "score": 33
        }
      }
    },
    {
      "attemptId": "59d1b665-15d1-494c-9a7a-cb5bf5dadb84",
      "userId": "dev-user-001",
      "examCode": "SCS-C03",
      "examVersion": null,
      "attemptSchemaVersion": 1,
      "startedAt": "2026-02-17T08:18:07.250Z",
      "finishedAt": null,
      "score": null,
      "answers": [
        {
          "questionId": "SCS-C03-0019",
          "selectedChoiceId": "c1",
          "selectedChoiceIds": null,
          "selectedIndex": null,
          "selectedIndices": null,
          "correct": true,
          "timeMs": 0,
          "showTip": false,
          "createdAt": "2026-02-17T08:22:00.587Z"
        }
      ],
      "metadata": {
        "serviceKeywords": [],
        "domains": [],
        "services": []
      },
      "questions": [
        {
          "id": "SCS-C03-0025",
          "question": "A Lambda function in a private subnet needs to call the Secrets Manager API to retrieve database credentials. The security team prohibits all internet-bound traffic from the VPC. How should the architect configure network access so the Lambda function can reach Secrets Manager without traversing the internet?",
          "choices": [
            {
              "id": "c1",
              "text": "Create an interface VPC endpoint (PrivateLink) for Secrets Manager in the same VPC and ensure the Lambda function's security group allows outbound HTTPS to the endpoint",
              "isCorrect": true,
              "explanation": "An interface VPC endpoint creates private ENIs within the VPC that route traffic to the Secrets Manager API entirely over the AWS private network, with no internet path required."
            },
            {
              "id": "c3",
              "text": "Attach an Elastic IP to the Lambda function's ENI for direct outbound access",
              "isCorrect": false,
              "explanation": "Lambda functions in a VPC do not support Elastic IPs, and this approach would use the internet gateway, which is prohibited."
            },
            {
              "id": "c2",
              "text": "Add a NAT Gateway to the VPC and route the Lambda subnet's traffic through it",
              "isCorrect": false,
              "explanation": "A NAT Gateway provides internet access for outbound traffic, which violates the security team's prohibition on internet-bound traffic from the VPC."
            },
            {
              "id": "c4",
              "text": "Configure the Lambda function outside the VPC so it can access Secrets Manager over the internet by default",
              "isCorrect": false,
              "explanation": "Placing the function outside the VPC gives it internet access to AWS APIs, but the question states the function is in a private subnet, and moving it out may break access to other VPC resources like the database."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Infrastructure Security",
          "services": [
            "Lambda",
            "VPC",
            "NAT Gateway",
            "PrivateLink",
            "Secrets Manager"
          ],
          "docs": "https://docs.aws.amazon.com/lambda/latest/dg/configuration-vpc.html",
          "tip": "When internet access is prohibited, PrivateLink endpoints bring AWS service APIs into the VPC over private connections.",
          "explanation": "Interface VPC endpoints (powered by AWS PrivateLink) create private IP addresses inside the VPC that serve as entry points for AWS service APIs. Traffic never leaves the AWS network, satisfying zero-internet-egress security requirements while allowing Lambda to call Secrets Manager."
        },
        {
          "id": "SCS-C03-0006",
          "question": "A security team needs to centrally manage findings from multiple AWS security services and ensure encryption of sensitive data at rest. Which TWO services should they use together? (Select TWO)",
          "choices": [
            {
              "id": "c4",
              "text": "AWS CloudFormation",
              "isCorrect": false,
              "explanation": "CloudFormation is an infrastructure-as-code service, not a security findings tool."
            },
            {
              "id": "c5",
              "text": "Amazon EC2",
              "isCorrect": false,
              "explanation": "EC2 provides virtual machines, not security findings management."
            },
            {
              "id": "c3",
              "text": "Amazon SQS",
              "isCorrect": false,
              "explanation": "SQS is a message queuing service, not related to security findings or encryption."
            },
            {
              "id": "c2",
              "text": "AWS KMS",
              "isCorrect": true,
              "explanation": "KMS provides centralized encryption key management for encrypting data at rest."
            },
            {
              "id": "c1",
              "text": "AWS Security Hub",
              "isCorrect": true,
              "explanation": "Security Hub provides a comprehensive view of security alerts and compliance status across accounts."
            }
          ],
          "selectCount": 2,
          "format": "text",
          "domain": "Detection",
          "services": [
            "Security Hub",
            "KMS",
            "SQS",
            "CloudFormation",
            "EC2"
          ],
          "docs": "https://docs.aws.amazon.com/securityhub/latest/userguide/what-is-securityhub.html",
          "tip": "Think about centralized findings aggregation and key management.",
          "explanation": "Security Hub aggregates and normalizes findings and KMS provides the keys to encrypt sensitive data."
        },
        {
          "id": "SCS-C03-0014",
          "question": "A data lake team manages a single S3 bucket accessed by multiple applications across different VPCs. They need to enforce that each application can only reach the bucket from its own VPC and can only access objects under its designated prefix. Which approach provides the strongest isolation with the least policy complexity?",
          "choices": [
            {
              "id": "c3",
              "text": "Create one VPC endpoint per VPC and use endpoint policies",
              "isCorrect": false,
              "explanation": "Endpoint policies are coarse for prefix-level scoping."
            },
            {
              "id": "c4",
              "text": "Replicate data into separate per-application buckets",
              "isCorrect": false,
              "explanation": "Replication increases cost and complexity."
            },
            {
              "id": "c2",
              "text": "Write a single S3 bucket policy with separate statements per application",
              "isCorrect": false,
              "explanation": "A single bucket policy becomes difficult to manage and has size limits."
            },
            {
              "id": "c1",
              "text": "Create a separate S3 Access Point for each application",
              "isCorrect": true,
              "explanation": "S3 Access Points allow per-application network and permission scoping against a shared bucket."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Data Protection",
          "services": [
            "S3",
            "IAM",
            "VPC",
            "PrivateLink"
          ],
          "docs": "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-points.html",
          "tip": "Consider a feature that lets you create named network-scoped entry points to a single bucket.",
          "explanation": "S3 Access Points provide named, per-application entry points to a bucket, each with its own policy and optional VPC restriction."
        },
        {
          "id": "SCS-C03-0020",
          "question": "After enabling GuardDuty S3 Protection, a security analyst notices a finding of type Policy:S3/BucketAnonymousAccessGranted for a production data bucket. The analyst needs to determine which principal changed the bucket policy and when. Which data source provides this information?",
          "choices": [
            {
              "id": "c1",
              "text": "CloudTrail management events showing the PutBucketPolicy API call",
              "isCorrect": true,
              "explanation": "CloudTrail records the identity (principal), timestamp, source IP, and request parameters for S3 control-plane API calls like PutBucketPolicy. This is the authoritative source for who changed the policy and when."
            },
            {
              "id": "c3",
              "text": "S3 server access logs for the data bucket",
              "isCorrect": false,
              "explanation": "S3 server access logs capture object-level read/write requests, not bucket policy changes. Control-plane actions like PutBucketPolicy are not recorded in access logs."
            },
            {
              "id": "c4",
              "text": "VPC Flow Logs for the VPC where the analyst is working",
              "isCorrect": false,
              "explanation": "VPC Flow Logs capture network-layer metadata (IP, port, protocol) but not API-level details like which principal called PutBucketPolicy."
            },
            {
              "id": "c2",
              "text": "The GuardDuty finding detail itself, which includes the actor and timestamp",
              "isCorrect": false,
              "explanation": "GuardDuty findings identify the affected resource and the anomaly but do not always include the full details of who made the original policy change. CloudTrail provides the definitive audit trail."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Detection",
          "services": [
            "GuardDuty",
            "CloudTrail",
            "S3",
            "Security Hub"
          ],
          "docs": "https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_s3-protection.html",
          "tip": "Distinguish between data-plane logs (S3 access logs, VPC Flow Logs) and control-plane logs (CloudTrail) when investigating policy changes.",
          "explanation": "CloudTrail management events are the single source of truth for AWS API activity. When investigating who changed a resource configuration, always start with CloudTrail, which records the IAM principal, the API action, the request parameters, and the exact timestamp."
        },
        {
          "id": "SCS-C03-0002",
          "question": "During an incident, which service lets you run investigative notebooks and analyze data?",
          "choices": [
            {
              "id": "c3",
              "text": "AWS Shield",
              "isCorrect": false,
              "explanation": "AWS Shield provides DDoS protections, not forensic investigation tools."
            },
            {
              "id": "c1",
              "text": "AWS Systems Manager",
              "isCorrect": false,
              "explanation": "Systems Manager helps manage instances but is not focused on security investigation notebooks."
            },
            {
              "id": "c4",
              "text": "AWS CloudTrail",
              "isCorrect": false,
              "explanation": "CloudTrail records API activity and is useful for forensics, but Detective provides investigative workflows."
            },
            {
              "id": "c2",
              "text": "Amazon Detective",
              "isCorrect": true,
              "explanation": "Amazon Detective is designed to analyze, visualize, and conduct investigations into potential security issues."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Incident Response",
          "services": [
            "Detective",
            "Systems Manager",
            "Shield",
            "CloudTrail"
          ],
          "docs": "https://docs.aws.amazon.com/detective/latest/adminguide/what-is.html",
          "tip": "This service helps visualize and investigate security issues by linking related findings and activity.",
          "explanation": "Amazon Detective automatically collects log data from VPC Flow Logs, CloudTrail, and GuardDuty, then builds a graph model that links related events so analysts can visually trace activity."
        },
        {
          "id": "SCS-C03-0005",
          "question": "Which service provides managed encryption keys that you can use to encrypt data at rest?",
          "choices": [
            {
              "id": "c4",
              "text": "AWS WAF",
              "isCorrect": false,
              "explanation": "AWS WAF is a web application firewall, not key management."
            },
            {
              "id": "c2",
              "text": "AWS IAM",
              "isCorrect": false,
              "explanation": "AWS IAM handles identity and permissions, not key storage or encryption primitives."
            },
            {
              "id": "c3",
              "text": "AWS Shield",
              "isCorrect": false,
              "explanation": "AWS Shield protects against DDoS attacks, not key management."
            },
            {
              "id": "c1",
              "text": "AWS KMS",
              "isCorrect": true,
              "explanation": "AWS KMS is the managed service for creating and controlling encryption keys."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Data Protection",
          "services": [
            "KMS",
            "IAM",
            "Shield",
            "WAF"
          ],
          "docs": "https://docs.aws.amazon.com/kms/latest/developerguide/overview.html",
          "tip": "Key management service with envelope encryption support.",
          "explanation": "AWS KMS provides centralized creation, rotation, and access control of encryption keys used to protect data at rest across services like S3, EBS, and RDS."
        },
        {
          "id": "SCS-C03-0010",
          "question": "A security architect needs to prevent any account in the organisation from launching EC2 instances outside of eu-west-1 and eu-west-2, regardless of the IAM permissions granted within those accounts. Which approach should they use?",
          "choices": [
            {
              "id": "c4",
              "text": "Use a CloudFormation StackSet with a hook that blocks ec2:RunInstances in disallowed regions",
              "isCorrect": false,
              "explanation": "CloudFormation hooks validate CloudFormation-managed resources only, not direct API calls or console launches."
            },
            {
              "id": "c2",
              "text": "Create an IAM policy in each account that denies ec2:RunInstances outside eu-west-1 and eu-west-2, and attach it to every IAM user and role",
              "isCorrect": false,
              "explanation": "Per-account IAM policies can be removed by local administrators, and new users or roles might not receive the policy."
            },
            {
              "id": "c1",
              "text": "Attach a Service Control Policy (SCP) to the organisation root or target OUs that denies ec2:RunInstances unless the aws:RequestedRegion condition matches eu-west-1 or eu-west-2",
              "isCorrect": true,
              "explanation": "SCPs set maximum permission boundaries across all accounts in an OU or organisation, overriding any IAM policy within those accounts."
            },
            {
              "id": "c3",
              "text": "Deploy an AWS Config rule that evaluates EC2 instances and flags any launched outside the allowed regions as non-compliant",
              "isCorrect": false,
              "explanation": "Config rules are detective, not preventive - the instance would already be running before Config flags it."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Identity and Access Management",
          "services": [
            "Organizations",
            "IAM",
            "Config",
            "CloudFormation"
          ],
          "docs": "https://docs.aws.amazon.com/organizations/latest/userguide/orgs_manage_policies_scps.html",
          "tip": "You need a preventive control that applies across all accounts regardless of each account's local IAM policies.",
          "explanation": "Service Control Policies (SCPs) in AWS Organizations act as guardrails that define the maximum permissions available to all principals in member accounts."
        },
        {
          "id": "SCS-C03-0008",
          "question": "A security team wants to use AWS Config to detect S3 buckets that have public read access. Which CloudFormation resource snippet correctly defines this managed Config rule?",
          "choices": [
            {
              "id": "c4",
              "text": "Enable S3 Block Public Access at the account level - this replaces the need for Config rules",
              "isCorrect": false,
              "explanation": "Block Public Access is preventive - it does not detect existing violations like a Config rule does."
            },
            {
              "id": "c1",
              "text": "Type: AWS::Config::ConfigRule\nProperties:\n  ConfigRuleName: s3-bucket-public-read-prohibited\n  Source:\n    Owner: AWS\n    SourceIdentifier: S3_BUCKET_PUBLIC_READ_PROHIBITED",
              "isCorrect": true,
              "explanation": "AWS managed Config rule using Owner: AWS and the standard S3 public read detection identifier."
            },
            {
              "id": "c2",
              "text": "Type: AWS::Config::ConfigRule\nProperties:\n  ConfigRuleName: s3-bucket-public-read-prohibited\n  Source:\n    Owner: CUSTOM\n    SourceIdentifier: S3_BUCKET_PUBLIC_READ_PROHIBITED",
              "isCorrect": false,
              "explanation": "Owner: CUSTOM is for custom rules backed by Lambda functions, not AWS managed rules."
            },
            {
              "id": "c3",
              "text": "Use AWS CloudTrail to monitor S3:GetBucketPolicy API calls and alert when public access is detected",
              "isCorrect": false,
              "explanation": "CloudTrail monitors API calls but does not provide continuous compliance evaluation like AWS Config."
            }
          ],
          "selectCount": 1,
          "format": "yaml",
          "domain": "Detection",
          "services": [
            "Config",
            "CloudFormation",
            "S3"
          ],
          "docs": "https://docs.aws.amazon.com/config/latest/developerguide/WhatIsConfig.html",
          "tip": "AWS Config managed rules use Owner: AWS with a predefined SourceIdentifier.",
          "explanation": "AWS Config managed rules are pre-built by AWS and referenced with Owner: AWS plus a SourceIdentifier like S3_BUCKET_PUBLIC_READ_PROHIBITED."
        },
        {
          "id": "SCS-C03-0018",
          "question": "A company runs workloads on Amazon EKS and needs each Kubernetes pod to assume a unique IAM role with fine-grained permissions. The trust policy must ensure only the intended service account in a specific namespace can assume the role. Which trust policy snippet correctly restricts role assumption to the pod's OIDC identity?",
          "choices": [
            {
              "id": "c2",
              "text": "{\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"eks.amazonaws.com\"},\"Action\":\"sts:AssumeRole\"}",
              "isCorrect": false,
              "explanation": "This trusts the EKS service itself (the control plane), not individual pod identities. Any EKS-managed component could assume this role, not just the intended pod."
            },
            {
              "id": "c3",
              "text": "{\"Effect\":\"Allow\",\"Principal\":{\"AWS\":\"arn:aws:iam::123456789012:role/eks-node-role\"},\"Action\":\"sts:AssumeRole\"}",
              "isCorrect": false,
              "explanation": "Trusting the node role lets every pod on that node assume this role, eliminating per-pod isolation."
            },
            {
              "id": "c4",
              "text": "{\"Effect\":\"Allow\",\"Principal\":{\"Federated\":\"cognito-identity.amazonaws.com\"},\"Action\":\"sts:AssumeRoleWithWebIdentity\"}",
              "isCorrect": false,
              "explanation": "Cognito Identity is for end-user identity federation, not Kubernetes workload identity. EKS uses its own OIDC provider endpoint."
            },
            {
              "id": "c1",
              "text": "{\"Effect\":\"Allow\",\"Principal\":{\"Federated\":\"arn:aws:iam::123456789012:oidc-provider/oidc.eks.us-east-1.amazonaws.com/id/EXAMPLED539D4633E53DE1B71EXAMPLE\"},\"Action\":\"sts:AssumeRoleWithWebIdentity\",\"Condition\":{\"StringEquals\":{\"oidc.eks.us-east-1.amazonaws.com/id/EXAMPLED539D4633E53DE1B71EXAMPLE:sub\":\"system:serviceaccount:app-ns:app-sa\"}}}",
              "isCorrect": true,
              "explanation": "This uses the EKS OIDC provider as a Federated principal with AssumeRoleWithWebIdentity, and the Condition restricts the sub claim to the exact namespace:serviceaccount pair."
            }
          ],
          "selectCount": 1,
          "format": "json",
          "domain": "Identity and Access Management",
          "services": [
            "IAM",
            "STS",
            "Cognito",
            "EKS"
          ],
          "docs": "https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_providers_oidc.html",
          "tip": "EKS IRSA (IAM Roles for Service Accounts) uses the cluster's OIDC provider URL as a federated principal and filters by the sub claim.",
          "explanation": "IRSA projects a signed OIDC token into each pod, and the trust policy uses the cluster OIDC provider as a Federated principal with a Condition on the sub claim (namespace:serviceaccount). This ensures only the precise service account in the correct namespace can assume the role."
        },
        {
          "id": "SCS-C03-0019",
          "question": "A financial services firm must store audit logs for seven years in a manner that no user, including root, can delete or modify them before the retention period expires. Regulators require proof of immutability. Which S3 feature satisfies these requirements?",
          "choices": [
            {
              "id": "c3",
              "text": "S3 Versioning with an S3 Lifecycle rule to transition objects to Glacier after 30 days",
              "isCorrect": false,
              "explanation": "Versioning preserves prior versions but does not prevent deletion of version markers. Glacier transition reduces cost but does not enforce immutability."
            },
            {
              "id": "c2",
              "text": "S3 Object Lock in Governance mode with a seven-year retention period",
              "isCorrect": false,
              "explanation": "Governance mode allows users with the s3:BypassGovernanceRetention permission to delete objects before the retention period ends, which does not meet the absolute immutability requirement."
            },
            {
              "id": "c1",
              "text": "S3 Object Lock in Compliance mode with a seven-year retention period",
              "isCorrect": true,
              "explanation": "Compliance mode prevents anyone, including the root user, from deleting or overwriting an object version until the retention date passes. This satisfies regulatory immutability requirements."
            },
            {
              "id": "c4",
              "text": "Enable MFA Delete on the S3 bucket to require MFA for all delete operations",
              "isCorrect": false,
              "explanation": "MFA Delete requires an additional authentication step but does not make objects truly immutable. A user with MFA can still delete them at any time."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Data Protection",
          "services": [
            "S3",
            "S3 Object Lock",
            "Glacier",
            "Backup"
          ],
          "docs": "https://docs.aws.amazon.com/AmazonS3/latest/userguide/object-lock.html",
          "tip": "Compliance mode is the only S3 mechanism where even the root account cannot shorten or remove the retention lock.",
          "explanation": "S3 Object Lock Compliance mode creates a WORM (Write Once Read Many) storage model. Once set, neither the object nor its retention settings can be altered or deleted by any principal until the retention period expires, meeting SEC 17a-4(f) and similar regulatory requirements."
        },
        {
          "id": "SCS-C03-0024",
          "question": "A security architect wants to continuously detect any S3 buckets, IAM roles, KMS keys, or Lambda functions that are shared with external AWS accounts or public access. The solution must generate findings automatically without requiring custom code. Which service should they enable?",
          "choices": [
            {
              "id": "c4",
              "text": "Amazon GuardDuty",
              "isCorrect": false,
              "explanation": "GuardDuty detects threats based on anomalous behaviour and threat intelligence. It does not analyze resource policies to find intentional cross-account sharing or public access grants."
            },
            {
              "id": "c2",
              "text": "AWS Config with the s3-bucket-public-read-prohibited managed rule",
              "isCorrect": false,
              "explanation": "This Config rule only checks S3 public read access. It does not cover cross-account sharing of IAM roles, KMS keys, or Lambda functions."
            },
            {
              "id": "c1",
              "text": "IAM Access Analyzer",
              "isCorrect": true,
              "explanation": "Access Analyzer uses automated reasoning to analyze resource-based policies and identifies resources that are accessible from outside the zone of trust (account or organisation), generating findings for each."
            },
            {
              "id": "c3",
              "text": "AWS Trusted Advisor security checks",
              "isCorrect": false,
              "explanation": "Trusted Advisor checks a limited set of security best practices (e.g., open security groups, root MFA) but does not perform policy-level analysis of cross-account resource sharing."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Identity and Access Management",
          "services": [
            "IAM Access Analyzer",
            "IAM",
            "S3",
            "Lambda",
            "KMS"
          ],
          "docs": "https://docs.aws.amazon.com/IAM/latest/UserGuide/access-analyzer-getting-started.html",
          "tip": "This service uses automated reasoning (formal logic) over policies, not anomaly detection or predefined compliance rules.",
          "explanation": "IAM Access Analyzer applies Zelkova-based automated reasoning to evaluate resource-based policies on S3 buckets, SQS queues, IAM roles, KMS keys, Lambda functions, and Secrets Manager secrets. It produces actionable findings whenever a policy grants access outside the defined zone of trust, with no custom code required."
        },
        {
          "id": "SCS-C03-0011",
          "question": "A compliance requirement mandates that all CloudWatch Logs log groups must be encrypted at rest with a customer-managed KMS key and that the key policy must allow the CloudWatch Logs service principal to use it. Which combination of steps achieves this?",
          "choices": [
            {
              "id": "c2",
              "text": "Enable SSE-S3 default encryption on the S3 bucket where CloudWatch Logs exports data and reference that bucket in each log group's settings",
              "isCorrect": false,
              "explanation": "S3 encryption applies only to exported log data in S3, not to log data stored within the CloudWatch Logs service itself."
            },
            {
              "id": "c4",
              "text": "Create an AWS-managed KMS key (alias aws/logs) and it will automatically encrypt all new log groups without any key policy changes",
              "isCorrect": false,
              "explanation": "CloudWatch Logs does not have an AWS-managed key. You must create and configure a customer-managed key explicitly."
            },
            {
              "id": "c3",
              "text": "Enable CloudTrail log file encryption with a KMS key and configure CloudWatch Logs as a CloudTrail destination",
              "isCorrect": false,
              "explanation": "CloudTrail encryption covers CloudTrail's own log files delivered to S3, not arbitrary CloudWatch Logs log groups."
            },
            {
              "id": "c1",
              "text": "Create a customer-managed KMS key with a key policy granting logs.<region>.amazonaws.com the kms:Encrypt, kms:Decrypt, kms:GenerateDataKey, and kms:DescribeKey actions, then associate the key with each log group",
              "isCorrect": true,
              "explanation": "CloudWatch Logs requires these four KMS actions in the key policy for the regional service principal to encrypt and decrypt log data."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Data Protection",
          "services": [
            "CloudWatch Logs",
            "KMS",
            "S3",
            "CloudTrail"
          ],
          "docs": "https://docs.aws.amazon.com/AmazonCloudWatch/latest/logs/encrypt-log-data-kms.html",
          "tip": "CloudWatch Logs encryption requires a customer-managed CMK - there is no AWS-managed key option for this service.",
          "explanation": "CloudWatch Logs supports encryption at rest only with customer-managed KMS keys. You must explicitly grant the regional service principal permission to use the key."
        },
        {
          "id": "SCS-C03-0004",
          "question": "Which feature helps enforce least privilege by providing temporary credentials?",
          "choices": [
            {
              "id": "c4",
              "text": "Amazon Cognito",
              "isCorrect": false,
              "explanation": "Amazon Cognito provides user identity for apps, but the core mechanism for temporary AWS credentials is STS with roles."
            },
            {
              "id": "c2",
              "text": "IAM Users with long-term access keys",
              "isCorrect": false,
              "explanation": "IAM Users with long-term keys are not recommended for least-privilege patterns."
            },
            {
              "id": "c3",
              "text": "Security Groups",
              "isCorrect": false,
              "explanation": "Security Groups are network controls, not credential mechanisms."
            },
            {
              "id": "c1",
              "text": "IAM Roles with STS",
              "isCorrect": true,
              "explanation": "IAM Roles with STS allow issuance of temporary credentials for short-term access."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Identity and Access Management",
          "services": [
            "IAM",
            "STS",
            "Cognito"
          ],
          "docs": "https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles.html",
          "tip": "Temporary credentials reduce the risk from long-lived keys.",
          "explanation": "IAM Roles combined with AWS STS issue temporary credentials that automatically expire, reducing blast radius if leaked."
        },
        {
          "id": "SCS-C03-0003",
          "question": "To restrict traffic at the network edge for HTTP endpoints, which service should you combine with CloudFront?",
          "choices": [
            {
              "id": "c3",
              "text": "VPC Endpoint",
              "isCorrect": false,
              "explanation": "VPC Endpoints provide private connectivity to services within a VPC, not edge HTTP filtering."
            },
            {
              "id": "c1",
              "text": "AWS WAF",
              "isCorrect": true,
              "explanation": "AWS WAF is the web application firewall used with CloudFront to filter HTTP(S) traffic."
            },
            {
              "id": "c4",
              "text": "AWS KMS",
              "isCorrect": false,
              "explanation": "AWS KMS is for key management and encryption, not traffic filtering."
            },
            {
              "id": "c2",
              "text": "Security Groups",
              "isCorrect": false,
              "explanation": "Security Groups control traffic to EC2 at the instance level, not the CloudFront edge."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Infrastructure Security",
          "services": [
            "WAF",
            "CloudFront",
            "Security Groups"
          ],
          "docs": "https://docs.aws.amazon.com/waf/latest/developerguide/waf-chapter.html",
          "tip": "Think web application protection rules that block common attack patterns at the edge.",
          "explanation": "AWS WAF integrates natively with CloudFront, ALB, and API Gateway to inspect and filter HTTP(S) requests using rules such as rate limiting and SQL injection detection."
        },
        {
          "id": "SCS-C03-0023",
          "question": "A web application team needs to ensure that TLS certificates on their internet-facing ALBs are renewed automatically without any manual intervention or downtime. Certificates must support multiple subdomain names (e.g., api.example.com, app.example.com). Which approach meets these requirements?",
          "choices": [
            {
              "id": "c4",
              "text": "Generate a self-signed certificate for each subdomain and configure the ALB to present them using SNI",
              "isCorrect": false,
              "explanation": "Self-signed certificates are not trusted by browsers and will produce security warnings. They also require manual rotation, defeating the automation requirement."
            },
            {
              "id": "c2",
              "text": "Purchase a wildcard certificate from a third-party CA, import it into ACM, and set a calendar reminder to renew it annually",
              "isCorrect": false,
              "explanation": "Imported certificates in ACM are not automatically renewed. Manual renewal and re-import is required, which introduces risk of expiration and human error."
            },
            {
              "id": "c3",
              "text": "Use Let's Encrypt with certbot running on the ALB instances to obtain and renew certificates",
              "isCorrect": false,
              "explanation": "ALBs are managed services; you cannot run certbot or any agent on them. Let's Encrypt certificates must be imported into ACM, losing automatic renewal."
            },
            {
              "id": "c1",
              "text": "Request a public ACM certificate with Subject Alternative Names (SANs) for each subdomain using DNS validation, and associate it with the ALB",
              "isCorrect": true,
              "explanation": "ACM public certificates with DNS validation renew automatically as long as the CNAME validation records remain in place. SANs allow multiple subdomains on a single certificate, and ALB natively integrates with ACM for zero-downtime deployment."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Data Protection",
          "services": [
            "ACM",
            "CloudFront",
            "ALB",
            "Route 53"
          ],
          "docs": "https://docs.aws.amazon.com/acm/latest/userguide/acm-overview.html",
          "tip": "ACM's automatic renewal only works for certificates it issues (not imported ones), and DNS validation is the set-and-forget option.",
          "explanation": "AWS Certificate Manager issues free public certificates that renew automatically when DNS validation is used. By adding SANs for each subdomain, a single certificate covers multiple endpoints. ACM's native integration with ALB means certificate deployment and rotation happen transparently."
        },
        {
          "id": "SCS-C03-0016",
          "question": "A development team stores database credentials in environment variables baked into their container images. The security team requires that credentials be rotated every 30 days without redeploying containers and that all credential access be auditable. Which approach best meets these requirements?",
          "choices": [
            {
              "id": "c2",
              "text": "Store credentials in SSM Parameter Store SecureString parameters and write a cron job to update them monthly",
              "isCorrect": false,
              "explanation": "Parameter Store SecureStrings can hold secrets but lack built-in automatic rotation. A cron job is fragile and requires custom coordination with both the parameter and the database."
            },
            {
              "id": "c4",
              "text": "Use IAM database authentication to eliminate passwords entirely",
              "isCorrect": false,
              "explanation": "IAM database authentication works only with supported engines (Aurora MySQL/PostgreSQL, RDS MySQL/PostgreSQL) and may not cover all the team's databases. It also does not address other types of credentials."
            },
            {
              "id": "c3",
              "text": "Encrypt the environment variables at build time with a KMS key and decrypt them at container start",
              "isCorrect": false,
              "explanation": "This protects secrets at rest in the image, but rotating requires rebuilding and redeploying the container, which violates the no-redeploy requirement."
            },
            {
              "id": "c1",
              "text": "Store credentials in AWS Secrets Manager with automatic rotation enabled and retrieve them at runtime using the Secrets Manager SDK",
              "isCorrect": true,
              "explanation": "Secrets Manager supports automatic rotation via Lambda, provides versioned secrets so applications always fetch the current value at runtime, and logs all access through CloudTrail."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Data Protection",
          "services": [
            "Secrets Manager",
            "Parameter Store",
            "KMS",
            "Lambda"
          ],
          "docs": "https://docs.aws.amazon.com/secretsmanager/latest/userguide/intro.html",
          "tip": "Automatic rotation without redeployment means the application must fetch secrets dynamically, not rely on values injected at build or deploy time.",
          "explanation": "Secrets Manager is purpose-built for credential lifecycle management. Its rotation feature invokes a Lambda function on a schedule to update both the secret value and the target resource (e.g., RDS password), while applications retrieve the current secret at runtime, eliminating the need for redeployment."
        },
        {
          "id": "SCS-C03-0007",
          "question": "A security engineer needs to restrict an IAM role so it can only access a specific S3 bucket from a particular VPC endpoint. Which policy condition block should be added?",
          "choices": [
            {
              "id": "c3",
              "text": "Add the VPC endpoint ID to the IAM role's trust policy as a Principal",
              "isCorrect": false,
              "explanation": "VPC endpoints are not IAM principals and cannot appear in a trust policy's Principal element."
            },
            {
              "id": "c1",
              "text": "{\"Condition\": {\"StringEquals\": {\"aws:sourceVpce\": \"vpce-1a2b3c4d\"}}}",
              "isCorrect": true,
              "explanation": "aws:sourceVpce condition restricts the policy to requests through the specified VPC endpoint."
            },
            {
              "id": "c2",
              "text": "{\"Condition\": {\"IpAddress\": {\"aws:SourceIp\": \"10.0.0.0/16\"}}}",
              "isCorrect": false,
              "explanation": "IpAddress/SourceIp restricts by IP range, not by VPC endpoint identity."
            },
            {
              "id": "c4",
              "text": "Attach a security group to the IAM role that only allows traffic from the VPC",
              "isCorrect": false,
              "explanation": "Security groups are network-level controls for ENIs - they cannot be attached to IAM roles."
            }
          ],
          "selectCount": 1,
          "format": "json",
          "domain": "Identity and Access Management",
          "services": [
            "IAM",
            "S3"
          ],
          "docs": "https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies.html",
          "tip": "VPC endpoint restrictions in IAM use the aws:sourceVpce condition key with StringEquals.",
          "explanation": "The aws:sourceVpce condition key with StringEquals restricts access to requests that traverse a specific VPC endpoint."
        },
        {
          "id": "SCS-C03-0015",
          "question": "A security team needs to provide shell access to EC2 instances in private subnets without opening SSH ports or managing bastion hosts, while maintaining a full audit trail of every command executed. Which solution meets these requirements?",
          "choices": [
            {
              "id": "c1",
              "text": "Systems Manager Session Manager",
              "isCorrect": true,
              "explanation": "Session Manager establishes encrypted sessions through the SSM agent without opening inbound ports and can log sessions to S3 or CloudWatch Logs."
            },
            {
              "id": "c3",
              "text": "EC2 Instance Connect",
              "isCorrect": false,
              "explanation": "Instance Connect still requires port 22 and does not natively log full session content."
            },
            {
              "id": "c4",
              "text": "VPN to the private subnet and SSH",
              "isCorrect": false,
              "explanation": "VPN plus SSH captures metadata but not command-level audit content."
            },
            {
              "id": "c2",
              "text": "Deploy a bastion host with SSH key-based authentication",
              "isCorrect": false,
              "explanation": "Bastion hosts require open SSH ports and add operational burden."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Infrastructure Security",
          "services": [
            "Systems Manager",
            "EC2",
            "IAM",
            "CloudTrail"
          ],
          "docs": "https://docs.aws.amazon.com/systems-manager/latest/userguide/session-manager.html",
          "tip": "Look for a service that provides shell access through an agent, not through network-level connectivity.",
          "explanation": "Session Manager uses the SSM agent to create encrypted, IAM-authenticated sessions without inbound security group rules and logs session output for auditing."
        },
        {
          "id": "SCS-C03-0001",
          "question": "Which AWS service helps aggregate and analyze security findings across accounts?",
          "choices": [
            {
              "id": "c4",
              "text": "Amazon SNS",
              "isCorrect": false,
              "explanation": "Amazon SNS is a notification service, not a security findings aggregator."
            },
            {
              "id": "c1",
              "text": "Amazon GuardDuty",
              "isCorrect": true,
              "explanation": "GuardDuty is a threat detection service that continuously monitors for malicious activity and unauthorized behavior."
            },
            {
              "id": "c3",
              "text": "AWS WAF",
              "isCorrect": false,
              "explanation": "AWS WAF is a web application firewall focused on HTTP(S) protections."
            },
            {
              "id": "c2",
              "text": "AWS Config",
              "isCorrect": false,
              "explanation": "AWS Config tracks resource configuration and compliance, not threat detection."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Detection",
          "services": [
            "GuardDuty",
            "Config",
            "WAF",
            "SNS"
          ],
          "docs": "https://docs.aws.amazon.com/guardduty/latest/ug/what-is-guardduty.html",
          "tip": "Think of a service that detects threats across your account using machine learning and threat intelligence.",
          "explanation": "Amazon GuardDuty uses ML models and threat intelligence feeds to continuously detect threats across accounts. The closest wrong answer is AWS Config, which evaluates resource configuration compliance, whereas GuardDuty detects active threats."
        },
        {
          "id": "SCS-C03-0013",
          "question": "An organisation wants to automatically isolate an EC2 instance when GuardDuty detects cryptocurrency mining activity. Which architecture achieves automated remediation with the least operational overhead?",
          "choices": [
            {
              "id": "c4",
              "text": "Use Systems Manager Automation runbooks triggered by a CPU alarm to stop instances",
              "isCorrect": false,
              "explanation": "CPU alarms are generic and can cause false positives."
            },
            {
              "id": "c1",
              "text": "Configure GuardDuty findings to flow into EventBridge and trigger a Lambda that isolates the instance",
              "isCorrect": true,
              "explanation": "EventBridge rules can filter GuardDuty finding types and invoke Lambda for automated remediation."
            },
            {
              "id": "c2",
              "text": "Enable Security Hub automated response playbooks to quarantine instances",
              "isCorrect": false,
              "explanation": "Security Hub aggregates findings but does not have built-in quarantine playbooks."
            },
            {
              "id": "c3",
              "text": "Schedule a Lambda to poll GuardDuty every five minutes and isolate flagged instances",
              "isCorrect": false,
              "explanation": "Polling introduces delay and extra maintenance."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Incident Response",
          "services": [
            "GuardDuty",
            "Security Hub",
            "EventBridge",
            "Lambda",
            "Systems Manager"
          ],
          "docs": "https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_finding-types-ec2.html",
          "tip": "The key is event-driven, near-real-time response with minimal ongoing maintenance.",
          "explanation": "GuardDuty publishes findings to EventBridge in near-real-time, enabling immediate Lambda-driven remediation."
        },
        {
          "id": "SCS-C03-0017",
          "question": "A network security team must capture all accepted and rejected traffic metadata for forensic analysis across 200 VPCs in a multi-account organisation. They need to query weeks of historical data on demand without maintaining always-on infrastructure. Which architecture meets these requirements most cost-effectively?",
          "choices": [
            {
              "id": "c2",
              "text": "Send VPC Flow Logs to CloudWatch Logs in each account and use CloudWatch Logs Insights for queries",
              "isCorrect": false,
              "explanation": "CloudWatch Logs Insights works well for recent data but becomes expensive at high volume over weeks, and cross-account querying adds operational complexity compared to a centralised S3 approach."
            },
            {
              "id": "c4",
              "text": "Enable Traffic Mirroring on all ENIs and capture full packets for analysis",
              "isCorrect": false,
              "explanation": "Traffic Mirroring captures full packet payloads, which is vastly more data than flow log metadata, increasing costs dramatically and exceeding what the team requested."
            },
            {
              "id": "c3",
              "text": "Stream Flow Logs to an Amazon OpenSearch cluster for real-time dashboards and historical search",
              "isCorrect": false,
              "explanation": "OpenSearch provides powerful search but requires always-on cluster infrastructure, violating the no-maintained-infrastructure requirement and increasing cost."
            },
            {
              "id": "c1",
              "text": "Publish VPC Flow Logs to a centralised S3 bucket in the security account and query with Amazon Athena",
              "isCorrect": true,
              "explanation": "S3 storage is inexpensive at scale, and Athena provides serverless on-demand querying with no infrastructure to manage. Flow Logs support direct S3 delivery across accounts via resource policies."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Detection",
          "services": [
            "VPC Flow Logs",
            "CloudWatch Logs",
            "S3",
            "Athena"
          ],
          "docs": "https://docs.aws.amazon.com/vpc/latest/userguide/flow-logs.html",
          "tip": "For high-volume, infrequently-queried log data, think serverless query engines over managed log databases.",
          "explanation": "VPC Flow Logs can deliver directly to S3 in Parquet format with Hive-compatible partitioning, and Athena charges only per query scanned. This combination handles cross-account aggregation at scale without provisioning or maintaining any infrastructure."
        },
        {
          "id": "SCS-C03-0021",
          "question": "A company needs to inspect all egress traffic from its VPC for data exfiltration patterns using Suricata-compatible IDS/IPS rules at the network layer. Security Groups and NACLs are already in place for basic access control. Which service should they deploy?",
          "choices": [
            {
              "id": "c4",
              "text": "Configure more restrictive NACLs on the VPC subnets",
              "isCorrect": false,
              "explanation": "NACLs are stateless IP/port filters. They cannot inspect packet payloads or apply IDS/IPS signature-based rules."
            },
            {
              "id": "c1",
              "text": "AWS Network Firewall",
              "isCorrect": true,
              "explanation": "Network Firewall is a managed, stateful network firewall that supports Suricata-compatible rules for deep packet inspection, IDS/IPS, and domain-based filtering on both ingress and egress traffic."
            },
            {
              "id": "c3",
              "text": "Tighten Security Group outbound rules to restrict destination IPs",
              "isCorrect": false,
              "explanation": "Security Groups provide stateful allow/deny by IP and port but cannot perform deep packet inspection or pattern-based detection of data exfiltration."
            },
            {
              "id": "c2",
              "text": "AWS WAF",
              "isCorrect": false,
              "explanation": "WAF operates at Layer 7 (HTTP/HTTPS) and integrates with CloudFront, ALB, and API Gateway. It cannot inspect arbitrary TCP/UDP egress traffic or run Suricata rules."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Infrastructure Security",
          "services": [
            "Network Firewall",
            "WAF",
            "Security Groups",
            "NACLs"
          ],
          "docs": "https://docs.aws.amazon.com/network-firewall/latest/developerguide/what-is-aws-network-firewall.html",
          "tip": "When the requirement mentions Suricata, IDS/IPS, or deep packet inspection at the network layer, think beyond Security Groups and WAF.",
          "explanation": "AWS Network Firewall sits in-line in VPC traffic paths (via Gateway Load Balancer endpoints or firewall subnets) and evaluates packets against stateful Suricata-compatible rule groups. It fills the gap between simple Security Group/NACL controls and full deep-packet inspection requirements."
        },
        {
          "id": "SCS-C03-0022",
          "question": "An operations team wants to automate incident response when a critical CloudWatch alarm triggers: page the on-call engineer, create a timeline, and start a runbook to collect diagnostic data. They want a single AWS-native service to orchestrate all three actions. Which service should they configure?",
          "choices": [
            {
              "id": "c3",
              "text": "Amazon SNS with multiple topic subscriptions",
              "isCorrect": false,
              "explanation": "SNS delivers notifications but does not manage incident timelines, runbook execution, or structured escalation workflows."
            },
            {
              "id": "c1",
              "text": "AWS Systems Manager Incident Manager",
              "isCorrect": true,
              "explanation": "Incident Manager automates incident creation with response plans that define escalation contacts, engagement protocols, and runbook automation, all triggered by CloudWatch alarms or EventBridge rules."
            },
            {
              "id": "c2",
              "text": "Amazon EventBridge with Lambda targets",
              "isCorrect": false,
              "explanation": "EventBridge plus Lambda can achieve similar automation but requires custom code for paging, timeline tracking, and runbook execution. It is not a single orchestration service purpose-built for incident response."
            },
            {
              "id": "c4",
              "text": "AWS CloudWatch composite alarms with auto-scaling actions",
              "isCorrect": false,
              "explanation": "Composite alarms aggregate alarm states but their actions are limited to SNS, Lambda, or Auto Scaling. They do not provide incident lifecycle management."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Incident Response",
          "services": [
            "Systems Manager Incident Manager",
            "EventBridge",
            "SNS",
            "PagerDuty"
          ],
          "docs": "https://docs.aws.amazon.com/incident-manager/latest/userguide/what-is-incident-manager.html",
          "tip": "Look for a service that combines paging, incident timeline, and runbook automation in a single response plan.",
          "explanation": "Incident Manager provides structured response plans that automatically engage contacts (via SMS, voice, or email), create incident timelines, and execute SSM Automation runbooks when triggered. This consolidates incident orchestration into one service rather than gluing multiple services together with custom logic."
        },
        {
          "id": "SCS-C03-0012",
          "question": "A platform team wants to allow developers to create their own IAM roles for Lambda functions, but ensure those roles can never have permissions beyond what the platform team defines. Which mechanism should they use?",
          "choices": [
            {
              "id": "c4",
              "text": "Use an SCP to deny iam:CreateRole for all developers and have the platform team create roles on request",
              "isCorrect": false,
              "explanation": "This removes developer self-service entirely, creating operational bottlenecks without enabling delegation."
            },
            {
              "id": "c2",
              "text": "Grant developers iam:CreateRole but restrict the role's trust policy to lambda.amazonaws.com only",
              "isCorrect": false,
              "explanation": "Restricting the trust policy limits who can assume the role, but does not limit what permissions the role itself can have."
            },
            {
              "id": "c1",
              "text": "Require developers to attach a permissions boundary to every role they create",
              "isCorrect": true,
              "explanation": "Permissions boundaries cap the maximum permissions a role can have, even if the role's identity policy grants broader access."
            },
            {
              "id": "c3",
              "text": "Create a single shared Lambda execution role managed by the platform team",
              "isCorrect": false,
              "explanation": "A shared role works but violates least privilege because all functions share the same permissions regardless of their needs."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Identity and Access Management",
          "services": [
            "IAM",
            "Organizations",
            "STS"
          ],
          "docs": "https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies_boundaries.html",
          "tip": "You need a mechanism that caps maximum permissions while still allowing developers to create and manage their own roles.",
          "explanation": "IAM permissions boundaries act as a ceiling on the effective permissions of a role or user."
        },
        {
          "id": "SCS-C03-0009",
          "question": "A company stores customer PII in S3 and needs to automatically discover and classify sensitive data across hundreds of buckets. Which service should they enable?",
          "choices": [
            {
              "id": "c2",
              "text": "Amazon GuardDuty",
              "isCorrect": false,
              "explanation": "GuardDuty detects threats like unusual API calls to S3 but does not inspect object contents for sensitive data."
            },
            {
              "id": "c1",
              "text": "Amazon Macie",
              "isCorrect": true,
              "explanation": "Macie scans S3 objects for PII, financial data, and credentials using ML-powered classifiers and managed data identifiers."
            },
            {
              "id": "c4",
              "text": "AWS Trusted Advisor",
              "isCorrect": false,
              "explanation": "Trusted Advisor provides account-level checks like open security groups, but does not scan S3 object contents."
            },
            {
              "id": "c3",
              "text": "Amazon Inspector",
              "isCorrect": false,
              "explanation": "Inspector focuses on vulnerability scanning for compute workloads, not data classification in S3."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Data Protection",
          "services": [
            "Macie",
            "GuardDuty",
            "Inspector",
            "Trusted Advisor"
          ],
          "docs": "https://docs.aws.amazon.com/macie/latest/user/what-is-macie.html",
          "tip": "This service is purpose-built for finding sensitive data like credit card numbers and passport IDs inside S3 objects.",
          "explanation": "Amazon Macie is designed to scan S3 objects and classify sensitive content such as PII and PHI using managed data identifiers."
        }
      ]
    },
    {
      "attemptId": "ad5d80d0-3019-4a08-8984-f11a11e59d49",
      "userId": "dev-user-001",
      "examCode": "SCS-C03",
      "examVersion": null,
      "attemptSchemaVersion": 1,
      "startedAt": "2026-02-17T08:27:34.058Z",
      "finishedAt": null,
      "score": null,
      "answers": [
        {
          "questionId": "SCS-C03-0007",
          "selectedChoiceId": "c1",
          "selectedChoiceIds": null,
          "selectedIndex": null,
          "selectedIndices": null,
          "correct": true,
          "timeMs": 0,
          "showTip": false,
          "createdAt": "2026-02-17T08:29:59.781Z"
        },
        {
          "questionId": "SCS-C03-0024",
          "selectedChoiceId": "c4",
          "selectedChoiceIds": null,
          "selectedIndex": null,
          "selectedIndices": null,
          "correct": false,
          "timeMs": 0,
          "showTip": false,
          "createdAt": "2026-02-17T08:32:12.702Z"
        },
        {
          "questionId": "SCS-C03-0020",
          "selectedChoiceId": "c1",
          "selectedChoiceIds": null,
          "selectedIndex": null,
          "selectedIndices": null,
          "correct": true,
          "timeMs": 0,
          "showTip": false,
          "createdAt": "2026-02-17T08:34:15.868Z"
        }
      ],
      "metadata": {
        "serviceKeywords": [],
        "domains": [],
        "services": []
      },
      "questions": [
        {
          "id": "SCS-C03-0025",
          "question": "A Lambda function in a private subnet needs to call the Secrets Manager API to retrieve database credentials. The security team prohibits all internet-bound traffic from the VPC. How should the architect configure network access so the Lambda function can reach Secrets Manager without traversing the internet?",
          "choices": [
            {
              "id": "c3",
              "text": "Attach an Elastic IP to the Lambda function's ENI for direct outbound access",
              "isCorrect": false,
              "explanation": "Lambda functions in a VPC do not support Elastic IPs, and this approach would use the internet gateway, which is prohibited."
            },
            {
              "id": "c4",
              "text": "Configure the Lambda function outside the VPC so it can access Secrets Manager over the internet by default",
              "isCorrect": false,
              "explanation": "Placing the function outside the VPC gives it internet access to AWS APIs, but the question states the function is in a private subnet, and moving it out may break access to other VPC resources like the database."
            },
            {
              "id": "c2",
              "text": "Add a NAT Gateway to the VPC and route the Lambda subnet's traffic through it",
              "isCorrect": false,
              "explanation": "A NAT Gateway provides internet access for outbound traffic, which violates the security team's prohibition on internet-bound traffic from the VPC."
            },
            {
              "id": "c1",
              "text": "Create an interface VPC endpoint (PrivateLink) for Secrets Manager in the same VPC and ensure the Lambda function's security group allows outbound HTTPS to the endpoint",
              "isCorrect": true,
              "explanation": "An interface VPC endpoint creates private ENIs within the VPC that route traffic to the Secrets Manager API entirely over the AWS private network, with no internet path required."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Infrastructure Security",
          "services": [
            "Lambda",
            "VPC",
            "NAT Gateway",
            "PrivateLink",
            "Secrets Manager"
          ],
          "docs": "https://docs.aws.amazon.com/lambda/latest/dg/configuration-vpc.html",
          "tip": "When internet access is prohibited, PrivateLink endpoints bring AWS service APIs into the VPC over private connections.",
          "explanation": "Interface VPC endpoints (powered by AWS PrivateLink) create private IP addresses inside the VPC that serve as entry points for AWS service APIs. Traffic never leaves the AWS network, satisfying zero-internet-egress security requirements while allowing Lambda to call Secrets Manager."
        },
        {
          "id": "SCS-C03-0015",
          "question": "A security team needs to provide shell access to EC2 instances in private subnets without opening SSH ports or managing bastion hosts, while maintaining a full audit trail of every command executed. Which solution meets these requirements?",
          "choices": [
            {
              "id": "c4",
              "text": "VPN to the private subnet and SSH",
              "isCorrect": false,
              "explanation": "VPN plus SSH captures metadata but not command-level audit content."
            },
            {
              "id": "c3",
              "text": "EC2 Instance Connect",
              "isCorrect": false,
              "explanation": "Instance Connect still requires port 22 and does not natively log full session content."
            },
            {
              "id": "c1",
              "text": "Systems Manager Session Manager",
              "isCorrect": true,
              "explanation": "Session Manager establishes encrypted sessions through the SSM agent without opening inbound ports and can log sessions to S3 or CloudWatch Logs."
            },
            {
              "id": "c2",
              "text": "Deploy a bastion host with SSH key-based authentication",
              "isCorrect": false,
              "explanation": "Bastion hosts require open SSH ports and add operational burden."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Infrastructure Security",
          "services": [
            "Systems Manager",
            "EC2",
            "IAM",
            "CloudTrail"
          ],
          "docs": "https://docs.aws.amazon.com/systems-manager/latest/userguide/session-manager.html",
          "tip": "Look for a service that provides shell access through an agent, not through network-level connectivity.",
          "explanation": "Session Manager uses the SSM agent to create encrypted, IAM-authenticated sessions without inbound security group rules and logs session output for auditing."
        },
        {
          "id": "SCS-C03-0017",
          "question": "A network security team must capture all accepted and rejected traffic metadata for forensic analysis across 200 VPCs in a multi-account organisation. They need to query weeks of historical data on demand without maintaining always-on infrastructure. Which architecture meets these requirements most cost-effectively?",
          "choices": [
            {
              "id": "c2",
              "text": "Send VPC Flow Logs to CloudWatch Logs in each account and use CloudWatch Logs Insights for queries",
              "isCorrect": false,
              "explanation": "CloudWatch Logs Insights works well for recent data but becomes expensive at high volume over weeks, and cross-account querying adds operational complexity compared to a centralised S3 approach."
            },
            {
              "id": "c4",
              "text": "Enable Traffic Mirroring on all ENIs and capture full packets for analysis",
              "isCorrect": false,
              "explanation": "Traffic Mirroring captures full packet payloads, which is vastly more data than flow log metadata, increasing costs dramatically and exceeding what the team requested."
            },
            {
              "id": "c3",
              "text": "Stream Flow Logs to an Amazon OpenSearch cluster for real-time dashboards and historical search",
              "isCorrect": false,
              "explanation": "OpenSearch provides powerful search but requires always-on cluster infrastructure, violating the no-maintained-infrastructure requirement and increasing cost."
            },
            {
              "id": "c1",
              "text": "Publish VPC Flow Logs to a centralised S3 bucket in the security account and query with Amazon Athena",
              "isCorrect": true,
              "explanation": "S3 storage is inexpensive at scale, and Athena provides serverless on-demand querying with no infrastructure to manage. Flow Logs support direct S3 delivery across accounts via resource policies."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Detection",
          "services": [
            "VPC Flow Logs",
            "CloudWatch Logs",
            "S3",
            "Athena"
          ],
          "docs": "https://docs.aws.amazon.com/vpc/latest/userguide/flow-logs.html",
          "tip": "For high-volume, infrequently-queried log data, think serverless query engines over managed log databases.",
          "explanation": "VPC Flow Logs can deliver directly to S3 in Parquet format with Hive-compatible partitioning, and Athena charges only per query scanned. This combination handles cross-account aggregation at scale without provisioning or maintaining any infrastructure."
        },
        {
          "id": "SCS-C03-0024",
          "question": "A security architect wants to continuously detect any S3 buckets, IAM roles, KMS keys, or Lambda functions that are shared with external AWS accounts or public access. The solution must generate findings automatically without requiring custom code. Which service should they enable?",
          "choices": [
            {
              "id": "c4",
              "text": "Amazon GuardDuty",
              "isCorrect": false,
              "explanation": "GuardDuty detects threats based on anomalous behaviour and threat intelligence. It does not analyze resource policies to find intentional cross-account sharing or public access grants."
            },
            {
              "id": "c3",
              "text": "AWS Trusted Advisor security checks",
              "isCorrect": false,
              "explanation": "Trusted Advisor checks a limited set of security best practices (e.g., open security groups, root MFA) but does not perform policy-level analysis of cross-account resource sharing."
            },
            {
              "id": "c2",
              "text": "AWS Config with the s3-bucket-public-read-prohibited managed rule",
              "isCorrect": false,
              "explanation": "This Config rule only checks S3 public read access. It does not cover cross-account sharing of IAM roles, KMS keys, or Lambda functions."
            },
            {
              "id": "c1",
              "text": "IAM Access Analyzer",
              "isCorrect": true,
              "explanation": "Access Analyzer uses automated reasoning to analyze resource-based policies and identifies resources that are accessible from outside the zone of trust (account or organisation), generating findings for each."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Identity and Access Management",
          "services": [
            "IAM Access Analyzer",
            "IAM",
            "S3",
            "Lambda",
            "KMS"
          ],
          "docs": "https://docs.aws.amazon.com/IAM/latest/UserGuide/access-analyzer-getting-started.html",
          "tip": "This service uses automated reasoning (formal logic) over policies, not anomaly detection or predefined compliance rules.",
          "explanation": "IAM Access Analyzer applies Zelkova-based automated reasoning to evaluate resource-based policies on S3 buckets, SQS queues, IAM roles, KMS keys, Lambda functions, and Secrets Manager secrets. It produces actionable findings whenever a policy grants access outside the defined zone of trust, with no custom code required."
        },
        {
          "id": "SCS-C03-0019",
          "question": "A financial services firm must store audit logs for seven years in a manner that no user, including root, can delete or modify them before the retention period expires. Regulators require proof of immutability. Which S3 feature satisfies these requirements?",
          "choices": [
            {
              "id": "c2",
              "text": "S3 Object Lock in Governance mode with a seven-year retention period",
              "isCorrect": false,
              "explanation": "Governance mode allows users with the s3:BypassGovernanceRetention permission to delete objects before the retention period ends, which does not meet the absolute immutability requirement."
            },
            {
              "id": "c1",
              "text": "S3 Object Lock in Compliance mode with a seven-year retention period",
              "isCorrect": true,
              "explanation": "Compliance mode prevents anyone, including the root user, from deleting or overwriting an object version until the retention date passes. This satisfies regulatory immutability requirements."
            },
            {
              "id": "c3",
              "text": "S3 Versioning with an S3 Lifecycle rule to transition objects to Glacier after 30 days",
              "isCorrect": false,
              "explanation": "Versioning preserves prior versions but does not prevent deletion of version markers. Glacier transition reduces cost but does not enforce immutability."
            },
            {
              "id": "c4",
              "text": "Enable MFA Delete on the S3 bucket to require MFA for all delete operations",
              "isCorrect": false,
              "explanation": "MFA Delete requires an additional authentication step but does not make objects truly immutable. A user with MFA can still delete them at any time."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Data Protection",
          "services": [
            "S3",
            "S3 Object Lock",
            "Glacier",
            "Backup"
          ],
          "docs": "https://docs.aws.amazon.com/AmazonS3/latest/userguide/object-lock.html",
          "tip": "Compliance mode is the only S3 mechanism where even the root account cannot shorten or remove the retention lock.",
          "explanation": "S3 Object Lock Compliance mode creates a WORM (Write Once Read Many) storage model. Once set, neither the object nor its retention settings can be altered or deleted by any principal until the retention period expires, meeting SEC 17a-4(f) and similar regulatory requirements."
        },
        {
          "id": "SCS-C03-0004",
          "question": "Which feature helps enforce least privilege by providing temporary credentials?",
          "choices": [
            {
              "id": "c4",
              "text": "Amazon Cognito",
              "isCorrect": false,
              "explanation": "Amazon Cognito provides user identity for apps, but the core mechanism for temporary AWS credentials is STS with roles."
            },
            {
              "id": "c1",
              "text": "IAM Roles with STS",
              "isCorrect": true,
              "explanation": "IAM Roles with STS allow issuance of temporary credentials for short-term access."
            },
            {
              "id": "c3",
              "text": "Security Groups",
              "isCorrect": false,
              "explanation": "Security Groups are network controls, not credential mechanisms."
            },
            {
              "id": "c2",
              "text": "IAM Users with long-term access keys",
              "isCorrect": false,
              "explanation": "IAM Users with long-term keys are not recommended for least-privilege patterns."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Identity and Access Management",
          "services": [
            "IAM",
            "STS",
            "Cognito"
          ],
          "docs": "https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles.html",
          "tip": "Temporary credentials reduce the risk from long-lived keys.",
          "explanation": "IAM Roles combined with AWS STS issue temporary credentials that automatically expire, reducing blast radius if leaked."
        },
        {
          "id": "SCS-C03-0020",
          "question": "After enabling GuardDuty S3 Protection, a security analyst notices a finding of type Policy:S3/BucketAnonymousAccessGranted for a production data bucket. The analyst needs to determine which principal changed the bucket policy and when. Which data source provides this information?",
          "choices": [
            {
              "id": "c4",
              "text": "VPC Flow Logs for the VPC where the analyst is working",
              "isCorrect": false,
              "explanation": "VPC Flow Logs capture network-layer metadata (IP, port, protocol) but not API-level details like which principal called PutBucketPolicy."
            },
            {
              "id": "c3",
              "text": "S3 server access logs for the data bucket",
              "isCorrect": false,
              "explanation": "S3 server access logs capture object-level read/write requests, not bucket policy changes. Control-plane actions like PutBucketPolicy are not recorded in access logs."
            },
            {
              "id": "c2",
              "text": "The GuardDuty finding detail itself, which includes the actor and timestamp",
              "isCorrect": false,
              "explanation": "GuardDuty findings identify the affected resource and the anomaly but do not always include the full details of who made the original policy change. CloudTrail provides the definitive audit trail."
            },
            {
              "id": "c1",
              "text": "CloudTrail management events showing the PutBucketPolicy API call",
              "isCorrect": true,
              "explanation": "CloudTrail records the identity (principal), timestamp, source IP, and request parameters for S3 control-plane API calls like PutBucketPolicy. This is the authoritative source for who changed the policy and when."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Detection",
          "services": [
            "GuardDuty",
            "CloudTrail",
            "S3",
            "Security Hub"
          ],
          "docs": "https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_s3-protection.html",
          "tip": "Distinguish between data-plane logs (S3 access logs, VPC Flow Logs) and control-plane logs (CloudTrail) when investigating policy changes.",
          "explanation": "CloudTrail management events are the single source of truth for AWS API activity. When investigating who changed a resource configuration, always start with CloudTrail, which records the IAM principal, the API action, the request parameters, and the exact timestamp."
        },
        {
          "id": "SCS-C03-0012",
          "question": "A platform team wants to allow developers to create their own IAM roles for Lambda functions, but ensure those roles can never have permissions beyond what the platform team defines. Which mechanism should they use?",
          "choices": [
            {
              "id": "c1",
              "text": "Require developers to attach a permissions boundary to every role they create",
              "isCorrect": true,
              "explanation": "Permissions boundaries cap the maximum permissions a role can have, even if the role's identity policy grants broader access."
            },
            {
              "id": "c3",
              "text": "Create a single shared Lambda execution role managed by the platform team",
              "isCorrect": false,
              "explanation": "A shared role works but violates least privilege because all functions share the same permissions regardless of their needs."
            },
            {
              "id": "c2",
              "text": "Grant developers iam:CreateRole but restrict the role's trust policy to lambda.amazonaws.com only",
              "isCorrect": false,
              "explanation": "Restricting the trust policy limits who can assume the role, but does not limit what permissions the role itself can have."
            },
            {
              "id": "c4",
              "text": "Use an SCP to deny iam:CreateRole for all developers and have the platform team create roles on request",
              "isCorrect": false,
              "explanation": "This removes developer self-service entirely, creating operational bottlenecks without enabling delegation."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Identity and Access Management",
          "services": [
            "IAM",
            "Organizations",
            "STS"
          ],
          "docs": "https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies_boundaries.html",
          "tip": "You need a mechanism that caps maximum permissions while still allowing developers to create and manage their own roles.",
          "explanation": "IAM permissions boundaries act as a ceiling on the effective permissions of a role or user."
        },
        {
          "id": "SCS-C03-0021",
          "question": "A company needs to inspect all egress traffic from its VPC for data exfiltration patterns using Suricata-compatible IDS/IPS rules at the network layer. Security Groups and NACLs are already in place for basic access control. Which service should they deploy?",
          "choices": [
            {
              "id": "c4",
              "text": "Configure more restrictive NACLs on the VPC subnets",
              "isCorrect": false,
              "explanation": "NACLs are stateless IP/port filters. They cannot inspect packet payloads or apply IDS/IPS signature-based rules."
            },
            {
              "id": "c1",
              "text": "AWS Network Firewall",
              "isCorrect": true,
              "explanation": "Network Firewall is a managed, stateful network firewall that supports Suricata-compatible rules for deep packet inspection, IDS/IPS, and domain-based filtering on both ingress and egress traffic."
            },
            {
              "id": "c3",
              "text": "Tighten Security Group outbound rules to restrict destination IPs",
              "isCorrect": false,
              "explanation": "Security Groups provide stateful allow/deny by IP and port but cannot perform deep packet inspection or pattern-based detection of data exfiltration."
            },
            {
              "id": "c2",
              "text": "AWS WAF",
              "isCorrect": false,
              "explanation": "WAF operates at Layer 7 (HTTP/HTTPS) and integrates with CloudFront, ALB, and API Gateway. It cannot inspect arbitrary TCP/UDP egress traffic or run Suricata rules."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Infrastructure Security",
          "services": [
            "Network Firewall",
            "WAF",
            "Security Groups",
            "NACLs"
          ],
          "docs": "https://docs.aws.amazon.com/network-firewall/latest/developerguide/what-is-aws-network-firewall.html",
          "tip": "When the requirement mentions Suricata, IDS/IPS, or deep packet inspection at the network layer, think beyond Security Groups and WAF.",
          "explanation": "AWS Network Firewall sits in-line in VPC traffic paths (via Gateway Load Balancer endpoints or firewall subnets) and evaluates packets against stateful Suricata-compatible rule groups. It fills the gap between simple Security Group/NACL controls and full deep-packet inspection requirements."
        },
        {
          "id": "SCS-C03-0018",
          "question": "A company runs workloads on Amazon EKS and needs each Kubernetes pod to assume a unique IAM role with fine-grained permissions. The trust policy must ensure only the intended service account in a specific namespace can assume the role. Which trust policy snippet correctly restricts role assumption to the pod's OIDC identity?",
          "choices": [
            {
              "id": "c3",
              "text": "{\"Effect\":\"Allow\",\"Principal\":{\"AWS\":\"arn:aws:iam::123456789012:role/eks-node-role\"},\"Action\":\"sts:AssumeRole\"}",
              "isCorrect": false,
              "explanation": "Trusting the node role lets every pod on that node assume this role, eliminating per-pod isolation."
            },
            {
              "id": "c1",
              "text": "{\"Effect\":\"Allow\",\"Principal\":{\"Federated\":\"arn:aws:iam::123456789012:oidc-provider/oidc.eks.us-east-1.amazonaws.com/id/EXAMPLED539D4633E53DE1B71EXAMPLE\"},\"Action\":\"sts:AssumeRoleWithWebIdentity\",\"Condition\":{\"StringEquals\":{\"oidc.eks.us-east-1.amazonaws.com/id/EXAMPLED539D4633E53DE1B71EXAMPLE:sub\":\"system:serviceaccount:app-ns:app-sa\"}}}",
              "isCorrect": true,
              "explanation": "This uses the EKS OIDC provider as a Federated principal with AssumeRoleWithWebIdentity, and the Condition restricts the sub claim to the exact namespace:serviceaccount pair."
            },
            {
              "id": "c4",
              "text": "{\"Effect\":\"Allow\",\"Principal\":{\"Federated\":\"cognito-identity.amazonaws.com\"},\"Action\":\"sts:AssumeRoleWithWebIdentity\"}",
              "isCorrect": false,
              "explanation": "Cognito Identity is for end-user identity federation, not Kubernetes workload identity. EKS uses its own OIDC provider endpoint."
            },
            {
              "id": "c2",
              "text": "{\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"eks.amazonaws.com\"},\"Action\":\"sts:AssumeRole\"}",
              "isCorrect": false,
              "explanation": "This trusts the EKS service itself (the control plane), not individual pod identities. Any EKS-managed component could assume this role, not just the intended pod."
            }
          ],
          "selectCount": 1,
          "format": "json",
          "domain": "Identity and Access Management",
          "services": [
            "IAM",
            "STS",
            "Cognito",
            "EKS"
          ],
          "docs": "https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_providers_oidc.html",
          "tip": "EKS IRSA (IAM Roles for Service Accounts) uses the cluster's OIDC provider URL as a federated principal and filters by the sub claim.",
          "explanation": "IRSA projects a signed OIDC token into each pod, and the trust policy uses the cluster OIDC provider as a Federated principal with a Condition on the sub claim (namespace:serviceaccount). This ensures only the precise service account in the correct namespace can assume the role."
        },
        {
          "id": "SCS-C03-0016",
          "question": "A development team stores database credentials in environment variables baked into their container images. The security team requires that credentials be rotated every 30 days without redeploying containers and that all credential access be auditable. Which approach best meets these requirements?",
          "choices": [
            {
              "id": "c3",
              "text": "Encrypt the environment variables at build time with a KMS key and decrypt them at container start",
              "isCorrect": false,
              "explanation": "This protects secrets at rest in the image, but rotating requires rebuilding and redeploying the container, which violates the no-redeploy requirement."
            },
            {
              "id": "c2",
              "text": "Store credentials in SSM Parameter Store SecureString parameters and write a cron job to update them monthly",
              "isCorrect": false,
              "explanation": "Parameter Store SecureStrings can hold secrets but lack built-in automatic rotation. A cron job is fragile and requires custom coordination with both the parameter and the database."
            },
            {
              "id": "c1",
              "text": "Store credentials in AWS Secrets Manager with automatic rotation enabled and retrieve them at runtime using the Secrets Manager SDK",
              "isCorrect": true,
              "explanation": "Secrets Manager supports automatic rotation via Lambda, provides versioned secrets so applications always fetch the current value at runtime, and logs all access through CloudTrail."
            },
            {
              "id": "c4",
              "text": "Use IAM database authentication to eliminate passwords entirely",
              "isCorrect": false,
              "explanation": "IAM database authentication works only with supported engines (Aurora MySQL/PostgreSQL, RDS MySQL/PostgreSQL) and may not cover all the team's databases. It also does not address other types of credentials."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Data Protection",
          "services": [
            "Secrets Manager",
            "Parameter Store",
            "KMS",
            "Lambda"
          ],
          "docs": "https://docs.aws.amazon.com/secretsmanager/latest/userguide/intro.html",
          "tip": "Automatic rotation without redeployment means the application must fetch secrets dynamically, not rely on values injected at build or deploy time.",
          "explanation": "Secrets Manager is purpose-built for credential lifecycle management. Its rotation feature invokes a Lambda function on a schedule to update both the secret value and the target resource (e.g., RDS password), while applications retrieve the current secret at runtime, eliminating the need for redeployment."
        },
        {
          "id": "SCS-C03-0001",
          "question": "Which AWS service helps aggregate and analyze security findings across accounts?",
          "choices": [
            {
              "id": "c3",
              "text": "AWS WAF",
              "isCorrect": false,
              "explanation": "AWS WAF is a web application firewall focused on HTTP(S) protections."
            },
            {
              "id": "c4",
              "text": "Amazon SNS",
              "isCorrect": false,
              "explanation": "Amazon SNS is a notification service, not a security findings aggregator."
            },
            {
              "id": "c1",
              "text": "Amazon GuardDuty",
              "isCorrect": true,
              "explanation": "GuardDuty is a threat detection service that continuously monitors for malicious activity and unauthorized behavior."
            },
            {
              "id": "c2",
              "text": "AWS Config",
              "isCorrect": false,
              "explanation": "AWS Config tracks resource configuration and compliance, not threat detection."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Detection",
          "services": [
            "GuardDuty",
            "Config",
            "WAF",
            "SNS"
          ],
          "docs": "https://docs.aws.amazon.com/guardduty/latest/ug/what-is-guardduty.html",
          "tip": "Think of a service that detects threats across your account using machine learning and threat intelligence.",
          "explanation": "Amazon GuardDuty uses ML models and threat intelligence feeds to continuously detect threats across accounts. The closest wrong answer is AWS Config, which evaluates resource configuration compliance, whereas GuardDuty detects active threats."
        },
        {
          "id": "SCS-C03-0006",
          "question": "A security team needs to centrally manage findings from multiple AWS security services and ensure encryption of sensitive data at rest. Which TWO services should they use together? (Select TWO)",
          "choices": [
            {
              "id": "c1",
              "text": "AWS Security Hub",
              "isCorrect": true,
              "explanation": "Security Hub provides a comprehensive view of security alerts and compliance status across accounts."
            },
            {
              "id": "c5",
              "text": "Amazon EC2",
              "isCorrect": false,
              "explanation": "EC2 provides virtual machines, not security findings management."
            },
            {
              "id": "c2",
              "text": "AWS KMS",
              "isCorrect": true,
              "explanation": "KMS provides centralized encryption key management for encrypting data at rest."
            },
            {
              "id": "c3",
              "text": "Amazon SQS",
              "isCorrect": false,
              "explanation": "SQS is a message queuing service, not related to security findings or encryption."
            },
            {
              "id": "c4",
              "text": "AWS CloudFormation",
              "isCorrect": false,
              "explanation": "CloudFormation is an infrastructure-as-code service, not a security findings tool."
            }
          ],
          "selectCount": 2,
          "format": "text",
          "domain": "Detection",
          "services": [
            "Security Hub",
            "KMS",
            "SQS",
            "CloudFormation",
            "EC2"
          ],
          "docs": "https://docs.aws.amazon.com/securityhub/latest/userguide/what-is-securityhub.html",
          "tip": "Think about centralized findings aggregation and key management.",
          "explanation": "Security Hub aggregates and normalizes findings and KMS provides the keys to encrypt sensitive data."
        },
        {
          "id": "SCS-C03-0002",
          "question": "During an incident, which service lets you run investigative notebooks and analyze data?",
          "choices": [
            {
              "id": "c2",
              "text": "Amazon Detective",
              "isCorrect": true,
              "explanation": "Amazon Detective is designed to analyze, visualize, and conduct investigations into potential security issues."
            },
            {
              "id": "c1",
              "text": "AWS Systems Manager",
              "isCorrect": false,
              "explanation": "Systems Manager helps manage instances but is not focused on security investigation notebooks."
            },
            {
              "id": "c4",
              "text": "AWS CloudTrail",
              "isCorrect": false,
              "explanation": "CloudTrail records API activity and is useful for forensics, but Detective provides investigative workflows."
            },
            {
              "id": "c3",
              "text": "AWS Shield",
              "isCorrect": false,
              "explanation": "AWS Shield provides DDoS protections, not forensic investigation tools."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Incident Response",
          "services": [
            "Detective",
            "Systems Manager",
            "Shield",
            "CloudTrail"
          ],
          "docs": "https://docs.aws.amazon.com/detective/latest/adminguide/what-is.html",
          "tip": "This service helps visualize and investigate security issues by linking related findings and activity.",
          "explanation": "Amazon Detective automatically collects log data from VPC Flow Logs, CloudTrail, and GuardDuty, then builds a graph model that links related events so analysts can visually trace activity."
        },
        {
          "id": "SCS-C03-0005",
          "question": "Which service provides managed encryption keys that you can use to encrypt data at rest?",
          "choices": [
            {
              "id": "c2",
              "text": "AWS IAM",
              "isCorrect": false,
              "explanation": "AWS IAM handles identity and permissions, not key storage or encryption primitives."
            },
            {
              "id": "c1",
              "text": "AWS KMS",
              "isCorrect": true,
              "explanation": "AWS KMS is the managed service for creating and controlling encryption keys."
            },
            {
              "id": "c3",
              "text": "AWS Shield",
              "isCorrect": false,
              "explanation": "AWS Shield protects against DDoS attacks, not key management."
            },
            {
              "id": "c4",
              "text": "AWS WAF",
              "isCorrect": false,
              "explanation": "AWS WAF is a web application firewall, not key management."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Data Protection",
          "services": [
            "KMS",
            "IAM",
            "Shield",
            "WAF"
          ],
          "docs": "https://docs.aws.amazon.com/kms/latest/developerguide/overview.html",
          "tip": "Key management service with envelope encryption support.",
          "explanation": "AWS KMS provides centralized creation, rotation, and access control of encryption keys used to protect data at rest across services like S3, EBS, and RDS."
        },
        {
          "id": "SCS-C03-0022",
          "question": "An operations team wants to automate incident response when a critical CloudWatch alarm triggers: page the on-call engineer, create a timeline, and start a runbook to collect diagnostic data. They want a single AWS-native service to orchestrate all three actions. Which service should they configure?",
          "choices": [
            {
              "id": "c2",
              "text": "Amazon EventBridge with Lambda targets",
              "isCorrect": false,
              "explanation": "EventBridge plus Lambda can achieve similar automation but requires custom code for paging, timeline tracking, and runbook execution. It is not a single orchestration service purpose-built for incident response."
            },
            {
              "id": "c3",
              "text": "Amazon SNS with multiple topic subscriptions",
              "isCorrect": false,
              "explanation": "SNS delivers notifications but does not manage incident timelines, runbook execution, or structured escalation workflows."
            },
            {
              "id": "c4",
              "text": "AWS CloudWatch composite alarms with auto-scaling actions",
              "isCorrect": false,
              "explanation": "Composite alarms aggregate alarm states but their actions are limited to SNS, Lambda, or Auto Scaling. They do not provide incident lifecycle management."
            },
            {
              "id": "c1",
              "text": "AWS Systems Manager Incident Manager",
              "isCorrect": true,
              "explanation": "Incident Manager automates incident creation with response plans that define escalation contacts, engagement protocols, and runbook automation, all triggered by CloudWatch alarms or EventBridge rules."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Incident Response",
          "services": [
            "Systems Manager Incident Manager",
            "EventBridge",
            "SNS",
            "PagerDuty"
          ],
          "docs": "https://docs.aws.amazon.com/incident-manager/latest/userguide/what-is-incident-manager.html",
          "tip": "Look for a service that combines paging, incident timeline, and runbook automation in a single response plan.",
          "explanation": "Incident Manager provides structured response plans that automatically engage contacts (via SMS, voice, or email), create incident timelines, and execute SSM Automation runbooks when triggered. This consolidates incident orchestration into one service rather than gluing multiple services together with custom logic."
        },
        {
          "id": "SCS-C03-0003",
          "question": "To restrict traffic at the network edge for HTTP endpoints, which service should you combine with CloudFront?",
          "choices": [
            {
              "id": "c3",
              "text": "VPC Endpoint",
              "isCorrect": false,
              "explanation": "VPC Endpoints provide private connectivity to services within a VPC, not edge HTTP filtering."
            },
            {
              "id": "c1",
              "text": "AWS WAF",
              "isCorrect": true,
              "explanation": "AWS WAF is the web application firewall used with CloudFront to filter HTTP(S) traffic."
            },
            {
              "id": "c2",
              "text": "Security Groups",
              "isCorrect": false,
              "explanation": "Security Groups control traffic to EC2 at the instance level, not the CloudFront edge."
            },
            {
              "id": "c4",
              "text": "AWS KMS",
              "isCorrect": false,
              "explanation": "AWS KMS is for key management and encryption, not traffic filtering."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Infrastructure Security",
          "services": [
            "WAF",
            "CloudFront",
            "Security Groups"
          ],
          "docs": "https://docs.aws.amazon.com/waf/latest/developerguide/waf-chapter.html",
          "tip": "Think web application protection rules that block common attack patterns at the edge.",
          "explanation": "AWS WAF integrates natively with CloudFront, ALB, and API Gateway to inspect and filter HTTP(S) requests using rules such as rate limiting and SQL injection detection."
        },
        {
          "id": "SCS-C03-0014",
          "question": "A data lake team manages a single S3 bucket accessed by multiple applications across different VPCs. They need to enforce that each application can only reach the bucket from its own VPC and can only access objects under its designated prefix. Which approach provides the strongest isolation with the least policy complexity?",
          "choices": [
            {
              "id": "c1",
              "text": "Create a separate S3 Access Point for each application",
              "isCorrect": true,
              "explanation": "S3 Access Points allow per-application network and permission scoping against a shared bucket."
            },
            {
              "id": "c2",
              "text": "Write a single S3 bucket policy with separate statements per application",
              "isCorrect": false,
              "explanation": "A single bucket policy becomes difficult to manage and has size limits."
            },
            {
              "id": "c4",
              "text": "Replicate data into separate per-application buckets",
              "isCorrect": false,
              "explanation": "Replication increases cost and complexity."
            },
            {
              "id": "c3",
              "text": "Create one VPC endpoint per VPC and use endpoint policies",
              "isCorrect": false,
              "explanation": "Endpoint policies are coarse for prefix-level scoping."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Data Protection",
          "services": [
            "S3",
            "IAM",
            "VPC",
            "PrivateLink"
          ],
          "docs": "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-points.html",
          "tip": "Consider a feature that lets you create named network-scoped entry points to a single bucket.",
          "explanation": "S3 Access Points provide named, per-application entry points to a bucket, each with its own policy and optional VPC restriction."
        },
        {
          "id": "SCS-C03-0010",
          "question": "A security architect needs to prevent any account in the organisation from launching EC2 instances outside of eu-west-1 and eu-west-2, regardless of the IAM permissions granted within those accounts. Which approach should they use?",
          "choices": [
            {
              "id": "c4",
              "text": "Use a CloudFormation StackSet with a hook that blocks ec2:RunInstances in disallowed regions",
              "isCorrect": false,
              "explanation": "CloudFormation hooks validate CloudFormation-managed resources only, not direct API calls or console launches."
            },
            {
              "id": "c2",
              "text": "Create an IAM policy in each account that denies ec2:RunInstances outside eu-west-1 and eu-west-2, and attach it to every IAM user and role",
              "isCorrect": false,
              "explanation": "Per-account IAM policies can be removed by local administrators, and new users or roles might not receive the policy."
            },
            {
              "id": "c1",
              "text": "Attach a Service Control Policy (SCP) to the organisation root or target OUs that denies ec2:RunInstances unless the aws:RequestedRegion condition matches eu-west-1 or eu-west-2",
              "isCorrect": true,
              "explanation": "SCPs set maximum permission boundaries across all accounts in an OU or organisation, overriding any IAM policy within those accounts."
            },
            {
              "id": "c3",
              "text": "Deploy an AWS Config rule that evaluates EC2 instances and flags any launched outside the allowed regions as non-compliant",
              "isCorrect": false,
              "explanation": "Config rules are detective, not preventive - the instance would already be running before Config flags it."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Identity and Access Management",
          "services": [
            "Organizations",
            "IAM",
            "Config",
            "CloudFormation"
          ],
          "docs": "https://docs.aws.amazon.com/organizations/latest/userguide/orgs_manage_policies_scps.html",
          "tip": "You need a preventive control that applies across all accounts regardless of each account's local IAM policies.",
          "explanation": "Service Control Policies (SCPs) in AWS Organizations act as guardrails that define the maximum permissions available to all principals in member accounts."
        },
        {
          "id": "SCS-C03-0011",
          "question": "A compliance requirement mandates that all CloudWatch Logs log groups must be encrypted at rest with a customer-managed KMS key and that the key policy must allow the CloudWatch Logs service principal to use it. Which combination of steps achieves this?",
          "choices": [
            {
              "id": "c3",
              "text": "Enable CloudTrail log file encryption with a KMS key and configure CloudWatch Logs as a CloudTrail destination",
              "isCorrect": false,
              "explanation": "CloudTrail encryption covers CloudTrail's own log files delivered to S3, not arbitrary CloudWatch Logs log groups."
            },
            {
              "id": "c1",
              "text": "Create a customer-managed KMS key with a key policy granting logs.<region>.amazonaws.com the kms:Encrypt, kms:Decrypt, kms:GenerateDataKey, and kms:DescribeKey actions, then associate the key with each log group",
              "isCorrect": true,
              "explanation": "CloudWatch Logs requires these four KMS actions in the key policy for the regional service principal to encrypt and decrypt log data."
            },
            {
              "id": "c4",
              "text": "Create an AWS-managed KMS key (alias aws/logs) and it will automatically encrypt all new log groups without any key policy changes",
              "isCorrect": false,
              "explanation": "CloudWatch Logs does not have an AWS-managed key. You must create and configure a customer-managed key explicitly."
            },
            {
              "id": "c2",
              "text": "Enable SSE-S3 default encryption on the S3 bucket where CloudWatch Logs exports data and reference that bucket in each log group's settings",
              "isCorrect": false,
              "explanation": "S3 encryption applies only to exported log data in S3, not to log data stored within the CloudWatch Logs service itself."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Data Protection",
          "services": [
            "CloudWatch Logs",
            "KMS",
            "S3",
            "CloudTrail"
          ],
          "docs": "https://docs.aws.amazon.com/AmazonCloudWatch/latest/logs/encrypt-log-data-kms.html",
          "tip": "CloudWatch Logs encryption requires a customer-managed CMK - there is no AWS-managed key option for this service.",
          "explanation": "CloudWatch Logs supports encryption at rest only with customer-managed KMS keys. You must explicitly grant the regional service principal permission to use the key."
        },
        {
          "id": "SCS-C03-0023",
          "question": "A web application team needs to ensure that TLS certificates on their internet-facing ALBs are renewed automatically without any manual intervention or downtime. Certificates must support multiple subdomain names (e.g., api.example.com, app.example.com). Which approach meets these requirements?",
          "choices": [
            {
              "id": "c4",
              "text": "Generate a self-signed certificate for each subdomain and configure the ALB to present them using SNI",
              "isCorrect": false,
              "explanation": "Self-signed certificates are not trusted by browsers and will produce security warnings. They also require manual rotation, defeating the automation requirement."
            },
            {
              "id": "c1",
              "text": "Request a public ACM certificate with Subject Alternative Names (SANs) for each subdomain using DNS validation, and associate it with the ALB",
              "isCorrect": true,
              "explanation": "ACM public certificates with DNS validation renew automatically as long as the CNAME validation records remain in place. SANs allow multiple subdomains on a single certificate, and ALB natively integrates with ACM for zero-downtime deployment."
            },
            {
              "id": "c2",
              "text": "Purchase a wildcard certificate from a third-party CA, import it into ACM, and set a calendar reminder to renew it annually",
              "isCorrect": false,
              "explanation": "Imported certificates in ACM are not automatically renewed. Manual renewal and re-import is required, which introduces risk of expiration and human error."
            },
            {
              "id": "c3",
              "text": "Use Let's Encrypt with certbot running on the ALB instances to obtain and renew certificates",
              "isCorrect": false,
              "explanation": "ALBs are managed services; you cannot run certbot or any agent on them. Let's Encrypt certificates must be imported into ACM, losing automatic renewal."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Data Protection",
          "services": [
            "ACM",
            "CloudFront",
            "ALB",
            "Route 53"
          ],
          "docs": "https://docs.aws.amazon.com/acm/latest/userguide/acm-overview.html",
          "tip": "ACM's automatic renewal only works for certificates it issues (not imported ones), and DNS validation is the set-and-forget option.",
          "explanation": "AWS Certificate Manager issues free public certificates that renew automatically when DNS validation is used. By adding SANs for each subdomain, a single certificate covers multiple endpoints. ACM's native integration with ALB means certificate deployment and rotation happen transparently."
        },
        {
          "id": "SCS-C03-0008",
          "question": "A security team wants to use AWS Config to detect S3 buckets that have public read access. Which CloudFormation resource snippet correctly defines this managed Config rule?",
          "choices": [
            {
              "id": "c1",
              "text": "Type: AWS::Config::ConfigRule\nProperties:\n  ConfigRuleName: s3-bucket-public-read-prohibited\n  Source:\n    Owner: AWS\n    SourceIdentifier: S3_BUCKET_PUBLIC_READ_PROHIBITED",
              "isCorrect": true,
              "explanation": "AWS managed Config rule using Owner: AWS and the standard S3 public read detection identifier."
            },
            {
              "id": "c3",
              "text": "Use AWS CloudTrail to monitor S3:GetBucketPolicy API calls and alert when public access is detected",
              "isCorrect": false,
              "explanation": "CloudTrail monitors API calls but does not provide continuous compliance evaluation like AWS Config."
            },
            {
              "id": "c2",
              "text": "Type: AWS::Config::ConfigRule\nProperties:\n  ConfigRuleName: s3-bucket-public-read-prohibited\n  Source:\n    Owner: CUSTOM\n    SourceIdentifier: S3_BUCKET_PUBLIC_READ_PROHIBITED",
              "isCorrect": false,
              "explanation": "Owner: CUSTOM is for custom rules backed by Lambda functions, not AWS managed rules."
            },
            {
              "id": "c4",
              "text": "Enable S3 Block Public Access at the account level - this replaces the need for Config rules",
              "isCorrect": false,
              "explanation": "Block Public Access is preventive - it does not detect existing violations like a Config rule does."
            }
          ],
          "selectCount": 1,
          "format": "yaml",
          "domain": "Detection",
          "services": [
            "Config",
            "CloudFormation",
            "S3"
          ],
          "docs": "https://docs.aws.amazon.com/config/latest/developerguide/WhatIsConfig.html",
          "tip": "AWS Config managed rules use Owner: AWS with a predefined SourceIdentifier.",
          "explanation": "AWS Config managed rules are pre-built by AWS and referenced with Owner: AWS plus a SourceIdentifier like S3_BUCKET_PUBLIC_READ_PROHIBITED."
        },
        {
          "id": "SCS-C03-0009",
          "question": "A company stores customer PII in S3 and needs to automatically discover and classify sensitive data across hundreds of buckets. Which service should they enable?",
          "choices": [
            {
              "id": "c1",
              "text": "Amazon Macie",
              "isCorrect": true,
              "explanation": "Macie scans S3 objects for PII, financial data, and credentials using ML-powered classifiers and managed data identifiers."
            },
            {
              "id": "c3",
              "text": "Amazon Inspector",
              "isCorrect": false,
              "explanation": "Inspector focuses on vulnerability scanning for compute workloads, not data classification in S3."
            },
            {
              "id": "c4",
              "text": "AWS Trusted Advisor",
              "isCorrect": false,
              "explanation": "Trusted Advisor provides account-level checks like open security groups, but does not scan S3 object contents."
            },
            {
              "id": "c2",
              "text": "Amazon GuardDuty",
              "isCorrect": false,
              "explanation": "GuardDuty detects threats like unusual API calls to S3 but does not inspect object contents for sensitive data."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Data Protection",
          "services": [
            "Macie",
            "GuardDuty",
            "Inspector",
            "Trusted Advisor"
          ],
          "docs": "https://docs.aws.amazon.com/macie/latest/user/what-is-macie.html",
          "tip": "This service is purpose-built for finding sensitive data like credit card numbers and passport IDs inside S3 objects.",
          "explanation": "Amazon Macie is designed to scan S3 objects and classify sensitive content such as PII and PHI using managed data identifiers."
        },
        {
          "id": "SCS-C03-0007",
          "question": "A security engineer needs to restrict an IAM role so it can only access a specific S3 bucket from a particular VPC endpoint. Which resource should be added?",
          "choices": [
            {
              "id": "c3",
              "text": "Add the VPC endpoint ID to the IAM role's trust policy as a Principal",
              "isCorrect": false,
              "explanation": "VPC endpoints are not IAM principals and cannot appear in a trust policy's Principal element."
            },
            {
              "id": "c1",
              "text": "{\"Condition\": {\"StringEquals\": {\"aws:sourceVpce\": \"vpce-1a2b3c4d\"}}}",
              "isCorrect": true,
              "explanation": "aws:sourceVpce condition restricts the policy to requests through the specified VPC endpoint."
            },
            {
              "id": "c2",
              "text": "{\"Condition\": {\"IpAddress\": {\"aws:SourceIp\": \"10.0.0.0/16\"}}}",
              "isCorrect": false,
              "explanation": "IpAddress/SourceIp restricts by IP range, not by VPC endpoint identity."
            },
            {
              "id": "c4",
              "text": "Attach a security group to the IAM role that only allows traffic from the VPC",
              "isCorrect": false,
              "explanation": "Security groups are network-level controls for ENIs - they cannot be attached to IAM roles."
            }
          ],
          "selectCount": 1,
          "format": "json",
          "domain": "Identity and Access Management",
          "services": [
            "IAM",
            "S3"
          ],
          "docs": "https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies.html",
          "tip": "VPC endpoint restrictions in IAM use the aws:sourceVpce condition key with StringEquals.",
          "explanation": "The aws:sourceVpce condition key with StringEquals restricts access to requests that traverse a specific VPC endpoint."
        },
        {
          "id": "SCS-C03-0013",
          "question": "An organisation wants to automatically isolate an EC2 instance when GuardDuty detects cryptocurrency mining activity. Which architecture achieves automated remediation with the least operational overhead?",
          "choices": [
            {
              "id": "c2",
              "text": "Enable Security Hub automated response playbooks to quarantine instances",
              "isCorrect": false,
              "explanation": "Security Hub aggregates findings but does not have built-in quarantine playbooks."
            },
            {
              "id": "c4",
              "text": "Use Systems Manager Automation runbooks triggered by a CPU alarm to stop instances",
              "isCorrect": false,
              "explanation": "CPU alarms are generic and can cause false positives."
            },
            {
              "id": "c3",
              "text": "Schedule a Lambda to poll GuardDuty every five minutes and isolate flagged instances",
              "isCorrect": false,
              "explanation": "Polling introduces delay and extra maintenance."
            },
            {
              "id": "c1",
              "text": "Configure GuardDuty findings to flow into EventBridge and trigger a Lambda that isolates the instance",
              "isCorrect": true,
              "explanation": "EventBridge rules can filter GuardDuty finding types and invoke Lambda for automated remediation."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Incident Response",
          "services": [
            "GuardDuty",
            "Security Hub",
            "EventBridge",
            "Lambda",
            "Systems Manager"
          ],
          "docs": "https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_finding-types-ec2.html",
          "tip": "The key is event-driven, near-real-time response with minimal ongoing maintenance.",
          "explanation": "GuardDuty publishes findings to EventBridge in near-real-time, enabling immediate Lambda-driven remediation."
        }
      ]
    },
    {
      "attemptId": "16f3be1a-31ab-4862-8942-109e94f5d58a",
      "userId": "dev-user-001",
      "examCode": "SCS-C03",
      "examVersion": null,
      "s3VersionId": "2Z3IKMxuB00IMQfahD8CV8E3DrzYD82S",
      "attemptSchemaVersion": 1,
      "startedAt": "2026-02-17T19:53:34.480Z",
      "finishedAt": null,
      "score": null,
      "answers": [
        {
          "questionId": "SCS-C03-0004",
          "selectedChoiceId": "c3",
          "selectedChoiceIds": null,
          "selectedIndex": null,
          "selectedIndices": null,
          "correct": false,
          "timeMs": null,
          "showTip": false,
          "createdAt": "2026-02-17T19:53:34.597Z"
        },
        {
          "questionId": "SCS-C03-0005",
          "selectedChoiceId": "c2",
          "selectedChoiceIds": null,
          "selectedIndex": null,
          "selectedIndices": null,
          "correct": false,
          "timeMs": null,
          "showTip": false,
          "createdAt": "2026-02-17T19:53:34.604Z"
        },
        {
          "questionId": "SCS-C03-0002",
          "selectedChoiceId": "c4",
          "selectedChoiceIds": null,
          "selectedIndex": null,
          "selectedIndices": null,
          "correct": false,
          "timeMs": null,
          "showTip": false,
          "createdAt": "2026-02-17T19:53:34.916Z"
        }
      ],
      "metadata": null,
      "questions": [
        {
          "id": "SCS-C03-0004",
          "question": "Which feature helps enforce least privilege by providing temporary credentials?",
          "choices": [
            {
              "id": "c3",
              "text": "Security Groups",
              "isCorrect": false,
              "explanation": "Security Groups are network controls, not credential mechanisms."
            },
            {
              "id": "c2",
              "text": "IAM Users with long-term access keys",
              "isCorrect": false,
              "explanation": "IAM Users with long-term keys are not recommended for least-privilege patterns."
            },
            {
              "id": "c4",
              "text": "Amazon Cognito",
              "isCorrect": false,
              "explanation": "Amazon Cognito provides user identity for apps, but the core mechanism for temporary AWS credentials is STS with roles."
            },
            {
              "id": "c1",
              "text": "IAM Roles with STS",
              "isCorrect": true,
              "explanation": "IAM Roles with STS allow issuance of temporary credentials for short-term access."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Identity and Access Management",
          "services": [
            "IAM",
            "STS",
            "Cognito"
          ],
          "docs": "https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles.html",
          "tip": "Temporary credentials reduce the risk from long-lived keys.",
          "explanation": "IAM Roles combined with AWS STS issue temporary credentials that automatically expire, reducing blast radius if leaked."
        },
        {
          "id": "SCS-C03-0005",
          "question": "Which service provides managed encryption keys that you can use to encrypt data at rest?",
          "choices": [
            {
              "id": "c2",
              "text": "AWS IAM",
              "isCorrect": false,
              "explanation": "AWS IAM handles identity and permissions, not key storage or encryption primitives."
            },
            {
              "id": "c1",
              "text": "AWS KMS",
              "isCorrect": true,
              "explanation": "AWS KMS is the managed service for creating and controlling encryption keys."
            },
            {
              "id": "c4",
              "text": "AWS WAF",
              "isCorrect": false,
              "explanation": "AWS WAF is a web application firewall, not key management."
            },
            {
              "id": "c3",
              "text": "AWS Shield",
              "isCorrect": false,
              "explanation": "AWS Shield protects against DDoS attacks, not key management."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Data Protection",
          "services": [
            "KMS",
            "IAM",
            "Shield",
            "WAF"
          ],
          "docs": "https://docs.aws.amazon.com/kms/latest/developerguide/overview.html",
          "tip": "Key management service with envelope encryption support.",
          "explanation": "AWS KMS provides centralized creation, rotation, and access control of encryption keys used to protect data at rest across services like S3, EBS, and RDS."
        },
        {
          "id": "SCS-C03-0002",
          "question": "During an incident, which service lets you run investigative notebooks and analyze data?",
          "choices": [
            {
              "id": "c4",
              "text": "AWS CloudTrail",
              "isCorrect": false,
              "explanation": "CloudTrail records API activity and is useful for forensics, but Detective provides investigative workflows."
            },
            {
              "id": "c1",
              "text": "AWS Systems Manager",
              "isCorrect": false,
              "explanation": "Systems Manager helps manage instances but is not focused on security investigation notebooks."
            },
            {
              "id": "c3",
              "text": "AWS Shield",
              "isCorrect": false,
              "explanation": "AWS Shield provides DDoS protections, not forensic investigation tools."
            },
            {
              "id": "c2",
              "text": "Amazon Detective",
              "isCorrect": true,
              "explanation": "Amazon Detective is designed to analyze, visualize, and conduct investigations into potential security issues."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Incident Response",
          "services": [
            "Detective",
            "Systems Manager",
            "Shield",
            "CloudTrail"
          ],
          "docs": "https://docs.aws.amazon.com/detective/latest/adminguide/what-is.html",
          "tip": "This service helps visualize and investigate security issues by linking related findings and activity.",
          "explanation": "Amazon Detective automatically collects log data from VPC Flow Logs, CloudTrail, and GuardDuty, then builds a graph model that links related events so analysts can visually trace activity."
        },
        {
          "id": "SCS-C03-0001",
          "question": "Which AWS service helps aggregate and analyze security findings across accounts?",
          "choices": [
            {
              "id": "c4",
              "text": "Amazon SNS",
              "isCorrect": false,
              "explanation": "Amazon SNS is a notification service, not a security findings aggregator."
            },
            {
              "id": "c1",
              "text": "Amazon GuardDuty",
              "isCorrect": true,
              "explanation": "GuardDuty is a threat detection service that continuously monitors for malicious activity and unauthorized behavior."
            },
            {
              "id": "c3",
              "text": "AWS WAF",
              "isCorrect": false,
              "explanation": "AWS WAF is a web application firewall focused on HTTP(S) protections."
            },
            {
              "id": "c2",
              "text": "AWS Config",
              "isCorrect": false,
              "explanation": "AWS Config tracks resource configuration and compliance, not threat detection."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Detection",
          "services": [
            "GuardDuty",
            "Config",
            "WAF",
            "SNS"
          ],
          "docs": "https://docs.aws.amazon.com/guardduty/latest/ug/what-is-guardduty.html",
          "tip": "Think of a service that detects threats across your account using machine learning and threat intelligence.",
          "explanation": "Amazon GuardDuty uses ML models and threat intelligence feeds to continuously detect threats across accounts. The closest wrong answer is AWS Config, which evaluates resource configuration compliance, whereas GuardDuty detects active threats."
        },
        {
          "id": "SCS-C03-0003",
          "question": "To restrict traffic at the network edge for HTTP endpoints, which service should you combine with CloudFront?",
          "choices": [
            {
              "id": "c3",
              "text": "VPC Endpoint",
              "isCorrect": false,
              "explanation": "VPC Endpoints provide private connectivity to services within a VPC, not edge HTTP filtering."
            },
            {
              "id": "c2",
              "text": "Security Groups",
              "isCorrect": false,
              "explanation": "Security Groups control traffic to EC2 at the instance level, not the CloudFront edge."
            },
            {
              "id": "c1",
              "text": "AWS WAF",
              "isCorrect": true,
              "explanation": "AWS WAF is the web application firewall used with CloudFront to filter HTTP(S) traffic."
            },
            {
              "id": "c4",
              "text": "AWS KMS",
              "isCorrect": false,
              "explanation": "AWS KMS is for key management and encryption, not traffic filtering."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Infrastructure Security",
          "services": [
            "WAF",
            "CloudFront",
            "Security Groups"
          ],
          "docs": "https://docs.aws.amazon.com/waf/latest/developerguide/waf-chapter.html",
          "tip": "Think web application protection rules that block common attack patterns at the edge.",
          "explanation": "AWS WAF integrates natively with CloudFront, ALB, and API Gateway to inspect and filter HTTP(S) requests using rules such as rate limiting and SQL injection detection."
        }
      ]
    },
    {
      "attemptId": "089172a4-6747-4881-8440-240bb7628c90",
      "userId": "dev-user-001",
      "examCode": "SCS-C03",
      "examVersion": null,
      "s3VersionId": "JH42DFQITNhtHz7PgsKZZpL3sr7JwRkR",
      "attemptSchemaVersion": 1,
      "startedAt": "2026-02-17T19:53:52.080Z",
      "finishedAt": "2026-02-17T19:53:52.530Z",
      "score": 0,
      "answers": [
        {
          "questionId": "SCS-C03-0002",
          "selectedChoiceId": "c4",
          "selectedChoiceIds": null,
          "selectedIndex": null,
          "selectedIndices": null,
          "correct": false,
          "timeMs": null,
          "showTip": false,
          "createdAt": "2026-02-17T19:53:52.197Z"
        },
        {
          "questionId": "SCS-C03-0004",
          "selectedChoiceId": "c4",
          "selectedChoiceIds": null,
          "selectedIndex": null,
          "selectedIndices": null,
          "correct": false,
          "timeMs": null,
          "showTip": false,
          "createdAt": "2026-02-17T19:53:52.202Z"
        },
        {
          "questionId": "SCS-C03-0005",
          "selectedChoiceId": "c3",
          "selectedChoiceIds": null,
          "selectedIndex": null,
          "selectedIndices": null,
          "correct": false,
          "timeMs": null,
          "showTip": false,
          "createdAt": "2026-02-17T19:53:52.525Z"
        }
      ],
      "metadata": null,
      "questions": [
        {
          "id": "SCS-C03-0002",
          "question": "During an incident, which service lets you run investigative notebooks and analyze data?",
          "choices": [
            {
              "id": "c4",
              "text": "AWS CloudTrail",
              "isCorrect": false,
              "explanation": "CloudTrail records API activity and is useful for forensics, but Detective provides investigative workflows."
            },
            {
              "id": "c1",
              "text": "AWS Systems Manager",
              "isCorrect": false,
              "explanation": "Systems Manager helps manage instances but is not focused on security investigation notebooks."
            },
            {
              "id": "c2",
              "text": "Amazon Detective",
              "isCorrect": true,
              "explanation": "Amazon Detective is designed to analyze, visualize, and conduct investigations into potential security issues."
            },
            {
              "id": "c3",
              "text": "AWS Shield",
              "isCorrect": false,
              "explanation": "AWS Shield provides DDoS protections, not forensic investigation tools."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Incident Response",
          "services": [
            "Detective",
            "Systems Manager",
            "Shield",
            "CloudTrail"
          ],
          "docs": "https://docs.aws.amazon.com/detective/latest/adminguide/what-is.html",
          "tip": "This service helps visualize and investigate security issues by linking related findings and activity.",
          "explanation": "Amazon Detective automatically collects log data from VPC Flow Logs, CloudTrail, and GuardDuty, then builds a graph model that links related events so analysts can visually trace activity."
        },
        {
          "id": "SCS-C03-0004",
          "question": "Which feature helps enforce least privilege by providing temporary credentials?",
          "choices": [
            {
              "id": "c4",
              "text": "Amazon Cognito",
              "isCorrect": false,
              "explanation": "Amazon Cognito provides user identity for apps, but the core mechanism for temporary AWS credentials is STS with roles."
            },
            {
              "id": "c3",
              "text": "Security Groups",
              "isCorrect": false,
              "explanation": "Security Groups are network controls, not credential mechanisms."
            },
            {
              "id": "c2",
              "text": "IAM Users with long-term access keys",
              "isCorrect": false,
              "explanation": "IAM Users with long-term keys are not recommended for least-privilege patterns."
            },
            {
              "id": "c1",
              "text": "IAM Roles with STS",
              "isCorrect": true,
              "explanation": "IAM Roles with STS allow issuance of temporary credentials for short-term access."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Identity and Access Management",
          "services": [
            "IAM",
            "STS",
            "Cognito"
          ],
          "docs": "https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles.html",
          "tip": "Temporary credentials reduce the risk from long-lived keys.",
          "explanation": "IAM Roles combined with AWS STS issue temporary credentials that automatically expire, reducing blast radius if leaked."
        },
        {
          "id": "SCS-C03-0005",
          "question": "Which service provides managed encryption keys that you can use to encrypt data at rest?",
          "choices": [
            {
              "id": "c3",
              "text": "AWS Shield",
              "isCorrect": false,
              "explanation": "AWS Shield protects against DDoS attacks, not key management."
            },
            {
              "id": "c2",
              "text": "AWS IAM",
              "isCorrect": false,
              "explanation": "AWS IAM handles identity and permissions, not key storage or encryption primitives."
            },
            {
              "id": "c1",
              "text": "AWS KMS",
              "isCorrect": true,
              "explanation": "AWS KMS is the managed service for creating and controlling encryption keys."
            },
            {
              "id": "c4",
              "text": "AWS WAF",
              "isCorrect": false,
              "explanation": "AWS WAF is a web application firewall, not key management."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Data Protection",
          "services": [
            "KMS",
            "IAM",
            "Shield",
            "WAF"
          ],
          "docs": "https://docs.aws.amazon.com/kms/latest/developerguide/overview.html",
          "tip": "Key management service with envelope encryption support.",
          "explanation": "AWS KMS provides centralized creation, rotation, and access control of encryption keys used to protect data at rest across services like S3, EBS, and RDS."
        },
        {
          "id": "SCS-C03-0001",
          "question": "Which AWS service helps aggregate and analyze security findings across accounts?",
          "choices": [
            {
              "id": "c4",
              "text": "Amazon SNS",
              "isCorrect": false,
              "explanation": "Amazon SNS is a notification service, not a security findings aggregator."
            },
            {
              "id": "c3",
              "text": "AWS WAF",
              "isCorrect": false,
              "explanation": "AWS WAF is a web application firewall focused on HTTP(S) protections."
            },
            {
              "id": "c2",
              "text": "AWS Config",
              "isCorrect": false,
              "explanation": "AWS Config tracks resource configuration and compliance, not threat detection."
            },
            {
              "id": "c1",
              "text": "Amazon GuardDuty",
              "isCorrect": true,
              "explanation": "GuardDuty is a threat detection service that continuously monitors for malicious activity and unauthorized behavior."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Detection",
          "services": [
            "GuardDuty",
            "Config",
            "WAF",
            "SNS"
          ],
          "docs": "https://docs.aws.amazon.com/guardduty/latest/ug/what-is-guardduty.html",
          "tip": "Think of a service that detects threats across your account using machine learning and threat intelligence.",
          "explanation": "Amazon GuardDuty uses ML models and threat intelligence feeds to continuously detect threats across accounts. The closest wrong answer is AWS Config, which evaluates resource configuration compliance, whereas GuardDuty detects active threats."
        },
        {
          "id": "SCS-C03-0003",
          "question": "To restrict traffic at the network edge for HTTP endpoints, which service should you combine with CloudFront?",
          "choices": [
            {
              "id": "c3",
              "text": "VPC Endpoint",
              "isCorrect": false,
              "explanation": "VPC Endpoints provide private connectivity to services within a VPC, not edge HTTP filtering."
            },
            {
              "id": "c1",
              "text": "AWS WAF",
              "isCorrect": true,
              "explanation": "AWS WAF is the web application firewall used with CloudFront to filter HTTP(S) traffic."
            },
            {
              "id": "c4",
              "text": "AWS KMS",
              "isCorrect": false,
              "explanation": "AWS KMS is for key management and encryption, not traffic filtering."
            },
            {
              "id": "c2",
              "text": "Security Groups",
              "isCorrect": false,
              "explanation": "Security Groups control traffic to EC2 at the instance level, not the CloudFront edge."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Infrastructure Security",
          "services": [
            "WAF",
            "CloudFront",
            "Security Groups"
          ],
          "docs": "https://docs.aws.amazon.com/waf/latest/developerguide/waf-chapter.html",
          "tip": "Think web application protection rules that block common attack patterns at the edge.",
          "explanation": "AWS WAF integrates natively with CloudFront, ALB, and API Gateway to inspect and filter HTTP(S) requests using rules such as rate limiting and SQL injection detection."
        }
      ],
      "perDomain": {
        "Incident Response": {
          "total": 1,
          "correct": 0,
          "score": 0
        },
        "Identity and Access Management": {
          "total": 1,
          "correct": 0,
          "score": 0
        },
        "Data Protection": {
          "total": 1,
          "correct": 0,
          "score": 0
        },
        "Detection": {
          "total": 1,
          "correct": 0,
          "score": 0
        },
        "Infrastructure Security": {
          "total": 1,
          "correct": 0,
          "score": 0
        }
      }
    },
    {
      "attemptId": "ded953e5-1976-4ade-b4ec-b863ee242eb7",
      "userId": "dev-user-001",
      "examCode": "SCS-C03",
      "examVersion": null,
      "s3VersionId": "65dmqgNmB3zxB7aj6XWWdHcQgY4YCjjo",
      "attemptSchemaVersion": 1,
      "startedAt": "2026-02-17T19:53:52.570Z",
      "finishedAt": null,
      "score": null,
      "answers": [],
      "metadata": null,
      "questions": [
        {
          "id": "SCS-C03-0001",
          "question": "Which AWS service helps aggregate and analyze security findings across accounts?",
          "choices": [
            {
              "id": "c1",
              "text": "Amazon GuardDuty",
              "isCorrect": true,
              "explanation": "GuardDuty is a threat detection service that continuously monitors for malicious activity and unauthorized behavior."
            },
            {
              "id": "c2",
              "text": "AWS Config",
              "isCorrect": false,
              "explanation": "AWS Config tracks resource configuration and compliance, not threat detection."
            },
            {
              "id": "c3",
              "text": "AWS WAF",
              "isCorrect": false,
              "explanation": "AWS WAF is a web application firewall focused on HTTP(S) protections."
            },
            {
              "id": "c4",
              "text": "Amazon SNS",
              "isCorrect": false,
              "explanation": "Amazon SNS is a notification service, not a security findings aggregator."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Detection",
          "services": [
            "GuardDuty",
            "Config",
            "WAF",
            "SNS"
          ],
          "docs": "https://docs.aws.amazon.com/guardduty/latest/ug/what-is-guardduty.html",
          "tip": "Think of a service that detects threats across your account using machine learning and threat intelligence.",
          "explanation": "Amazon GuardDuty uses ML models and threat intelligence feeds to continuously detect threats across accounts. The closest wrong answer is AWS Config, which evaluates resource configuration compliance, whereas GuardDuty detects active threats."
        },
        {
          "id": "SCS-C03-0002",
          "question": "During an incident, which service lets you run investigative notebooks and analyze data?",
          "choices": [
            {
              "id": "c4",
              "text": "AWS CloudTrail",
              "isCorrect": false,
              "explanation": "CloudTrail records API activity and is useful for forensics, but Detective provides investigative workflows."
            },
            {
              "id": "c3",
              "text": "AWS Shield",
              "isCorrect": false,
              "explanation": "AWS Shield provides DDoS protections, not forensic investigation tools."
            },
            {
              "id": "c1",
              "text": "AWS Systems Manager",
              "isCorrect": false,
              "explanation": "Systems Manager helps manage instances but is not focused on security investigation notebooks."
            },
            {
              "id": "c2",
              "text": "Amazon Detective",
              "isCorrect": true,
              "explanation": "Amazon Detective is designed to analyze, visualize, and conduct investigations into potential security issues."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Incident Response",
          "services": [
            "Detective",
            "Systems Manager",
            "Shield",
            "CloudTrail"
          ],
          "docs": "https://docs.aws.amazon.com/detective/latest/adminguide/what-is.html",
          "tip": "This service helps visualize and investigate security issues by linking related findings and activity.",
          "explanation": "Amazon Detective automatically collects log data from VPC Flow Logs, CloudTrail, and GuardDuty, then builds a graph model that links related events so analysts can visually trace activity."
        },
        {
          "id": "SCS-C03-0003",
          "question": "To restrict traffic at the network edge for HTTP endpoints, which service should you combine with CloudFront?",
          "choices": [
            {
              "id": "c4",
              "text": "AWS KMS",
              "isCorrect": false,
              "explanation": "AWS KMS is for key management and encryption, not traffic filtering."
            },
            {
              "id": "c2",
              "text": "Security Groups",
              "isCorrect": false,
              "explanation": "Security Groups control traffic to EC2 at the instance level, not the CloudFront edge."
            },
            {
              "id": "c1",
              "text": "AWS WAF",
              "isCorrect": true,
              "explanation": "AWS WAF is the web application firewall used with CloudFront to filter HTTP(S) traffic."
            },
            {
              "id": "c3",
              "text": "VPC Endpoint",
              "isCorrect": false,
              "explanation": "VPC Endpoints provide private connectivity to services within a VPC, not edge HTTP filtering."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Infrastructure Security",
          "services": [
            "WAF",
            "CloudFront",
            "Security Groups"
          ],
          "docs": "https://docs.aws.amazon.com/waf/latest/developerguide/waf-chapter.html",
          "tip": "Think web application protection rules that block common attack patterns at the edge.",
          "explanation": "AWS WAF integrates natively with CloudFront, ALB, and API Gateway to inspect and filter HTTP(S) requests using rules such as rate limiting and SQL injection detection."
        }
      ]
    },
    {
      "attemptId": "e820646d-da4d-43f1-aa9c-6005998abf66",
      "userId": "9255a4e4-20f1-7010-8a80-17c43ca141e3",
      "examCode": "SCS-C03",
      "examVersion": null,
      "s3VersionId": null,
      "attemptSchemaVersion": 1,
      "startedAt": "2026-02-18T10:37:00.876Z",
      "finishedAt": "2026-02-18T10:37:18.730Z",
      "score": 100,
      "answers": [
        {
          "questionId": "SCS-C03-0008",
          "selectedChoiceId": "c1",
          "selectedChoiceIds": null,
          "selectedIndex": null,
          "selectedIndices": null,
          "correct": true,
          "timeMs": 0,
          "showTip": false,
          "createdAt": "2026-02-18T10:37:06.071Z"
        },
        {
          "questionId": "SCS-C03-0005",
          "selectedChoiceId": "c1",
          "selectedChoiceIds": null,
          "selectedIndex": null,
          "selectedIndices": null,
          "correct": true,
          "timeMs": 0,
          "showTip": false,
          "createdAt": "2026-02-18T10:37:14.794Z"
        }
      ],
      "metadata": {
        "serviceKeywords": [],
        "domains": [],
        "services": []
      },
      "questions": [
        {
          "id": "SCS-C03-0008",
          "question": "A security team wants to use AWS Config to detect S3 buckets that have public read access. Which CloudFormation resource snippet correctly defines this managed Config rule?",
          "choices": [
            {
              "id": "c3",
              "text": "Use AWS CloudTrail to monitor S3:GetBucketPolicy API calls and alert when public access is detected",
              "isCorrect": false,
              "explanation": "CloudTrail monitors API calls but does not provide continuous compliance evaluation like AWS Config."
            },
            {
              "id": "c1",
              "text": "Type: AWS::Config::ConfigRule\nProperties:\n  ConfigRuleName: s3-bucket-public-read-prohibited\n  Source:\n    Owner: AWS\n    SourceIdentifier: S3_BUCKET_PUBLIC_READ_PROHIBITED",
              "isCorrect": true,
              "explanation": "AWS managed Config rule using Owner: AWS and the standard S3 public read detection identifier."
            },
            {
              "id": "c2",
              "text": "Type: AWS::Config::ConfigRule\nProperties:\n  ConfigRuleName: s3-bucket-public-read-prohibited\n  Source:\n    Owner: CUSTOM\n    SourceIdentifier: S3_BUCKET_PUBLIC_READ_PROHIBITED",
              "isCorrect": false,
              "explanation": "Owner: CUSTOM is for custom rules backed by Lambda functions, not AWS managed rules."
            },
            {
              "id": "c4",
              "text": "Enable S3 Block Public Access at the account level - this replaces the need for Config rules",
              "isCorrect": false,
              "explanation": "Block Public Access is preventive - it does not detect existing violations like a Config rule does."
            }
          ],
          "selectCount": 1,
          "format": "yaml",
          "domain": "Detection",
          "services": [
            "Config",
            "CloudFormation",
            "S3"
          ],
          "docs": "https://docs.aws.amazon.com/config/latest/developerguide/WhatIsConfig.html",
          "tip": "AWS Config managed rules use Owner: AWS with a predefined SourceIdentifier.",
          "explanation": "AWS Config managed rules are pre-built by AWS and referenced with Owner: AWS plus a SourceIdentifier like S3_BUCKET_PUBLIC_READ_PROHIBITED."
        },
        {
          "id": "SCS-C03-0005",
          "question": "Which service provides managed encryption keys that you can use to encrypt data at rest?",
          "choices": [
            {
              "id": "c4",
              "text": "AWS WAF",
              "isCorrect": false,
              "explanation": "AWS WAF is a web application firewall, not key management."
            },
            {
              "id": "c2",
              "text": "AWS IAM",
              "isCorrect": false,
              "explanation": "AWS IAM handles identity and permissions, not key storage or encryption primitives."
            },
            {
              "id": "c1",
              "text": "AWS KMS",
              "isCorrect": true,
              "explanation": "AWS KMS is the managed service for creating and controlling encryption keys."
            },
            {
              "id": "c3",
              "text": "AWS Shield",
              "isCorrect": false,
              "explanation": "AWS Shield protects against DDoS attacks, not key management."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Data Protection",
          "services": [
            "KMS",
            "IAM",
            "Shield",
            "WAF"
          ],
          "docs": "https://docs.aws.amazon.com/kms/latest/developerguide/overview.html",
          "tip": "Key management service with envelope encryption support.",
          "explanation": "AWS KMS provides centralized creation, rotation, and access control of encryption keys used to protect data at rest across services like S3, EBS, and RDS."
        },
        {
          "id": "SCS-C03-0017",
          "question": "A network security team must capture all accepted and rejected traffic metadata for forensic analysis across 200 VPCs in a multi-account organisation. They need to query weeks of historical data on demand without maintaining always-on infrastructure. Which architecture meets these requirements most cost-effectively?",
          "choices": [
            {
              "id": "c3",
              "text": "Stream Flow Logs to an Amazon OpenSearch cluster for real-time dashboards and historical search",
              "isCorrect": false,
              "explanation": "OpenSearch provides powerful search but requires always-on cluster infrastructure, violating the no-maintained-infrastructure requirement and increasing cost."
            },
            {
              "id": "c2",
              "text": "Send VPC Flow Logs to CloudWatch Logs in each account and use CloudWatch Logs Insights for queries",
              "isCorrect": false,
              "explanation": "CloudWatch Logs Insights works well for recent data but becomes expensive at high volume over weeks, and cross-account querying adds operational complexity compared to a centralised S3 approach."
            },
            {
              "id": "c4",
              "text": "Enable Traffic Mirroring on all ENIs and capture full packets for analysis",
              "isCorrect": false,
              "explanation": "Traffic Mirroring captures full packet payloads, which is vastly more data than flow log metadata, increasing costs dramatically and exceeding what the team requested."
            },
            {
              "id": "c1",
              "text": "Publish VPC Flow Logs to a centralised S3 bucket in the security account and query with Amazon Athena",
              "isCorrect": true,
              "explanation": "S3 storage is inexpensive at scale, and Athena provides serverless on-demand querying with no infrastructure to manage. Flow Logs support direct S3 delivery across accounts via resource policies."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Detection",
          "services": [
            "VPC Flow Logs",
            "CloudWatch Logs",
            "S3",
            "Athena"
          ],
          "docs": "https://docs.aws.amazon.com/vpc/latest/userguide/flow-logs.html",
          "tip": "For high-volume, infrequently-queried log data, think serverless query engines over managed log databases.",
          "explanation": "VPC Flow Logs can deliver directly to S3 in Parquet format with Hive-compatible partitioning, and Athena charges only per query scanned. This combination handles cross-account aggregation at scale without provisioning or maintaining any infrastructure."
        },
        {
          "id": "SCS-C03-0001",
          "question": "Which AWS service helps aggregate and analyze security findings across accounts?",
          "choices": [
            {
              "id": "c1",
              "text": "Amazon GuardDuty",
              "isCorrect": true,
              "explanation": "GuardDuty is a threat detection service that continuously monitors for malicious activity and unauthorized behavior."
            },
            {
              "id": "c3",
              "text": "AWS WAF",
              "isCorrect": false,
              "explanation": "AWS WAF is a web application firewall focused on HTTP(S) protections."
            },
            {
              "id": "c4",
              "text": "Amazon SNS",
              "isCorrect": false,
              "explanation": "Amazon SNS is a notification service, not a security findings aggregator."
            },
            {
              "id": "c2",
              "text": "AWS Config",
              "isCorrect": false,
              "explanation": "AWS Config tracks resource configuration and compliance, not threat detection."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Detection",
          "services": [
            "GuardDuty",
            "Config",
            "WAF",
            "SNS"
          ],
          "docs": "https://docs.aws.amazon.com/guardduty/latest/ug/what-is-guardduty.html",
          "tip": "Think of a service that detects threats across your account using machine learning and threat intelligence.",
          "explanation": "Amazon GuardDuty uses ML models and threat intelligence feeds to continuously detect threats across accounts. The closest wrong answer is AWS Config, which evaluates resource configuration compliance, whereas GuardDuty detects active threats."
        },
        {
          "id": "SCS-C03-0035",
          "question": "A CISO wants a single dashboard that shows the organisation's compliance posture against the CIS AWS Foundations Benchmark and the AWS Foundational Security Best Practices standard, with automated checks running continuously. Findings from GuardDuty and Inspector should also appear in the same view. Which TWO steps are required? (Select TWO)",
          "choices": [
            {
              "id": "c3",
              "text": "Create a custom CloudWatch dashboard aggregating Config, GuardDuty, and Inspector metrics",
              "isCorrect": false,
              "explanation": "CloudWatch dashboards show metrics and alarms, not security findings or compliance posture. Security Hub already provides the unified finding and compliance view."
            },
            {
              "id": "c2",
              "text": "Ensure AWS Config is enabled with recording turned on for all supported resource types",
              "isCorrect": true,
              "explanation": "Security Hub's compliance checks depend on AWS Config rules. If Config recording is not enabled, the automated checks cannot evaluate resource configurations and will produce no findings."
            },
            {
              "id": "c4",
              "text": "Deploy AWS Firewall Manager to enforce compliance checks across all accounts",
              "isCorrect": false,
              "explanation": "Firewall Manager manages WAF, Shield, and security group policies. It does not run CIS or Best Practices compliance checks or aggregate findings from GuardDuty and Inspector."
            },
            {
              "id": "c1",
              "text": "Enable AWS Security Hub and activate the CIS and Foundational Security Best Practices security standards",
              "isCorrect": true,
              "explanation": "Security Hub provides the unified dashboard and runs automated compliance checks against the selected standards using AWS Config rules it deploys automatically."
            },
            {
              "id": "c5",
              "text": "Manually export GuardDuty and Inspector findings to S3 and build QuickSight dashboards",
              "isCorrect": false,
              "explanation": "This creates a custom reporting pipeline but is not necessary. GuardDuty and Inspector integrate natively with Security Hub, sending findings automatically without manual export."
            }
          ],
          "selectCount": 2,
          "format": "text",
          "domain": "Detection",
          "services": [
            "Security Hub",
            "Config",
            "GuardDuty",
            "Firewall Manager",
            "Inspector"
          ],
          "docs": "https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards.html",
          "tip": "Security Hub is the aggregation layer, but it depends on Config for compliance checks. Both must be enabled.",
          "explanation": "Security Hub serves as the central security findings hub. It runs compliance checks by deploying Config rules for each control in the enabled standards, so AWS Config must be recording. GuardDuty and Inspector automatically send findings to Security Hub when both are enabled, providing the unified dashboard the CISO needs."
        },
        {
          "id": "SCS-C03-0013",
          "question": "An organisation wants to automatically isolate an EC2 instance when GuardDuty detects cryptocurrency mining activity. Which architecture achieves automated remediation with the least operational overhead?",
          "choices": [
            {
              "id": "c4",
              "text": "Use Systems Manager Automation runbooks triggered by a CPU alarm to stop instances",
              "isCorrect": false,
              "explanation": "CPU alarms are generic and can cause false positives."
            },
            {
              "id": "c3",
              "text": "Schedule a Lambda to poll GuardDuty every five minutes and isolate flagged instances",
              "isCorrect": false,
              "explanation": "Polling introduces delay and extra maintenance."
            },
            {
              "id": "c2",
              "text": "Enable Security Hub automated response playbooks to quarantine instances",
              "isCorrect": false,
              "explanation": "Security Hub aggregates findings but does not have built-in quarantine playbooks."
            },
            {
              "id": "c1",
              "text": "Configure GuardDuty findings to flow into EventBridge and trigger a Lambda that isolates the instance",
              "isCorrect": true,
              "explanation": "EventBridge rules can filter GuardDuty finding types and invoke Lambda for automated remediation."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Incident Response",
          "services": [
            "GuardDuty",
            "Security Hub",
            "EventBridge",
            "Lambda",
            "Systems Manager"
          ],
          "docs": "https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_finding-types-ec2.html",
          "tip": "The key is event-driven, near-real-time response with minimal ongoing maintenance.",
          "explanation": "GuardDuty publishes findings to EventBridge in near-real-time, enabling immediate Lambda-driven remediation."
        },
        {
          "id": "SCS-C03-0036",
          "question": "A security platform team must deploy a hardened VPC, a set of IAM permission boundaries, and logging configuration to 15 existing AWS accounts. Changes must be automated via CI/CD, deployments must be auditable, and any account drift should be detectable centrally. The team also wants least-privilege for the agents that perform deployments. Which approach best satisfies these requirements?",
          "choices": [
            {
              "id": "c1",
              "text": "Create a parameterized CloudFormation module for the baseline, publish it to a central artifact repository, and deploy via CloudFormation StackSets (service-managed) from a CI/CD pipeline using delegated administrator roles; enable drift detection and record pipeline runs for auditability",
              "isCorrect": true,
              "explanation": "StackSets (service-managed) supports automated, organization-aware deployments driven by CI/CD, delegated admin roles provide least-privilege, and enabling drift detection plus CI/CD run logs provides centralized detection and an audit trail."
            },
            {
              "id": "c3",
              "text": "Use Terraform workspaces stored locally per account and have individual engineers apply changes when notified",
              "isCorrect": false,
              "explanation": "Local, manual Terraform applies lack centralized automation, auditability, and organization-level drift detection; they also increase risk of inconsistent state."
            },
            {
              "id": "c2",
              "text": "Let each account run CloudFormation stacks triggered manually by account owners, and collect logs centrally afterwards",
              "isCorrect": false,
              "explanation": "Manual, per-account deployments are not automated or easily auditable and do not provide centralized drift detection or consistent configuration."
            },
            {
              "id": "c4",
              "text": "Utilise AWS Control Tower guardrails to keep accounts compliant and make manual adjustments via the console for exceptions",
              "isCorrect": false,
              "explanation": "Control Tower provides guardrails and a landing zone but is not a full CI/CD-driven IaC deployment and does not replace an auditable, parameterized IaC pipeline for existing accounts at scale."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Security Foundations and Governance",
          "services": [
            "CloudFormation",
            "StackSets",
            "CI/CD",
            "Organizations"
          ],
          "docs": "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/what-is-cfn.html",
          "tip": "Prefer org-aware IaC patterns that integrate with CI/CD, use delegated roles, and enable drift detection for centralized management.",
          "explanation": "For consistent, auditable, and automated deployments across multiple accounts, an org-aware IaC pattern like CloudFormation StackSets driven by a CI/CD pipeline provides parameterized modules, centralized rollout, delegated administration for least-privilege, and drift detection to identify configuration divergence. This pattern satisfies automation, auditability, and centralized management requirements."
        },
        {
          "id": "SCS-C03-0019",
          "question": "A financial services firm must store audit logs for seven years in a manner that no user, including root, can delete or modify them before the retention period expires. Regulators require proof of immutability. Which S3 feature satisfies these requirements?",
          "choices": [
            {
              "id": "c4",
              "text": "Enable MFA Delete on the S3 bucket to require MFA for all delete operations",
              "isCorrect": false,
              "explanation": "MFA Delete requires an additional authentication step but does not make objects truly immutable. A user with MFA can still delete them at any time."
            },
            {
              "id": "c1",
              "text": "S3 Object Lock in Compliance mode with a seven-year retention period",
              "isCorrect": true,
              "explanation": "Compliance mode prevents anyone, including the root user, from deleting or overwriting an object version until the retention date passes. This satisfies regulatory immutability requirements."
            },
            {
              "id": "c3",
              "text": "S3 Versioning with an S3 Lifecycle rule to transition objects to Glacier after 30 days",
              "isCorrect": false,
              "explanation": "Versioning preserves prior versions but does not prevent deletion of version markers. Glacier transition reduces cost but does not enforce immutability."
            },
            {
              "id": "c2",
              "text": "S3 Object Lock in Governance mode with a seven-year retention period",
              "isCorrect": false,
              "explanation": "Governance mode allows users with the s3:BypassGovernanceRetention permission to delete objects before the retention period ends, which does not meet the absolute immutability requirement."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Data Protection",
          "services": [
            "S3",
            "S3 Object Lock",
            "Glacier",
            "Backup"
          ],
          "docs": "https://docs.aws.amazon.com/AmazonS3/latest/userguide/object-lock.html",
          "tip": "Compliance mode is the only S3 mechanism where even the root account cannot shorten or remove the retention lock.",
          "explanation": "S3 Object Lock Compliance mode creates a WORM (Write Once Read Many) storage model. Once set, neither the object nor its retention settings can be altered or deleted by any principal until the retention period expires, meeting SEC 17a-4(f) and similar regulatory requirements."
        },
        {
          "id": "SCS-C03-0010",
          "question": "A security architect needs to prevent any account in the organisation from launching EC2 instances outside of eu-west-1 and eu-west-2, regardless of the IAM permissions granted within those accounts. Which approach should they use?",
          "choices": [
            {
              "id": "c4",
              "text": "Use a CloudFormation StackSet with a hook that blocks ec2:RunInstances in disallowed regions",
              "isCorrect": false,
              "explanation": "CloudFormation hooks validate CloudFormation-managed resources only, not direct API calls or console launches."
            },
            {
              "id": "c1",
              "text": "Attach a Service Control Policy (SCP) to the organisation root or target OUs that denies ec2:RunInstances unless the aws:RequestedRegion condition matches eu-west-1 or eu-west-2",
              "isCorrect": true,
              "explanation": "SCPs set maximum permission boundaries across all accounts in an OU or organisation, overriding any IAM policy within those accounts."
            },
            {
              "id": "c3",
              "text": "Deploy an AWS Config rule that evaluates EC2 instances and flags any launched outside the allowed regions as non-compliant",
              "isCorrect": false,
              "explanation": "Config rules are detective, not preventive - the instance would already be running before Config flags it."
            },
            {
              "id": "c2",
              "text": "Create an IAM policy in each account that denies ec2:RunInstances outside eu-west-1 and eu-west-2, and attach it to every IAM user and role",
              "isCorrect": false,
              "explanation": "Per-account IAM policies can be removed by local administrators, and new users or roles might not receive the policy."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Identity and Access Management",
          "services": [
            "Organizations",
            "IAM",
            "Config",
            "CloudFormation"
          ],
          "docs": "https://docs.aws.amazon.com/organizations/latest/userguide/orgs_manage_policies_scps.html",
          "tip": "You need a preventive control that applies across all accounts regardless of each account's local IAM policies.",
          "explanation": "Service Control Policies (SCPs) in AWS Organizations act as guardrails that define the maximum permissions available to all principals in member accounts."
        },
        {
          "id": "SCS-C03-0025",
          "question": "A Lambda function in a private subnet needs to call the Secrets Manager API to retrieve database credentials. The security team prohibits all internet-bound traffic from the VPC. How should the architect configure network access so the Lambda function can reach Secrets Manager without traversing the internet?",
          "choices": [
            {
              "id": "c4",
              "text": "Configure the Lambda function outside the VPC so it can access Secrets Manager over the internet by default",
              "isCorrect": false,
              "explanation": "Placing the function outside the VPC gives it internet access to AWS APIs, but the question states the function is in a private subnet, and moving it out may break access to other VPC resources like the database."
            },
            {
              "id": "c3",
              "text": "Attach an Elastic IP to the Lambda function's ENI for direct outbound access",
              "isCorrect": false,
              "explanation": "Lambda functions in a VPC do not support Elastic IPs, and this approach would use the internet gateway, which is prohibited."
            },
            {
              "id": "c1",
              "text": "Create an interface VPC endpoint (PrivateLink) for Secrets Manager in the same VPC and ensure the Lambda function's security group allows outbound HTTPS to the endpoint",
              "isCorrect": true,
              "explanation": "An interface VPC endpoint creates private ENIs within the VPC that route traffic to the Secrets Manager API entirely over the AWS private network, with no internet path required."
            },
            {
              "id": "c2",
              "text": "Add a NAT Gateway to the VPC and route the Lambda subnet's traffic through it",
              "isCorrect": false,
              "explanation": "A NAT Gateway provides internet access for outbound traffic, which violates the security team's prohibition on internet-bound traffic from the VPC."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Infrastructure Security",
          "services": [
            "Lambda",
            "VPC",
            "NAT Gateway",
            "PrivateLink",
            "Secrets Manager"
          ],
          "docs": "https://docs.aws.amazon.com/lambda/latest/dg/configuration-vpc.html",
          "tip": "When internet access is prohibited, PrivateLink endpoints bring AWS service APIs into the VPC over private connections.",
          "explanation": "Interface VPC endpoints (powered by AWS PrivateLink) create private IP addresses inside the VPC that serve as entry points for AWS service APIs. Traffic never leaves the AWS network, satisfying zero-internet-egress security requirements while allowing Lambda to call Secrets Manager."
        },
        {
          "id": "SCS-C03-0021",
          "question": "A company needs to inspect all egress traffic from its VPC for data exfiltration patterns using Suricata-compatible IDS/IPS rules at the network layer. Security Groups and NACLs are already in place for basic access control. Which service should they deploy?",
          "choices": [
            {
              "id": "c2",
              "text": "AWS WAF",
              "isCorrect": false,
              "explanation": "WAF operates at Layer 7 (HTTP/HTTPS) and integrates with CloudFront, ALB, and API Gateway. It cannot inspect arbitrary TCP/UDP egress traffic or run Suricata rules."
            },
            {
              "id": "c4",
              "text": "Configure more restrictive NACLs on the VPC subnets",
              "isCorrect": false,
              "explanation": "NACLs are stateless IP/port filters. They cannot inspect packet payloads or apply IDS/IPS signature-based rules."
            },
            {
              "id": "c1",
              "text": "AWS Network Firewall",
              "isCorrect": true,
              "explanation": "Network Firewall is a managed, stateful network firewall that supports Suricata-compatible rules for deep packet inspection, IDS/IPS, and domain-based filtering on both ingress and egress traffic."
            },
            {
              "id": "c3",
              "text": "Tighten Security Group outbound rules to restrict destination IPs",
              "isCorrect": false,
              "explanation": "Security Groups provide stateful allow/deny by IP and port but cannot perform deep packet inspection or pattern-based detection of data exfiltration."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Infrastructure Security",
          "services": [
            "Network Firewall",
            "WAF",
            "Security Groups",
            "NACLs"
          ],
          "docs": "https://docs.aws.amazon.com/network-firewall/latest/developerguide/what-is-aws-network-firewall.html",
          "tip": "When the requirement mentions Suricata, IDS/IPS, or deep packet inspection at the network layer, think beyond Security Groups and WAF.",
          "explanation": "AWS Network Firewall sits in-line in VPC traffic paths (via Gateway Load Balancer endpoints or firewall subnets) and evaluates packets against stateful Suricata-compatible rule groups. It fills the gap between simple Security Group/NACL controls and full deep-packet inspection requirements."
        },
        {
          "id": "SCS-C03-0007",
          "question": "A security engineer needs to restrict an IAM role so it can only access a specific S3 bucket from a particular VPC endpoint. Which resource should be added?",
          "choices": [
            {
              "id": "c4",
              "text": "Attach a security group to the IAM role that only allows traffic from the VPC",
              "isCorrect": false,
              "explanation": "Security groups are network-level controls for ENIs - they cannot be attached to IAM roles."
            },
            {
              "id": "c3",
              "text": "Add the VPC endpoint ID to the IAM role's trust policy as a Principal",
              "isCorrect": false,
              "explanation": "VPC endpoints are not IAM principals and cannot appear in a trust policy's Principal element."
            },
            {
              "id": "c1",
              "text": "{\"Condition\": {\"StringEquals\": {\"aws:sourceVpce\": \"vpce-certshack123\"}}}",
              "isCorrect": true,
              "explanation": "aws:sourceVpce condition restricts the policy to requests through the specified VPC endpoint."
            },
            {
              "id": "c2",
              "text": "{\"Condition\": {\"IpAddress\": {\"aws:SourceIp\": \"10.0.0.0/16\"}}}",
              "isCorrect": false,
              "explanation": "IpAddress/SourceIp restricts by IP range, not by VPC endpoint identity."
            }
          ],
          "selectCount": 1,
          "format": "json",
          "domain": "Identity and Access Management",
          "services": [
            "IAM",
            "S3"
          ],
          "docs": "https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies.html",
          "tip": "VPC endpoint restrictions in IAM use the aws:sourceVpce condition key with StringEquals.",
          "explanation": "The aws:sourceVpce condition key with StringEquals restricts access to requests that traverse a specific VPC endpoint."
        },
        {
          "id": "SCS-C03-0016",
          "question": "A development team stores database credentials in environment variables baked into their container images. The security team requires that credentials be rotated every 30 days without redeploying containers and that all credential access be auditable. Which approach best meets these requirements?",
          "choices": [
            {
              "id": "c3",
              "text": "Encrypt the environment variables at build time with a KMS key and decrypt them at container start",
              "isCorrect": false,
              "explanation": "This protects secrets at rest in the image, but rotating requires rebuilding and redeploying the container, which violates the no-redeploy requirement."
            },
            {
              "id": "c2",
              "text": "Store credentials in SSM Parameter Store SecureString parameters and write a cron job to update them monthly",
              "isCorrect": false,
              "explanation": "Parameter Store SecureStrings can hold secrets but lack built-in automatic rotation. A cron job is fragile and requires custom coordination with both the parameter and the database."
            },
            {
              "id": "c4",
              "text": "Use IAM database authentication to eliminate passwords entirely",
              "isCorrect": false,
              "explanation": "IAM database authentication works only with supported engines (Aurora MySQL/PostgreSQL, RDS MySQL/PostgreSQL) and may not cover all the team's databases. It also does not address other types of credentials."
            },
            {
              "id": "c1",
              "text": "Store credentials in AWS Secrets Manager with automatic rotation enabled and retrieve them at runtime using the Secrets Manager SDK",
              "isCorrect": true,
              "explanation": "Secrets Manager supports automatic rotation via Lambda, provides versioned secrets so applications always fetch the current value at runtime, and logs all access through CloudTrail."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Data Protection",
          "services": [
            "Secrets Manager",
            "Parameter Store",
            "KMS",
            "Lambda"
          ],
          "docs": "https://docs.aws.amazon.com/secretsmanager/latest/userguide/intro.html",
          "tip": "Automatic rotation without redeployment means the application must fetch secrets dynamically, not rely on values injected at build or deploy time.",
          "explanation": "Secrets Manager is purpose-built for credential lifecycle management. Its rotation feature invokes a Lambda function on a schedule to update both the secret value and the target resource (e.g., RDS password), while applications retrieve the current secret at runtime, eliminating the need for redeployment."
        },
        {
          "id": "SCS-C03-0023",
          "question": "A web application team needs to ensure that TLS certificates on their internet-facing ALBs are renewed automatically without any manual intervention or downtime. Certificates must support multiple subdomain names (e.g., api.example.com, app.example.com). Which approach meets these requirements?",
          "choices": [
            {
              "id": "c3",
              "text": "Use Let's Encrypt with certbot running on the ALB instances to obtain and renew certificates",
              "isCorrect": false,
              "explanation": "ALBs are managed services; you cannot run certbot or any agent on them. Let's Encrypt certificates must be imported into ACM, losing automatic renewal."
            },
            {
              "id": "c4",
              "text": "Generate a self-signed certificate for each subdomain and configure the ALB to present them using SNI",
              "isCorrect": false,
              "explanation": "Self-signed certificates are not trusted by browsers and will produce security warnings. They also require manual rotation, defeating the automation requirement."
            },
            {
              "id": "c1",
              "text": "Request a public ACM certificate with Subject Alternative Names (SANs) for each subdomain using DNS validation, and associate it with the ALB",
              "isCorrect": true,
              "explanation": "ACM public certificates with DNS validation renew automatically as long as the CNAME validation records remain in place. SANs allow multiple subdomains on a single certificate, and ALB natively integrates with ACM for zero-downtime deployment."
            },
            {
              "id": "c2",
              "text": "Purchase a wildcard certificate from a third-party CA, import it into ACM, and set a calendar reminder to renew it annually",
              "isCorrect": false,
              "explanation": "Imported certificates in ACM are not automatically renewed. Manual renewal and re-import is required, which introduces risk of expiration and human error."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Data Protection",
          "services": [
            "ACM",
            "CloudFront",
            "ALB",
            "Route 53"
          ],
          "docs": "https://docs.aws.amazon.com/acm/latest/userguide/acm-overview.html",
          "tip": "ACM's automatic renewal only works for certificates it issues (not imported ones), and DNS validation is the set-and-forget option.",
          "explanation": "AWS Certificate Manager issues free public certificates that renew automatically when DNS validation is used. By adding SANs for each subdomain, a single certificate covers multiple endpoints. ACM's native integration with ALB means certificate deployment and rotation happen transparently."
        },
        {
          "id": "SCS-C03-0003",
          "question": "To restrict traffic at the network edge for HTTP endpoints, which service should you combine with CloudFront?",
          "choices": [
            {
              "id": "c2",
              "text": "Security Groups",
              "isCorrect": false,
              "explanation": "Security Groups control traffic to EC2 at the instance level, not the CloudFront edge."
            },
            {
              "id": "c4",
              "text": "AWS KMS",
              "isCorrect": false,
              "explanation": "AWS KMS is for key management and encryption, not traffic filtering."
            },
            {
              "id": "c3",
              "text": "VPC Endpoint",
              "isCorrect": false,
              "explanation": "VPC Endpoints provide private connectivity to services within a VPC, not edge HTTP filtering."
            },
            {
              "id": "c1",
              "text": "AWS WAF",
              "isCorrect": true,
              "explanation": "AWS WAF is the web application firewall used with CloudFront to filter HTTP(S) traffic."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Infrastructure Security",
          "services": [
            "WAF",
            "CloudFront",
            "Security Groups"
          ],
          "docs": "https://docs.aws.amazon.com/waf/latest/developerguide/waf-chapter.html",
          "tip": "Think web application protection rules that block common attack patterns at the edge.",
          "explanation": "AWS WAF integrates natively with CloudFront, ALB, and API Gateway to inspect and filter HTTP(S) requests using rules such as rate limiting and SQL injection detection."
        },
        {
          "id": "SCS-C03-0011",
          "question": "A compliance requirement mandates that all CloudWatch Logs log groups must be encrypted at rest with a customer-managed KMS key and that the key policy must allow the CloudWatch Logs service principal to use it. Which combination of steps achieves this?",
          "choices": [
            {
              "id": "c4",
              "text": "Create an AWS-managed KMS key (alias aws/logs) and it will automatically encrypt all new log groups without any key policy changes",
              "isCorrect": false,
              "explanation": "CloudWatch Logs does not have an AWS-managed key. You must create and configure a customer-managed key explicitly."
            },
            {
              "id": "c3",
              "text": "Enable CloudTrail log file encryption with a KMS key and configure CloudWatch Logs as a CloudTrail destination",
              "isCorrect": false,
              "explanation": "CloudTrail encryption covers CloudTrail's own log files delivered to S3, not arbitrary CloudWatch Logs log groups."
            },
            {
              "id": "c1",
              "text": "Create a customer-managed KMS key with a key policy granting logs.<region>.amazonaws.com the kms:Encrypt, kms:Decrypt, kms:GenerateDataKey, and kms:DescribeKey actions, then associate the key with each log group",
              "isCorrect": true,
              "explanation": "CloudWatch Logs requires these four KMS actions in the key policy for the regional service principal to encrypt and decrypt log data."
            },
            {
              "id": "c2",
              "text": "Enable SSE-S3 default encryption on the S3 bucket where CloudWatch Logs exports data and reference that bucket in each log group's settings",
              "isCorrect": false,
              "explanation": "S3 encryption applies only to exported log data in S3, not to log data stored within the CloudWatch Logs service itself."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Data Protection",
          "services": [
            "CloudWatch Logs",
            "KMS",
            "S3",
            "CloudTrail"
          ],
          "docs": "https://docs.aws.amazon.com/AmazonCloudWatch/latest/logs/encrypt-log-data-kms.html",
          "tip": "CloudWatch Logs encryption requires a customer-managed CMK - there is no AWS-managed key option for this service.",
          "explanation": "CloudWatch Logs supports encryption at rest only with customer-managed KMS keys. You must explicitly grant the regional service principal permission to use the key."
        },
        {
          "id": "SCS-C03-0029",
          "question": "An organisation with 300 member accounts needs to enable GuardDuty in every account and every region, automatically including future accounts. All findings must be viewable from the security account. Which approach achieves this with the least ongoing maintenance?",
          "choices": [
            {
              "id": "c2",
              "text": "Send manual invitation requests from the security account to each of the 300 member accounts and accept them individually",
              "isCorrect": false,
              "explanation": "Manual invitations work but require per-account acceptance, do not auto-enrol future accounts, and become unmanageable at scale."
            },
            {
              "id": "c4",
              "text": "Enable Security Hub in the security account and it will automatically enable GuardDuty across all member accounts",
              "isCorrect": false,
              "explanation": "Security Hub aggregates findings from GuardDuty but does not enable or manage GuardDuty. They are independent services with separate enablement processes."
            },
            {
              "id": "c1",
              "text": "Designate a delegated administrator account for GuardDuty through AWS Organizations and enable the auto-enable feature for new member accounts",
              "isCorrect": true,
              "explanation": "The delegated administrator model in GuardDuty with auto-enable automatically activates GuardDuty in all current and future member accounts. Findings from all accounts are aggregated in the administrator account."
            },
            {
              "id": "c3",
              "text": "Deploy GuardDuty via a CloudFormation StackSet targeting all accounts and regions",
              "isCorrect": false,
              "explanation": "StackSets can enable GuardDuty but do not establish the administrator-member relationship needed to aggregate findings centrally, and they require additional work for auto-enabling in new accounts."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Detection",
          "services": [
            "GuardDuty",
            "Organizations",
            "Security Hub",
            "S3"
          ],
          "docs": "https://docs.aws.amazon.com/guardduty/latest/ug/what-is-guardduty.html",
          "tip": "The Organizations integration with delegated administrator and auto-enable is the hands-off, scalable approach for GuardDuty at organisation scale.",
          "explanation": "GuardDuty's Organizations integration allows a delegated administrator to manage GuardDuty across all member accounts centrally. The auto-enable feature ensures new accounts are automatically enrolled without manual intervention, and all findings flow to the administrator account for consolidated monitoring."
        },
        {
          "id": "SCS-C03-0006",
          "question": "A security team needs to centrally manage findings from multiple AWS security services and ensure encryption of sensitive data at rest. Which TWO services should they use together? (Select TWO)",
          "choices": [
            {
              "id": "c3",
              "text": "Amazon SQS",
              "isCorrect": false,
              "explanation": "SQS is a message queuing service, not related to security findings or encryption."
            },
            {
              "id": "c2",
              "text": "AWS KMS",
              "isCorrect": true,
              "explanation": "KMS provides centralized encryption key management for encrypting data at rest."
            },
            {
              "id": "c1",
              "text": "AWS Security Hub",
              "isCorrect": true,
              "explanation": "Security Hub provides a comprehensive view of security alerts and compliance status across accounts."
            },
            {
              "id": "c4",
              "text": "AWS CloudFormation",
              "isCorrect": false,
              "explanation": "CloudFormation is an infrastructure-as-code service, not a security findings tool."
            },
            {
              "id": "c5",
              "text": "Amazon EC2",
              "isCorrect": false,
              "explanation": "EC2 provides virtual machines, not security findings management."
            }
          ],
          "selectCount": 2,
          "format": "text",
          "domain": "Detection",
          "services": [
            "Security Hub",
            "KMS",
            "SQS",
            "CloudFormation",
            "EC2"
          ],
          "docs": "https://docs.aws.amazon.com/securityhub/latest/userguide/what-is-securityhub.html",
          "tip": "Think about centralized findings aggregation and key management.",
          "explanation": "Security Hub aggregates and normalizes findings and KMS provides the keys to encrypt sensitive data."
        },
        {
          "id": "SCS-C03-0034",
          "question": "A media company serves video content from S3 through CloudFront. They need to ensure users cannot bypass CloudFront and access S3 directly via the bucket URL. The solution must work with SSE-KMS encrypted objects. Which approach correctly restricts S3 access to CloudFront only?",
          "choices": [
            {
              "id": "c1",
              "text": "Create a CloudFront Origin Access Control (OAC) and update the S3 bucket policy to allow access only from the OAC",
              "isCorrect": true,
              "explanation": "OAC is the recommended method for restricting S3 access to CloudFront. Unlike the legacy OAI, OAC supports SSE-KMS, S3 Object Lock, and all S3 features. The bucket policy uses aws:SourceArn to allow only the specific CloudFront distribution."
            },
            {
              "id": "c4",
              "text": "Block public access on the bucket and share S3 pre-signed URLs directly with users instead of using CloudFront",
              "isCorrect": false,
              "explanation": "Pre-signed URLs bypass CloudFront entirely, losing edge caching, WAF protection, and geo-restriction capabilities. They also expose direct S3 access."
            },
            {
              "id": "c2",
              "text": "Create a CloudFront Origin Access Identity (OAI) and grant it read access in the S3 bucket policy",
              "isCorrect": false,
              "explanation": "OAI is the legacy approach and does not support SSE-KMS encrypted objects. CloudFront cannot forward the required SigV4 KMS headers when using OAI."
            },
            {
              "id": "c3",
              "text": "Make the S3 bucket a website endpoint origin in CloudFront and restrict access with a Referer header condition in the bucket policy",
              "isCorrect": false,
              "explanation": "Website endpoint origins use HTTP (not the S3 API), don't support SSE-KMS, and Referer headers can be spoofed, making this both incompatible and insecure."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Infrastructure Security",
          "services": [
            "CloudFront",
            "S3",
            "OAC",
            "WAF"
          ],
          "docs": "https://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/private-content-restricting-access-to-s3.html",
          "tip": "OAC replaced OAI and is required for SSE-KMS, S3 Object Lock, and other modern S3 features.",
          "explanation": "Origin Access Control (OAC) uses SigV4-signed requests from CloudFront to S3, which supports all S3 encryption modes including SSE-KMS. The S3 bucket policy can use the Condition key aws:SourceArn to restrict access to a specific CloudFront distribution ARN, ensuring no direct S3 access is possible."
        },
        {
          "id": "SCS-C03-0012",
          "question": "A platform team wants to allow developers to create their own IAM roles for Lambda functions, but ensure those roles can never have permissions beyond what the platform team defines. Which mechanism should they use?",
          "choices": [
            {
              "id": "c4",
              "text": "Use an SCP to deny iam:CreateRole for all developers and have the platform team create roles on request",
              "isCorrect": false,
              "explanation": "This removes developer self-service entirely, creating operational bottlenecks without enabling delegation."
            },
            {
              "id": "c2",
              "text": "Grant developers iam:CreateRole but restrict the role's trust policy to lambda.amazonaws.com only",
              "isCorrect": false,
              "explanation": "Restricting the trust policy limits who can assume the role, but does not limit what permissions the role itself can have."
            },
            {
              "id": "c1",
              "text": "Require developers to attach a permissions boundary to every role they create",
              "isCorrect": true,
              "explanation": "Permissions boundaries cap the maximum permissions a role can have, even if the role's identity policy grants broader access."
            },
            {
              "id": "c3",
              "text": "Create a single shared Lambda execution role managed by the platform team",
              "isCorrect": false,
              "explanation": "A shared role works but violates least privilege because all functions share the same permissions regardless of their needs."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Identity and Access Management",
          "services": [
            "IAM",
            "Organizations",
            "STS"
          ],
          "docs": "https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies_boundaries.html",
          "tip": "You need a mechanism that caps maximum permissions while still allowing developers to create and manage their own roles.",
          "explanation": "IAM permissions boundaries act as a ceiling on the effective permissions of a role or user."
        },
        {
          "id": "SCS-C03-0002",
          "question": "During an incident, which service lets you run investigative notebooks and analyze data?",
          "choices": [
            {
              "id": "c4",
              "text": "AWS CloudTrail",
              "isCorrect": false,
              "explanation": "CloudTrail records API activity and is useful for forensics, but Detective provides investigative workflows."
            },
            {
              "id": "c3",
              "text": "AWS Shield",
              "isCorrect": false,
              "explanation": "AWS Shield provides DDoS protections, not forensic investigation tools."
            },
            {
              "id": "c2",
              "text": "Amazon Detective",
              "isCorrect": true,
              "explanation": "Amazon Detective is designed to analyze, visualize, and conduct investigations into potential security issues."
            },
            {
              "id": "c1",
              "text": "AWS Systems Manager",
              "isCorrect": false,
              "explanation": "Systems Manager helps manage instances but is not focused on security investigation notebooks."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Incident Response",
          "services": [
            "Detective",
            "Systems Manager",
            "Shield",
            "CloudTrail"
          ],
          "docs": "https://docs.aws.amazon.com/detective/latest/adminguide/what-is.html",
          "tip": "This service helps visualize and investigate security issues by linking related findings and activity.",
          "explanation": "Amazon Detective automatically collects log data from VPC Flow Logs, CloudTrail, and GuardDuty, then builds a graph model that links related events so analysts can visually trace activity."
        },
        {
          "id": "SCS-C03-0024",
          "question": "A security architect wants to continuously detect any S3 buckets, IAM roles, KMS keys, or Lambda functions that are shared with external AWS accounts or public access. The solution must generate findings automatically without requiring custom code. Which service should they enable?",
          "choices": [
            {
              "id": "c2",
              "text": "AWS Config with the s3-bucket-public-read-prohibited managed rule",
              "isCorrect": false,
              "explanation": "This Config rule only checks S3 public read access. It does not cover cross-account sharing of IAM roles, KMS keys, or Lambda functions."
            },
            {
              "id": "c3",
              "text": "AWS Trusted Advisor security checks",
              "isCorrect": false,
              "explanation": "Trusted Advisor checks a limited set of security best practices (e.g., open security groups, root MFA) but does not perform policy-level analysis of cross-account resource sharing."
            },
            {
              "id": "c4",
              "text": "Amazon GuardDuty",
              "isCorrect": false,
              "explanation": "GuardDuty detects threats based on anomalous behaviour and threat intelligence. It does not analyze resource policies to find intentional cross-account sharing or public access grants."
            },
            {
              "id": "c1",
              "text": "IAM Access Analyzer",
              "isCorrect": true,
              "explanation": "Access Analyzer uses automated reasoning to analyze resource-based policies and identifies resources that are accessible from outside the zone of trust (account or organisation), generating findings for each."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Identity and Access Management",
          "services": [
            "IAM Access Analyzer",
            "IAM",
            "S3",
            "Lambda",
            "KMS"
          ],
          "docs": "https://docs.aws.amazon.com/IAM/latest/UserGuide/access-analyzer-getting-started.html",
          "tip": "This service uses automated reasoning (formal logic) over policies, not anomaly detection or predefined compliance rules.",
          "explanation": "IAM Access Analyzer applies Zelkova-based automated reasoning to evaluate resource-based policies on S3 buckets, SQS queues, IAM roles, KMS keys, Lambda functions, and Secrets Manager secrets. It produces actionable findings whenever a policy grants access outside the defined zone of trust, with no custom code required."
        },
        {
          "id": "SCS-C03-0033",
          "question": "An incident responder has identified a compromised IAM role and needs to immediately invalidate all existing sessions for that role while preserving the role itself for forensic analysis. Which approach revokes all active sessions without deleting the role?",
          "choices": [
            {
              "id": "c4",
              "text": "Contact AWS Support to force-expire the role's temporary credentials",
              "isCorrect": false,
              "explanation": "AWS Support cannot force-expire individual STS tokens. Session revocation must be done through IAM policy mechanisms by the account administrator."
            },
            {
              "id": "c3",
              "text": "Change the role's trust policy to deny all principals",
              "isCorrect": false,
              "explanation": "Modifying the trust policy prevents new role assumptions but does not invalidate existing active sessions. Temporary credentials already issued remain valid until they expire."
            },
            {
              "id": "c1",
              "text": "Add an inline deny-all policy to the role with a condition that aws:TokenIssueTime is before the current timestamp:\n{\"Effect\":\"Deny\",\"Action\":\"*\",\"Resource\":\"*\",\"Condition\":{\"DateLessThan\":{\"aws:TokenIssueTime\":\"2026-02-16T12:00:00Z\"}}}",
              "isCorrect": true,
              "explanation": "This technique (Revoke Session) denies all actions for temporary credentials issued before the specified time. New sessions assumed after that time are unaffected, and the role remains intact for investigation."
            },
            {
              "id": "c2",
              "text": "Delete all inline and managed policies from the role to remove its permissions",
              "isCorrect": false,
              "explanation": "Removing policies prevents new actions but also destroys the evidence of what permissions the role had, which is critical for forensic analysis."
            }
          ],
          "selectCount": 1,
          "format": "json",
          "domain": "Incident Response",
          "services": [
            "STS",
            "IAM",
            "CloudTrail"
          ],
          "docs": "https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_temp_request.html",
          "tip": "The Revoke Session technique uses a deny policy with the aws:TokenIssueTime condition to invalidate all credentials issued before a cutoff time.",
          "explanation": "STS temporary credentials cannot be individually revoked, but you can render them useless by attaching a deny-all policy with a DateLessThan condition on aws:TokenIssueTime. This is the recommended emergency response for compromised roles because it immediately neutralizes existing sessions while keeping the role and its policies intact for forensic review."
        },
        {
          "id": "SCS-C03-0032",
          "question": "A security team discovers that malware on compromised EC2 instances is using DNS queries to known command-and-control domains for data exfiltration. They need to block DNS resolution of these domains for all resources in the VPC without deploying custom DNS servers. Which service provides this capability?",
          "choices": [
            {
              "id": "c3",
              "text": "Create NACL rules to block outbound UDP port 53 to the internet",
              "isCorrect": false,
              "explanation": "Blocking port 53 outbound would break DNS resolution for all VPC resources, not just malicious queries. VPC DNS uses the Route 53 Resolver internally, so NACL rules do not affect VPC-internal DNS resolution."
            },
            {
              "id": "c4",
              "text": "Enable GuardDuty DNS resolution monitoring to automatically block malicious domains",
              "isCorrect": false,
              "explanation": "GuardDuty detects and alerts on DNS queries to known malicious domains, but it does not block them. DNS Firewall provides the enforcement (blocking) capability."
            },
            {
              "id": "c2",
              "text": "AWS WAF with a custom rule to block DNS traffic patterns",
              "isCorrect": false,
              "explanation": "WAF operates on HTTP/HTTPS traffic at Layer 7. It cannot inspect or block DNS queries (UDP port 53) made by VPC resources to the Route 53 Resolver."
            },
            {
              "id": "c1",
              "text": "Route 53 Resolver DNS Firewall with a block-list rule group associated to the VPC",
              "isCorrect": true,
              "explanation": "DNS Firewall lets you create domain lists and rule groups that block, allow, or alert on DNS queries made through the Route 53 Resolver. Associating a rule group to a VPC applies the rules to all DNS queries from that VPC."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Infrastructure Security",
          "services": [
            "Route 53",
            "Route 53 Resolver DNS Firewall",
            "VPC",
            "GuardDuty"
          ],
          "docs": "https://docs.aws.amazon.com/Route53/latest/DeveloperGuide/resolver-dns-firewall.html",
          "tip": "GuardDuty detects, but DNS Firewall blocks. Use both together for detect-and-prevent.",
          "explanation": "Route 53 Resolver DNS Firewall provides managed DNS-layer filtering within VPCs. You define domain lists (or import AWS-managed threat lists) and create rule groups with BLOCK, ALLOW, or ALERT actions. Associating the rule group to a VPC applies filtering to all Route 53 Resolver queries from that VPC."
        },
        {
          "id": "SCS-C03-0015",
          "question": "A security team needs to provide shell access to EC2 instances in private subnets without opening SSH ports or managing bastion hosts, while maintaining a full audit trail of every command executed. Which solution meets these requirements?",
          "choices": [
            {
              "id": "c3",
              "text": "EC2 Instance Connect",
              "isCorrect": false,
              "explanation": "Instance Connect still requires port 22 and does not natively log full session content."
            },
            {
              "id": "c4",
              "text": "VPN to the private subnet and SSH",
              "isCorrect": false,
              "explanation": "VPN plus SSH captures metadata but not command-level audit content."
            },
            {
              "id": "c1",
              "text": "Systems Manager Session Manager",
              "isCorrect": true,
              "explanation": "Session Manager establishes encrypted sessions through the SSM agent without opening inbound ports and can log sessions to S3 or CloudWatch Logs."
            },
            {
              "id": "c2",
              "text": "Deploy a bastion host with SSH key-based authentication",
              "isCorrect": false,
              "explanation": "Bastion hosts require open SSH ports and add operational burden."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Infrastructure Security",
          "services": [
            "Systems Manager",
            "EC2",
            "IAM",
            "CloudTrail"
          ],
          "docs": "https://docs.aws.amazon.com/systems-manager/latest/userguide/session-manager.html",
          "tip": "Look for a service that provides shell access through an agent, not through network-level connectivity.",
          "explanation": "Session Manager uses the SSM agent to create encrypted, IAM-authenticated sessions without inbound security group rules and logs session output for auditing."
        },
        {
          "id": "SCS-C03-0014",
          "question": "A data lake team manages a single S3 bucket accessed by multiple applications across different VPCs. They need to enforce that each application can only reach the bucket from its own VPC and can only access objects under its designated prefix. Which approach provides the strongest isolation with the least policy complexity?",
          "choices": [
            {
              "id": "c3",
              "text": "Create one VPC endpoint per VPC and use endpoint policies",
              "isCorrect": false,
              "explanation": "Endpoint policies are coarse for prefix-level scoping."
            },
            {
              "id": "c2",
              "text": "Write a single S3 bucket policy with separate statements per application",
              "isCorrect": false,
              "explanation": "A single bucket policy becomes difficult to manage and has size limits."
            },
            {
              "id": "c4",
              "text": "Replicate data into separate per-application buckets",
              "isCorrect": false,
              "explanation": "Replication increases cost and complexity."
            },
            {
              "id": "c1",
              "text": "Create a separate S3 Access Point for each application",
              "isCorrect": true,
              "explanation": "S3 Access Points allow per-application network and permission scoping against a shared bucket."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Data Protection",
          "services": [
            "S3",
            "IAM",
            "VPC",
            "PrivateLink"
          ],
          "docs": "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-points.html",
          "tip": "Consider a feature that lets you create named network-scoped entry points to a single bucket.",
          "explanation": "S3 Access Points provide named, per-application entry points to a bucket, each with its own policy and optional VPC restriction."
        },
        {
          "id": "SCS-C03-0026",
          "question": "A company with 50 AWS accounts wants to enforce a baseline set of preventive and detective security controls (e.g., disallow public S3 buckets, require CloudTrail in all regions) across all accounts. They need a managed landing zone that automatically applies these controls to new accounts as they are created. Which service provides this capability?",
          "choices": [
            {
              "id": "c4",
              "text": "AWS Trusted Advisor organisational view",
              "isCorrect": false,
              "explanation": "Trusted Advisor provides recommendations and checks but does not enforce controls or manage account provisioning or landing zones."
            },
            {
              "id": "c1",
              "text": "AWS Control Tower with mandatory and elective guardrails",
              "isCorrect": true,
              "explanation": "Control Tower provides a managed landing zone with pre-configured guardrails (implemented as SCPs for preventive controls and Config rules for detective controls) that are automatically applied to accounts enrolled in the landing zone."
            },
            {
              "id": "c2",
              "text": "AWS Organizations with manually written SCPs and Config rules deployed via StackSets",
              "isCorrect": false,
              "explanation": "This approach works but requires manual authoring, testing, and deployment of each control. Control Tower automates this with curated, pre-tested guardrails and handles new-account enrollment automatically."
            },
            {
              "id": "c3",
              "text": "AWS Security Hub with the AWS Foundational Security Best Practices standard",
              "isCorrect": false,
              "explanation": "Security Hub detects deviations from best practices (detective) but does not prevent them (preventive). It also does not provision or manage accounts or landing zones."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Identity and Access Management",
          "services": [
            "Control Tower",
            "Organizations",
            "Config",
            "CloudFormation"
          ],
          "docs": "https://docs.aws.amazon.com/controltower/latest/userguide/guardrails.html",
          "tip": "The key phrase is 'managed landing zone' with automatic enforcement on new accounts, which points to a specific governance service.",
          "explanation": "Control Tower orchestrates Organizations, Config, CloudFormation, and IAM Identity Center to create a governed multi-account environment. Its guardrails are curated controls that are automatically enforced (preventive via SCPs) or monitored (detective via Config rules) across all enrolled accounts, including newly created ones."
        },
        {
          "id": "SCS-C03-0030",
          "question": "A disaster recovery plan requires that all objects in a production S3 bucket encrypted with a customer-managed KMS key be replicated to a bucket in a different region using a different KMS key. Which TWO configurations are required for cross-region replication to work with KMS-encrypted objects? (Select TWO)",
          "choices": [
            {
              "id": "c4",
              "text": "Enable S3 Transfer Acceleration on both buckets to speed up cross-region replication",
              "isCorrect": false,
              "explanation": "Transfer Acceleration optimizes direct uploads via CloudFront edge locations. It is not related to S3 replication, which uses its own internal transfer mechanism."
            },
            {
              "id": "c1",
              "text": "Specify the destination KMS key ARN in the replication rule configuration",
              "isCorrect": true,
              "explanation": "When replicating KMS-encrypted objects, the replication configuration must specify the destination KMS key so S3 can re-encrypt the objects in the destination region."
            },
            {
              "id": "c5",
              "text": "Disable KMS encryption on the destination bucket and use SSE-S3 instead",
              "isCorrect": false,
              "explanation": "Switching to SSE-S3 would avoid KMS complexity but loses the benefits of customer-managed key control, audit via CloudTrail, and compliance requirements that may mandate CMK usage."
            },
            {
              "id": "c3",
              "text": "Use the same KMS key in both the source and destination regions",
              "isCorrect": false,
              "explanation": "KMS keys are regional. A key in us-east-1 cannot be used in eu-west-1. Multi-Region KMS keys exist but are not required; specifying the destination key in the replication rule is sufficient."
            },
            {
              "id": "c2",
              "text": "Grant the S3 replication role kms:Decrypt permission on the source key and kms:Encrypt permission on the destination key",
              "isCorrect": true,
              "explanation": "The replication role must decrypt the objects using the source CMK and then encrypt them with the destination CMK. Without both permissions, replication fails with AccessDenied."
            }
          ],
          "selectCount": 2,
          "format": "text",
          "domain": "Data Protection",
          "services": [
            "S3",
            "KMS",
            "IAM",
            "Organizations"
          ],
          "docs": "https://docs.aws.amazon.com/AmazonS3/latest/userguide/replication-walkthrough-2.html",
          "tip": "Cross-region KMS replication requires both a destination key specification and the right permissions for the replication role on both the source and destination keys.",
          "explanation": "S3 replication with SSE-KMS objects requires two key configurations: the replication rule must specify the destination KMS key ARN (since KMS keys are regional), and the replication IAM role must have kms:Decrypt on the source key plus kms:Encrypt and kms:GenerateDataKey on the destination key."
        },
        {
          "id": "SCS-C03-0028",
          "question": "A data engineering team needs their Lambda function to decrypt objects in an S3 bucket that uses SSE-KMS with a customer-managed key. The function's execution role has s3:GetObject permission. Decryption attempts fail with AccessDeniedException from KMS. Which key policy statement, added to the CMK, resolves this?",
          "choices": [
            {
              "id": "c4",
              "text": "Change the bucket encryption from SSE-KMS to SSE-S3 to avoid the KMS dependency",
              "isCorrect": false,
              "explanation": "Switching to SSE-S3 would eliminate the error, but it removes the ability to control access through KMS key policies, audit key usage via CloudTrail, and use customer-managed key rotation, which may be required by policy."
            },
            {
              "id": "c2",
              "text": "{\"Sid\":\"AllowLambdaDecrypt\",\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"lambda.amazonaws.com\"},\"Action\":[\"kms:Decrypt\"],\"Resource\":\"*\"}",
              "isCorrect": false,
              "explanation": "KMS key policies should grant permissions to the IAM role, not to the Lambda service principal. The service principal is used in trust policies, not key policies."
            },
            {
              "id": "c3",
              "text": "Add kms:Decrypt to the Lambda execution role's IAM policy without changing the key policy",
              "isCorrect": false,
              "explanation": "For customer-managed KMS keys, both the key policy AND the IAM policy must allow the action. If the key policy does not grant access to the principal, the IAM policy alone is insufficient."
            },
            {
              "id": "c1",
              "text": "{\"Sid\":\"AllowLambdaDecrypt\",\"Effect\":\"Allow\",\"Principal\":{\"AWS\":\"arn:aws:iam::123456789012:role/lambda-exec-role\"},\"Action\":[\"kms:Decrypt\",\"kms:DescribeKey\"],\"Resource\":\"*\"}",
              "isCorrect": true,
              "explanation": "The Lambda execution role needs kms:Decrypt (to decrypt the data key protecting the S3 object) and kms:DescribeKey (to validate the key). The key policy must explicitly grant these actions to the role's ARN."
            }
          ],
          "selectCount": 1,
          "format": "json",
          "domain": "Data Protection",
          "services": [
            "KMS",
            "IAM",
            "S3",
            "Lambda"
          ],
          "docs": "https://docs.aws.amazon.com/kms/latest/developerguide/key-policy-modifying.html",
          "tip": "With customer-managed KMS keys, access requires permission in both the key policy and the caller's IAM policy. The key policy is the primary gatekeeper.",
          "explanation": "Customer-managed KMS keys use a resource-based policy (key policy) that must explicitly allow principals to perform cryptographic operations. Unlike AWS-managed keys, there is no automatic cross-grant. Both the key policy and the IAM policy on the caller must allow the action for it to succeed."
        },
        {
          "id": "SCS-C03-0020",
          "question": "After enabling GuardDuty S3 Protection, a security analyst notices a finding of type Policy:S3/BucketAnonymousAccessGranted for a production data bucket. The analyst needs to determine which principal changed the bucket policy and when. Which data source provides this information?",
          "choices": [
            {
              "id": "c1",
              "text": "CloudTrail management events showing the PutBucketPolicy API call",
              "isCorrect": true,
              "explanation": "CloudTrail records the identity (principal), timestamp, source IP, and request parameters for S3 control-plane API calls like PutBucketPolicy. This is the authoritative source for who changed the policy and when."
            },
            {
              "id": "c3",
              "text": "S3 server access logs for the data bucket",
              "isCorrect": false,
              "explanation": "S3 server access logs capture object-level read/write requests, not bucket policy changes. Control-plane actions like PutBucketPolicy are not recorded in access logs."
            },
            {
              "id": "c2",
              "text": "The GuardDuty finding detail itself, which includes the actor and timestamp",
              "isCorrect": false,
              "explanation": "GuardDuty findings identify the affected resource and the anomaly but do not always include the full details of who made the original policy change. CloudTrail provides the definitive audit trail."
            },
            {
              "id": "c4",
              "text": "VPC Flow Logs for the VPC where the analyst is working",
              "isCorrect": false,
              "explanation": "VPC Flow Logs capture network-layer metadata (IP, port, protocol) but not API-level details like which principal called PutBucketPolicy."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Detection",
          "services": [
            "GuardDuty",
            "CloudTrail",
            "S3",
            "Security Hub"
          ],
          "docs": "https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_s3-protection.html",
          "tip": "Distinguish between data-plane logs (S3 access logs, VPC Flow Logs) and control-plane logs (CloudTrail) when investigating policy changes.",
          "explanation": "CloudTrail management events are the single source of truth for AWS API activity. When investigating who changed a resource configuration, always start with CloudTrail, which records the IAM principal, the API action, the request parameters, and the exact timestamp."
        },
        {
          "id": "SCS-C03-0018",
          "question": "A company runs workloads on Amazon EKS and needs each Kubernetes pod to assume a unique IAM role with fine-grained permissions. The trust policy must ensure only the intended service account in a specific namespace can assume the role. Which trust policy snippet correctly restricts role assumption to the pod's OIDC identity?",
          "choices": [
            {
              "id": "c4",
              "text": "{\"Effect\":\"Allow\",\"Principal\":{\"Federated\":\"cognito-identity.amazonaws.com\"},\"Action\":\"sts:AssumeRoleWithWebIdentity\"}",
              "isCorrect": false,
              "explanation": "Cognito Identity is for end-user identity federation, not Kubernetes workload identity. EKS uses its own OIDC provider endpoint."
            },
            {
              "id": "c3",
              "text": "{\"Effect\":\"Allow\",\"Principal\":{\"AWS\":\"arn:aws:iam::123456789012:role/eks-node-role\"},\"Action\":\"sts:AssumeRole\"}",
              "isCorrect": false,
              "explanation": "Trusting the node role lets every pod on that node assume this role, eliminating per-pod isolation."
            },
            {
              "id": "c1",
              "text": "{\"Effect\":\"Allow\",\"Principal\":{\"Federated\":\"arn:aws:iam::123456789012:oidc-provider/oidc.eks.us-east-1.amazonaws.com/id/EXAMPLED539D4633E53DE1B71EXAMPLE\"},\"Action\":\"sts:AssumeRoleWithWebIdentity\",\"Condition\":{\"StringEquals\":{\"oidc.eks.us-east-1.amazonaws.com/id/EXAMPLED539D4633E53DE1B71EXAMPLE:sub\":\"system:serviceaccount:app-ns:app-sa\"}}}",
              "isCorrect": true,
              "explanation": "This uses the EKS OIDC provider as a Federated principal with AssumeRoleWithWebIdentity, and the Condition restricts the sub claim to the exact namespace:serviceaccount pair."
            },
            {
              "id": "c2",
              "text": "{\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"eks.amazonaws.com\"},\"Action\":\"sts:AssumeRole\"}",
              "isCorrect": false,
              "explanation": "This trusts the EKS service itself (the control plane), not individual pod identities. Any EKS-managed component could assume this role, not just the intended pod."
            }
          ],
          "selectCount": 1,
          "format": "json",
          "domain": "Identity and Access Management",
          "services": [
            "IAM",
            "STS",
            "Cognito",
            "EKS"
          ],
          "docs": "https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_providers_oidc.html",
          "tip": "EKS IRSA (IAM Roles for Service Accounts) uses the cluster's OIDC provider URL as a federated principal and filters by the sub claim.",
          "explanation": "IRSA projects a signed OIDC token into each pod, and the trust policy uses the cluster OIDC provider as a Federated principal with a Condition on the sub claim (namespace:serviceaccount). This ensures only the precise service account in the correct namespace can assume the role."
        },
        {
          "id": "SCS-C03-0031",
          "question": "During an incident investigation, an analyst has shell access to a compromised EC2 instance and needs to determine which IAM identity the instance is currently using to make AWS API calls. Which CLI command reveals this information?",
          "choices": [
            {
              "id": "c1",
              "text": "aws sts get-caller-identity",
              "isCorrect": true,
              "explanation": "This command returns the UserId, Account, and ARN of the IAM identity (user, role, or federated identity) making the request. On an EC2 instance, it reveals the instance profile role."
            },
            {
              "id": "c4",
              "text": "curl http://169.254.169.254/latest/meta-data/iam/security-credentials/",
              "isCorrect": false,
              "explanation": "This metadata endpoint lists the instance profile role name and can retrieve temporary credentials, but it does not show the full ARN or account ID. It also does not detect if the instance is using a different assumed role via manual STS calls."
            },
            {
              "id": "c2",
              "text": "aws iam get-user",
              "isCorrect": false,
              "explanation": "get-user returns information about an IAM user. On an instance using a role (not a user), this command fails because the caller is not an IAM user."
            },
            {
              "id": "c3",
              "text": "aws ec2 describe-instances --instance-id $(curl -s http://169.254.169.254/latest/meta-data/instance-id)",
              "isCorrect": false,
              "explanation": "describe-instances shows instance metadata including the IamInstanceProfile association, but the response contains the profile ARN, not the currently assumed role ARN with session details. get-caller-identity is more direct."
            }
          ],
          "selectCount": 1,
          "format": "cli",
          "domain": "Incident Response",
          "services": [
            "STS",
            "IAM",
            "CloudShell"
          ],
          "docs": "https://docs.aws.amazon.com/cli/latest/reference/sts/get-caller-identity.html",
          "tip": "This STS command works universally regardless of whether the caller is a user, role, federated identity, or instance profile.",
          "explanation": "aws sts get-caller-identity is the quickest and most reliable way to determine the current AWS identity context. It works for all principal types and returns the ARN that appears in CloudTrail logs, making it invaluable during investigations."
        },
        {
          "id": "SCS-C03-0027",
          "question": "A security team has an AWS Config rule that detects S3 buckets without default encryption enabled. They want Config to automatically remediate non-compliant buckets by applying AES-256 server-side encryption. Which CloudFormation snippet correctly defines the auto-remediation action?",
          "choices": [
            {
              "id": "c1",
              "text": "Type: AWS::Config::RemediationConfiguration\nProperties:\n  ConfigRuleName: s3-bucket-server-side-encryption-enabled\n  TargetType: SSM_DOCUMENT\n  TargetId: AWS-EnableS3BucketEncryption\n  Automatic: true\n  MaximumAutomaticAttempts: 3\n  RetryAttemptSeconds: 60\n  Parameters:\n    BucketName:\n      ResourceValue:\n        Value: RESOURCE_ID",
              "isCorrect": true,
              "explanation": "This uses an AWS-provided SSM Automation document to enable encryption on the non-compliant bucket. TargetType SSM_DOCUMENT and the RESOURCE_ID placeholder correctly bind the remediation to the flagged resource."
            },
            {
              "id": "c2",
              "text": "Type: AWS::Config::RemediationConfiguration\nProperties:\n  ConfigRuleName: s3-bucket-server-side-encryption-enabled\n  TargetType: LAMBDA\n  TargetId: arn:aws:lambda:us-east-1:123456789012:function:fix-encryption\n  Automatic: true",
              "isCorrect": false,
              "explanation": "Config remediation currently only supports SSM_DOCUMENT as a TargetType. Lambda functions cannot be used directly as remediation targets in a RemediationConfiguration resource."
            },
            {
              "id": "c3",
              "text": "Add a ComplianceResourceTypes property to the Config rule that triggers an SNS notification, then subscribe a Lambda function to apply encryption",
              "isCorrect": false,
              "explanation": "This creates a notification pipeline, not an automatic remediation. It also requires custom SNS-to-Lambda wiring and does not use Config's built-in remediation feature."
            },
            {
              "id": "c4",
              "text": "Use an EventBridge rule to detect Config compliance change events and invoke a Step Functions workflow",
              "isCorrect": false,
              "explanation": "While this architecture works, it bypasses Config's native remediation capability, introducing more components to build and maintain. The question asks for Config auto-remediation."
            }
          ],
          "selectCount": 1,
          "format": "yaml",
          "domain": "Detection",
          "services": [
            "Config",
            "Systems Manager",
            "S3",
            "Lambda"
          ],
          "docs": "https://docs.aws.amazon.com/config/latest/developerguide/remediation.html",
          "tip": "Config auto-remediation always uses SSM Automation documents (TargetType: SSM_DOCUMENT), not Lambda directly.",
          "explanation": "AWS Config remediation actions invoke SSM Automation documents to fix non-compliant resources. AWS provides pre-built documents like AWS-EnableS3BucketEncryption. Setting Automatic to true and configuring retry parameters ensures Config will apply the fix without manual intervention whenever a drift is detected."
        },
        {
          "id": "SCS-C03-0004",
          "question": "Which feature helps enforce least privilege by providing temporary credentials?",
          "choices": [
            {
              "id": "c3",
              "text": "Security Groups",
              "isCorrect": false,
              "explanation": "Security Groups are network controls, not credential mechanisms."
            },
            {
              "id": "c1",
              "text": "IAM Roles with STS",
              "isCorrect": true,
              "explanation": "IAM Roles with STS allow issuance of temporary credentials for short-term access."
            },
            {
              "id": "c4",
              "text": "Amazon Cognito",
              "isCorrect": false,
              "explanation": "Amazon Cognito provides user identity for apps, but the core mechanism for temporary AWS credentials is STS with roles."
            },
            {
              "id": "c2",
              "text": "IAM Users with long-term access keys",
              "isCorrect": false,
              "explanation": "IAM Users with long-term keys are not recommended for least-privilege patterns."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Identity and Access Management",
          "services": [
            "IAM",
            "STS",
            "Cognito"
          ],
          "docs": "https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles.html",
          "tip": "Temporary credentials reduce the risk from long-lived keys.",
          "explanation": "IAM Roles combined with AWS STS issue temporary credentials that automatically expire, reducing blast radius if leaked."
        },
        {
          "id": "SCS-C03-0009",
          "question": "A company stores customer PII in S3 and needs to automatically discover and classify sensitive data across hundreds of buckets. Which service should they enable?",
          "choices": [
            {
              "id": "c4",
              "text": "AWS Trusted Advisor",
              "isCorrect": false,
              "explanation": "Trusted Advisor provides account-level checks like open security groups, but does not scan S3 object contents."
            },
            {
              "id": "c3",
              "text": "Amazon Inspector",
              "isCorrect": false,
              "explanation": "Inspector focuses on vulnerability scanning for compute workloads, not data classification in S3."
            },
            {
              "id": "c2",
              "text": "Amazon GuardDuty",
              "isCorrect": false,
              "explanation": "GuardDuty detects threats like unusual API calls to S3 but does not inspect object contents for sensitive data."
            },
            {
              "id": "c1",
              "text": "Amazon Macie",
              "isCorrect": true,
              "explanation": "Macie scans S3 objects for PII, financial data, and credentials using ML-powered classifiers and managed data identifiers."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Data Protection",
          "services": [
            "Macie",
            "GuardDuty",
            "Inspector",
            "Trusted Advisor"
          ],
          "docs": "https://docs.aws.amazon.com/macie/latest/user/what-is-macie.html",
          "tip": "This service is purpose-built for finding sensitive data like credit card numbers and passport IDs inside S3 objects.",
          "explanation": "Amazon Macie is designed to scan S3 objects and classify sensitive content such as PII and PHI using managed data identifiers."
        },
        {
          "id": "SCS-C03-0022",
          "question": "An operations team wants to automate incident response when a critical CloudWatch alarm triggers: page the on-call engineer, create a timeline, and start a runbook to collect diagnostic data. They want a single AWS-native service to orchestrate all three actions. Which service should they configure?",
          "choices": [
            {
              "id": "c1",
              "text": "AWS Systems Manager Incident Manager",
              "isCorrect": true,
              "explanation": "Incident Manager automates incident creation with response plans that define escalation contacts, engagement protocols, and runbook automation, all triggered by CloudWatch alarms or EventBridge rules."
            },
            {
              "id": "c4",
              "text": "AWS CloudWatch composite alarms with auto-scaling actions",
              "isCorrect": false,
              "explanation": "Composite alarms aggregate alarm states but their actions are limited to SNS, Lambda, or Auto Scaling. They do not provide incident lifecycle management."
            },
            {
              "id": "c3",
              "text": "Amazon SNS with multiple topic subscriptions",
              "isCorrect": false,
              "explanation": "SNS delivers notifications but does not manage incident timelines, runbook execution, or structured escalation workflows."
            },
            {
              "id": "c2",
              "text": "Amazon EventBridge with Lambda targets",
              "isCorrect": false,
              "explanation": "EventBridge plus Lambda can achieve similar automation but requires custom code for paging, timeline tracking, and runbook execution. It is not a single orchestration service purpose-built for incident response."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Incident Response",
          "services": [
            "Systems Manager Incident Manager",
            "EventBridge",
            "SNS",
            "PagerDuty"
          ],
          "docs": "https://docs.aws.amazon.com/incident-manager/latest/userguide/what-is-incident-manager.html",
          "tip": "Look for a service that combines paging, incident timeline, and runbook automation in a single response plan.",
          "explanation": "Incident Manager provides structured response plans that automatically engage contacts (via SMS, voice, or email), create incident timelines, and execute SSM Automation runbooks when triggered. This consolidates incident orchestration into one service rather than gluing multiple services together with custom logic."
        }
      ],
      "perDomain": {
        "Detection": {
          "total": 1,
          "correct": 1,
          "score": 100
        },
        "Data Protection": {
          "total": 1,
          "correct": 1,
          "score": 100
        }
      },
      "earlyComplete": true,
      "answeredCount": 2,
      "totalQuestions": 36
    },
    {
      "attemptId": "46fe58a2-9cf1-4eab-a2cd-8c470b1c5f63",
      "userId": "9255a4e4-20f1-7010-8a80-17c43ca141e3",
      "examCode": "SCS-C03",
      "examVersion": null,
      "s3VersionId": null,
      "attemptSchemaVersion": 1,
      "startedAt": "2026-02-18T10:38:47.635Z",
      "finishedAt": "2026-02-18T10:39:35.743Z",
      "score": 50,
      "answers": [
        {
          "questionId": "SCS-C03-0022",
          "selectedChoiceId": "c2",
          "selectedChoiceIds": null,
          "selectedIndex": null,
          "selectedIndices": null,
          "correct": false,
          "timeMs": 0,
          "showTip": false,
          "createdAt": "2026-02-18T10:39:17.579Z"
        },
        {
          "questionId": "SCS-C03-0006",
          "selectedChoiceId": null,
          "selectedChoiceIds": [
            "c1",
            "c2"
          ],
          "selectedIndex": null,
          "selectedIndices": null,
          "correct": true,
          "timeMs": 0,
          "showTip": false,
          "createdAt": "2026-02-18T10:39:31.573Z"
        }
      ],
      "metadata": {
        "serviceKeywords": [],
        "domains": [],
        "services": []
      },
      "questions": [
        {
          "id": "SCS-C03-0022",
          "question": "An operations team wants to automate incident response when a critical CloudWatch alarm triggers: page the on-call engineer, create a timeline, and start a runbook to collect diagnostic data. They want a single AWS-native service to orchestrate all three actions. Which service should they configure?",
          "choices": [
            {
              "id": "c3",
              "text": "Amazon SNS with multiple topic subscriptions",
              "isCorrect": false,
              "explanation": "SNS delivers notifications but does not manage incident timelines, runbook execution, or structured escalation workflows."
            },
            {
              "id": "c1",
              "text": "AWS Systems Manager Incident Manager",
              "isCorrect": true,
              "explanation": "Incident Manager automates incident creation with response plans that define escalation contacts, engagement protocols, and runbook automation, all triggered by CloudWatch alarms or EventBridge rules."
            },
            {
              "id": "c4",
              "text": "AWS CloudWatch composite alarms with auto-scaling actions",
              "isCorrect": false,
              "explanation": "Composite alarms aggregate alarm states but their actions are limited to SNS, Lambda, or Auto Scaling. They do not provide incident lifecycle management."
            },
            {
              "id": "c2",
              "text": "Amazon EventBridge with Lambda targets",
              "isCorrect": false,
              "explanation": "EventBridge plus Lambda can achieve similar automation but requires custom code for paging, timeline tracking, and runbook execution. It is not a single orchestration service purpose-built for incident response."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Incident Response",
          "services": [
            "Systems Manager Incident Manager",
            "EventBridge",
            "SNS",
            "PagerDuty"
          ],
          "docs": "https://docs.aws.amazon.com/incident-manager/latest/userguide/what-is-incident-manager.html",
          "tip": "Look for a service that combines paging, incident timeline, and runbook automation in a single response plan.",
          "explanation": "Incident Manager provides structured response plans that automatically engage contacts (via SMS, voice, or email), create incident timelines, and execute SSM Automation runbooks when triggered. This consolidates incident orchestration into one service rather than gluing multiple services together with custom logic."
        },
        {
          "id": "SCS-C03-0006",
          "question": "A security team needs to centrally manage findings from multiple AWS security services and ensure encryption of sensitive data at rest. Which TWO services should they use together? (Select TWO)",
          "choices": [
            {
              "id": "c5",
              "text": "Amazon EC2",
              "isCorrect": false,
              "explanation": "EC2 provides virtual machines, not security findings management."
            },
            {
              "id": "c1",
              "text": "AWS Security Hub",
              "isCorrect": true,
              "explanation": "Security Hub provides a comprehensive view of security alerts and compliance status across accounts."
            },
            {
              "id": "c3",
              "text": "Amazon SQS",
              "isCorrect": false,
              "explanation": "SQS is a message queuing service, not related to security findings or encryption."
            },
            {
              "id": "c4",
              "text": "AWS CloudFormation",
              "isCorrect": false,
              "explanation": "CloudFormation is an infrastructure-as-code service, not a security findings tool."
            },
            {
              "id": "c2",
              "text": "AWS KMS",
              "isCorrect": true,
              "explanation": "KMS provides centralized encryption key management for encrypting data at rest."
            }
          ],
          "selectCount": 2,
          "format": "text",
          "domain": "Detection",
          "services": [
            "Security Hub",
            "KMS",
            "SQS",
            "CloudFormation",
            "EC2"
          ],
          "docs": "https://docs.aws.amazon.com/securityhub/latest/userguide/what-is-securityhub.html",
          "tip": "Think about centralized findings aggregation and key management.",
          "explanation": "Security Hub aggregates and normalizes findings and KMS provides the keys to encrypt sensitive data."
        },
        {
          "id": "SCS-C03-0015",
          "question": "A security team needs to provide shell access to EC2 instances in private subnets without opening SSH ports or managing bastion hosts, while maintaining a full audit trail of every command executed. Which solution meets these requirements?",
          "choices": [
            {
              "id": "c3",
              "text": "EC2 Instance Connect",
              "isCorrect": false,
              "explanation": "Instance Connect still requires port 22 and does not natively log full session content."
            },
            {
              "id": "c2",
              "text": "Deploy a bastion host with SSH key-based authentication",
              "isCorrect": false,
              "explanation": "Bastion hosts require open SSH ports and add operational burden."
            },
            {
              "id": "c4",
              "text": "VPN to the private subnet and SSH",
              "isCorrect": false,
              "explanation": "VPN plus SSH captures metadata but not command-level audit content."
            },
            {
              "id": "c1",
              "text": "Systems Manager Session Manager",
              "isCorrect": true,
              "explanation": "Session Manager establishes encrypted sessions through the SSM agent without opening inbound ports and can log sessions to S3 or CloudWatch Logs."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Infrastructure Security",
          "services": [
            "Systems Manager",
            "EC2",
            "IAM",
            "CloudTrail"
          ],
          "docs": "https://docs.aws.amazon.com/systems-manager/latest/userguide/session-manager.html",
          "tip": "Look for a service that provides shell access through an agent, not through network-level connectivity.",
          "explanation": "Session Manager uses the SSM agent to create encrypted, IAM-authenticated sessions without inbound security group rules and logs session output for auditing."
        },
        {
          "id": "SCS-C03-0032",
          "question": "A security team discovers that malware on compromised EC2 instances is using DNS queries to known command-and-control domains for data exfiltration. They need to block DNS resolution of these domains for all resources in the VPC without deploying custom DNS servers. Which service provides this capability?",
          "choices": [
            {
              "id": "c4",
              "text": "Enable GuardDuty DNS resolution monitoring to automatically block malicious domains",
              "isCorrect": false,
              "explanation": "GuardDuty detects and alerts on DNS queries to known malicious domains, but it does not block them. DNS Firewall provides the enforcement (blocking) capability."
            },
            {
              "id": "c2",
              "text": "AWS WAF with a custom rule to block DNS traffic patterns",
              "isCorrect": false,
              "explanation": "WAF operates on HTTP/HTTPS traffic at Layer 7. It cannot inspect or block DNS queries (UDP port 53) made by VPC resources to the Route 53 Resolver."
            },
            {
              "id": "c1",
              "text": "Route 53 Resolver DNS Firewall with a block-list rule group associated to the VPC",
              "isCorrect": true,
              "explanation": "DNS Firewall lets you create domain lists and rule groups that block, allow, or alert on DNS queries made through the Route 53 Resolver. Associating a rule group to a VPC applies the rules to all DNS queries from that VPC."
            },
            {
              "id": "c3",
              "text": "Create NACL rules to block outbound UDP port 53 to the internet",
              "isCorrect": false,
              "explanation": "Blocking port 53 outbound would break DNS resolution for all VPC resources, not just malicious queries. VPC DNS uses the Route 53 Resolver internally, so NACL rules do not affect VPC-internal DNS resolution."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Infrastructure Security",
          "services": [
            "Route 53",
            "Route 53 Resolver DNS Firewall",
            "VPC",
            "GuardDuty"
          ],
          "docs": "https://docs.aws.amazon.com/Route53/latest/DeveloperGuide/resolver-dns-firewall.html",
          "tip": "GuardDuty detects, but DNS Firewall blocks. Use both together for detect-and-prevent.",
          "explanation": "Route 53 Resolver DNS Firewall provides managed DNS-layer filtering within VPCs. You define domain lists (or import AWS-managed threat lists) and create rule groups with BLOCK, ALLOW, or ALERT actions. Associating the rule group to a VPC applies filtering to all Route 53 Resolver queries from that VPC."
        },
        {
          "id": "SCS-C03-0009",
          "question": "A company stores customer PII in S3 and needs to automatically discover and classify sensitive data across hundreds of buckets. Which service should they enable?",
          "choices": [
            {
              "id": "c4",
              "text": "AWS Trusted Advisor",
              "isCorrect": false,
              "explanation": "Trusted Advisor provides account-level checks like open security groups, but does not scan S3 object contents."
            },
            {
              "id": "c1",
              "text": "Amazon Macie",
              "isCorrect": true,
              "explanation": "Macie scans S3 objects for PII, financial data, and credentials using ML-powered classifiers and managed data identifiers."
            },
            {
              "id": "c3",
              "text": "Amazon Inspector",
              "isCorrect": false,
              "explanation": "Inspector focuses on vulnerability scanning for compute workloads, not data classification in S3."
            },
            {
              "id": "c2",
              "text": "Amazon GuardDuty",
              "isCorrect": false,
              "explanation": "GuardDuty detects threats like unusual API calls to S3 but does not inspect object contents for sensitive data."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Data Protection",
          "services": [
            "Macie",
            "GuardDuty",
            "Inspector",
            "Trusted Advisor"
          ],
          "docs": "https://docs.aws.amazon.com/macie/latest/user/what-is-macie.html",
          "tip": "This service is purpose-built for finding sensitive data like credit card numbers and passport IDs inside S3 objects.",
          "explanation": "Amazon Macie is designed to scan S3 objects and classify sensitive content such as PII and PHI using managed data identifiers."
        },
        {
          "id": "SCS-C03-0035",
          "question": "A CISO wants a single dashboard that shows the organisation's compliance posture against the CIS AWS Foundations Benchmark and the AWS Foundational Security Best Practices standard, with automated checks running continuously. Findings from GuardDuty and Inspector should also appear in the same view. Which TWO steps are required? (Select TWO)",
          "choices": [
            {
              "id": "c2",
              "text": "Ensure AWS Config is enabled with recording turned on for all supported resource types",
              "isCorrect": true,
              "explanation": "Security Hub's compliance checks depend on AWS Config rules. If Config recording is not enabled, the automated checks cannot evaluate resource configurations and will produce no findings."
            },
            {
              "id": "c3",
              "text": "Create a custom CloudWatch dashboard aggregating Config, GuardDuty, and Inspector metrics",
              "isCorrect": false,
              "explanation": "CloudWatch dashboards show metrics and alarms, not security findings or compliance posture. Security Hub already provides the unified finding and compliance view."
            },
            {
              "id": "c4",
              "text": "Deploy AWS Firewall Manager to enforce compliance checks across all accounts",
              "isCorrect": false,
              "explanation": "Firewall Manager manages WAF, Shield, and security group policies. It does not run CIS or Best Practices compliance checks or aggregate findings from GuardDuty and Inspector."
            },
            {
              "id": "c1",
              "text": "Enable AWS Security Hub and activate the CIS and Foundational Security Best Practices security standards",
              "isCorrect": true,
              "explanation": "Security Hub provides the unified dashboard and runs automated compliance checks against the selected standards using AWS Config rules it deploys automatically."
            },
            {
              "id": "c5",
              "text": "Manually export GuardDuty and Inspector findings to S3 and build QuickSight dashboards",
              "isCorrect": false,
              "explanation": "This creates a custom reporting pipeline but is not necessary. GuardDuty and Inspector integrate natively with Security Hub, sending findings automatically without manual export."
            }
          ],
          "selectCount": 2,
          "format": "text",
          "domain": "Detection",
          "services": [
            "Security Hub",
            "Config",
            "GuardDuty",
            "Firewall Manager",
            "Inspector"
          ],
          "docs": "https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards.html",
          "tip": "Security Hub is the aggregation layer, but it depends on Config for compliance checks. Both must be enabled.",
          "explanation": "Security Hub serves as the central security findings hub. It runs compliance checks by deploying Config rules for each control in the enabled standards, so AWS Config must be recording. GuardDuty and Inspector automatically send findings to Security Hub when both are enabled, providing the unified dashboard the CISO needs."
        },
        {
          "id": "SCS-C03-0010",
          "question": "A security architect needs to prevent any account in the organisation from launching EC2 instances outside of eu-west-1 and eu-west-2, regardless of the IAM permissions granted within those accounts. Which approach should they use?",
          "choices": [
            {
              "id": "c2",
              "text": "Create an IAM policy in each account that denies ec2:RunInstances outside eu-west-1 and eu-west-2, and attach it to every IAM user and role",
              "isCorrect": false,
              "explanation": "Per-account IAM policies can be removed by local administrators, and new users or roles might not receive the policy."
            },
            {
              "id": "c4",
              "text": "Use a CloudFormation StackSet with a hook that blocks ec2:RunInstances in disallowed regions",
              "isCorrect": false,
              "explanation": "CloudFormation hooks validate CloudFormation-managed resources only, not direct API calls or console launches."
            },
            {
              "id": "c3",
              "text": "Deploy an AWS Config rule that evaluates EC2 instances and flags any launched outside the allowed regions as non-compliant",
              "isCorrect": false,
              "explanation": "Config rules are detective, not preventive - the instance would already be running before Config flags it."
            },
            {
              "id": "c1",
              "text": "Attach a Service Control Policy (SCP) to the organisation root or target OUs that denies ec2:RunInstances unless the aws:RequestedRegion condition matches eu-west-1 or eu-west-2",
              "isCorrect": true,
              "explanation": "SCPs set maximum permission boundaries across all accounts in an OU or organisation, overriding any IAM policy within those accounts."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Identity and Access Management",
          "services": [
            "Organizations",
            "IAM",
            "Config",
            "CloudFormation"
          ],
          "docs": "https://docs.aws.amazon.com/organizations/latest/userguide/orgs_manage_policies_scps.html",
          "tip": "You need a preventive control that applies across all accounts regardless of each account's local IAM policies.",
          "explanation": "Service Control Policies (SCPs) in AWS Organizations act as guardrails that define the maximum permissions available to all principals in member accounts."
        },
        {
          "id": "SCS-C03-0005",
          "question": "Which service provides managed encryption keys that you can use to encrypt data at rest?",
          "choices": [
            {
              "id": "c2",
              "text": "AWS IAM",
              "isCorrect": false,
              "explanation": "AWS IAM handles identity and permissions, not key storage or encryption primitives."
            },
            {
              "id": "c3",
              "text": "AWS Shield",
              "isCorrect": false,
              "explanation": "AWS Shield protects against DDoS attacks, not key management."
            },
            {
              "id": "c4",
              "text": "AWS WAF",
              "isCorrect": false,
              "explanation": "AWS WAF is a web application firewall, not key management."
            },
            {
              "id": "c1",
              "text": "AWS KMS",
              "isCorrect": true,
              "explanation": "AWS KMS is the managed service for creating and controlling encryption keys."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Data Protection",
          "services": [
            "KMS",
            "IAM",
            "Shield",
            "WAF"
          ],
          "docs": "https://docs.aws.amazon.com/kms/latest/developerguide/overview.html",
          "tip": "Key management service with envelope encryption support.",
          "explanation": "AWS KMS provides centralized creation, rotation, and access control of encryption keys used to protect data at rest across services like S3, EBS, and RDS."
        },
        {
          "id": "SCS-C03-0033",
          "question": "An incident responder has identified a compromised IAM role and needs to immediately invalidate all existing sessions for that role while preserving the role itself for forensic analysis. Which approach revokes all active sessions without deleting the role?",
          "choices": [
            {
              "id": "c2",
              "text": "Delete all inline and managed policies from the role to remove its permissions",
              "isCorrect": false,
              "explanation": "Removing policies prevents new actions but also destroys the evidence of what permissions the role had, which is critical for forensic analysis."
            },
            {
              "id": "c3",
              "text": "Change the role's trust policy to deny all principals",
              "isCorrect": false,
              "explanation": "Modifying the trust policy prevents new role assumptions but does not invalidate existing active sessions. Temporary credentials already issued remain valid until they expire."
            },
            {
              "id": "c1",
              "text": "Add an inline deny-all policy to the role with a condition that aws:TokenIssueTime is before the current timestamp:\n{\"Effect\":\"Deny\",\"Action\":\"*\",\"Resource\":\"*\",\"Condition\":{\"DateLessThan\":{\"aws:TokenIssueTime\":\"2026-02-16T12:00:00Z\"}}}",
              "isCorrect": true,
              "explanation": "This technique (Revoke Session) denies all actions for temporary credentials issued before the specified time. New sessions assumed after that time are unaffected, and the role remains intact for investigation."
            },
            {
              "id": "c4",
              "text": "Contact AWS Support to force-expire the role's temporary credentials",
              "isCorrect": false,
              "explanation": "AWS Support cannot force-expire individual STS tokens. Session revocation must be done through IAM policy mechanisms by the account administrator."
            }
          ],
          "selectCount": 1,
          "format": "json",
          "domain": "Incident Response",
          "services": [
            "STS",
            "IAM",
            "CloudTrail"
          ],
          "docs": "https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_temp_request.html",
          "tip": "The Revoke Session technique uses a deny policy with the aws:TokenIssueTime condition to invalidate all credentials issued before a cutoff time.",
          "explanation": "STS temporary credentials cannot be individually revoked, but you can render them useless by attaching a deny-all policy with a DateLessThan condition on aws:TokenIssueTime. This is the recommended emergency response for compromised roles because it immediately neutralizes existing sessions while keeping the role and its policies intact for forensic review."
        },
        {
          "id": "SCS-C03-0026",
          "question": "A company with 50 AWS accounts wants to enforce a baseline set of preventive and detective security controls (e.g., disallow public S3 buckets, require CloudTrail in all regions) across all accounts. They need a managed landing zone that automatically applies these controls to new accounts as they are created. Which service provides this capability?",
          "choices": [
            {
              "id": "c1",
              "text": "AWS Control Tower with mandatory and elective guardrails",
              "isCorrect": true,
              "explanation": "Control Tower provides a managed landing zone with pre-configured guardrails (implemented as SCPs for preventive controls and Config rules for detective controls) that are automatically applied to accounts enrolled in the landing zone."
            },
            {
              "id": "c2",
              "text": "AWS Organizations with manually written SCPs and Config rules deployed via StackSets",
              "isCorrect": false,
              "explanation": "This approach works but requires manual authoring, testing, and deployment of each control. Control Tower automates this with curated, pre-tested guardrails and handles new-account enrollment automatically."
            },
            {
              "id": "c3",
              "text": "AWS Security Hub with the AWS Foundational Security Best Practices standard",
              "isCorrect": false,
              "explanation": "Security Hub detects deviations from best practices (detective) but does not prevent them (preventive). It also does not provision or manage accounts or landing zones."
            },
            {
              "id": "c4",
              "text": "AWS Trusted Advisor organisational view",
              "isCorrect": false,
              "explanation": "Trusted Advisor provides recommendations and checks but does not enforce controls or manage account provisioning or landing zones."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Identity and Access Management",
          "services": [
            "Control Tower",
            "Organizations",
            "Config",
            "CloudFormation"
          ],
          "docs": "https://docs.aws.amazon.com/controltower/latest/userguide/guardrails.html",
          "tip": "The key phrase is 'managed landing zone' with automatic enforcement on new accounts, which points to a specific governance service.",
          "explanation": "Control Tower orchestrates Organizations, Config, CloudFormation, and IAM Identity Center to create a governed multi-account environment. Its guardrails are curated controls that are automatically enforced (preventive via SCPs) or monitored (detective via Config rules) across all enrolled accounts, including newly created ones."
        },
        {
          "id": "SCS-C03-0021",
          "question": "A company needs to inspect all egress traffic from its VPC for data exfiltration patterns using Suricata-compatible IDS/IPS rules at the network layer. Security Groups and NACLs are already in place for basic access control. Which service should they deploy?",
          "choices": [
            {
              "id": "c2",
              "text": "AWS WAF",
              "isCorrect": false,
              "explanation": "WAF operates at Layer 7 (HTTP/HTTPS) and integrates with CloudFront, ALB, and API Gateway. It cannot inspect arbitrary TCP/UDP egress traffic or run Suricata rules."
            },
            {
              "id": "c3",
              "text": "Tighten Security Group outbound rules to restrict destination IPs",
              "isCorrect": false,
              "explanation": "Security Groups provide stateful allow/deny by IP and port but cannot perform deep packet inspection or pattern-based detection of data exfiltration."
            },
            {
              "id": "c4",
              "text": "Configure more restrictive NACLs on the VPC subnets",
              "isCorrect": false,
              "explanation": "NACLs are stateless IP/port filters. They cannot inspect packet payloads or apply IDS/IPS signature-based rules."
            },
            {
              "id": "c1",
              "text": "AWS Network Firewall",
              "isCorrect": true,
              "explanation": "Network Firewall is a managed, stateful network firewall that supports Suricata-compatible rules for deep packet inspection, IDS/IPS, and domain-based filtering on both ingress and egress traffic."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Infrastructure Security",
          "services": [
            "Network Firewall",
            "WAF",
            "Security Groups",
            "NACLs"
          ],
          "docs": "https://docs.aws.amazon.com/network-firewall/latest/developerguide/what-is-aws-network-firewall.html",
          "tip": "When the requirement mentions Suricata, IDS/IPS, or deep packet inspection at the network layer, think beyond Security Groups and WAF.",
          "explanation": "AWS Network Firewall sits in-line in VPC traffic paths (via Gateway Load Balancer endpoints or firewall subnets) and evaluates packets against stateful Suricata-compatible rule groups. It fills the gap between simple Security Group/NACL controls and full deep-packet inspection requirements."
        },
        {
          "id": "SCS-C03-0017",
          "question": "A network security team must capture all accepted and rejected traffic metadata for forensic analysis across 200 VPCs in a multi-account organisation. They need to query weeks of historical data on demand without maintaining always-on infrastructure. Which architecture meets these requirements most cost-effectively?",
          "choices": [
            {
              "id": "c4",
              "text": "Enable Traffic Mirroring on all ENIs and capture full packets for analysis",
              "isCorrect": false,
              "explanation": "Traffic Mirroring captures full packet payloads, which is vastly more data than flow log metadata, increasing costs dramatically and exceeding what the team requested."
            },
            {
              "id": "c1",
              "text": "Publish VPC Flow Logs to a centralised S3 bucket in the security account and query with Amazon Athena",
              "isCorrect": true,
              "explanation": "S3 storage is inexpensive at scale, and Athena provides serverless on-demand querying with no infrastructure to manage. Flow Logs support direct S3 delivery across accounts via resource policies."
            },
            {
              "id": "c2",
              "text": "Send VPC Flow Logs to CloudWatch Logs in each account and use CloudWatch Logs Insights for queries",
              "isCorrect": false,
              "explanation": "CloudWatch Logs Insights works well for recent data but becomes expensive at high volume over weeks, and cross-account querying adds operational complexity compared to a centralised S3 approach."
            },
            {
              "id": "c3",
              "text": "Stream Flow Logs to an Amazon OpenSearch cluster for real-time dashboards and historical search",
              "isCorrect": false,
              "explanation": "OpenSearch provides powerful search but requires always-on cluster infrastructure, violating the no-maintained-infrastructure requirement and increasing cost."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Detection",
          "services": [
            "VPC Flow Logs",
            "CloudWatch Logs",
            "S3",
            "Athena"
          ],
          "docs": "https://docs.aws.amazon.com/vpc/latest/userguide/flow-logs.html",
          "tip": "For high-volume, infrequently-queried log data, think serverless query engines over managed log databases.",
          "explanation": "VPC Flow Logs can deliver directly to S3 in Parquet format with Hive-compatible partitioning, and Athena charges only per query scanned. This combination handles cross-account aggregation at scale without provisioning or maintaining any infrastructure."
        },
        {
          "id": "SCS-C03-0025",
          "question": "A Lambda function in a private subnet needs to call the Secrets Manager API to retrieve database credentials. The security team prohibits all internet-bound traffic from the VPC. How should the architect configure network access so the Lambda function can reach Secrets Manager without traversing the internet?",
          "choices": [
            {
              "id": "c1",
              "text": "Create an interface VPC endpoint (PrivateLink) for Secrets Manager in the same VPC and ensure the Lambda function's security group allows outbound HTTPS to the endpoint",
              "isCorrect": true,
              "explanation": "An interface VPC endpoint creates private ENIs within the VPC that route traffic to the Secrets Manager API entirely over the AWS private network, with no internet path required."
            },
            {
              "id": "c4",
              "text": "Configure the Lambda function outside the VPC so it can access Secrets Manager over the internet by default",
              "isCorrect": false,
              "explanation": "Placing the function outside the VPC gives it internet access to AWS APIs, but the question states the function is in a private subnet, and moving it out may break access to other VPC resources like the database."
            },
            {
              "id": "c2",
              "text": "Add a NAT Gateway to the VPC and route the Lambda subnet's traffic through it",
              "isCorrect": false,
              "explanation": "A NAT Gateway provides internet access for outbound traffic, which violates the security team's prohibition on internet-bound traffic from the VPC."
            },
            {
              "id": "c3",
              "text": "Attach an Elastic IP to the Lambda function's ENI for direct outbound access",
              "isCorrect": false,
              "explanation": "Lambda functions in a VPC do not support Elastic IPs, and this approach would use the internet gateway, which is prohibited."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Infrastructure Security",
          "services": [
            "Lambda",
            "VPC",
            "NAT Gateway",
            "PrivateLink",
            "Secrets Manager"
          ],
          "docs": "https://docs.aws.amazon.com/lambda/latest/dg/configuration-vpc.html",
          "tip": "When internet access is prohibited, PrivateLink endpoints bring AWS service APIs into the VPC over private connections.",
          "explanation": "Interface VPC endpoints (powered by AWS PrivateLink) create private IP addresses inside the VPC that serve as entry points for AWS service APIs. Traffic never leaves the AWS network, satisfying zero-internet-egress security requirements while allowing Lambda to call Secrets Manager."
        },
        {
          "id": "SCS-C03-0018",
          "question": "A company runs workloads on Amazon EKS and needs each Kubernetes pod to assume a unique IAM role with fine-grained permissions. The trust policy must ensure only the intended service account in a specific namespace can assume the role. Which trust policy snippet correctly restricts role assumption to the pod's OIDC identity?",
          "choices": [
            {
              "id": "c4",
              "text": "{\"Effect\":\"Allow\",\"Principal\":{\"Federated\":\"cognito-identity.amazonaws.com\"},\"Action\":\"sts:AssumeRoleWithWebIdentity\"}",
              "isCorrect": false,
              "explanation": "Cognito Identity is for end-user identity federation, not Kubernetes workload identity. EKS uses its own OIDC provider endpoint."
            },
            {
              "id": "c3",
              "text": "{\"Effect\":\"Allow\",\"Principal\":{\"AWS\":\"arn:aws:iam::123456789012:role/eks-node-role\"},\"Action\":\"sts:AssumeRole\"}",
              "isCorrect": false,
              "explanation": "Trusting the node role lets every pod on that node assume this role, eliminating per-pod isolation."
            },
            {
              "id": "c1",
              "text": "{\"Effect\":\"Allow\",\"Principal\":{\"Federated\":\"arn:aws:iam::123456789012:oidc-provider/oidc.eks.us-east-1.amazonaws.com/id/EXAMPLED539D4633E53DE1B71EXAMPLE\"},\"Action\":\"sts:AssumeRoleWithWebIdentity\",\"Condition\":{\"StringEquals\":{\"oidc.eks.us-east-1.amazonaws.com/id/EXAMPLED539D4633E53DE1B71EXAMPLE:sub\":\"system:serviceaccount:app-ns:app-sa\"}}}",
              "isCorrect": true,
              "explanation": "This uses the EKS OIDC provider as a Federated principal with AssumeRoleWithWebIdentity, and the Condition restricts the sub claim to the exact namespace:serviceaccount pair."
            },
            {
              "id": "c2",
              "text": "{\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"eks.amazonaws.com\"},\"Action\":\"sts:AssumeRole\"}",
              "isCorrect": false,
              "explanation": "This trusts the EKS service itself (the control plane), not individual pod identities. Any EKS-managed component could assume this role, not just the intended pod."
            }
          ],
          "selectCount": 1,
          "format": "json",
          "domain": "Identity and Access Management",
          "services": [
            "IAM",
            "STS",
            "Cognito",
            "EKS"
          ],
          "docs": "https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_providers_oidc.html",
          "tip": "EKS IRSA (IAM Roles for Service Accounts) uses the cluster's OIDC provider URL as a federated principal and filters by the sub claim.",
          "explanation": "IRSA projects a signed OIDC token into each pod, and the trust policy uses the cluster OIDC provider as a Federated principal with a Condition on the sub claim (namespace:serviceaccount). This ensures only the precise service account in the correct namespace can assume the role."
        },
        {
          "id": "SCS-C03-0008",
          "question": "A security team wants to use AWS Config to detect S3 buckets that have public read access. Which CloudFormation resource snippet correctly defines this managed Config rule?",
          "choices": [
            {
              "id": "c4",
              "text": "Enable S3 Block Public Access at the account level - this replaces the need for Config rules",
              "isCorrect": false,
              "explanation": "Block Public Access is preventive - it does not detect existing violations like a Config rule does."
            },
            {
              "id": "c1",
              "text": "Type: AWS::Config::ConfigRule\nProperties:\n  ConfigRuleName: s3-bucket-public-read-prohibited\n  Source:\n    Owner: AWS\n    SourceIdentifier: S3_BUCKET_PUBLIC_READ_PROHIBITED",
              "isCorrect": true,
              "explanation": "AWS managed Config rule using Owner: AWS and the standard S3 public read detection identifier."
            },
            {
              "id": "c3",
              "text": "Use AWS CloudTrail to monitor S3:GetBucketPolicy API calls and alert when public access is detected",
              "isCorrect": false,
              "explanation": "CloudTrail monitors API calls but does not provide continuous compliance evaluation like AWS Config."
            },
            {
              "id": "c2",
              "text": "Type: AWS::Config::ConfigRule\nProperties:\n  ConfigRuleName: s3-bucket-public-read-prohibited\n  Source:\n    Owner: CUSTOM\n    SourceIdentifier: S3_BUCKET_PUBLIC_READ_PROHIBITED",
              "isCorrect": false,
              "explanation": "Owner: CUSTOM is for custom rules backed by Lambda functions, not AWS managed rules."
            }
          ],
          "selectCount": 1,
          "format": "yaml",
          "domain": "Detection",
          "services": [
            "Config",
            "CloudFormation",
            "S3"
          ],
          "docs": "https://docs.aws.amazon.com/config/latest/developerguide/WhatIsConfig.html",
          "tip": "AWS Config managed rules use Owner: AWS with a predefined SourceIdentifier.",
          "explanation": "AWS Config managed rules are pre-built by AWS and referenced with Owner: AWS plus a SourceIdentifier like S3_BUCKET_PUBLIC_READ_PROHIBITED."
        },
        {
          "id": "SCS-C03-0028",
          "question": "A data engineering team needs their Lambda function to decrypt objects in an S3 bucket that uses SSE-KMS with a customer-managed key. The function's execution role has s3:GetObject permission. Decryption attempts fail with AccessDeniedException from KMS. Which key policy statement, added to the CMK, resolves this?",
          "choices": [
            {
              "id": "c1",
              "text": "{\"Sid\":\"AllowLambdaDecrypt\",\"Effect\":\"Allow\",\"Principal\":{\"AWS\":\"arn:aws:iam::123456789012:role/lambda-exec-role\"},\"Action\":[\"kms:Decrypt\",\"kms:DescribeKey\"],\"Resource\":\"*\"}",
              "isCorrect": true,
              "explanation": "The Lambda execution role needs kms:Decrypt (to decrypt the data key protecting the S3 object) and kms:DescribeKey (to validate the key). The key policy must explicitly grant these actions to the role's ARN."
            },
            {
              "id": "c3",
              "text": "Add kms:Decrypt to the Lambda execution role's IAM policy without changing the key policy",
              "isCorrect": false,
              "explanation": "For customer-managed KMS keys, both the key policy AND the IAM policy must allow the action. If the key policy does not grant access to the principal, the IAM policy alone is insufficient."
            },
            {
              "id": "c4",
              "text": "Change the bucket encryption from SSE-KMS to SSE-S3 to avoid the KMS dependency",
              "isCorrect": false,
              "explanation": "Switching to SSE-S3 would eliminate the error, but it removes the ability to control access through KMS key policies, audit key usage via CloudTrail, and use customer-managed key rotation, which may be required by policy."
            },
            {
              "id": "c2",
              "text": "{\"Sid\":\"AllowLambdaDecrypt\",\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"lambda.amazonaws.com\"},\"Action\":[\"kms:Decrypt\"],\"Resource\":\"*\"}",
              "isCorrect": false,
              "explanation": "KMS key policies should grant permissions to the IAM role, not to the Lambda service principal. The service principal is used in trust policies, not key policies."
            }
          ],
          "selectCount": 1,
          "format": "json",
          "domain": "Data Protection",
          "services": [
            "KMS",
            "IAM",
            "S3",
            "Lambda"
          ],
          "docs": "https://docs.aws.amazon.com/kms/latest/developerguide/key-policy-modifying.html",
          "tip": "With customer-managed KMS keys, access requires permission in both the key policy and the caller's IAM policy. The key policy is the primary gatekeeper.",
          "explanation": "Customer-managed KMS keys use a resource-based policy (key policy) that must explicitly allow principals to perform cryptographic operations. Unlike AWS-managed keys, there is no automatic cross-grant. Both the key policy and the IAM policy on the caller must allow the action for it to succeed."
        },
        {
          "id": "SCS-C03-0004",
          "question": "Which feature helps enforce least privilege by providing temporary credentials?",
          "choices": [
            {
              "id": "c2",
              "text": "IAM Users with long-term access keys",
              "isCorrect": false,
              "explanation": "IAM Users with long-term keys are not recommended for least-privilege patterns."
            },
            {
              "id": "c1",
              "text": "IAM Roles with STS",
              "isCorrect": true,
              "explanation": "IAM Roles with STS allow issuance of temporary credentials for short-term access."
            },
            {
              "id": "c4",
              "text": "Amazon Cognito",
              "isCorrect": false,
              "explanation": "Amazon Cognito provides user identity for apps, but the core mechanism for temporary AWS credentials is STS with roles."
            },
            {
              "id": "c3",
              "text": "Security Groups",
              "isCorrect": false,
              "explanation": "Security Groups are network controls, not credential mechanisms."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Identity and Access Management",
          "services": [
            "IAM",
            "STS",
            "Cognito"
          ],
          "docs": "https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles.html",
          "tip": "Temporary credentials reduce the risk from long-lived keys.",
          "explanation": "IAM Roles combined with AWS STS issue temporary credentials that automatically expire, reducing blast radius if leaked."
        },
        {
          "id": "SCS-C03-0023",
          "question": "A web application team needs to ensure that TLS certificates on their internet-facing ALBs are renewed automatically without any manual intervention or downtime. Certificates must support multiple subdomain names (e.g., api.example.com, app.example.com). Which approach meets these requirements?",
          "choices": [
            {
              "id": "c1",
              "text": "Request a public ACM certificate with Subject Alternative Names (SANs) for each subdomain using DNS validation, and associate it with the ALB",
              "isCorrect": true,
              "explanation": "ACM public certificates with DNS validation renew automatically as long as the CNAME validation records remain in place. SANs allow multiple subdomains on a single certificate, and ALB natively integrates with ACM for zero-downtime deployment."
            },
            {
              "id": "c2",
              "text": "Purchase a wildcard certificate from a third-party CA, import it into ACM, and set a calendar reminder to renew it annually",
              "isCorrect": false,
              "explanation": "Imported certificates in ACM are not automatically renewed. Manual renewal and re-import is required, which introduces risk of expiration and human error."
            },
            {
              "id": "c4",
              "text": "Generate a self-signed certificate for each subdomain and configure the ALB to present them using SNI",
              "isCorrect": false,
              "explanation": "Self-signed certificates are not trusted by browsers and will produce security warnings. They also require manual rotation, defeating the automation requirement."
            },
            {
              "id": "c3",
              "text": "Use Let's Encrypt with certbot running on the ALB instances to obtain and renew certificates",
              "isCorrect": false,
              "explanation": "ALBs are managed services; you cannot run certbot or any agent on them. Let's Encrypt certificates must be imported into ACM, losing automatic renewal."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Data Protection",
          "services": [
            "ACM",
            "CloudFront",
            "ALB",
            "Route 53"
          ],
          "docs": "https://docs.aws.amazon.com/acm/latest/userguide/acm-overview.html",
          "tip": "ACM's automatic renewal only works for certificates it issues (not imported ones), and DNS validation is the set-and-forget option.",
          "explanation": "AWS Certificate Manager issues free public certificates that renew automatically when DNS validation is used. By adding SANs for each subdomain, a single certificate covers multiple endpoints. ACM's native integration with ALB means certificate deployment and rotation happen transparently."
        },
        {
          "id": "SCS-C03-0002",
          "question": "During an incident, which service lets you run investigative notebooks and analyze data?",
          "choices": [
            {
              "id": "c1",
              "text": "AWS Systems Manager",
              "isCorrect": false,
              "explanation": "Systems Manager helps manage instances but is not focused on security investigation notebooks."
            },
            {
              "id": "c4",
              "text": "AWS CloudTrail",
              "isCorrect": false,
              "explanation": "CloudTrail records API activity and is useful for forensics, but Detective provides investigative workflows."
            },
            {
              "id": "c3",
              "text": "AWS Shield",
              "isCorrect": false,
              "explanation": "AWS Shield provides DDoS protections, not forensic investigation tools."
            },
            {
              "id": "c2",
              "text": "Amazon Detective",
              "isCorrect": true,
              "explanation": "Amazon Detective is designed to analyze, visualize, and conduct investigations into potential security issues."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Incident Response",
          "services": [
            "Detective",
            "Systems Manager",
            "Shield",
            "CloudTrail"
          ],
          "docs": "https://docs.aws.amazon.com/detective/latest/adminguide/what-is.html",
          "tip": "This service helps visualize and investigate security issues by linking related findings and activity.",
          "explanation": "Amazon Detective automatically collects log data from VPC Flow Logs, CloudTrail, and GuardDuty, then builds a graph model that links related events so analysts can visually trace activity."
        },
        {
          "id": "SCS-C03-0011",
          "question": "A compliance requirement mandates that all CloudWatch Logs log groups must be encrypted at rest with a customer-managed KMS key and that the key policy must allow the CloudWatch Logs service principal to use it. Which combination of steps achieves this?",
          "choices": [
            {
              "id": "c3",
              "text": "Enable CloudTrail log file encryption with a KMS key and configure CloudWatch Logs as a CloudTrail destination",
              "isCorrect": false,
              "explanation": "CloudTrail encryption covers CloudTrail's own log files delivered to S3, not arbitrary CloudWatch Logs log groups."
            },
            {
              "id": "c2",
              "text": "Enable SSE-S3 default encryption on the S3 bucket where CloudWatch Logs exports data and reference that bucket in each log group's settings",
              "isCorrect": false,
              "explanation": "S3 encryption applies only to exported log data in S3, not to log data stored within the CloudWatch Logs service itself."
            },
            {
              "id": "c1",
              "text": "Create a customer-managed KMS key with a key policy granting logs.<region>.amazonaws.com the kms:Encrypt, kms:Decrypt, kms:GenerateDataKey, and kms:DescribeKey actions, then associate the key with each log group",
              "isCorrect": true,
              "explanation": "CloudWatch Logs requires these four KMS actions in the key policy for the regional service principal to encrypt and decrypt log data."
            },
            {
              "id": "c4",
              "text": "Create an AWS-managed KMS key (alias aws/logs) and it will automatically encrypt all new log groups without any key policy changes",
              "isCorrect": false,
              "explanation": "CloudWatch Logs does not have an AWS-managed key. You must create and configure a customer-managed key explicitly."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Data Protection",
          "services": [
            "CloudWatch Logs",
            "KMS",
            "S3",
            "CloudTrail"
          ],
          "docs": "https://docs.aws.amazon.com/AmazonCloudWatch/latest/logs/encrypt-log-data-kms.html",
          "tip": "CloudWatch Logs encryption requires a customer-managed CMK - there is no AWS-managed key option for this service.",
          "explanation": "CloudWatch Logs supports encryption at rest only with customer-managed KMS keys. You must explicitly grant the regional service principal permission to use the key."
        },
        {
          "id": "SCS-C03-0019",
          "question": "A financial services firm must store audit logs for seven years in a manner that no user, including root, can delete or modify them before the retention period expires. Regulators require proof of immutability. Which S3 feature satisfies these requirements?",
          "choices": [
            {
              "id": "c2",
              "text": "S3 Object Lock in Governance mode with a seven-year retention period",
              "isCorrect": false,
              "explanation": "Governance mode allows users with the s3:BypassGovernanceRetention permission to delete objects before the retention period ends, which does not meet the absolute immutability requirement."
            },
            {
              "id": "c1",
              "text": "S3 Object Lock in Compliance mode with a seven-year retention period",
              "isCorrect": true,
              "explanation": "Compliance mode prevents anyone, including the root user, from deleting or overwriting an object version until the retention date passes. This satisfies regulatory immutability requirements."
            },
            {
              "id": "c3",
              "text": "S3 Versioning with an S3 Lifecycle rule to transition objects to Glacier after 30 days",
              "isCorrect": false,
              "explanation": "Versioning preserves prior versions but does not prevent deletion of version markers. Glacier transition reduces cost but does not enforce immutability."
            },
            {
              "id": "c4",
              "text": "Enable MFA Delete on the S3 bucket to require MFA for all delete operations",
              "isCorrect": false,
              "explanation": "MFA Delete requires an additional authentication step but does not make objects truly immutable. A user with MFA can still delete them at any time."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Data Protection",
          "services": [
            "S3",
            "S3 Object Lock",
            "Glacier",
            "Backup"
          ],
          "docs": "https://docs.aws.amazon.com/AmazonS3/latest/userguide/object-lock.html",
          "tip": "Compliance mode is the only S3 mechanism where even the root account cannot shorten or remove the retention lock.",
          "explanation": "S3 Object Lock Compliance mode creates a WORM (Write Once Read Many) storage model. Once set, neither the object nor its retention settings can be altered or deleted by any principal until the retention period expires, meeting SEC 17a-4(f) and similar regulatory requirements."
        },
        {
          "id": "SCS-C03-0036",
          "question": "A security platform team must deploy a hardened VPC, a set of IAM permission boundaries, and logging configuration to 15 existing AWS accounts. Changes must be automated via CI/CD, deployments must be auditable, and any account drift should be detectable centrally. The team also wants least-privilege for the agents that perform deployments. Which approach best satisfies these requirements?",
          "choices": [
            {
              "id": "c3",
              "text": "Use Terraform workspaces stored locally per account and have individual engineers apply changes when notified",
              "isCorrect": false,
              "explanation": "Local, manual Terraform applies lack centralized automation, auditability, and organization-level drift detection; they also increase risk of inconsistent state."
            },
            {
              "id": "c1",
              "text": "Create a parameterized CloudFormation module for the baseline, publish it to a central artifact repository, and deploy via CloudFormation StackSets (service-managed) from a CI/CD pipeline using delegated administrator roles; enable drift detection and record pipeline runs for auditability",
              "isCorrect": true,
              "explanation": "StackSets (service-managed) supports automated, organization-aware deployments driven by CI/CD, delegated admin roles provide least-privilege, and enabling drift detection plus CI/CD run logs provides centralized detection and an audit trail."
            },
            {
              "id": "c4",
              "text": "Utilise AWS Control Tower guardrails to keep accounts compliant and make manual adjustments via the console for exceptions",
              "isCorrect": false,
              "explanation": "Control Tower provides guardrails and a landing zone but is not a full CI/CD-driven IaC deployment and does not replace an auditable, parameterized IaC pipeline for existing accounts at scale."
            },
            {
              "id": "c2",
              "text": "Let each account run CloudFormation stacks triggered manually by account owners, and collect logs centrally afterwards",
              "isCorrect": false,
              "explanation": "Manual, per-account deployments are not automated or easily auditable and do not provide centralized drift detection or consistent configuration."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Security Foundations and Governance",
          "services": [
            "CloudFormation",
            "StackSets",
            "CI/CD",
            "Organizations"
          ],
          "docs": "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/what-is-cfn.html",
          "tip": "Prefer org-aware IaC patterns that integrate with CI/CD, use delegated roles, and enable drift detection for centralized management.",
          "explanation": "For consistent, auditable, and automated deployments across multiple accounts, an org-aware IaC pattern like CloudFormation StackSets driven by a CI/CD pipeline provides parameterized modules, centralized rollout, delegated administration for least-privilege, and drift detection to identify configuration divergence. This pattern satisfies automation, auditability, and centralized management requirements."
        },
        {
          "id": "SCS-C03-0013",
          "question": "An organisation wants to automatically isolate an EC2 instance when GuardDuty detects cryptocurrency mining activity. Which architecture achieves automated remediation with the least operational overhead?",
          "choices": [
            {
              "id": "c2",
              "text": "Enable Security Hub automated response playbooks to quarantine instances",
              "isCorrect": false,
              "explanation": "Security Hub aggregates findings but does not have built-in quarantine playbooks."
            },
            {
              "id": "c4",
              "text": "Use Systems Manager Automation runbooks triggered by a CPU alarm to stop instances",
              "isCorrect": false,
              "explanation": "CPU alarms are generic and can cause false positives."
            },
            {
              "id": "c3",
              "text": "Schedule a Lambda to poll GuardDuty every five minutes and isolate flagged instances",
              "isCorrect": false,
              "explanation": "Polling introduces delay and extra maintenance."
            },
            {
              "id": "c1",
              "text": "Configure GuardDuty findings to flow into EventBridge and trigger a Lambda that isolates the instance",
              "isCorrect": true,
              "explanation": "EventBridge rules can filter GuardDuty finding types and invoke Lambda for automated remediation."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Incident Response",
          "services": [
            "GuardDuty",
            "Security Hub",
            "EventBridge",
            "Lambda",
            "Systems Manager"
          ],
          "docs": "https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_finding-types-ec2.html",
          "tip": "The key is event-driven, near-real-time response with minimal ongoing maintenance.",
          "explanation": "GuardDuty publishes findings to EventBridge in near-real-time, enabling immediate Lambda-driven remediation."
        },
        {
          "id": "SCS-C03-0030",
          "question": "A disaster recovery plan requires that all objects in a production S3 bucket encrypted with a customer-managed KMS key be replicated to a bucket in a different region using a different KMS key. Which TWO configurations are required for cross-region replication to work with KMS-encrypted objects? (Select TWO)",
          "choices": [
            {
              "id": "c2",
              "text": "Grant the S3 replication role kms:Decrypt permission on the source key and kms:Encrypt permission on the destination key",
              "isCorrect": true,
              "explanation": "The replication role must decrypt the objects using the source CMK and then encrypt them with the destination CMK. Without both permissions, replication fails with AccessDenied."
            },
            {
              "id": "c1",
              "text": "Specify the destination KMS key ARN in the replication rule configuration",
              "isCorrect": true,
              "explanation": "When replicating KMS-encrypted objects, the replication configuration must specify the destination KMS key so S3 can re-encrypt the objects in the destination region."
            },
            {
              "id": "c3",
              "text": "Use the same KMS key in both the source and destination regions",
              "isCorrect": false,
              "explanation": "KMS keys are regional. A key in us-east-1 cannot be used in eu-west-1. Multi-Region KMS keys exist but are not required; specifying the destination key in the replication rule is sufficient."
            },
            {
              "id": "c4",
              "text": "Enable S3 Transfer Acceleration on both buckets to speed up cross-region replication",
              "isCorrect": false,
              "explanation": "Transfer Acceleration optimizes direct uploads via CloudFront edge locations. It is not related to S3 replication, which uses its own internal transfer mechanism."
            },
            {
              "id": "c5",
              "text": "Disable KMS encryption on the destination bucket and use SSE-S3 instead",
              "isCorrect": false,
              "explanation": "Switching to SSE-S3 would avoid KMS complexity but loses the benefits of customer-managed key control, audit via CloudTrail, and compliance requirements that may mandate CMK usage."
            }
          ],
          "selectCount": 2,
          "format": "text",
          "domain": "Data Protection",
          "services": [
            "S3",
            "KMS",
            "IAM",
            "Organizations"
          ],
          "docs": "https://docs.aws.amazon.com/AmazonS3/latest/userguide/replication-walkthrough-2.html",
          "tip": "Cross-region KMS replication requires both a destination key specification and the right permissions for the replication role on both the source and destination keys.",
          "explanation": "S3 replication with SSE-KMS objects requires two key configurations: the replication rule must specify the destination KMS key ARN (since KMS keys are regional), and the replication IAM role must have kms:Decrypt on the source key plus kms:Encrypt and kms:GenerateDataKey on the destination key."
        },
        {
          "id": "SCS-C03-0024",
          "question": "A security architect wants to continuously detect any S3 buckets, IAM roles, KMS keys, or Lambda functions that are shared with external AWS accounts or public access. The solution must generate findings automatically without requiring custom code. Which service should they enable?",
          "choices": [
            {
              "id": "c4",
              "text": "Amazon GuardDuty",
              "isCorrect": false,
              "explanation": "GuardDuty detects threats based on anomalous behaviour and threat intelligence. It does not analyze resource policies to find intentional cross-account sharing or public access grants."
            },
            {
              "id": "c2",
              "text": "AWS Config with the s3-bucket-public-read-prohibited managed rule",
              "isCorrect": false,
              "explanation": "This Config rule only checks S3 public read access. It does not cover cross-account sharing of IAM roles, KMS keys, or Lambda functions."
            },
            {
              "id": "c1",
              "text": "IAM Access Analyzer",
              "isCorrect": true,
              "explanation": "Access Analyzer uses automated reasoning to analyze resource-based policies and identifies resources that are accessible from outside the zone of trust (account or organisation), generating findings for each."
            },
            {
              "id": "c3",
              "text": "AWS Trusted Advisor security checks",
              "isCorrect": false,
              "explanation": "Trusted Advisor checks a limited set of security best practices (e.g., open security groups, root MFA) but does not perform policy-level analysis of cross-account resource sharing."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Identity and Access Management",
          "services": [
            "IAM Access Analyzer",
            "IAM",
            "S3",
            "Lambda",
            "KMS"
          ],
          "docs": "https://docs.aws.amazon.com/IAM/latest/UserGuide/access-analyzer-getting-started.html",
          "tip": "This service uses automated reasoning (formal logic) over policies, not anomaly detection or predefined compliance rules.",
          "explanation": "IAM Access Analyzer applies Zelkova-based automated reasoning to evaluate resource-based policies on S3 buckets, SQS queues, IAM roles, KMS keys, Lambda functions, and Secrets Manager secrets. It produces actionable findings whenever a policy grants access outside the defined zone of trust, with no custom code required."
        },
        {
          "id": "SCS-C03-0034",
          "question": "A media company serves video content from S3 through CloudFront. They need to ensure users cannot bypass CloudFront and access S3 directly via the bucket URL. The solution must work with SSE-KMS encrypted objects. Which approach correctly restricts S3 access to CloudFront only?",
          "choices": [
            {
              "id": "c3",
              "text": "Make the S3 bucket a website endpoint origin in CloudFront and restrict access with a Referer header condition in the bucket policy",
              "isCorrect": false,
              "explanation": "Website endpoint origins use HTTP (not the S3 API), don't support SSE-KMS, and Referer headers can be spoofed, making this both incompatible and insecure."
            },
            {
              "id": "c1",
              "text": "Create a CloudFront Origin Access Control (OAC) and update the S3 bucket policy to allow access only from the OAC",
              "isCorrect": true,
              "explanation": "OAC is the recommended method for restricting S3 access to CloudFront. Unlike the legacy OAI, OAC supports SSE-KMS, S3 Object Lock, and all S3 features. The bucket policy uses aws:SourceArn to allow only the specific CloudFront distribution."
            },
            {
              "id": "c2",
              "text": "Create a CloudFront Origin Access Identity (OAI) and grant it read access in the S3 bucket policy",
              "isCorrect": false,
              "explanation": "OAI is the legacy approach and does not support SSE-KMS encrypted objects. CloudFront cannot forward the required SigV4 KMS headers when using OAI."
            },
            {
              "id": "c4",
              "text": "Block public access on the bucket and share S3 pre-signed URLs directly with users instead of using CloudFront",
              "isCorrect": false,
              "explanation": "Pre-signed URLs bypass CloudFront entirely, losing edge caching, WAF protection, and geo-restriction capabilities. They also expose direct S3 access."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Infrastructure Security",
          "services": [
            "CloudFront",
            "S3",
            "OAC",
            "WAF"
          ],
          "docs": "https://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/private-content-restricting-access-to-s3.html",
          "tip": "OAC replaced OAI and is required for SSE-KMS, S3 Object Lock, and other modern S3 features.",
          "explanation": "Origin Access Control (OAC) uses SigV4-signed requests from CloudFront to S3, which supports all S3 encryption modes including SSE-KMS. The S3 bucket policy can use the Condition key aws:SourceArn to restrict access to a specific CloudFront distribution ARN, ensuring no direct S3 access is possible."
        },
        {
          "id": "SCS-C03-0020",
          "question": "After enabling GuardDuty S3 Protection, a security analyst notices a finding of type Policy:S3/BucketAnonymousAccessGranted for a production data bucket. The analyst needs to determine which principal changed the bucket policy and when. Which data source provides this information?",
          "choices": [
            {
              "id": "c4",
              "text": "VPC Flow Logs for the VPC where the analyst is working",
              "isCorrect": false,
              "explanation": "VPC Flow Logs capture network-layer metadata (IP, port, protocol) but not API-level details like which principal called PutBucketPolicy."
            },
            {
              "id": "c1",
              "text": "CloudTrail management events showing the PutBucketPolicy API call",
              "isCorrect": true,
              "explanation": "CloudTrail records the identity (principal), timestamp, source IP, and request parameters for S3 control-plane API calls like PutBucketPolicy. This is the authoritative source for who changed the policy and when."
            },
            {
              "id": "c3",
              "text": "S3 server access logs for the data bucket",
              "isCorrect": false,
              "explanation": "S3 server access logs capture object-level read/write requests, not bucket policy changes. Control-plane actions like PutBucketPolicy are not recorded in access logs."
            },
            {
              "id": "c2",
              "text": "The GuardDuty finding detail itself, which includes the actor and timestamp",
              "isCorrect": false,
              "explanation": "GuardDuty findings identify the affected resource and the anomaly but do not always include the full details of who made the original policy change. CloudTrail provides the definitive audit trail."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Detection",
          "services": [
            "GuardDuty",
            "CloudTrail",
            "S3",
            "Security Hub"
          ],
          "docs": "https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_s3-protection.html",
          "tip": "Distinguish between data-plane logs (S3 access logs, VPC Flow Logs) and control-plane logs (CloudTrail) when investigating policy changes.",
          "explanation": "CloudTrail management events are the single source of truth for AWS API activity. When investigating who changed a resource configuration, always start with CloudTrail, which records the IAM principal, the API action, the request parameters, and the exact timestamp."
        },
        {
          "id": "SCS-C03-0029",
          "question": "An organisation with 300 member accounts needs to enable GuardDuty in every account and every region, automatically including future accounts. All findings must be viewable from the security account. Which approach achieves this with the least ongoing maintenance?",
          "choices": [
            {
              "id": "c4",
              "text": "Enable Security Hub in the security account and it will automatically enable GuardDuty across all member accounts",
              "isCorrect": false,
              "explanation": "Security Hub aggregates findings from GuardDuty but does not enable or manage GuardDuty. They are independent services with separate enablement processes."
            },
            {
              "id": "c1",
              "text": "Designate a delegated administrator account for GuardDuty through AWS Organizations and enable the auto-enable feature for new member accounts",
              "isCorrect": true,
              "explanation": "The delegated administrator model in GuardDuty with auto-enable automatically activates GuardDuty in all current and future member accounts. Findings from all accounts are aggregated in the administrator account."
            },
            {
              "id": "c3",
              "text": "Deploy GuardDuty via a CloudFormation StackSet targeting all accounts and regions",
              "isCorrect": false,
              "explanation": "StackSets can enable GuardDuty but do not establish the administrator-member relationship needed to aggregate findings centrally, and they require additional work for auto-enabling in new accounts."
            },
            {
              "id": "c2",
              "text": "Send manual invitation requests from the security account to each of the 300 member accounts and accept them individually",
              "isCorrect": false,
              "explanation": "Manual invitations work but require per-account acceptance, do not auto-enrol future accounts, and become unmanageable at scale."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Detection",
          "services": [
            "GuardDuty",
            "Organizations",
            "Security Hub",
            "S3"
          ],
          "docs": "https://docs.aws.amazon.com/guardduty/latest/ug/what-is-guardduty.html",
          "tip": "The Organizations integration with delegated administrator and auto-enable is the hands-off, scalable approach for GuardDuty at organisation scale.",
          "explanation": "GuardDuty's Organizations integration allows a delegated administrator to manage GuardDuty across all member accounts centrally. The auto-enable feature ensures new accounts are automatically enrolled without manual intervention, and all findings flow to the administrator account for consolidated monitoring."
        },
        {
          "id": "SCS-C03-0012",
          "question": "A platform team wants to allow developers to create their own IAM roles for Lambda functions, but ensure those roles can never have permissions beyond what the platform team defines. Which mechanism should they use?",
          "choices": [
            {
              "id": "c1",
              "text": "Require developers to attach a permissions boundary to every role they create",
              "isCorrect": true,
              "explanation": "Permissions boundaries cap the maximum permissions a role can have, even if the role's identity policy grants broader access."
            },
            {
              "id": "c4",
              "text": "Use an SCP to deny iam:CreateRole for all developers and have the platform team create roles on request",
              "isCorrect": false,
              "explanation": "This removes developer self-service entirely, creating operational bottlenecks without enabling delegation."
            },
            {
              "id": "c2",
              "text": "Grant developers iam:CreateRole but restrict the role's trust policy to lambda.amazonaws.com only",
              "isCorrect": false,
              "explanation": "Restricting the trust policy limits who can assume the role, but does not limit what permissions the role itself can have."
            },
            {
              "id": "c3",
              "text": "Create a single shared Lambda execution role managed by the platform team",
              "isCorrect": false,
              "explanation": "A shared role works but violates least privilege because all functions share the same permissions regardless of their needs."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Identity and Access Management",
          "services": [
            "IAM",
            "Organizations",
            "STS"
          ],
          "docs": "https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies_boundaries.html",
          "tip": "You need a mechanism that caps maximum permissions while still allowing developers to create and manage their own roles.",
          "explanation": "IAM permissions boundaries act as a ceiling on the effective permissions of a role or user."
        },
        {
          "id": "SCS-C03-0016",
          "question": "A development team stores database credentials in environment variables baked into their container images. The security team requires that credentials be rotated every 30 days without redeploying containers and that all credential access be auditable. Which approach best meets these requirements?",
          "choices": [
            {
              "id": "c2",
              "text": "Store credentials in SSM Parameter Store SecureString parameters and write a cron job to update them monthly",
              "isCorrect": false,
              "explanation": "Parameter Store SecureStrings can hold secrets but lack built-in automatic rotation. A cron job is fragile and requires custom coordination with both the parameter and the database."
            },
            {
              "id": "c3",
              "text": "Encrypt the environment variables at build time with a KMS key and decrypt them at container start",
              "isCorrect": false,
              "explanation": "This protects secrets at rest in the image, but rotating requires rebuilding and redeploying the container, which violates the no-redeploy requirement."
            },
            {
              "id": "c4",
              "text": "Use IAM database authentication to eliminate passwords entirely",
              "isCorrect": false,
              "explanation": "IAM database authentication works only with supported engines (Aurora MySQL/PostgreSQL, RDS MySQL/PostgreSQL) and may not cover all the team's databases. It also does not address other types of credentials."
            },
            {
              "id": "c1",
              "text": "Store credentials in AWS Secrets Manager with automatic rotation enabled and retrieve them at runtime using the Secrets Manager SDK",
              "isCorrect": true,
              "explanation": "Secrets Manager supports automatic rotation via Lambda, provides versioned secrets so applications always fetch the current value at runtime, and logs all access through CloudTrail."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Data Protection",
          "services": [
            "Secrets Manager",
            "Parameter Store",
            "KMS",
            "Lambda"
          ],
          "docs": "https://docs.aws.amazon.com/secretsmanager/latest/userguide/intro.html",
          "tip": "Automatic rotation without redeployment means the application must fetch secrets dynamically, not rely on values injected at build or deploy time.",
          "explanation": "Secrets Manager is purpose-built for credential lifecycle management. Its rotation feature invokes a Lambda function on a schedule to update both the secret value and the target resource (e.g., RDS password), while applications retrieve the current secret at runtime, eliminating the need for redeployment."
        },
        {
          "id": "SCS-C03-0001",
          "question": "Which AWS service helps aggregate and analyze security findings across accounts?",
          "choices": [
            {
              "id": "c4",
              "text": "Amazon SNS",
              "isCorrect": false,
              "explanation": "Amazon SNS is a notification service, not a security findings aggregator."
            },
            {
              "id": "c3",
              "text": "AWS WAF",
              "isCorrect": false,
              "explanation": "AWS WAF is a web application firewall focused on HTTP(S) protections."
            },
            {
              "id": "c1",
              "text": "Amazon GuardDuty",
              "isCorrect": true,
              "explanation": "GuardDuty is a threat detection service that continuously monitors for malicious activity and unauthorized behavior."
            },
            {
              "id": "c2",
              "text": "AWS Config",
              "isCorrect": false,
              "explanation": "AWS Config tracks resource configuration and compliance, not threat detection."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Detection",
          "services": [
            "GuardDuty",
            "Config",
            "WAF",
            "SNS"
          ],
          "docs": "https://docs.aws.amazon.com/guardduty/latest/ug/what-is-guardduty.html",
          "tip": "Think of a service that detects threats across your account using machine learning and threat intelligence.",
          "explanation": "Amazon GuardDuty uses ML models and threat intelligence feeds to continuously detect threats across accounts. The closest wrong answer is AWS Config, which evaluates resource configuration compliance, whereas GuardDuty detects active threats."
        },
        {
          "id": "SCS-C03-0007",
          "question": "A security engineer needs to restrict an IAM role so it can only access a specific S3 bucket from a particular VPC endpoint. Which resource should be added?",
          "choices": [
            {
              "id": "c3",
              "text": "Add the VPC endpoint ID to the IAM role's trust policy as a Principal",
              "isCorrect": false,
              "explanation": "VPC endpoints are not IAM principals and cannot appear in a trust policy's Principal element."
            },
            {
              "id": "c2",
              "text": "{\"Condition\": {\"IpAddress\": {\"aws:SourceIp\": \"10.0.0.0/16\"}}}",
              "isCorrect": false,
              "explanation": "IpAddress/SourceIp restricts by IP range, not by VPC endpoint identity."
            },
            {
              "id": "c4",
              "text": "Attach a security group to the IAM role that only allows traffic from the VPC",
              "isCorrect": false,
              "explanation": "Security groups are network-level controls for ENIs - they cannot be attached to IAM roles."
            },
            {
              "id": "c1",
              "text": "{\"Condition\": {\"StringEquals\": {\"aws:sourceVpce\": \"vpce-certshack123\"}}}",
              "isCorrect": true,
              "explanation": "aws:sourceVpce condition restricts the policy to requests through the specified VPC endpoint."
            }
          ],
          "selectCount": 1,
          "format": "json",
          "domain": "Identity and Access Management",
          "services": [
            "IAM",
            "S3"
          ],
          "docs": "https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies.html",
          "tip": "VPC endpoint restrictions in IAM use the aws:sourceVpce condition key with StringEquals.",
          "explanation": "The aws:sourceVpce condition key with StringEquals restricts access to requests that traverse a specific VPC endpoint."
        },
        {
          "id": "SCS-C03-0031",
          "question": "During an incident investigation, an analyst has shell access to a compromised EC2 instance and needs to determine which IAM identity the instance is currently using to make AWS API calls. Which CLI command reveals this information?",
          "choices": [
            {
              "id": "c4",
              "text": "curl http://169.254.169.254/latest/meta-data/iam/security-credentials/",
              "isCorrect": false,
              "explanation": "This metadata endpoint lists the instance profile role name and can retrieve temporary credentials, but it does not show the full ARN or account ID. It also does not detect if the instance is using a different assumed role via manual STS calls."
            },
            {
              "id": "c3",
              "text": "aws ec2 describe-instances --instance-id $(curl -s http://169.254.169.254/latest/meta-data/instance-id)",
              "isCorrect": false,
              "explanation": "describe-instances shows instance metadata including the IamInstanceProfile association, but the response contains the profile ARN, not the currently assumed role ARN with session details. get-caller-identity is more direct."
            },
            {
              "id": "c2",
              "text": "aws iam get-user",
              "isCorrect": false,
              "explanation": "get-user returns information about an IAM user. On an instance using a role (not a user), this command fails because the caller is not an IAM user."
            },
            {
              "id": "c1",
              "text": "aws sts get-caller-identity",
              "isCorrect": true,
              "explanation": "This command returns the UserId, Account, and ARN of the IAM identity (user, role, or federated identity) making the request. On an EC2 instance, it reveals the instance profile role."
            }
          ],
          "selectCount": 1,
          "format": "cli",
          "domain": "Incident Response",
          "services": [
            "STS",
            "IAM",
            "CloudShell"
          ],
          "docs": "https://docs.aws.amazon.com/cli/latest/reference/sts/get-caller-identity.html",
          "tip": "This STS command works universally regardless of whether the caller is a user, role, federated identity, or instance profile.",
          "explanation": "aws sts get-caller-identity is the quickest and most reliable way to determine the current AWS identity context. It works for all principal types and returns the ARN that appears in CloudTrail logs, making it invaluable during investigations."
        },
        {
          "id": "SCS-C03-0027",
          "question": "A security team has an AWS Config rule that detects S3 buckets without default encryption enabled. They want Config to automatically remediate non-compliant buckets by applying AES-256 server-side encryption. Which CloudFormation snippet correctly defines the auto-remediation action?",
          "choices": [
            {
              "id": "c4",
              "text": "Use an EventBridge rule to detect Config compliance change events and invoke a Step Functions workflow",
              "isCorrect": false,
              "explanation": "While this architecture works, it bypasses Config's native remediation capability, introducing more components to build and maintain. The question asks for Config auto-remediation."
            },
            {
              "id": "c3",
              "text": "Add a ComplianceResourceTypes property to the Config rule that triggers an SNS notification, then subscribe a Lambda function to apply encryption",
              "isCorrect": false,
              "explanation": "This creates a notification pipeline, not an automatic remediation. It also requires custom SNS-to-Lambda wiring and does not use Config's built-in remediation feature."
            },
            {
              "id": "c1",
              "text": "Type: AWS::Config::RemediationConfiguration\nProperties:\n  ConfigRuleName: s3-bucket-server-side-encryption-enabled\n  TargetType: SSM_DOCUMENT\n  TargetId: AWS-EnableS3BucketEncryption\n  Automatic: true\n  MaximumAutomaticAttempts: 3\n  RetryAttemptSeconds: 60\n  Parameters:\n    BucketName:\n      ResourceValue:\n        Value: RESOURCE_ID",
              "isCorrect": true,
              "explanation": "This uses an AWS-provided SSM Automation document to enable encryption on the non-compliant bucket. TargetType SSM_DOCUMENT and the RESOURCE_ID placeholder correctly bind the remediation to the flagged resource."
            },
            {
              "id": "c2",
              "text": "Type: AWS::Config::RemediationConfiguration\nProperties:\n  ConfigRuleName: s3-bucket-server-side-encryption-enabled\n  TargetType: LAMBDA\n  TargetId: arn:aws:lambda:us-east-1:123456789012:function:fix-encryption\n  Automatic: true",
              "isCorrect": false,
              "explanation": "Config remediation currently only supports SSM_DOCUMENT as a TargetType. Lambda functions cannot be used directly as remediation targets in a RemediationConfiguration resource."
            }
          ],
          "selectCount": 1,
          "format": "yaml",
          "domain": "Detection",
          "services": [
            "Config",
            "Systems Manager",
            "S3",
            "Lambda"
          ],
          "docs": "https://docs.aws.amazon.com/config/latest/developerguide/remediation.html",
          "tip": "Config auto-remediation always uses SSM Automation documents (TargetType: SSM_DOCUMENT), not Lambda directly.",
          "explanation": "AWS Config remediation actions invoke SSM Automation documents to fix non-compliant resources. AWS provides pre-built documents like AWS-EnableS3BucketEncryption. Setting Automatic to true and configuring retry parameters ensures Config will apply the fix without manual intervention whenever a drift is detected."
        },
        {
          "id": "SCS-C03-0003",
          "question": "To restrict traffic at the network edge for HTTP endpoints, which service should you combine with CloudFront?",
          "choices": [
            {
              "id": "c2",
              "text": "Security Groups",
              "isCorrect": false,
              "explanation": "Security Groups control traffic to EC2 at the instance level, not the CloudFront edge."
            },
            {
              "id": "c3",
              "text": "VPC Endpoint",
              "isCorrect": false,
              "explanation": "VPC Endpoints provide private connectivity to services within a VPC, not edge HTTP filtering."
            },
            {
              "id": "c1",
              "text": "AWS WAF",
              "isCorrect": true,
              "explanation": "AWS WAF is the web application firewall used with CloudFront to filter HTTP(S) traffic."
            },
            {
              "id": "c4",
              "text": "AWS KMS",
              "isCorrect": false,
              "explanation": "AWS KMS is for key management and encryption, not traffic filtering."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Infrastructure Security",
          "services": [
            "WAF",
            "CloudFront",
            "Security Groups"
          ],
          "docs": "https://docs.aws.amazon.com/waf/latest/developerguide/waf-chapter.html",
          "tip": "Think web application protection rules that block common attack patterns at the edge.",
          "explanation": "AWS WAF integrates natively with CloudFront, ALB, and API Gateway to inspect and filter HTTP(S) requests using rules such as rate limiting and SQL injection detection."
        },
        {
          "id": "SCS-C03-0014",
          "question": "A data lake team manages a single S3 bucket accessed by multiple applications across different VPCs. They need to enforce that each application can only reach the bucket from its own VPC and can only access objects under its designated prefix. Which approach provides the strongest isolation with the least policy complexity?",
          "choices": [
            {
              "id": "c4",
              "text": "Replicate data into separate per-application buckets",
              "isCorrect": false,
              "explanation": "Replication increases cost and complexity."
            },
            {
              "id": "c1",
              "text": "Create a separate S3 Access Point for each application",
              "isCorrect": true,
              "explanation": "S3 Access Points allow per-application network and permission scoping against a shared bucket."
            },
            {
              "id": "c3",
              "text": "Create one VPC endpoint per VPC and use endpoint policies",
              "isCorrect": false,
              "explanation": "Endpoint policies are coarse for prefix-level scoping."
            },
            {
              "id": "c2",
              "text": "Write a single S3 bucket policy with separate statements per application",
              "isCorrect": false,
              "explanation": "A single bucket policy becomes difficult to manage and has size limits."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Data Protection",
          "services": [
            "S3",
            "IAM",
            "VPC",
            "PrivateLink"
          ],
          "docs": "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-points.html",
          "tip": "Consider a feature that lets you create named network-scoped entry points to a single bucket.",
          "explanation": "S3 Access Points provide named, per-application entry points to a bucket, each with its own policy and optional VPC restriction."
        }
      ],
      "perDomain": {
        "Incident Response": {
          "total": 1,
          "correct": 0,
          "score": 0
        },
        "Detection": {
          "total": 1,
          "correct": 1,
          "score": 100
        }
      },
      "earlyComplete": true,
      "answeredCount": 2,
      "totalQuestions": 36
    },
    {
      "attemptId": "f4d416a6-2879-4a1a-9400-bf00e33aadbc",
      "userId": "9255a4e4-20f1-7010-8a80-17c43ca141e3",
      "examCode": "SCS-C03",
      "examVersion": null,
      "s3VersionId": null,
      "attemptSchemaVersion": 1,
      "startedAt": "2026-02-18T13:30:48.917Z",
      "finishedAt": "2026-02-18T13:41:14.682Z",
      "score": 100,
      "answers": [
        {
          "questionId": "SCS-C03-0064",
          "selectedChoiceId": "c1",
          "selectedChoiceIds": null,
          "selectedIndex": null,
          "selectedIndices": null,
          "correct": true,
          "timeMs": 0,
          "showTip": false,
          "createdAt": "2026-02-18T13:33:01.736Z"
        }
      ],
      "metadata": {
        "serviceKeywords": [],
        "domains": [],
        "services": []
      },
      "questions": [
        {
          "id": "SCS-C03-0064",
          "question": "After a GuardDuty finding indicates suspicious API calls from a role, which steps validate scope and impact?",
          "choices": [
            {
              "id": "c3",
              "text": "Ignore the finding if there are no console alerts",
              "isCorrect": false,
              "explanation": "Findings should be validated; absence of console alerts doesn't mean no impact."
            },
            {
              "id": "c2",
              "text": "Disable the role immediately without investigation",
              "isCorrect": false,
              "explanation": "Immediate disabling may be necessary in severe compromises, but initial validation helps confirm scope before wide measures."
            },
            {
              "id": "c4",
              "text": "Assume GuardDuty is faulty and open a support ticket",
              "isCorrect": false,
              "explanation": "While false positives can occur, perform validation steps before concluding GuardDuty is wrong."
            },
            {
              "id": "c1",
              "text": "Retrieve CloudTrail management events for the role, query related CloudWatch Logs, and inspect resource changes",
              "isCorrect": true,
              "explanation": "Correlate GuardDuty findings with CloudTrail events and application logs to scope the impact and timeline."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Incident Response",
          "services": [
            "GuardDuty",
            "Security Hub",
            "EventBridge"
          ],
          "docs": "https://docs.aws.amazon.com/guardduty/latest/ug/what-is-guardduty.html",
          "tip": "Correlate GuardDuty with CloudTrail and application logs to validate impact.",
          "explanation": "Effective validation uses multiple data sources: CloudTrail shows API callers and timestamps; CloudWatch and application logs show resource-level effects and help identify affected assets."
        },
        {
          "id": "SCS-C03-0031",
          "question": "During an incident investigation, an analyst has shell access to a compromised EC2 instance and needs to determine which IAM identity the instance is currently using to make AWS API calls. Which CLI command reveals this information?",
          "choices": [
            {
              "id": "c3",
              "text": "aws ec2 describe-instances --instance-id $(curl -s http://169.254.169.254/latest/meta-data/instance-id)",
              "isCorrect": false,
              "explanation": "describe-instances shows instance metadata including the IamInstanceProfile association, but the response contains the profile ARN, not the currently assumed role ARN with session details. get-caller-identity is more direct."
            },
            {
              "id": "c4",
              "text": "curl http://169.254.169.254/latest/meta-data/iam/security-credentials/",
              "isCorrect": false,
              "explanation": "This metadata endpoint lists the instance profile role name and can retrieve temporary credentials, but it does not show the full ARN or account ID. It also does not detect if the instance is using a different assumed role via manual STS calls."
            },
            {
              "id": "c2",
              "text": "aws iam get-user",
              "isCorrect": false,
              "explanation": "get-user returns information about an IAM user. On an instance using a role (not a user), this command fails because the caller is not an IAM user."
            },
            {
              "id": "c1",
              "text": "aws sts get-caller-identity",
              "isCorrect": true,
              "explanation": "This command returns the UserId, Account, and ARN of the IAM identity (user, role, or federated identity) making the request. On an EC2 instance, it reveals the instance profile role."
            }
          ],
          "selectCount": 1,
          "format": "cli",
          "domain": "Incident Response",
          "services": [
            "STS",
            "IAM",
            "CloudShell"
          ],
          "docs": "https://docs.aws.amazon.com/cli/latest/reference/sts/get-caller-identity.html",
          "tip": "This STS command works universally regardless of whether the caller is a user, role, federated identity, or instance profile.",
          "explanation": "aws sts get-caller-identity is the quickest and most reliable way to determine the current AWS identity context. It works for all principal types and returns the ARN that appears in CloudTrail logs, making it invaluable during investigations."
        },
        {
          "id": "SCS-C03-0023",
          "question": "A web application team needs to ensure that TLS certificates on their internet-facing ALBs are renewed automatically without any manual intervention or downtime. Certificates must support multiple subdomain names (e.g., api.example.com, app.example.com). Which approach meets these requirements?",
          "choices": [
            {
              "id": "c1",
              "text": "Request a public ACM certificate with Subject Alternative Names (SANs) for each subdomain using DNS validation, and associate it with the ALB",
              "isCorrect": true,
              "explanation": "ACM public certificates with DNS validation renew automatically as long as the CNAME validation records remain in place. SANs allow multiple subdomains on a single certificate, and ALB natively integrates with ACM for zero-downtime deployment."
            },
            {
              "id": "c2",
              "text": "Purchase a wildcard certificate from a third-party CA, import it into ACM, and set a calendar reminder to renew it annually",
              "isCorrect": false,
              "explanation": "Imported certificates in ACM are not automatically renewed. Manual renewal and re-import is required, which introduces risk of expiration and human error."
            },
            {
              "id": "c3",
              "text": "Use Let's Encrypt with certbot running on the ALB instances to obtain and renew certificates",
              "isCorrect": false,
              "explanation": "ALBs are managed services; you cannot run certbot or any agent on them. Let's Encrypt certificates must be imported into ACM, losing automatic renewal."
            },
            {
              "id": "c4",
              "text": "Generate a self-signed certificate for each subdomain and configure the ALB to present them using SNI",
              "isCorrect": false,
              "explanation": "Self-signed certificates are not trusted by browsers and will produce security warnings. They also require manual rotation, defeating the automation requirement."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Data Protection",
          "services": [
            "ACM",
            "CloudFront",
            "ALB",
            "Route 53"
          ],
          "docs": "https://docs.aws.amazon.com/acm/latest/userguide/acm-overview.html",
          "tip": "ACM's automatic renewal only works for certificates it issues (not imported ones), and DNS validation is the set-and-forget option.",
          "explanation": "AWS Certificate Manager issues free public certificates that renew automatically when DNS validation is used. By adding SANs for each subdomain, a single certificate covers multiple endpoints. ACM's native integration with ALB means certificate deployment and rotation happen transparently."
        },
        {
          "id": "SCS-C03-0046",
          "question": "Faced with application-layer bot traffic and volumetric DDoS, which combined edge strategy provides layered protection?",
          "choices": [
            {
              "id": "c4",
              "text": "Increase EC2 instance sizes behind the load balancer",
              "isCorrect": false,
              "explanation": "Scaling instances may help capacity but does not stop DDoS or malicious application-layer requests at the edge."
            },
            {
              "id": "c2",
              "text": "Only enable security groups at the origin",
              "isCorrect": false,
              "explanation": "Security groups do not protect the global edge nor mitigate volumetric attacks effectively."
            },
            {
              "id": "c1",
              "text": "Use AWS Shield Advanced for DDoS and AWS WAF at CloudFront for application-layer filtering",
              "isCorrect": true,
              "explanation": "Shield Advanced mitigates volumetric network attacks while WAF filters application-layer patterns such as bots and OWASP threats."
            },
            {
              "id": "c3",
              "text": "Rely on client-side Captcha only",
              "isCorrect": false,
              "explanation": "Client-side controls can be bypassed and don't handle volumetric network-level attacks."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Infrastructure Security",
          "services": [
            "WAF",
            "CloudFront",
            "Shield"
          ],
          "docs": "https://docs.aws.amazon.com/waf/latest/developerguide/waf-chapter.html",
          "tip": "Combine network- and application-layer protections at the edge.",
          "explanation": "Defence in depth: Shield Advanced for volumetric and network-layer attacks, WAF for application-layer patterns, and CloudFront for caching and geographic distribution."
        },
        {
          "id": "SCS-C03-0049",
          "question": "A team must provide audited shell access to instances in private subnets without SSH port exposure. Which solution meets this requirement?",
          "choices": [
            {
              "id": "c3",
              "text": "Use RDP through a bastion host for Linux instances",
              "isCorrect": false,
              "explanation": "RDP is inappropriate for Linux and bastions reintroduce exposed access vectors."
            },
            {
              "id": "c2",
              "text": "Open SSH port 22 and enforce key rotation manually",
              "isCorrect": false,
              "explanation": "Opening SSH ports exposes network surface and complicates auditing compared to agent-based sessions."
            },
            {
              "id": "c4",
              "text": "Embed root credentials in AMI for quick access",
              "isCorrect": false,
              "explanation": "Embedding credentials is insecure and hinders auditing and rotation."
            },
            {
              "id": "c1",
              "text": "Use Systems Manager Session Manager with logging to CloudWatch or S3 and IAM-based access controls",
              "isCorrect": true,
              "explanation": "Session Manager provides agent-based access without inbound ports and records sessions for auditing."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Infrastructure Security",
          "services": [
            "Systems Manager",
            "SSM",
            "CloudTrail"
          ],
          "docs": "https://docs.aws.amazon.com/systems-manager/latest/userguide/session-manager.html",
          "tip": "Session Manager uses IAM for access control and logs sessions for audits.",
          "explanation": "Systems Manager's Session Manager avoids bastions and allows session logging to CloudWatch/S3 and control via IAM, meeting audit requirements."
        },
        {
          "id": "SCS-C03-0006",
          "question": "Your security team needs a single place for findings and strong key management for encrypted data which TWO services should they use together? (Select TWO)",
          "choices": [
            {
              "id": "c2",
              "text": "AWS KMS",
              "isCorrect": true,
              "explanation": "KMS provides centralized encryption key management for encrypting data at rest."
            },
            {
              "id": "c4",
              "text": "AWS CloudFormation",
              "isCorrect": false,
              "explanation": "CloudFormation is an infrastructure-as-code service, not a security findings tool."
            },
            {
              "id": "c3",
              "text": "Amazon SQS",
              "isCorrect": false,
              "explanation": "SQS is a message queuing service, not related to security findings or encryption."
            },
            {
              "id": "c1",
              "text": "AWS Security Hub",
              "isCorrect": true,
              "explanation": "Security Hub provides a comprehensive view of security alerts and compliance status across accounts."
            },
            {
              "id": "c5",
              "text": "Amazon EC2",
              "isCorrect": false,
              "explanation": "EC2 provides virtual machines, not security findings management."
            }
          ],
          "selectCount": 2,
          "format": "text",
          "domain": "Detection",
          "services": [
            "Security Hub",
            "KMS",
            "SQS",
            "CloudFormation",
            "EC2"
          ],
          "docs": "https://docs.aws.amazon.com/securityhub/latest/userguide/what-is-securityhub.html",
          "tip": "Think about centralized findings aggregation and key management.",
          "explanation": "Security Hub aggregates and normalizes findings and KMS provides the keys to encrypt sensitive data."
        },
        {
          "id": "SCS-C03-0012",
          "question": "Which IAM mechanism lets you enforce that ceiling while preserving self-service?",
          "choices": [
            {
              "id": "c4",
              "text": "Use an SCP to deny iam:CreateRole for all developers and have the platform team create roles on request",
              "isCorrect": false,
              "explanation": "This removes developer self-service entirely, creating operational bottlenecks without enabling delegation."
            },
            {
              "id": "c1",
              "text": "Require developers to attach a permissions boundary to every role they create",
              "isCorrect": true,
              "explanation": "Permissions boundaries cap the maximum permissions a role can have, even if the role's identity policy grants broader access."
            },
            {
              "id": "c2",
              "text": "Grant developers iam:CreateRole but restrict the role's trust policy to lambda.amazonaws.com only",
              "isCorrect": false,
              "explanation": "Restricting the trust policy limits who can assume the role, but does not limit what permissions the role itself can have."
            },
            {
              "id": "c3",
              "text": "Create a single shared Lambda execution role managed by the platform team",
              "isCorrect": false,
              "explanation": "A shared role works but violates least privilege because all functions share the same permissions regardless of their needs."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Identity and Access Management",
          "services": [
            "IAM",
            "Organizations",
            "STS"
          ],
          "docs": "https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies_boundaries.html",
          "tip": "You need a mechanism that caps maximum permissions while still allowing developers to create and manage their own roles.",
          "explanation": "IAM permissions boundaries act as a ceiling on the effective permissions of a role or user."
        },
        {
          "id": "SCS-C03-0027",
          "question": "A security team has an AWS Config rule that detects S3 buckets without default encryption enabled. They want Config to automatically remediate non-compliant buckets by applying AES-256 server-side encryption. Which CloudFormation snippet correctly defines the auto-remediation action?",
          "choices": [
            {
              "id": "c1",
              "text": "Type: AWS::Config::RemediationConfiguration\nProperties:\n  ConfigRuleName: s3-bucket-server-side-encryption-enabled\n  TargetType: SSM_DOCUMENT\n  TargetId: AWS-EnableS3BucketEncryption\n  Automatic: true\n  MaximumAutomaticAttempts: 3\n  RetryAttemptSeconds: 60\n  Parameters:\n    BucketName:\n      ResourceValue:\n        Value: RESOURCE_ID",
              "isCorrect": true,
              "explanation": "This uses an AWS-provided SSM Automation document to enable encryption on the non-compliant bucket. TargetType SSM_DOCUMENT and the RESOURCE_ID placeholder correctly bind the remediation to the flagged resource."
            },
            {
              "id": "c3",
              "text": "Add a ComplianceResourceTypes property to the Config rule that triggers an SNS notification, then subscribe a Lambda function to apply encryption",
              "isCorrect": false,
              "explanation": "This creates a notification pipeline, not an automatic remediation. It also requires custom SNS-to-Lambda wiring and does not use Config's built-in remediation feature."
            },
            {
              "id": "c4",
              "text": "Use an EventBridge rule to detect Config compliance change events and invoke a Step Functions workflow",
              "isCorrect": false,
              "explanation": "While this architecture works, it bypasses Config's native remediation capability, introducing more components to build and maintain. The question asks for Config auto-remediation."
            },
            {
              "id": "c2",
              "text": "Type: AWS::Config::RemediationConfiguration\nProperties:\n  ConfigRuleName: s3-bucket-server-side-encryption-enabled\n  TargetType: LAMBDA\n  TargetId: arn:aws:lambda:us-east-1:123456789012:function:fix-encryption\n  Automatic: true",
              "isCorrect": false,
              "explanation": "Config remediation currently only supports SSM_DOCUMENT as a TargetType. Lambda functions cannot be used directly as remediation targets in a RemediationConfiguration resource."
            }
          ],
          "selectCount": 1,
          "format": "yaml",
          "domain": "Detection",
          "services": [
            "Config",
            "Systems Manager",
            "S3",
            "Lambda"
          ],
          "docs": "https://docs.aws.amazon.com/config/latest/developerguide/remediation.html",
          "tip": "Config auto-remediation always uses SSM Automation documents (TargetType: SSM_DOCUMENT), not Lambda directly.",
          "explanation": "AWS Config remediation actions invoke SSM Automation documents to fix non-compliant resources. AWS provides pre-built documents like AWS-EnableS3BucketEncryption. Setting Automatic to true and configuring retry parameters ensures Config will apply the fix without manual intervention whenever a drift is detected."
        },
        {
          "id": "SCS-C03-0063",
          "question": "Which practice validates that an incident response runbook will work under real conditions?",
          "choices": [
            {
              "id": "c1",
              "text": "Conduct tabletop exercises and full-scale simulated incident drills using controlled fault injection",
              "isCorrect": true,
              "explanation": "Tabletops test decision-making; simulated drills and fault injection test technical runbooks and automation under realistic conditions."
            },
            {
              "id": "c4",
              "text": "Rely on vendor-provided runbooks without customization",
              "isCorrect": false,
              "explanation": "Vendor runbooks may not match the customer's environment and need adaptation and testing."
            },
            {
              "id": "c2",
              "text": "Only review runbooks annually without testing",
              "isCorrect": false,
              "explanation": "Reviews without testing may miss operational and technical gaps discovered during live drills."
            },
            {
              "id": "c3",
              "text": "Assume runbooks are valid if written by senior staff",
              "isCorrect": false,
              "explanation": "Assumptions without testing risk undiscovered issues in execution under pressure."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Incident Response",
          "services": [
            "Incident Manager",
            "CloudWatch",
            "EventBridge"
          ],
          "docs": "https://docs.aws.amazon.com/whitepapers/latest/aws-security-best-practices/incident-response.html",
          "tip": "Run both tabletop and technical drills to validate playbooks.",
          "explanation": "Combining tabletop exercises for roles and decisions with full technical drills (injecting faults) validates both human and automated aspects of incident response."
        },
        {
          "id": "SCS-C03-0013",
          "question": "An organisation wants to automatically isolate an EC2 instance when GuardDuty detects cryptocurrency mining activity. Which architecture achieves automated remediation with the least operational overhead?",
          "choices": [
            {
              "id": "c3",
              "text": "Schedule a Lambda to poll GuardDuty every five minutes and isolate flagged instances",
              "isCorrect": false,
              "explanation": "Polling introduces delay and extra maintenance."
            },
            {
              "id": "c2",
              "text": "Enable Security Hub automated response playbooks to quarantine instances",
              "isCorrect": false,
              "explanation": "Security Hub aggregates findings but does not have built-in quarantine playbooks."
            },
            {
              "id": "c1",
              "text": "Configure GuardDuty findings to flow into EventBridge and trigger a Lambda that isolates the instance",
              "isCorrect": true,
              "explanation": "EventBridge rules can filter GuardDuty finding types and invoke Lambda for automated remediation."
            },
            {
              "id": "c4",
              "text": "Use Systems Manager Automation runbooks triggered by a CPU alarm to stop instances",
              "isCorrect": false,
              "explanation": "CPU alarms are generic and can cause false positives."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Incident Response",
          "services": [
            "GuardDuty",
            "Security Hub",
            "EventBridge",
            "Lambda",
            "Systems Manager"
          ],
          "docs": "https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_finding-types-ec2.html",
          "tip": "The key is event-driven, near-real-time response with minimal ongoing maintenance.",
          "explanation": "GuardDuty publishes findings to EventBridge in near-real-time, enabling immediate Lambda-driven remediation."
        },
        {
          "id": "SCS-C03-0029",
          "question": "An organisation with 300 member accounts needs to enable GuardDuty in every account and every region, automatically including future accounts. All findings must be viewable from the security account. Which approach achieves this with the least ongoing maintenance?",
          "choices": [
            {
              "id": "c1",
              "text": "Designate a delegated administrator account for GuardDuty through AWS Organizations and enable the auto-enable feature for new member accounts",
              "isCorrect": true,
              "explanation": "The delegated administrator model in GuardDuty with auto-enable automatically activates GuardDuty in all current and future member accounts. Findings from all accounts are aggregated in the administrator account."
            },
            {
              "id": "c4",
              "text": "Enable Security Hub in the security account and it will automatically enable GuardDuty across all member accounts",
              "isCorrect": false,
              "explanation": "Security Hub aggregates findings from GuardDuty but does not enable or manage GuardDuty. They are independent services with separate enablement processes."
            },
            {
              "id": "c3",
              "text": "Deploy GuardDuty via a CloudFormation StackSet targeting all accounts and regions",
              "isCorrect": false,
              "explanation": "StackSets can enable GuardDuty but do not establish the administrator-member relationship needed to aggregate findings centrally, and they require additional work for auto-enabling in new accounts."
            },
            {
              "id": "c2",
              "text": "Send manual invitation requests from the security account to each of the 300 member accounts and accept them individually",
              "isCorrect": false,
              "explanation": "Manual invitations work but require per-account acceptance, do not auto-enrol future accounts, and become unmanageable at scale."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Detection",
          "services": [
            "GuardDuty",
            "Organizations",
            "Security Hub",
            "S3"
          ],
          "docs": "https://docs.aws.amazon.com/guardduty/latest/ug/what-is-guardduty.html",
          "tip": "The Organizations integration with delegated administrator and auto-enable is the hands-off, scalable approach for GuardDuty at organisation scale.",
          "explanation": "GuardDuty's Organizations integration allows a delegated administrator to manage GuardDuty across all member accounts centrally. The auto-enable feature ensures new accounts are automatically enrolled without manual intervention, and all findings flow to the administrator account for consolidated monitoring."
        },
        {
          "id": "SCS-C03-0054",
          "question": "What is a key operational difference between imported key material and AWS-generated KMS keys?",
          "choices": [
            {
              "id": "c2",
              "text": "Imported key material automatically rotates daily",
              "isCorrect": false,
              "explanation": "Automatic daily rotation is not a feature of imported key material; rotation must be managed by the customer."
            },
            {
              "id": "c4",
              "text": "AWS may export imported key material to other customers",
              "isCorrect": false,
              "explanation": "AWS does not export customer-imported key material; it's managed per customer account/CMK."
            },
            {
              "id": "c3",
              "text": "Imported keys are free of charge for cross-region usage",
              "isCorrect": false,
              "explanation": "Billing is not the defining operational difference; cross-region use still requires correct configuration."
            },
            {
              "id": "c1",
              "text": "Imported key material may have restrictions on automatic rotation and cannot be exported by AWS; customer manages lifecycle",
              "isCorrect": true,
              "explanation": "Imported key material is under customer control for import/removal and has different rotation/export characteristics than AWS-generated keys."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Data Protection",
          "services": [
            "KMS",
            "CloudHSM",
            "Secrets Manager"
          ],
          "docs": "https://docs.aws.amazon.com/KMS/latest/developerguide/importing-keys.html",
          "tip": "Imported key material requires explicit lifecycle and rotation planning.",
          "explanation": "Choosing imported key material affects rotation, import windows, and export constraints; plan operational processes accordingly."
        },
        {
          "id": "SCS-C03-0030",
          "question": "A disaster recovery plan requires that all objects in a production S3 bucket encrypted with a customer-managed KMS key be replicated to a bucket in a different region using a different KMS key. Which TWO configurations are required for cross-region replication to work with KMS-encrypted objects? (Select TWO)",
          "choices": [
            {
              "id": "c5",
              "text": "Disable KMS encryption on the destination bucket and use SSE-S3 instead",
              "isCorrect": false,
              "explanation": "Switching to SSE-S3 would avoid KMS complexity but loses the benefits of customer-managed key control, audit via CloudTrail, and compliance requirements that may mandate CMK usage."
            },
            {
              "id": "c2",
              "text": "Grant the S3 replication role kms:Decrypt permission on the source key and kms:Encrypt permission on the destination key",
              "isCorrect": true,
              "explanation": "The replication role must decrypt the objects using the source CMK and then encrypt them with the destination CMK. Without both permissions, replication fails with AccessDenied."
            },
            {
              "id": "c3",
              "text": "Use the same KMS key in both the source and destination regions",
              "isCorrect": false,
              "explanation": "KMS keys are regional. A key in us-east-1 cannot be used in eu-west-1. Multi-Region KMS keys exist but are not required; specifying the destination key in the replication rule is sufficient."
            },
            {
              "id": "c4",
              "text": "Enable S3 Transfer Acceleration on both buckets to speed up cross-region replication",
              "isCorrect": false,
              "explanation": "Transfer Acceleration optimizes direct uploads via CloudFront edge locations. It is not related to S3 replication, which uses its own internal transfer mechanism."
            },
            {
              "id": "c1",
              "text": "Specify the destination KMS key ARN in the replication rule configuration",
              "isCorrect": true,
              "explanation": "When replicating KMS-encrypted objects, the replication configuration must specify the destination KMS key so S3 can re-encrypt the objects in the destination region."
            }
          ],
          "selectCount": 2,
          "format": "text",
          "domain": "Data Protection",
          "services": [
            "S3",
            "KMS",
            "IAM",
            "Organizations"
          ],
          "docs": "https://docs.aws.amazon.com/AmazonS3/latest/userguide/replication-walkthrough-2.html",
          "tip": "Cross-region KMS replication requires both a destination key specification and the right permissions for the replication role on both the source and destination keys.",
          "explanation": "S3 replication with SSE-KMS objects requires two key configurations: the replication rule must specify the destination KMS key ARN (since KMS keys are regional), and the replication IAM role must have kms:Decrypt on the source key plus kms:Encrypt and kms:GenerateDataKey on the destination key."
        },
        {
          "id": "SCS-C03-0011",
          "question": "Compliance requires CloudWatch Logs to use a customer-managed CMK and let the service use it what steps achieve this configuration?",
          "choices": [
            {
              "id": "c2",
              "text": "Enable SSE-S3 default encryption on the S3 bucket where CloudWatch Logs exports data and reference that bucket in each log group's settings",
              "isCorrect": false,
              "explanation": "S3 encryption applies only to exported log data in S3, not to log data stored within the CloudWatch Logs service itself."
            },
            {
              "id": "c1",
              "text": "Create a customer-managed KMS key with a key policy granting logs.<region>.amazonaws.com the kms:Encrypt, kms:Decrypt, kms:GenerateDataKey, and kms:DescribeKey actions, then associate the key with each log group",
              "isCorrect": true,
              "explanation": "CloudWatch Logs requires these four KMS actions in the key policy for the regional service principal to encrypt and decrypt log data."
            },
            {
              "id": "c4",
              "text": "Create an AWS-managed KMS key (alias aws/logs) and it will automatically encrypt all new log groups without any key policy changes",
              "isCorrect": false,
              "explanation": "CloudWatch Logs does not have an AWS-managed key. You must create and configure a customer-managed key explicitly."
            },
            {
              "id": "c3",
              "text": "Enable CloudTrail log file encryption with a KMS key and configure CloudWatch Logs as a CloudTrail destination",
              "isCorrect": false,
              "explanation": "CloudTrail encryption covers CloudTrail's own log files delivered to S3, not arbitrary CloudWatch Logs log groups."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Data Protection",
          "services": [
            "CloudWatch Logs",
            "KMS",
            "S3",
            "CloudTrail"
          ],
          "docs": "https://docs.aws.amazon.com/AmazonCloudWatch/latest/logs/encrypt-log-data-kms.html",
          "tip": "CloudWatch Logs encryption requires a customer-managed CMK - there is no AWS-managed key option for this service.",
          "explanation": "CloudWatch Logs supports encryption at rest only with customer-managed KMS keys. You must explicitly grant the regional service principal permission to use the key."
        },
        {
          "id": "SCS-C03-0037",
          "question": "For a critical service running in an Auto Scaling group behind an ALB, which monitoring approach provides aggregated health metrics and automated alerting for service-level availability?",
          "choices": [
            {
              "id": "c4",
              "text": "Attach detailed instance metrics to each EC2 instance and rely on manual inspection",
              "isCorrect": false,
              "explanation": "Instance-level metrics are useful but relying on manual inspection does not provide automated alerting or aggregated service-level visibility across an Auto Scaling group."
            },
            {
              "id": "c3",
              "text": "Use S3 access logs aggregated into Athena queries to detect failures",
              "isCorrect": false,
              "explanation": "S3 access logs are eventual and not designed for real-time service availability monitoring."
            },
            {
              "id": "c1",
              "text": "Create CloudWatch alarms on aggregated ALB and Auto Scaling metrics and notify via SNS to trigger automated remediation",
              "isCorrect": true,
              "explanation": "CloudWatch aggregates service metrics (ALB and ASG), allows alarm thresholds, and integrates with SNS and automated remediation actions such as scaling or Lambda-driven fixes."
            },
            {
              "id": "c2",
              "text": "Rely on CloudTrail event history to monitor service health and send alerts",
              "isCorrect": false,
              "explanation": "CloudTrail records API activity and is not suitable as a primary source of service health metrics or near-real-time availability alarms."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Detection",
          "services": [
            "CloudWatch",
            "Auto Scaling",
            "Elastic Load Balancing",
            "SNS"
          ],
          "docs": "https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/WhatIsCloudWatch.html",
          "tip": "Aggregate ALB and ASG metrics into CloudWatch alarms and hook alarms to SNS or automation for remediation.",
          "explanation": "CloudWatch is the natural aggregation point for service metrics; combining ALB and Auto Scaling metrics with alarms and SNS-driven automation provides both service-level visibility and automatic remediation triggers."
        },
        {
          "id": "SCS-C03-0050",
          "question": "Which approach meets the requirement: rotate DB credentials every 30 days without redeploying applications?",
          "choices": [
            {
              "id": "c1",
              "text": "Use AWS Secrets Manager rotation with a Lambda rotation function and have apps retrieve secrets at runtime",
              "isCorrect": true,
              "explanation": "Secrets Manager supports automatic rotation and applications that fetch secrets at runtime do not need redeployment."
            },
            {
              "id": "c4",
              "text": "Rotate credentials manually and email them to developers",
              "isCorrect": false,
              "explanation": "Manual rotation and distribution is insecure and error-prone."
            },
            {
              "id": "c2",
              "text": "Bake credentials into container images and rebuild monthly",
              "isCorrect": false,
              "explanation": "Rebuilding images is operationally heavy and requires redeployment, which the requirement forbids."
            },
            {
              "id": "c3",
              "text": "Store credentials in SSM Parameter Store without rotation",
              "isCorrect": false,
              "explanation": "Parameter Store can store secrets but does not provide automated rotation like Secrets Manager."
            }
          ],
          "selectCount": 1,
          "format": "json",
          "domain": "Data Protection",
          "services": [
            "Secrets Manager",
            "IAM",
            "Lambda"
          ],
          "docs": "https://docs.aws.amazon.com/secretsmanager/latest/userguide/intro.html",
          "tip": "Use Secrets Manager rotation plus runtime retrieval by the application.",
          "explanation": "Automatic rotation decouples credential lifecycles from deployments; applications should fetch secrets at runtime to benefit from rotation without redeployments."
        },
        {
          "id": "SCS-C03-0036",
          "question": "A security platform team must deploy a hardened VPC, a set of IAM permission boundaries, and logging configuration to 15 existing AWS accounts. Changes must be automated via CI/CD, deployments must be auditable, and any account drift should be detectable centrally. The team also wants least-privilege for the agents that perform deployments. Which approach best satisfies these requirements?",
          "choices": [
            {
              "id": "c4",
              "text": "Utilise AWS Control Tower guardrails to keep accounts compliant and make manual adjustments via the console for exceptions",
              "isCorrect": false,
              "explanation": "Control Tower provides guardrails and a landing zone but is not a full CI/CD-driven IaC deployment and does not replace an auditable, parameterized IaC pipeline for existing accounts at scale."
            },
            {
              "id": "c1",
              "text": "Create a parameterized CloudFormation module for the baseline, publish it to a central artifact repository, and deploy via CloudFormation StackSets (service-managed) from a CI/CD pipeline using delegated administrator roles; enable drift detection and record pipeline runs for auditability",
              "isCorrect": true,
              "explanation": "StackSets (service-managed) supports automated, organization-aware deployments driven by CI/CD, delegated admin roles provide least-privilege, and enabling drift detection plus CI/CD run logs provides centralized detection and an audit trail."
            },
            {
              "id": "c2",
              "text": "Let each account run CloudFormation stacks triggered manually by account owners, and collect logs centrally afterwards",
              "isCorrect": false,
              "explanation": "Manual, per-account deployments are not automated or easily auditable and do not provide centralized drift detection or consistent configuration."
            },
            {
              "id": "c3",
              "text": "Use Terraform workspaces stored locally per account and have individual engineers apply changes when notified",
              "isCorrect": false,
              "explanation": "Local, manual Terraform applies lack centralized automation, auditability, and organization-level drift detection; they also increase risk of inconsistent state."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Security Foundations and Governance",
          "services": [
            "CloudFormation",
            "StackSets",
            "CI/CD",
            "Organizations"
          ],
          "docs": "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/what-is-cfn.html",
          "tip": "Prefer org-aware IaC patterns that integrate with CI/CD, use delegated roles, and enable drift detection for centralized management.",
          "explanation": "For consistent, auditable, and automated deployments across multiple accounts, an org-aware IaC pattern like CloudFormation StackSets driven by a CI/CD pipeline provides parameterized modules, centralized rollout, delegated administration for least-privilege, and drift detection to identify configuration divergence. This pattern satisfies automation, auditability, and centralized management requirements."
        },
        {
          "id": "SCS-C03-0021",
          "question": "A company needs to inspect all egress traffic from its VPC for data exfiltration patterns using Suricata-compatible IDS/IPS rules at the network layer. Security Groups and NACLs are already in place for basic access control. Which service should they deploy?",
          "choices": [
            {
              "id": "c1",
              "text": "AWS Network Firewall",
              "isCorrect": true,
              "explanation": "Network Firewall is a managed, stateful network firewall that supports Suricata-compatible rules for deep packet inspection, IDS/IPS, and domain-based filtering on both ingress and egress traffic."
            },
            {
              "id": "c3",
              "text": "Tighten Security Group outbound rules to restrict destination IPs",
              "isCorrect": false,
              "explanation": "Security Groups provide stateful allow/deny by IP and port but cannot perform deep packet inspection or pattern-based detection of data exfiltration."
            },
            {
              "id": "c4",
              "text": "Configure more restrictive NACLs on the VPC subnets",
              "isCorrect": false,
              "explanation": "NACLs are stateless IP/port filters. They cannot inspect packet payloads or apply IDS/IPS signature-based rules."
            },
            {
              "id": "c2",
              "text": "AWS WAF",
              "isCorrect": false,
              "explanation": "WAF operates at Layer 7 (HTTP/HTTPS) and integrates with CloudFront, ALB, and API Gateway. It cannot inspect arbitrary TCP/UDP egress traffic or run Suricata rules."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Infrastructure Security",
          "services": [
            "Network Firewall",
            "WAF",
            "Security Groups",
            "NACLs"
          ],
          "docs": "https://docs.aws.amazon.com/network-firewall/latest/developerguide/what-is-aws-network-firewall.html",
          "tip": "When the requirement mentions Suricata, IDS/IPS, or deep packet inspection at the network layer, think beyond Security Groups and WAF.",
          "explanation": "AWS Network Firewall sits in-line in VPC traffic paths (via Gateway Load Balancer endpoints or firewall subnets) and evaluates packets against stateful Suricata-compatible rule groups. It fills the gap between simple Security Group/NACL controls and full deep-packet inspection requirements."
        },
        {
          "id": "SCS-C03-0033",
          "question": "An incident responder has identified a compromised IAM role and needs to immediately invalidate all existing sessions for that role while preserving the role itself for forensic analysis. Which approach revokes all active sessions without deleting the role?",
          "choices": [
            {
              "id": "c1",
              "text": "Add an inline deny-all policy to the role with a condition that aws:TokenIssueTime is before the current timestamp:\n{\"Effect\":\"Deny\",\"Action\":\"*\",\"Resource\":\"*\",\"Condition\":{\"DateLessThan\":{\"aws:TokenIssueTime\":\"2026-02-16T12:00:00Z\"}}}",
              "isCorrect": true,
              "explanation": "This technique (Revoke Session) denies all actions for temporary credentials issued before the specified time. New sessions assumed after that time are unaffected, and the role remains intact for investigation."
            },
            {
              "id": "c4",
              "text": "Contact AWS Support to force-expire the role's temporary credentials",
              "isCorrect": false,
              "explanation": "AWS Support cannot force-expire individual STS tokens. Session revocation must be done through IAM policy mechanisms by the account administrator."
            },
            {
              "id": "c3",
              "text": "Change the role's trust policy to deny all principals",
              "isCorrect": false,
              "explanation": "Modifying the trust policy prevents new role assumptions but does not invalidate existing active sessions. Temporary credentials already issued remain valid until they expire."
            },
            {
              "id": "c2",
              "text": "Delete all inline and managed policies from the role to remove its permissions",
              "isCorrect": false,
              "explanation": "Removing policies prevents new actions but also destroys the evidence of what permissions the role had, which is critical for forensic analysis."
            }
          ],
          "selectCount": 1,
          "format": "json",
          "domain": "Incident Response",
          "services": [
            "STS",
            "IAM",
            "CloudTrail"
          ],
          "docs": "https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_temp_request.html",
          "tip": "The Revoke Session technique uses a deny policy with the aws:TokenIssueTime condition to invalidate all credentials issued before a cutoff time.",
          "explanation": "STS temporary credentials cannot be individually revoked, but you can render them useless by attaching a deny-all policy with a DateLessThan condition on aws:TokenIssueTime. This is the recommended emergency response for compromised roles because it immediately neutralizes existing sessions while keeping the role and its policies intact for forensic review."
        },
        {
          "id": "SCS-C03-0022",
          "question": "An operations team wants to automate incident response when a critical CloudWatch alarm triggers: page the on-call engineer, create a timeline, and start a runbook to collect diagnostic data. They want a single AWS-native service to orchestrate all three actions. Which service should they configure?",
          "choices": [
            {
              "id": "c4",
              "text": "AWS CloudWatch composite alarms with auto-scaling actions",
              "isCorrect": false,
              "explanation": "Composite alarms aggregate alarm states but their actions are limited to SNS, Lambda, or Auto Scaling. They do not provide incident lifecycle management."
            },
            {
              "id": "c3",
              "text": "Amazon SNS with multiple topic subscriptions",
              "isCorrect": false,
              "explanation": "SNS delivers notifications but does not manage incident timelines, runbook execution, or structured escalation workflows."
            },
            {
              "id": "c1",
              "text": "AWS Systems Manager Incident Manager",
              "isCorrect": true,
              "explanation": "Incident Manager automates incident creation with response plans that define escalation contacts, engagement protocols, and runbook automation, all triggered by CloudWatch alarms or EventBridge rules."
            },
            {
              "id": "c2",
              "text": "Amazon EventBridge with Lambda targets",
              "isCorrect": false,
              "explanation": "EventBridge plus Lambda can achieve similar automation but requires custom code for paging, timeline tracking, and runbook execution. It is not a single orchestration service purpose-built for incident response."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Incident Response",
          "services": [
            "Systems Manager Incident Manager",
            "EventBridge",
            "SNS",
            "PagerDuty"
          ],
          "docs": "https://docs.aws.amazon.com/incident-manager/latest/userguide/what-is-incident-manager.html",
          "tip": "Look for a service that combines paging, incident timeline, and runbook automation in a single response plan.",
          "explanation": "Incident Manager provides structured response plans that automatically engage contacts (via SMS, voice, or email), create incident timelines, and execute SSM Automation runbooks when triggered. This consolidates incident orchestration into one service rather than gluing multiple services together with custom logic."
        },
        {
          "id": "SCS-C03-0001",
          "question": "You're the security lead for a multi-account AWS environment. Which AWS service helps aggregate and analyze security findings across accounts?",
          "choices": [
            {
              "id": "c4",
              "text": "Amazon SNS",
              "isCorrect": false,
              "explanation": "Amazon SNS is a notification service, not a security findings aggregator."
            },
            {
              "id": "c1",
              "text": "Amazon GuardDuty",
              "isCorrect": true,
              "explanation": "GuardDuty is a threat detection service that continuously monitors for malicious activity and unauthorized behavior."
            },
            {
              "id": "c2",
              "text": "AWS Config",
              "isCorrect": false,
              "explanation": "AWS Config tracks resource configuration and compliance, not threat detection."
            },
            {
              "id": "c3",
              "text": "AWS WAF",
              "isCorrect": false,
              "explanation": "AWS WAF is a web application firewall focused on HTTP(S) protections."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Detection",
          "services": [
            "GuardDuty",
            "Config",
            "WAF",
            "SNS"
          ],
          "docs": "https://docs.aws.amazon.com/guardduty/latest/ug/what-is-guardduty.html",
          "tip": "Think of a service that detects threats across your account using machine learning and threat intelligence.",
          "explanation": "Amazon GuardDuty uses ML models and threat intelligence feeds to continuously detect threats across accounts. The closest wrong answer is AWS Config, which evaluates resource configuration compliance, whereas GuardDuty detects active threats."
        },
        {
          "id": "SCS-C03-0014",
          "question": "A data lake team manages a single S3 bucket accessed by multiple applications across different VPCs. They need to enforce that each application can only reach the bucket from its own VPC and can only access objects under its designated prefix. Which approach provides the strongest isolation with the least policy complexity?",
          "choices": [
            {
              "id": "c1",
              "text": "Create a separate S3 Access Point for each application",
              "isCorrect": true,
              "explanation": "S3 Access Points allow per-application network and permission scoping against a shared bucket."
            },
            {
              "id": "c4",
              "text": "Replicate data into separate per-application buckets",
              "isCorrect": false,
              "explanation": "Replication increases cost and complexity."
            },
            {
              "id": "c3",
              "text": "Create one VPC endpoint per VPC and use endpoint policies",
              "isCorrect": false,
              "explanation": "Endpoint policies are coarse for prefix-level scoping."
            },
            {
              "id": "c2",
              "text": "Write a single S3 bucket policy with separate statements per application",
              "isCorrect": false,
              "explanation": "A single bucket policy becomes difficult to manage and has size limits."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Data Protection",
          "services": [
            "S3",
            "IAM",
            "VPC",
            "PrivateLink"
          ],
          "docs": "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-points.html",
          "tip": "Consider a feature that lets you create named network-scoped entry points to a single bucket.",
          "explanation": "S3 Access Points provide named, per-application entry points to a bucket, each with its own policy and optional VPC restriction."
        },
        {
          "id": "SCS-C03-0039",
          "question": "To ensure all client connections to an internet-facing application use modern TLS ciphers and automated certificate rotation, which configuration should be used on the load balancer?",
          "choices": [
            {
              "id": "c4",
              "text": "Use self-signed certificates deployed to each client",
              "isCorrect": false,
              "explanation": "Self-signed certificates are not practical for public internet-facing services and do not support automated rotation and trust by clients."
            },
            {
              "id": "c3",
              "text": "Rely solely on security groups to restrict plaintext access",
              "isCorrect": false,
              "explanation": "Security groups control network access but do not provide TLS encryption or manage certificates."
            },
            {
              "id": "c2",
              "text": "Use an HTTP listener and perform TLS termination on backend instances",
              "isCorrect": false,
              "explanation": "Terminating TLS on backend instances increases operational complexity and loses benefits of managed certificate rotation; it also may expose traffic if not configured properly."
            },
            {
              "id": "c1",
              "text": "Configure an HTTPS listener with an ACM-issued certificate and a recommended TLS security policy",
              "isCorrect": true,
              "explanation": "An HTTPS listener with an ACM-managed certificate ensures automated renewals and pairing with a recommended security policy enforces modern TLS ciphers and protocol versions."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Data Protection",
          "services": [
            "ALB",
            "ACM",
            "Route 53"
          ],
          "docs": "https://docs.aws.amazon.com/elasticloadbalancing/latest/application/create-https-listener.html",
          "tip": "Put TLS at the edge with ACM certificates and choose a modern security policy to enforce TLS 1.2+.",
          "explanation": "ACM-managed certificates integrate with ALB listeners for seamless rotation; pairing them with an appropriate security policy ensures modern ciphers and protocol versions without manual certificate management."
        },
        {
          "id": "SCS-C03-0045",
          "question": "Given an IAM role ARN, which CLI command quickly reveals the caller identity to correlate with CloudTrail events?",
          "choices": [
            {
              "id": "c2",
              "text": "aws iam list-roles",
              "isCorrect": false,
              "explanation": "List-roles enumerates roles but doesn't show the runtime caller identity."
            },
            {
              "id": "c1",
              "text": "aws sts get-caller-identity",
              "isCorrect": true,
              "explanation": "This STS call returns the effective principal; useful for correlating with CloudTrail event ARNs."
            },
            {
              "id": "c3",
              "text": "aws cloudtrail lookup-events",
              "isCorrect": false,
              "explanation": "Lookup-events finds historical events but does not directly reveal the current caller context."
            },
            {
              "id": "c4",
              "text": "aws sts decode-authorization-message",
              "isCorrect": false,
              "explanation": "Decoding auth message requires a message from AWS and is not the general approach for caller identity."
            }
          ],
          "selectCount": 1,
          "format": "cli",
          "domain": "Incident Response",
          "services": [
            "IAM",
            "STS"
          ],
          "docs": "https://docs.aws.amazon.com/iam/latest/UserGuide/id_roles.html",
          "tip": "Use `aws sts get-caller-identity` during live investigations to confirm identity.",
          "explanation": "`get-caller-identity` is the simplest way to determine which principal is currently making API calls; pair it with CloudTrail to find related events."
        },
        {
          "id": "SCS-C03-0062",
          "question": "How should a CI/CD pipeline handle high-severity image vulnerabilities discovered by Inspector to enforce security gates?",
          "choices": [
            {
              "id": "c2",
              "text": "Allow the build but schedule a follow-up ticket",
              "isCorrect": false,
              "explanation": "Allowing promotion undermines enforcement and risks running vulnerable code in production."
            },
            {
              "id": "c4",
              "text": "Convert vulnerabilities into user stories without blocking releases",
              "isCorrect": false,
              "explanation": "Converting to backlog items without blocking promotion fails to protect production environments."
            },
            {
              "id": "c1",
              "text": "Fail the build when high-severity vulnerabilities are found and require a remediation PR before promotion",
              "isCorrect": true,
              "explanation": "Blocking promotion of vulnerable images enforces security gates and prevents vulnerable artifacts from reaching production."
            },
            {
              "id": "c3",
              "text": "Ignore Inspector findings as false positives",
              "isCorrect": false,
              "explanation": "Blindly ignoring findings removes an important safety mechanism; investigate and triage findings appropriately."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Infrastructure Security",
          "services": [
            "Inspector",
            "Security Hub",
            "Lambda"
          ],
          "docs": "https://docs.aws.amazon.com/inspector/latest/userguide/inspector_introduction.html",
          "tip": "Enforce CI gates for critical vulnerabilities and require remediation before promotion.",
          "explanation": "Integrating Inspector into CI/CD and failing builds for critical findings reduces the chance of vulnerable artifacts reaching production and ensures remediation is required."
        },
        {
          "id": "SCS-C03-0019",
          "question": "A financial services firm must store audit logs for seven years in a manner that no user, including root, can delete or modify them before the retention period expires. Regulators require proof of immutability. Which S3 feature satisfies these requirements?",
          "choices": [
            {
              "id": "c1",
              "text": "S3 Object Lock in Compliance mode with a seven-year retention period",
              "isCorrect": true,
              "explanation": "Compliance mode prevents anyone, including the root user, from deleting or overwriting an object version until the retention date passes. This satisfies regulatory immutability requirements."
            },
            {
              "id": "c3",
              "text": "S3 Versioning with an S3 Lifecycle rule to transition objects to Glacier after 30 days",
              "isCorrect": false,
              "explanation": "Versioning preserves prior versions but does not prevent deletion of version markers. Glacier transition reduces cost but does not enforce immutability."
            },
            {
              "id": "c2",
              "text": "S3 Object Lock in Governance mode with a seven-year retention period",
              "isCorrect": false,
              "explanation": "Governance mode allows users with the s3:BypassGovernanceRetention permission to delete objects before the retention period ends, which does not meet the absolute immutability requirement."
            },
            {
              "id": "c4",
              "text": "Enable MFA Delete on the S3 bucket to require MFA for all delete operations",
              "isCorrect": false,
              "explanation": "MFA Delete requires an additional authentication step but does not make objects truly immutable. A user with MFA can still delete them at any time."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Data Protection",
          "services": [
            "S3",
            "S3 Object Lock",
            "Glacier",
            "Backup"
          ],
          "docs": "https://docs.aws.amazon.com/AmazonS3/latest/userguide/object-lock.html",
          "tip": "Compliance mode is the only S3 mechanism where even the root account cannot shorten or remove the retention lock.",
          "explanation": "S3 Object Lock Compliance mode creates a WORM (Write Once Read Many) storage model. Once set, neither the object nor its retention settings can be altered or deleted by any principal until the retention period expires, meeting SEC 17a-4(f) and similar regulatory requirements."
        },
        {
          "id": "SCS-C03-0020",
          "question": "After enabling GuardDuty S3 Protection, a security analyst notices a finding of type Policy:S3/BucketAnonymousAccessGranted for a production data bucket. The analyst needs to determine which principal changed the bucket policy and when. Which data source provides this information?",
          "choices": [
            {
              "id": "c1",
              "text": "CloudTrail management events showing the PutBucketPolicy API call",
              "isCorrect": true,
              "explanation": "CloudTrail records the identity (principal), timestamp, source IP, and request parameters for S3 control-plane API calls like PutBucketPolicy. This is the authoritative source for who changed the policy and when."
            },
            {
              "id": "c4",
              "text": "VPC Flow Logs for the VPC where the analyst is working",
              "isCorrect": false,
              "explanation": "VPC Flow Logs capture network-layer metadata (IP, port, protocol) but not API-level details like which principal called PutBucketPolicy."
            },
            {
              "id": "c2",
              "text": "The GuardDuty finding detail itself, which includes the actor and timestamp",
              "isCorrect": false,
              "explanation": "GuardDuty findings identify the affected resource and the anomaly but do not always include the full details of who made the original policy change. CloudTrail provides the definitive audit trail."
            },
            {
              "id": "c3",
              "text": "S3 server access logs for the data bucket",
              "isCorrect": false,
              "explanation": "S3 server access logs capture object-level read/write requests, not bucket policy changes. Control-plane actions like PutBucketPolicy are not recorded in access logs."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Detection",
          "services": [
            "GuardDuty",
            "CloudTrail",
            "S3",
            "Security Hub"
          ],
          "docs": "https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_s3-protection.html",
          "tip": "Distinguish between data-plane logs (S3 access logs, VPC Flow Logs) and control-plane logs (CloudTrail) when investigating policy changes.",
          "explanation": "CloudTrail management events are the single source of truth for AWS API activity. When investigating who changed a resource configuration, always start with CloudTrail, which records the IAM principal, the API action, the request parameters, and the exact timestamp."
        },
        {
          "id": "SCS-C03-0024",
          "question": "A security architect wants to continuously detect any S3 buckets, IAM roles, KMS keys, or Lambda functions that are shared with external AWS accounts or public access. The solution must generate findings automatically without requiring custom code. Which service should they enable?",
          "choices": [
            {
              "id": "c4",
              "text": "Amazon GuardDuty",
              "isCorrect": false,
              "explanation": "GuardDuty detects threats based on anomalous behaviour and threat intelligence. It does not analyze resource policies to find intentional cross-account sharing or public access grants."
            },
            {
              "id": "c1",
              "text": "IAM Access Analyzer",
              "isCorrect": true,
              "explanation": "Access Analyzer uses automated reasoning to analyze resource-based policies and identifies resources that are accessible from outside the zone of trust (account or organisation), generating findings for each."
            },
            {
              "id": "c3",
              "text": "AWS Trusted Advisor security checks",
              "isCorrect": false,
              "explanation": "Trusted Advisor checks a limited set of security best practices (e.g., open security groups, root MFA) but does not perform policy-level analysis of cross-account resource sharing."
            },
            {
              "id": "c2",
              "text": "AWS Config with the s3-bucket-public-read-prohibited managed rule",
              "isCorrect": false,
              "explanation": "This Config rule only checks S3 public read access. It does not cover cross-account sharing of IAM roles, KMS keys, or Lambda functions."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Identity and Access Management",
          "services": [
            "IAM Access Analyzer",
            "IAM",
            "S3",
            "Lambda",
            "KMS"
          ],
          "docs": "https://docs.aws.amazon.com/IAM/latest/UserGuide/access-analyzer-getting-started.html",
          "tip": "This service uses automated reasoning (formal logic) over policies, not anomaly detection or predefined compliance rules.",
          "explanation": "IAM Access Analyzer applies Zelkova-based automated reasoning to evaluate resource-based policies on S3 buckets, SQS queues, IAM roles, KMS keys, Lambda functions, and Secrets Manager secrets. It produces actionable findings whenever a policy grants access outside the defined zone of trust, with no custom code required."
        },
        {
          "id": "SCS-C03-0004",
          "question": "You're designing a system that avoids long-lived keys. Which AWS feature helps enforce least privilege by issuing temporary credentials?",
          "choices": [
            {
              "id": "c3",
              "text": "Security Groups",
              "isCorrect": false,
              "explanation": "Security Groups are network controls, not credential mechanisms."
            },
            {
              "id": "c2",
              "text": "IAM Users with long-term access keys",
              "isCorrect": false,
              "explanation": "IAM Users with long-term keys are not recommended for least-privilege patterns."
            },
            {
              "id": "c1",
              "text": "IAM Roles with STS",
              "isCorrect": true,
              "explanation": "IAM Roles with STS allow issuance of temporary credentials for short-term access."
            },
            {
              "id": "c4",
              "text": "Amazon Cognito",
              "isCorrect": false,
              "explanation": "Amazon Cognito provides user identity for apps, but the core mechanism for temporary AWS credentials is STS with roles."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Identity and Access Management",
          "services": [
            "IAM",
            "STS",
            "Cognito"
          ],
          "docs": "https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles.html",
          "tip": "Temporary credentials reduce the risk from long-lived keys.",
          "explanation": "IAM Roles combined with AWS STS issue temporary credentials that automatically expire, reducing blast radius if leaked."
        },
        {
          "id": "SCS-C03-0048",
          "question": "Which integration helps ensure container images are scanned for known vulnerabilities before deployment?",
          "choices": [
            {
              "id": "c3",
              "text": "Scan images manually once per quarter",
              "isCorrect": false,
              "explanation": "Infrequent manual scans miss new vulnerabilities discovered between scans."
            },
            {
              "id": "c1",
              "text": "Enable Inspector image scanning for ECR and fail CI on high-severity findings",
              "isCorrect": true,
              "explanation": "Inspector integrates with ECR to scan images and can be used as a gate in CI to prevent deploying vulnerable images."
            },
            {
              "id": "c2",
              "text": "Rely only on runtime detection like GuardDuty",
              "isCorrect": false,
              "explanation": "Runtime detection is useful but does not prevent vulnerable images from being deployed in the first place."
            },
            {
              "id": "c4",
              "text": "Use S3 object versioning to store old images",
              "isCorrect": false,
              "explanation": "S3 versioning stores objects but does not scan or prevent vulnerable images from running."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Infrastructure Security",
          "services": [
            "Inspector",
            "ECR",
            "Lambda"
          ],
          "docs": "https://docs.aws.amazon.com/inspector/latest/userguide/what-is-inspector.html",
          "tip": "Integrate image scanning into CI/CD and fail builds with critical findings.",
          "explanation": "Shifting vulnerability scans left (during build) reduces risk; Inspector/ECR scanning plus CI gates prevents deploying images with known critical vulnerabilities."
        },
        {
          "id": "SCS-C03-0056",
          "question": "Which mechanism should be used to automatically remediate a non-compliant resource detected by AWS Config?",
          "choices": [
            {
              "id": "c1",
              "text": "Configure AWS Config automatic remediation using an SSM Automation document",
              "isCorrect": true,
              "explanation": "Config remediation actions invoke SSM Automation documents to fix identified non-compliance automatically."
            },
            {
              "id": "c2",
              "text": "Send alerts only to email and wait for manual action",
              "isCorrect": false,
              "explanation": "Manual remediation is slower and does not meet automatic remediation requirements."
            },
            {
              "id": "c4",
              "text": "Deploy a Lambda that polls Config every 24 hours",
              "isCorrect": false,
              "explanation": "Polling is less efficient and misses near-real-time remediation compared to Config automatic remediation."
            },
            {
              "id": "c3",
              "text": "Use CloudTrail to roll back the resource change",
              "isCorrect": false,
              "explanation": "CloudTrail records events but does not perform automated remediation by itself."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Detection",
          "services": [
            "Config",
            "SSM",
            "CloudWatch"
          ],
          "docs": "https://docs.aws.amazon.com/config/latest/developerguide/remediation.html",
          "tip": "Use built-in Config remediation with SSM documents for automated fixes.",
          "explanation": "AWS Config's remediation model is designed to trigger SSM Automation documents to correct drift promptly and reliably."
        },
        {
          "id": "SCS-C03-0052",
          "question": "Which AWS feature helps simulate a principal's effective permissions to diagnose an unexpected AccessDenied?",
          "choices": [
            {
              "id": "c4",
              "text": "S3 Access Analyzer",
              "isCorrect": false,
              "explanation": "Access Analyzer inspects resource-based policies for external access, not per-principal simulation of permissions."
            },
            {
              "id": "c3",
              "text": "CloudTrail data events",
              "isCorrect": false,
              "explanation": "CloudTrail records events but does not simulate policy evaluation prior to the request."
            },
            {
              "id": "c2",
              "text": "AWS Config",
              "isCorrect": false,
              "explanation": "Config tracks resource configurations but does not simulate policy evaluation for a principal."
            },
            {
              "id": "c1",
              "text": "IAM Policy Simulator",
              "isCorrect": true,
              "explanation": "IAM Policy Simulator evaluates policies to determine whether a given action would be allowed for a principal and helps diagnose AccessDenied errors."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Identity and Access Management",
          "services": [
            "IAM",
            "Access Analyzer",
            "KMS"
          ],
          "docs": "https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies.html",
          "tip": "Use Policy Simulator to reproduce an AccessDenied scenario with the exact principal and action.",
          "explanation": "Policy Simulator can combine identity and resource policies to explain why a request was denied and recommend policy changes."
        },
        {
          "id": "SCS-C03-0035",
          "question": "A CISO wants a single dashboard that shows the organisation's compliance posture against the CIS AWS Foundations Benchmark and the AWS Foundational Security Best Practices standard, with automated checks running continuously. Findings from GuardDuty and Inspector should also appear in the same view. Which TWO steps are required? (Select TWO)",
          "choices": [
            {
              "id": "c1",
              "text": "Enable AWS Security Hub and activate the CIS and Foundational Security Best Practices security standards",
              "isCorrect": true,
              "explanation": "Security Hub provides the unified dashboard and runs automated compliance checks against the selected standards using AWS Config rules it deploys automatically."
            },
            {
              "id": "c3",
              "text": "Create a custom CloudWatch dashboard aggregating Config, GuardDuty, and Inspector metrics",
              "isCorrect": false,
              "explanation": "CloudWatch dashboards show metrics and alarms, not security findings or compliance posture. Security Hub already provides the unified finding and compliance view."
            },
            {
              "id": "c4",
              "text": "Deploy AWS Firewall Manager to enforce compliance checks across all accounts",
              "isCorrect": false,
              "explanation": "Firewall Manager manages WAF, Shield, and security group policies. It does not run CIS or Best Practices compliance checks or aggregate findings from GuardDuty and Inspector."
            },
            {
              "id": "c5",
              "text": "Manually export GuardDuty and Inspector findings to S3 and build QuickSight dashboards",
              "isCorrect": false,
              "explanation": "This creates a custom reporting pipeline but is not necessary. GuardDuty and Inspector integrate natively with Security Hub, sending findings automatically without manual export."
            },
            {
              "id": "c2",
              "text": "Ensure AWS Config is enabled with recording turned on for all supported resource types",
              "isCorrect": true,
              "explanation": "Security Hub's compliance checks depend on AWS Config rules. If Config recording is not enabled, the automated checks cannot evaluate resource configurations and will produce no findings."
            }
          ],
          "selectCount": 2,
          "format": "text",
          "domain": "Detection",
          "services": [
            "Security Hub",
            "Config",
            "GuardDuty",
            "Firewall Manager",
            "Inspector"
          ],
          "docs": "https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards.html",
          "tip": "Security Hub is the aggregation layer, but it depends on Config for compliance checks. Both must be enabled.",
          "explanation": "Security Hub serves as the central security findings hub. It runs compliance checks by deploying Config rules for each control in the enabled standards, so AWS Config must be recording. GuardDuty and Inspector automatically send findings to Security Hub when both are enabled, providing the unified dashboard the CISO needs."
        },
        {
          "id": "SCS-C03-0042",
          "question": "Which architecture most cost-effectively stores months of high-volume logs for ad-hoc forensic queries?",
          "choices": [
            {
              "id": "c1",
              "text": "Deliver logs to S3 in partitioned Parquet and query with Athena",
              "isCorrect": true,
              "explanation": "S3 + Parquet + Athena supports low-cost storage and ad-hoc querying without always-on infrastructure."
            },
            {
              "id": "c3",
              "text": "Store logs in DynamoDB single-table design",
              "isCorrect": false,
              "explanation": "DynamoDB is not cost-effective for large historical log volumes and analytics queries."
            },
            {
              "id": "c2",
              "text": "Stream logs to OpenSearch with 90-day hot storage",
              "isCorrect": false,
              "explanation": "OpenSearch is efficient for real-time searches but expensive for long-term retention at scale."
            },
            {
              "id": "c4",
              "text": "Keep logs only on instance disk for speed",
              "isCorrect": false,
              "explanation": "Instance disks are ephemeral and unsuitable for long-term forensic retention."
            }
          ],
          "selectCount": 1,
          "format": "yaml",
          "domain": "Detection",
          "services": [
            "CloudWatch Logs",
            "Athena",
            "S3"
          ],
          "docs": "https://docs.aws.amazon.com/AmazonCloudWatch/latest/logs/WhatIsCloudWatchLogs.html",
          "tip": "Partition logs and use columnar formats for cheaper queries.",
          "explanation": "Exporting log data to S3 in Parquet with partitioning reduces query scan costs and enables scalable ad-hoc analysis via Athena or Lakehouse tools."
        },
        {
          "id": "SCS-C03-0065",
          "question": "Which integration allows custom request inspection logic at the edge before forwarding to the origin?",
          "choices": [
            {
              "id": "c3",
              "text": "Only use origin-side web servers to inspect requests",
              "isCorrect": false,
              "explanation": "Origin-side inspection allows attacks to reach the origin and increases bandwidth and processing costs."
            },
            {
              "id": "c4",
              "text": "Rely on DNS-level filtering for application-layer inspection",
              "isCorrect": false,
              "explanation": "DNS filtering cannot inspect HTTP request content for application-layer threats."
            },
            {
              "id": "c1",
              "text": "Use CloudFront with Lambda@Edge (or CloudFront Functions) to run custom inspection and modify requests",
              "isCorrect": true,
              "explanation": "Lambda@Edge or CloudFront Functions can execute custom logic during request/response flows at the edge to inspect or mutate requests."
            },
            {
              "id": "c2",
              "text": "Use SQS between CloudFront and origin for inspection",
              "isCorrect": false,
              "explanation": "SQS is asynchronous and not suitable for synchronous request inspection at the edge."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Infrastructure Security",
          "services": [
            "WAF",
            "CloudFront",
            "Lambda"
          ],
          "docs": "https://docs.aws.amazon.com/waf/latest/developerguide/waf-rule-statement-type.html",
          "tip": "Use edge compute (Lambda@Edge/CloudFront Functions) for fast, custom request inspection.",
          "explanation": "Placing lightweight inspection at the edge reduces origin load and enables early mitigation of malicious requests before they traverse the network to backend systems."
        },
        {
          "id": "SCS-C03-0034",
          "question": "A media company serves video content from S3 through CloudFront. They need to ensure users cannot bypass CloudFront and access S3 directly via the bucket URL. The solution must work with SSE-KMS encrypted objects. Which approach correctly restricts S3 access to CloudFront only?",
          "choices": [
            {
              "id": "c3",
              "text": "Make the S3 bucket a website endpoint origin in CloudFront and restrict access with a Referer header condition in the bucket policy",
              "isCorrect": false,
              "explanation": "Website endpoint origins use HTTP (not the S3 API), don't support SSE-KMS, and Referer headers can be spoofed, making this both incompatible and insecure."
            },
            {
              "id": "c2",
              "text": "Create a CloudFront Origin Access Identity (OAI) and grant it read access in the S3 bucket policy",
              "isCorrect": false,
              "explanation": "OAI is the legacy approach and does not support SSE-KMS encrypted objects. CloudFront cannot forward the required SigV4 KMS headers when using OAI."
            },
            {
              "id": "c1",
              "text": "Create a CloudFront Origin Access Control (OAC) and update the S3 bucket policy to allow access only from the OAC",
              "isCorrect": true,
              "explanation": "OAC is the recommended method for restricting S3 access to CloudFront. Unlike the legacy OAI, OAC supports SSE-KMS, S3 Object Lock, and all S3 features. The bucket policy uses aws:SourceArn to allow only the specific CloudFront distribution."
            },
            {
              "id": "c4",
              "text": "Block public access on the bucket and share S3 pre-signed URLs directly with users instead of using CloudFront",
              "isCorrect": false,
              "explanation": "Pre-signed URLs bypass CloudFront entirely, losing edge caching, WAF protection, and geo-restriction capabilities. They also expose direct S3 access."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Infrastructure Security",
          "services": [
            "CloudFront",
            "S3",
            "OAC",
            "WAF"
          ],
          "docs": "https://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/private-content-restricting-access-to-s3.html",
          "tip": "OAC replaced OAI and is required for SSE-KMS, S3 Object Lock, and other modern S3 features.",
          "explanation": "Origin Access Control (OAC) uses SigV4-signed requests from CloudFront to S3, which supports all S3 encryption modes including SSE-KMS. The S3 bucket policy can use the Condition key aws:SourceArn to restrict access to a specific CloudFront distribution ARN, ensuring no direct S3 access is possible."
        },
        {
          "id": "SCS-C03-0058",
          "question": "To rate-limit abusive clients at the edge while preserving legitimate traffic, which feature combination should be used?",
          "choices": [
            {
              "id": "c3",
              "text": "Increase origin instance capacity",
              "isCorrect": false,
              "explanation": "Scaling origin capacity doesn't stop abusive traffic or reduce edge processing cost."
            },
            {
              "id": "c4",
              "text": "Use Route 53 geolocation routing only",
              "isCorrect": false,
              "explanation": "Geolocation routing doesn't provide rate-limiting or application-layer filtering."
            },
            {
              "id": "c2",
              "text": "NACL rules to block IP ranges",
              "isCorrect": false,
              "explanation": "NACLs are coarse-grained and do not provide application-layer rate limiting."
            },
            {
              "id": "c1",
              "text": "AWS WAF rate-based rules on CloudFront with CloudFront caching",
              "isCorrect": true,
              "explanation": "WAF rate-based rules block clients over request thresholds while CloudFront caching reduces backend load for legitimate traffic."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Infrastructure Security",
          "services": [
            "ALB",
            "WAF",
            "Route 53"
          ],
          "docs": "https://docs.aws.amazon.com/elasticloadbalancing/latest/application/listener-update-rule.html",
          "tip": "Implement WAF rate rules at CloudFront for cost-effective edge rate-limiting.",
          "explanation": "WAF's rate-based rules applied at CloudFront prevent abusive clients from reaching origin and, combined with caching, protect backend capacity."
        },
        {
          "id": "SCS-C03-0025",
          "question": "A Lambda function in a private subnet needs to call the Secrets Manager API to retrieve database credentials. The security team prohibits all internet-bound traffic from the VPC. How should the architect configure network access so the Lambda function can reach Secrets Manager without traversing the internet?",
          "choices": [
            {
              "id": "c2",
              "text": "Add a NAT Gateway to the VPC and route the Lambda subnet's traffic through it",
              "isCorrect": false,
              "explanation": "A NAT Gateway provides internet access for outbound traffic, which violates the security team's prohibition on internet-bound traffic from the VPC."
            },
            {
              "id": "c3",
              "text": "Attach an Elastic IP to the Lambda function's ENI for direct outbound access",
              "isCorrect": false,
              "explanation": "Lambda functions in a VPC do not support Elastic IPs, and this approach would use the internet gateway, which is prohibited."
            },
            {
              "id": "c1",
              "text": "Create an interface VPC endpoint (PrivateLink) for Secrets Manager in the same VPC and ensure the Lambda function's security group allows outbound HTTPS to the endpoint",
              "isCorrect": true,
              "explanation": "An interface VPC endpoint creates private ENIs within the VPC that route traffic to the Secrets Manager API entirely over the AWS private network, with no internet path required."
            },
            {
              "id": "c4",
              "text": "Configure the Lambda function outside the VPC so it can access Secrets Manager over the internet by default",
              "isCorrect": false,
              "explanation": "Placing the function outside the VPC gives it internet access to AWS APIs, but the question states the function is in a private subnet, and moving it out may break access to other VPC resources like the database."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Infrastructure Security",
          "services": [
            "Lambda",
            "VPC",
            "NAT Gateway",
            "PrivateLink",
            "Secrets Manager"
          ],
          "docs": "https://docs.aws.amazon.com/lambda/latest/dg/configuration-vpc.html",
          "tip": "When internet access is prohibited, PrivateLink endpoints bring AWS service APIs into the VPC over private connections.",
          "explanation": "Interface VPC endpoints (powered by AWS PrivateLink) create private IP addresses inside the VPC that serve as entry points for AWS service APIs. Traffic never leaves the AWS network, satisfying zero-internet-egress security requirements while allowing Lambda to call Secrets Manager."
        },
        {
          "id": "SCS-C03-0057",
          "question": "Which approach supports zero-downtime TLS certificate renewal for multiple subdomains?",
          "choices": [
            {
              "id": "c4",
              "text": "Disable TLS and rely on internal network controls",
              "isCorrect": false,
              "explanation": "TLS should be used; ACM simplifies automated renewals."
            },
            {
              "id": "c3",
              "text": "Use a wildcard cert imported into each instance",
              "isCorrect": false,
              "explanation": "Importing certificates to instances complicates automation and rotation compared to ACM."
            },
            {
              "id": "c1",
              "text": "Use ACM certificates with DNS validation and attach to ALB listeners",
              "isCorrect": true,
              "explanation": "ACM issues public certificates that renew automatically when DNS validation is used; ALB integration ensures rotation without downtime."
            },
            {
              "id": "c2",
              "text": "Use self-signed certs rotated manually via SSH",
              "isCorrect": false,
              "explanation": "Manual self-signed rotation risks downtime and trust issues."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Data Protection",
          "services": [
            "ACM",
            "Route 53",
            "ALB"
          ],
          "docs": "https://docs.aws.amazon.com/acm/latest/userguide/acm-certificate.html",
          "tip": "Prefer ACM with DNS validation for automatic renewals.",
          "explanation": "ACM manages the lifecycle of certificates it issues and integrates with ALB/CloudFront to rotate certificates transparently."
        },
        {
          "id": "SCS-C03-0043",
          "question": "Which approach automates security posture checks across new accounts automatically?",
          "choices": [
            {
              "id": "c1",
              "text": "Use Organizations with SCPs and automated Config conformance packs deployed on account creation",
              "isCorrect": true,
              "explanation": "Combining Organizations lifecycle hooks with automated Config conformance packs provides automatic posture checks for new accounts."
            },
            {
              "id": "c2",
              "text": "Require each team to run a manual checklist during onboarding",
              "isCorrect": false,
              "explanation": "Manual checklists are error-prone and do not scale automatically for many accounts."
            },
            {
              "id": "c3",
              "text": "Use S3 replication to copy Templates across accounts",
              "isCorrect": false,
              "explanation": "S3 replication doesn't enforce security posture or run automated assessments."
            },
            {
              "id": "c4",
              "text": "Rely on Control Tower alone without additional automation",
              "isCorrect": false,
              "explanation": "Control Tower helps but combining it with conformance packs and automated policies gives stronger, automated checks."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Detection",
          "services": [
            "Organizations",
            "IAM",
            "SCPs"
          ],
          "docs": "https://docs.aws.amazon.com/organizations/latest/userguide/orgs_manage_policies_scps.html",
          "tip": "Automate posture checks at account provisioning time.",
          "explanation": "Provisioning-time automation that deploys Config rules/conformance packs along with SCP guardrails ensures new accounts meet baseline security posture automatically."
        },
        {
          "id": "SCS-C03-0005",
          "question": "You've been asked to centralise key management for data-at-rest across services. Which AWS service provides managed encryption keys for this purpose?",
          "choices": [
            {
              "id": "c2",
              "text": "AWS IAM",
              "isCorrect": false,
              "explanation": "AWS IAM handles identity and permissions, not key storage or encryption primitives."
            },
            {
              "id": "c3",
              "text": "AWS Shield",
              "isCorrect": false,
              "explanation": "AWS Shield protects against DDoS attacks, not key management."
            },
            {
              "id": "c4",
              "text": "AWS WAF",
              "isCorrect": false,
              "explanation": "AWS WAF is a web application firewall, not key management."
            },
            {
              "id": "c1",
              "text": "AWS KMS",
              "isCorrect": true,
              "explanation": "AWS KMS is the managed service for creating and controlling encryption keys."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Data Protection",
          "services": [
            "KMS",
            "IAM",
            "Shield",
            "WAF"
          ],
          "docs": "https://docs.aws.amazon.com/kms/latest/developerguide/overview.html",
          "tip": "Key management service with envelope encryption support.",
          "explanation": "AWS KMS provides centralized creation, rotation, and access control of encryption keys used to protect data at rest across services like S3, EBS, and RDS."
        },
        {
          "id": "SCS-C03-0007",
          "question": "You're locking down access so an IAM role can only reach an S3 bucket via a specific VPC endpoint. Which condition should you add to the policy to enforce this?",
          "choices": [
            {
              "id": "c2",
              "text": "{\"Condition\": {\"IpAddress\": {\"aws:SourceIp\": \"10.0.0.0/16\"}}}",
              "isCorrect": false,
              "explanation": "IpAddress/SourceIp restricts by IP range, not by VPC endpoint identity."
            },
            {
              "id": "c3",
              "text": "Add the VPC endpoint ID to the IAM role's trust policy as a Principal",
              "isCorrect": false,
              "explanation": "VPC endpoints are not IAM principals and cannot appear in a trust policy's Principal element."
            },
            {
              "id": "c4",
              "text": "Attach a security group to the IAM role that only allows traffic from the VPC",
              "isCorrect": false,
              "explanation": "Security groups are network-level controls for ENIs - they cannot be attached to IAM roles."
            },
            {
              "id": "c1",
              "text": "{\"Condition\": {\"StringEquals\": {\"aws:sourceVpce\": \"vpce-certshack123\"}}}",
              "isCorrect": true,
              "explanation": "aws:sourceVpce condition restricts the policy to requests through the specified VPC endpoint."
            }
          ],
          "selectCount": 1,
          "format": "json",
          "domain": "Identity and Access Management",
          "services": [
            "IAM",
            "S3"
          ],
          "docs": "https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies.html",
          "tip": "VPC endpoint restrictions in IAM use the aws:sourceVpce condition key with StringEquals.",
          "explanation": "The aws:sourceVpce condition key with StringEquals restricts access to requests that traverse a specific VPC endpoint."
        },
        {
          "id": "SCS-C03-0041",
          "question": "When sizing monitoring for a high-throughput API, which combination of metrics should inform your alarm thresholds for availability and performance?",
          "choices": [
            {
              "id": "c3",
              "text": "Number of open TCP connections to the VPC",
              "isCorrect": false,
              "explanation": "TCP connection counts may be noisy and do not directly indicate application-level errors or latency."
            },
            {
              "id": "c4",
              "text": "S3 bucket size growth",
              "isCorrect": false,
              "explanation": "S3 growth is unrelated to API availability metrics for request handling."
            },
            {
              "id": "c2",
              "text": "Only CPU utilization across EC2 instances",
              "isCorrect": false,
              "explanation": "CPU is useful but insufficient alone to detect request-level failures or latency spikes."
            },
            {
              "id": "c1",
              "text": "Request count, 5xx error rate, and latency percentiles",
              "isCorrect": true,
              "explanation": "Combining request volume, error rates and latency percentiles gives a balanced view of availability and performance under load."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Detection",
          "services": [
            "CloudWatch",
            "CloudWatch Logs",
            "SNS"
          ],
          "docs": "https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/monitoring-overview.html",
          "tip": "Combine volume, errors, and latency percentiles for robust thresholds.",
          "explanation": "A monitoring strategy should include throughput (request count), error rates (5xx), and latency percentiles (p95/p99) to detect degradation under load and trigger appropriate alerts."
        },
        {
          "id": "SCS-C03-0053",
          "question": "Which strategy enables workload access policies that scale with many teams and dynamic resources in AWS?",
          "choices": [
            {
              "id": "c4",
              "text": "Rely solely on VPC-level security groups for access control",
              "isCorrect": false,
              "explanation": "Security groups operate at network level, not at identity/attribute level."
            },
            {
              "id": "c1",
              "text": "Use ABAC with tags to grant permissions based on attributes such as department or environment",
              "isCorrect": true,
              "explanation": "ABAC provides scalable, attribute-based permissions without creating many static IAM policies per resource."
            },
            {
              "id": "c2",
              "text": "Create a single monolithic admin role for all teams",
              "isCorrect": false,
              "explanation": "Monolithic roles violate least privilege and do not scale well."
            },
            {
              "id": "c3",
              "text": "Hardcode permissions into application config files",
              "isCorrect": false,
              "explanation": "Hardcoding is insecure and prevents centralized management and auditing."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Identity and Access Management",
          "services": [
            "EKS",
            "IAM",
            "KMS"
          ],
          "docs": "https://docs.aws.amazon.com/eks/latest/userguide/security_iam.html",
          "tip": "Use tags and ABAC for dynamic, scalable permission models.",
          "explanation": "ABAC allows policies to reference resource or principal tags, reducing policy proliferation while enabling fine-grained access control aligned to organizational attributes."
        },
        {
          "id": "SCS-C03-0026",
          "question": "A company with 50 AWS accounts wants to enforce a baseline set of preventive and detective security controls (e.g., disallow public S3 buckets, require CloudTrail in all regions) across all accounts. They need a managed landing zone that automatically applies these controls to new accounts as they are created. Which service provides this capability?",
          "choices": [
            {
              "id": "c3",
              "text": "AWS Security Hub with the AWS Foundational Security Best Practices standard",
              "isCorrect": false,
              "explanation": "Security Hub detects deviations from best practices (detective) but does not prevent them (preventive). It also does not provision or manage accounts or landing zones."
            },
            {
              "id": "c4",
              "text": "AWS Trusted Advisor organisational view",
              "isCorrect": false,
              "explanation": "Trusted Advisor provides recommendations and checks but does not enforce controls or manage account provisioning or landing zones."
            },
            {
              "id": "c1",
              "text": "AWS Control Tower with mandatory and elective guardrails",
              "isCorrect": true,
              "explanation": "Control Tower provides a managed landing zone with pre-configured guardrails (implemented as SCPs for preventive controls and Config rules for detective controls) that are automatically applied to accounts enrolled in the landing zone."
            },
            {
              "id": "c2",
              "text": "AWS Organizations with manually written SCPs and Config rules deployed via StackSets",
              "isCorrect": false,
              "explanation": "This approach works but requires manual authoring, testing, and deployment of each control. Control Tower automates this with curated, pre-tested guardrails and handles new-account enrollment automatically."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Identity and Access Management",
          "services": [
            "Control Tower",
            "Organizations",
            "Config",
            "CloudFormation"
          ],
          "docs": "https://docs.aws.amazon.com/controltower/latest/userguide/guardrails.html",
          "tip": "The key phrase is 'managed landing zone' with automatic enforcement on new accounts, which points to a specific governance service.",
          "explanation": "Control Tower orchestrates Organizations, Config, CloudFormation, and IAM Identity Center to create a governed multi-account environment. Its guardrails are curated controls that are automatically enforced (preventive via SCPs) or monitored (detective via Config rules) across all enrolled accounts, including newly created ones."
        },
        {
          "id": "SCS-C03-0061",
          "question": "Which solution ensures centralized, policy-driven backups across RDS and EFS with retention controls?",
          "choices": [
            {
              "id": "c4",
              "text": "Rely on EC2 AMI snapshots for database backups",
              "isCorrect": false,
              "explanation": "AMI snapshots are not suitable for database-consistent backups across services without application-level coordination."
            },
            {
              "id": "c2",
              "text": "Create per-service scripts to snapshot data and copy to S3",
              "isCorrect": false,
              "explanation": "Custom scripts lack centralized policy management and consistent retention enforcement."
            },
            {
              "id": "c1",
              "text": "Use AWS Backup with backup plans and vaults to centrally manage backups and retention",
              "isCorrect": true,
              "explanation": "AWS Backup centralizes backups across supported services and enforces retention and lifecycle rules via backup plans and vaults."
            },
            {
              "id": "c3",
              "text": "Use cross-region replication for S3 only",
              "isCorrect": false,
              "explanation": "S3 replication is specific to S3 and doesn't manage backups for other services like RDS/EFS."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Data Protection",
          "services": [
            "AWS Backup",
            "RDS",
            "S3"
          ],
          "docs": "https://docs.aws.amazon.com/backup/latest/devguide/whatisbackup.html",
          "tip": "Use AWS Backup for consistent, policy-driven backup management across services.",
          "explanation": "AWS Backup simplifies centralized backup orchestration, retention policies, and cross-account/cross-region copy workflows for supported AWS resources."
        },
        {
          "id": "SCS-C03-0015",
          "question": "A security team needs to provide shell access to EC2 instances in private subnets without opening SSH ports or managing bastion hosts, while maintaining a full audit trail of every command executed. Which solution meets these requirements?",
          "choices": [
            {
              "id": "c1",
              "text": "Systems Manager Session Manager",
              "isCorrect": true,
              "explanation": "Session Manager establishes encrypted sessions through the SSM agent without opening inbound ports and can log sessions to S3 or CloudWatch Logs."
            },
            {
              "id": "c2",
              "text": "Deploy a bastion host with SSH key-based authentication",
              "isCorrect": false,
              "explanation": "Bastion hosts require open SSH ports and add operational burden."
            },
            {
              "id": "c4",
              "text": "VPN to the private subnet and SSH",
              "isCorrect": false,
              "explanation": "VPN plus SSH captures metadata but not command-level audit content."
            },
            {
              "id": "c3",
              "text": "EC2 Instance Connect",
              "isCorrect": false,
              "explanation": "Instance Connect still requires port 22 and does not natively log full session content."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Infrastructure Security",
          "services": [
            "Systems Manager",
            "EC2",
            "IAM",
            "CloudTrail"
          ],
          "docs": "https://docs.aws.amazon.com/systems-manager/latest/userguide/session-manager.html",
          "tip": "Look for a service that provides shell access through an agent, not through network-level connectivity.",
          "explanation": "Session Manager uses the SSM agent to create encrypted, IAM-authenticated sessions without inbound security group rules and logs session output for auditing."
        },
        {
          "id": "SCS-C03-0047",
          "question": "Which practice grants least-privilege permissions to pods running in EKS for accessing AWS APIs?",
          "choices": [
            {
              "id": "c4",
              "text": "Store AWS keys in pod environment variables at build time",
              "isCorrect": false,
              "explanation": "Hard-coding keys in images is insecure and prevents rotation."
            },
            {
              "id": "c1",
              "text": "Use IRSA (IAM Roles for Service Accounts) to map service accounts to IAM roles with narrow permissions",
              "isCorrect": true,
              "explanation": "IRSA ties an IAM role to a Kubernetes service account, allowing fine-grained, pod-level permissions."
            },
            {
              "id": "c3",
              "text": "Use instance metadata to share credentials across pods",
              "isCorrect": false,
              "explanation": "Instance metadata exposes node credentials and is not recommended for per-pod least-privilege."
            },
            {
              "id": "c2",
              "text": "Attach a broad IAM role to all worker nodes",
              "isCorrect": false,
              "explanation": "Node roles provide host-level permissions and risk privilege escalation from any pod to node-level permissions."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Identity and Access Management",
          "services": [
            "EKS",
            "IAM",
            "STS"
          ],
          "docs": "https://docs.aws.amazon.com/eks/latest/userguide/iam-roles-for-service-accounts.html",
          "tip": "Prefer IRSA for narrow, auditable pod permissions.",
          "explanation": "IRSA provides workload identity that limits permissions to the specific service account and namespace, reducing blast radius and improving auditability."
        },
        {
          "id": "SCS-C03-0044",
          "question": "Which log sources are most relevant when troubleshooting intermittent 502 responses from an ALB?",
          "choices": [
            {
              "id": "c4",
              "text": "IAM access logs",
              "isCorrect": false,
              "explanation": "IAM logs are unrelated to HTTP 502 responses."
            },
            {
              "id": "c1",
              "text": "ALB access logs, target group health checks, and CloudWatch metrics for targets",
              "isCorrect": true,
              "explanation": "ALB access logs show request/response details; target health and metrics reveal backend errors that cause 502s."
            },
            {
              "id": "c3",
              "text": "Route 53 DNS query logs",
              "isCorrect": false,
              "explanation": "DNS logs don't provide HTTP backend error details."
            },
            {
              "id": "c2",
              "text": "S3 server access logs only",
              "isCorrect": false,
              "explanation": "S3 logs are irrelevant to ALB 502s unless the origin is S3, which is uncommon for dynamic backends."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Detection",
          "services": [
            "ALB",
            "Target Groups",
            "Auto Scaling"
          ],
          "docs": "https://docs.aws.amazon.com/elasticloadbalancing/latest/application/load-balancer-target-groups.html",
          "tip": "Correlate ALB access logs with target health checks and backend metrics.",
          "explanation": "Investigations into 502 errors should include ALB access logs (to see upstream responses), backend target health and metrics (to spot crashes), and application logs where possible."
        },
        {
          "id": "SCS-C03-0028",
          "question": "A data engineering team needs their Lambda function to decrypt objects in an S3 bucket that uses SSE-KMS with a customer-managed key. The function's execution role has s3:GetObject permission. Decryption attempts fail with AccessDeniedException from KMS. Which key policy statement, added to the CMK, resolves this?",
          "choices": [
            {
              "id": "c1",
              "text": "{\"Sid\":\"AllowLambdaDecrypt\",\"Effect\":\"Allow\",\"Principal\":{\"AWS\":\"arn:aws:iam::123456789012:role/lambda-exec-role\"},\"Action\":[\"kms:Decrypt\",\"kms:DescribeKey\"],\"Resource\":\"*\"}",
              "isCorrect": true,
              "explanation": "The Lambda execution role needs kms:Decrypt (to decrypt the data key protecting the S3 object) and kms:DescribeKey (to validate the key). The key policy must explicitly grant these actions to the role's ARN."
            },
            {
              "id": "c4",
              "text": "Change the bucket encryption from SSE-KMS to SSE-S3 to avoid the KMS dependency",
              "isCorrect": false,
              "explanation": "Switching to SSE-S3 would eliminate the error, but it removes the ability to control access through KMS key policies, audit key usage via CloudTrail, and use customer-managed key rotation, which may be required by policy."
            },
            {
              "id": "c3",
              "text": "Add kms:Decrypt to the Lambda execution role's IAM policy without changing the key policy",
              "isCorrect": false,
              "explanation": "For customer-managed KMS keys, both the key policy AND the IAM policy must allow the action. If the key policy does not grant access to the principal, the IAM policy alone is insufficient."
            },
            {
              "id": "c2",
              "text": "{\"Sid\":\"AllowLambdaDecrypt\",\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"lambda.amazonaws.com\"},\"Action\":[\"kms:Decrypt\"],\"Resource\":\"*\"}",
              "isCorrect": false,
              "explanation": "KMS key policies should grant permissions to the IAM role, not to the Lambda service principal. The service principal is used in trust policies, not key policies."
            }
          ],
          "selectCount": 1,
          "format": "json",
          "domain": "Data Protection",
          "services": [
            "KMS",
            "IAM",
            "S3",
            "Lambda"
          ],
          "docs": "https://docs.aws.amazon.com/kms/latest/developerguide/key-policy-modifying.html",
          "tip": "With customer-managed KMS keys, access requires permission in both the key policy and the caller's IAM policy. The key policy is the primary gatekeeper.",
          "explanation": "Customer-managed KMS keys use a resource-based policy (key policy) that must explicitly allow principals to perform cryptographic operations. Unlike AWS-managed keys, there is no automatic cross-grant. Both the key policy and the IAM policy on the caller must allow the action for it to succeed."
        },
        {
          "id": "SCS-C03-0018",
          "question": "A company runs workloads on Amazon EKS and needs each Kubernetes pod to assume a unique IAM role with fine-grained permissions. The trust policy must ensure only the intended service account in a specific namespace can assume the role. Which trust policy snippet correctly restricts role assumption to the pod's OIDC identity?",
          "choices": [
            {
              "id": "c4",
              "text": "{\"Effect\":\"Allow\",\"Principal\":{\"Federated\":\"cognito-identity.amazonaws.com\"},\"Action\":\"sts:AssumeRoleWithWebIdentity\"}",
              "isCorrect": false,
              "explanation": "Cognito Identity is for end-user identity federation, not Kubernetes workload identity. EKS uses its own OIDC provider endpoint."
            },
            {
              "id": "c1",
              "text": "{\"Effect\":\"Allow\",\"Principal\":{\"Federated\":\"arn:aws:iam::123456789012:oidc-provider/oidc.eks.us-east-1.amazonaws.com/id/EXAMPLED539D4633E53DE1B71EXAMPLE\"},\"Action\":\"sts:AssumeRoleWithWebIdentity\",\"Condition\":{\"StringEquals\":{\"oidc.eks.us-east-1.amazonaws.com/id/EXAMPLED539D4633E53DE1B71EXAMPLE:sub\":\"system:serviceaccount:app-ns:app-sa\"}}}",
              "isCorrect": true,
              "explanation": "This uses the EKS OIDC provider as a Federated principal with AssumeRoleWithWebIdentity, and the Condition restricts the sub claim to the exact namespace:serviceaccount pair."
            },
            {
              "id": "c3",
              "text": "{\"Effect\":\"Allow\",\"Principal\":{\"AWS\":\"arn:aws:iam::123456789012:role/eks-node-role\"},\"Action\":\"sts:AssumeRole\"}",
              "isCorrect": false,
              "explanation": "Trusting the node role lets every pod on that node assume this role, eliminating per-pod isolation."
            },
            {
              "id": "c2",
              "text": "{\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"eks.amazonaws.com\"},\"Action\":\"sts:AssumeRole\"}",
              "isCorrect": false,
              "explanation": "This trusts the EKS service itself (the control plane), not individual pod identities. Any EKS-managed component could assume this role, not just the intended pod."
            }
          ],
          "selectCount": 1,
          "format": "json",
          "domain": "Identity and Access Management",
          "services": [
            "IAM",
            "STS",
            "Cognito",
            "EKS"
          ],
          "docs": "https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_providers_oidc.html",
          "tip": "EKS IRSA (IAM Roles for Service Accounts) uses the cluster's OIDC provider URL as a federated principal and filters by the sub claim.",
          "explanation": "IRSA projects a signed OIDC token into each pod, and the trust policy uses the cluster OIDC provider as a Federated principal with a Condition on the sub claim (namespace:serviceaccount). This ensures only the precise service account in the correct namespace can assume the role."
        },
        {
          "id": "SCS-C03-0009",
          "question": "As a data steward you need to automatically find and classify PII across hundreds of S3 buckets. Which AWS service is built for that task?",
          "choices": [
            {
              "id": "c4",
              "text": "AWS Trusted Advisor",
              "isCorrect": false,
              "explanation": "Trusted Advisor provides account-level checks like open security groups, but does not scan S3 object contents."
            },
            {
              "id": "c2",
              "text": "Amazon GuardDuty",
              "isCorrect": false,
              "explanation": "GuardDuty detects threats like unusual API calls to S3 but does not inspect object contents for sensitive data."
            },
            {
              "id": "c1",
              "text": "Amazon Macie",
              "isCorrect": true,
              "explanation": "Macie scans S3 objects for PII, financial data, and credentials using ML-powered classifiers and managed data identifiers."
            },
            {
              "id": "c3",
              "text": "Amazon Inspector",
              "isCorrect": false,
              "explanation": "Inspector focuses on vulnerability scanning for compute workloads, not data classification in S3."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Data Protection",
          "services": [
            "Macie",
            "GuardDuty",
            "Inspector",
            "Trusted Advisor"
          ],
          "docs": "https://docs.aws.amazon.com/macie/latest/user/what-is-macie.html",
          "tip": "This service is purpose-built for finding sensitive data like credit card numbers and passport IDs inside S3 objects.",
          "explanation": "Amazon Macie is designed to scan S3 objects and classify sensitive content such as PII and PHI using managed data identifiers."
        },
        {
          "id": "SCS-C03-0040",
          "question": "Which combination of practices best secures the AWS account root user while preserving necessary break-glass access?",
          "choices": [
            {
              "id": "c3",
              "text": "Remove MFA and rely on a complex password rotated monthly",
              "isCorrect": false,
              "explanation": "Removing MFA weakens security; passwords alone are insufficient for strong break-glass protections."
            },
            {
              "id": "c1",
              "text": "Enable MFA on the root account, store credentials in a secure offline vault, and use IAM administrative roles for daily operations",
              "isCorrect": true,
              "explanation": "Enforcing MFA, securing root credentials offline, and delegating daily administrative tasks to IAM roles minimizes root usage while preserving a secured break-glass path."
            },
            {
              "id": "c4",
              "text": "Keep root access enabled for all admins but log usage to CloudTrail",
              "isCorrect": false,
              "explanation": "Allowing easy root access contradicts best practices even if logged; the preferred pattern is delegation and protected root credentials."
            },
            {
              "id": "c2",
              "text": "Share root credentials with the security team to ensure quick access during incidents",
              "isCorrect": false,
              "explanation": "Sharing root credentials increases blast radius and is contrary to least-privilege practices."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Security Foundations and Governance",
          "services": [
            "IAM",
            "Organizations",
            "Secrets Manager"
          ],
          "docs": "https://docs.aws.amazon.com/IAM/latest/UserGuide/id_root-user.html",
          "tip": "Minimize root use: enable MFA, protect credentials offline, and use IAM roles for day-to-day admin tasks.",
          "explanation": "AWS recommends enabling MFA on the root account, storing root credentials securely (e.g., an offline vault with restricted access), and using IAM roles and delegated administration for routine tasks to reduce risk and provide an auditable break-glass process."
        },
        {
          "id": "SCS-C03-0051",
          "question": "For secure, performant connectivity between on-premises and multiple AWS regions, which architecture is recommended?",
          "choices": [
            {
              "id": "c2",
              "text": "Create individual Site-to-Site VPNs from on-prem to each VPC",
              "isCorrect": false,
              "explanation": "Multiple VPNs increase operational overhead and complexity for multi-region connectivity."
            },
            {
              "id": "c3",
              "text": "Rely on internet-based VPNs only",
              "isCorrect": false,
              "explanation": "Internet VPNs may not meet performance and security requirements compared to Direct Connect."
            },
            {
              "id": "c4",
              "text": "Use S3 transfer acceleration for VPC connectivity",
              "isCorrect": false,
              "explanation": "S3 Transfer Acceleration is for object transfers and not a network topology solution."
            },
            {
              "id": "c1",
              "text": "Use AWS Transit Gateway in each region with Direct Connect and Transit Gateway inter-region peering",
              "isCorrect": true,
              "explanation": "Transit Gateway with Direct Connect and inter-region peering reduces management complexity and centralizes routing at scale."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Infrastructure Security",
          "services": [
            "VPC",
            "Transit Gateway",
            "VPN"
          ],
          "docs": "https://docs.aws.amazon.com/vpc/latest/userguide/what-is-amazon-vpc.html",
          "tip": "Use Transit Gateway + Direct Connect for scalable multi-region hybrid networking.",
          "explanation": "Transit Gateway simplifies routing between many VPCs and on-premises, and Direct Connect improves performance and security over internet VPNs."
        },
        {
          "id": "SCS-C03-0008",
          "question": "You want AWS Config to spot S3 buckets with public read access automatically which CloudFormation snippet defines the correct managed Config rule?",
          "choices": [
            {
              "id": "c1",
              "text": "Type: AWS::Config::ConfigRule\nProperties:\n  ConfigRuleName: s3-bucket-public-read-prohibited\n  Source:\n    Owner: AWS\n    SourceIdentifier: S3_BUCKET_PUBLIC_READ_PROHIBITED",
              "isCorrect": true,
              "explanation": "AWS managed Config rule using Owner: AWS and the standard S3 public read detection identifier."
            },
            {
              "id": "c3",
              "text": "Use AWS CloudTrail to monitor S3:GetBucketPolicy API calls and alert when public access is detected",
              "isCorrect": false,
              "explanation": "CloudTrail monitors API calls but does not provide continuous compliance evaluation like AWS Config."
            },
            {
              "id": "c2",
              "text": "Type: AWS::Config::ConfigRule\nProperties:\n  ConfigRuleName: s3-bucket-public-read-prohibited\n  Source:\n    Owner: CUSTOM\n    SourceIdentifier: S3_BUCKET_PUBLIC_READ_PROHIBITED",
              "isCorrect": false,
              "explanation": "Owner: CUSTOM is for custom rules backed by Lambda functions, not AWS managed rules."
            },
            {
              "id": "c4",
              "text": "Enable S3 Block Public Access at the account level - this replaces the need for Config rules",
              "isCorrect": false,
              "explanation": "Block Public Access is preventive - it does not detect existing violations like a Config rule does."
            }
          ],
          "selectCount": 1,
          "format": "yaml",
          "domain": "Detection",
          "services": [
            "Config",
            "CloudFormation",
            "S3"
          ],
          "docs": "https://docs.aws.amazon.com/config/latest/developerguide/WhatIsConfig.html",
          "tip": "AWS Config managed rules use Owner: AWS with a predefined SourceIdentifier.",
          "explanation": "AWS Config managed rules are pre-built by AWS and referenced with Owner: AWS plus a SourceIdentifier like S3_BUCKET_PUBLIC_READ_PROHIBITED."
        },
        {
          "id": "SCS-C03-0017",
          "question": "A network security team must capture all accepted and rejected traffic metadata for forensic analysis across 200 VPCs in a multi-account organisation. They need to query weeks of historical data on demand without maintaining always-on infrastructure. Which architecture meets these requirements most cost-effectively?",
          "choices": [
            {
              "id": "c4",
              "text": "Enable Traffic Mirroring on all ENIs and capture full packets for analysis",
              "isCorrect": false,
              "explanation": "Traffic Mirroring captures full packet payloads, which is vastly more data than flow log metadata, increasing costs dramatically and exceeding what the team requested."
            },
            {
              "id": "c3",
              "text": "Stream Flow Logs to an Amazon OpenSearch cluster for real-time dashboards and historical search",
              "isCorrect": false,
              "explanation": "OpenSearch provides powerful search but requires always-on cluster infrastructure, violating the no-maintained-infrastructure requirement and increasing cost."
            },
            {
              "id": "c2",
              "text": "Send VPC Flow Logs to CloudWatch Logs in each account and use CloudWatch Logs Insights for queries",
              "isCorrect": false,
              "explanation": "CloudWatch Logs Insights works well for recent data but becomes expensive at high volume over weeks, and cross-account querying adds operational complexity compared to a centralised S3 approach."
            },
            {
              "id": "c1",
              "text": "Publish VPC Flow Logs to a centralised S3 bucket in the security account and query with Amazon Athena",
              "isCorrect": true,
              "explanation": "S3 storage is inexpensive at scale, and Athena provides serverless on-demand querying with no infrastructure to manage. Flow Logs support direct S3 delivery across accounts via resource policies."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Detection",
          "services": [
            "VPC Flow Logs",
            "CloudWatch Logs",
            "S3",
            "Athena"
          ],
          "docs": "https://docs.aws.amazon.com/vpc/latest/userguide/flow-logs.html",
          "tip": "For high-volume, infrequently-queried log data, think serverless query engines over managed log databases.",
          "explanation": "VPC Flow Logs can deliver directly to S3 in Parquet format with Hive-compatible partitioning, and Athena charges only per query scanned. This combination handles cross-account aggregation at scale without provisioning or maintaining any infrastructure."
        },
        {
          "id": "SCS-C03-0059",
          "question": "For workforce single sign-on with centralized permission sets, which service provides identity federation and permission management?",
          "choices": [
            {
              "id": "c3",
              "text": "Use local OS accounts on bastion hosts",
              "isCorrect": false,
              "explanation": "Local accounts are not centralized or scalable for enterprise SSO needs."
            },
            {
              "id": "c1",
              "text": "IAM Identity Center (AWS SSO)",
              "isCorrect": true,
              "explanation": "IAM Identity Center provides SSO and centralized permission set management for workforce identities."
            },
            {
              "id": "c4",
              "text": "Use API keys stored in S3 for employees",
              "isCorrect": false,
              "explanation": "API keys are for programmatic access and not suitable for workforce SSO."
            },
            {
              "id": "c2",
              "text": "Create IAM Users for each employee",
              "isCorrect": false,
              "explanation": "IAM Users are not ideal for large-scale workforce SSO and federation scenarios."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Identity and Access Management",
          "services": [
            "IAM",
            "IAM Identity Center"
          ],
          "docs": "https://docs.aws.amazon.com/iam/latest/UserGuide/id_users_create.html",
          "tip": "Use IAM Identity Center for centralized SSO and permission sets.",
          "explanation": "IAM Identity Center integrates with external IdPs and maps users to AWS permission sets, simplifying enterprise SSO and access management."
        },
        {
          "id": "SCS-C03-0055",
          "question": "Which pattern centralizes billing, consolidated policies, and delegated security administration across many accounts?",
          "choices": [
            {
              "id": "c3",
              "text": "Use a single shared AWS account for all teams",
              "isCorrect": false,
              "explanation": "A single account lacks isolation and governance for multiple teams or environments."
            },
            {
              "id": "c2",
              "text": "Manage each account independently with separate billing",
              "isCorrect": false,
              "explanation": "Independent accounts increase operational overhead and hinder centralized policy enforcement."
            },
            {
              "id": "c1",
              "text": "Use AWS Organizations with an organizational management account, OUs for environment separation, and delegated admin roles",
              "isCorrect": true,
              "explanation": "Organizations centralize management, apply SCPs, and enable delegated admin accounts for service management across member accounts."
            },
            {
              "id": "c4",
              "text": "Delegate everything to third-party SaaS governance tools only",
              "isCorrect": false,
              "explanation": "Third-party tools can help but AWS Organizations provides foundational native patterns for central control."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Security Foundations and Governance",
          "services": [
            "Organizations",
            "IAM",
            "CloudTrail"
          ],
          "docs": "https://docs.aws.amazon.com/whitepapers/latest/aws-security-best-practices/overview.html",
          "tip": "Structure accounts using OUs and delegated admins for scale and governance.",
          "explanation": "AWS Organizations supports centralized billing, SCPs for guardrails, and delegated admin roles for services such as GuardDuty or Security Hub, enabling scalable governance."
        },
        {
          "id": "SCS-C03-0002",
          "question": "You're investigating suspicious activity and want to run investigative notebooks to visualise relationships which AWS service provides that investigative workspace?",
          "choices": [
            {
              "id": "c3",
              "text": "AWS Shield",
              "isCorrect": false,
              "explanation": "AWS Shield provides DDoS protections, not forensic investigation tools."
            },
            {
              "id": "c4",
              "text": "AWS CloudTrail",
              "isCorrect": false,
              "explanation": "CloudTrail records API activity and is useful for forensics, but Detective provides investigative workflows."
            },
            {
              "id": "c1",
              "text": "AWS Systems Manager",
              "isCorrect": false,
              "explanation": "Systems Manager helps manage instances but is not focused on security investigation notebooks."
            },
            {
              "id": "c2",
              "text": "Amazon Detective",
              "isCorrect": true,
              "explanation": "Amazon Detective is designed to analyze, visualize, and conduct investigations into potential security issues."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Incident Response",
          "services": [
            "Detective",
            "Systems Manager",
            "Shield",
            "CloudTrail"
          ],
          "docs": "https://docs.aws.amazon.com/detective/latest/adminguide/what-is.html",
          "tip": "This service helps visualize and investigate security issues by linking related findings and activity.",
          "explanation": "Amazon Detective automatically collects log data from VPC Flow Logs, CloudTrail, and GuardDuty, then builds a graph model that links related events so analysts can visually trace activity."
        },
        {
          "id": "SCS-C03-0032",
          "question": "A security team discovers that malware on compromised EC2 instances is using DNS queries to known command-and-control domains for data exfiltration. They need to block DNS resolution of these domains for all resources in the VPC without deploying custom DNS servers. Which service provides this capability?",
          "choices": [
            {
              "id": "c3",
              "text": "Create NACL rules to block outbound UDP port 53 to the internet",
              "isCorrect": false,
              "explanation": "Blocking port 53 outbound would break DNS resolution for all VPC resources, not just malicious queries. VPC DNS uses the Route 53 Resolver internally, so NACL rules do not affect VPC-internal DNS resolution."
            },
            {
              "id": "c2",
              "text": "AWS WAF with a custom rule to block DNS traffic patterns",
              "isCorrect": false,
              "explanation": "WAF operates on HTTP/HTTPS traffic at Layer 7. It cannot inspect or block DNS queries (UDP port 53) made by VPC resources to the Route 53 Resolver."
            },
            {
              "id": "c1",
              "text": "Route 53 Resolver DNS Firewall with a block-list rule group associated to the VPC",
              "isCorrect": true,
              "explanation": "DNS Firewall lets you create domain lists and rule groups that block, allow, or alert on DNS queries made through the Route 53 Resolver. Associating a rule group to a VPC applies the rules to all DNS queries from that VPC."
            },
            {
              "id": "c4",
              "text": "Enable GuardDuty DNS resolution monitoring to automatically block malicious domains",
              "isCorrect": false,
              "explanation": "GuardDuty detects and alerts on DNS queries to known malicious domains, but it does not block them. DNS Firewall provides the enforcement (blocking) capability."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Infrastructure Security",
          "services": [
            "Route 53",
            "Route 53 Resolver DNS Firewall",
            "VPC",
            "GuardDuty"
          ],
          "docs": "https://docs.aws.amazon.com/Route53/latest/DeveloperGuide/resolver-dns-firewall.html",
          "tip": "GuardDuty detects, but DNS Firewall blocks. Use both together for detect-and-prevent.",
          "explanation": "Route 53 Resolver DNS Firewall provides managed DNS-layer filtering within VPCs. You define domain lists (or import AWS-managed threat lists) and create rule groups with BLOCK, ALLOW, or ALERT actions. Associating the rule group to a VPC applies filtering to all Route 53 Resolver queries from that VPC."
        },
        {
          "id": "SCS-C03-0016",
          "question": "A development team stores database credentials in environment variables baked into their container images. The security team requires that credentials be rotated every 30 days without redeploying containers and that all credential access be auditable. Which approach best meets these requirements?",
          "choices": [
            {
              "id": "c2",
              "text": "Store credentials in SSM Parameter Store SecureString parameters and write a cron job to update them monthly",
              "isCorrect": false,
              "explanation": "Parameter Store SecureStrings can hold secrets but lack built-in automatic rotation. A cron job is fragile and requires custom coordination with both the parameter and the database."
            },
            {
              "id": "c3",
              "text": "Encrypt the environment variables at build time with a KMS key and decrypt them at container start",
              "isCorrect": false,
              "explanation": "This protects secrets at rest in the image, but rotating requires rebuilding and redeploying the container, which violates the no-redeploy requirement."
            },
            {
              "id": "c1",
              "text": "Store credentials in AWS Secrets Manager with automatic rotation enabled and retrieve them at runtime using the Secrets Manager SDK",
              "isCorrect": true,
              "explanation": "Secrets Manager supports automatic rotation via Lambda, provides versioned secrets so applications always fetch the current value at runtime, and logs all access through CloudTrail."
            },
            {
              "id": "c4",
              "text": "Use IAM database authentication to eliminate passwords entirely",
              "isCorrect": false,
              "explanation": "IAM database authentication works only with supported engines (Aurora MySQL/PostgreSQL, RDS MySQL/PostgreSQL) and may not cover all the team's databases. It also does not address other types of credentials."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Data Protection",
          "services": [
            "Secrets Manager",
            "Parameter Store",
            "KMS",
            "Lambda"
          ],
          "docs": "https://docs.aws.amazon.com/secretsmanager/latest/userguide/intro.html",
          "tip": "Automatic rotation without redeployment means the application must fetch secrets dynamically, not rely on values injected at build or deploy time.",
          "explanation": "Secrets Manager is purpose-built for credential lifecycle management. Its rotation feature invokes a Lambda function on a schedule to update both the secret value and the target resource (e.g., RDS password), while applications retrieve the current secret at runtime, eliminating the need for redeployment."
        },
        {
          "id": "SCS-C03-0038",
          "question": "Which AWS service automates building, testing, and distributing hardened AMIs with a repeatable pipeline?",
          "choices": [
            {
              "id": "c2",
              "text": "AWS Glue",
              "isCorrect": false,
              "explanation": "Glue is an ETL/data integration service, not an image-building pipeline."
            },
            {
              "id": "c3",
              "text": "Amazon Inspector",
              "isCorrect": false,
              "explanation": "Inspector performs vulnerability assessments but does not build or distribute hardened AMIs."
            },
            {
              "id": "c1",
              "text": "EC2 Image Builder",
              "isCorrect": true,
              "explanation": "EC2 Image Builder automates the creation, patching, testing, and distribution of server images according to repeatable pipelines and policies."
            },
            {
              "id": "c4",
              "text": "AWS CloudFormation",
              "isCorrect": false,
              "explanation": "CloudFormation deploys infrastructure as code but does not provide an image build-and-test pipeline by itself."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Infrastructure Security",
          "services": [
            "EC2 Image Builder",
            "EC2",
            "Systems Manager"
          ],
          "docs": "https://docs.aws.amazon.com/imagebuilder/latest/userguide/what-is-image-builder.html",
          "tip": "Use an automated image pipeline to bake in patches and configuration checks before distribution.",
          "explanation": "EC2 Image Builder provides a repeatable, auditable pipeline to produce hardened AMIs, including testing steps and integration with Systems Manager for patching and compliance verification."
        },
        {
          "id": "SCS-C03-0060",
          "question": "Which strategy reduces cost while preserving required retention for infrequently accessed file data?",
          "choices": [
            {
              "id": "c4",
              "text": "Delete older data to save cost without retention requirements",
              "isCorrect": false,
              "explanation": "Deletion may violate retention and compliance requirements."
            },
            {
              "id": "c2",
              "text": "Keep all data on high-performance SSD tiers indefinitely",
              "isCorrect": false,
              "explanation": "Retaining everything on high-cost tiers is inefficient and expensive."
            },
            {
              "id": "c1",
              "text": "Use lifecycle policies to move infrequently accessed data to lower-cost storage tiers such as EFS Infrequent Access or archival destinations",
              "isCorrect": true,
              "explanation": "Lifecycle policies move data automatically to cheaper tiers while retaining access and meeting retention policies."
            },
            {
              "id": "c3",
              "text": "Manually archive files to local tape every quarter",
              "isCorrect": false,
              "explanation": "Manual processes are error-prone and lack automation and auditability."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Data Protection",
          "services": [
            "EFS",
            "Lifecycle",
            "S3 Glacier"
          ],
          "docs": "https://docs.aws.amazon.com/efs/latest/ug/what-is-efs.html",
          "tip": "Automate lifecycle transitions to lower-cost tiers when access patterns change.",
          "explanation": "Automated lifecycle policies balance cost and retention by moving data to appropriate storage classes based on age and access frequency."
        },
        {
          "id": "SCS-C03-0003",
          "question": "You need to block malicious HTTP traffic before it reaches your origin which service should you pair with CloudFront to filter requests at the edge?",
          "choices": [
            {
              "id": "c2",
              "text": "Security Groups",
              "isCorrect": false,
              "explanation": "Security Groups control traffic to EC2 at the instance level, not the CloudFront edge."
            },
            {
              "id": "c4",
              "text": "AWS KMS",
              "isCorrect": false,
              "explanation": "AWS KMS is for key management and encryption, not traffic filtering."
            },
            {
              "id": "c3",
              "text": "VPC Endpoint",
              "isCorrect": false,
              "explanation": "VPC Endpoints provide private connectivity to services within a VPC, not edge HTTP filtering."
            },
            {
              "id": "c1",
              "text": "AWS WAF",
              "isCorrect": true,
              "explanation": "AWS WAF is the web application firewall used with CloudFront to filter HTTP(S) traffic."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Infrastructure Security",
          "services": [
            "WAF",
            "CloudFront",
            "Security Groups"
          ],
          "docs": "https://docs.aws.amazon.com/waf/latest/developerguide/waf-chapter.html",
          "tip": "Think web application protection rules that block common attack patterns at the edge.",
          "explanation": "AWS WAF integrates natively with CloudFront, ALB, and API Gateway to inspect and filter HTTP(S) requests using rules such as rate limiting and SQL injection detection."
        },
        {
          "id": "SCS-C03-0010",
          "question": "You must prevent any account in your Org from launching EC2 instances outside eu-west-1 and eu-west-2 which preventive control should you apply across the organization?",
          "choices": [
            {
              "id": "c3",
              "text": "Deploy an AWS Config rule that evaluates EC2 instances and flags any launched outside the allowed regions as non-compliant",
              "isCorrect": false,
              "explanation": "Config rules are detective, not preventive - the instance would already be running before Config flags it."
            },
            {
              "id": "c1",
              "text": "Attach a Service Control Policy (SCP) to the organisation root or target OUs that denies ec2:RunInstances unless the aws:RequestedRegion condition matches eu-west-1 or eu-west-2",
              "isCorrect": true,
              "explanation": "SCPs set maximum permission boundaries across all accounts in an OU or organisation, overriding any IAM policy within those accounts."
            },
            {
              "id": "c4",
              "text": "Use a CloudFormation StackSet with a hook that blocks ec2:RunInstances in disallowed regions",
              "isCorrect": false,
              "explanation": "CloudFormation hooks validate CloudFormation-managed resources only, not direct API calls or console launches."
            },
            {
              "id": "c2",
              "text": "Create an IAM policy in each account that denies ec2:RunInstances outside eu-west-1 and eu-west-2, and attach it to every IAM user and role",
              "isCorrect": false,
              "explanation": "Per-account IAM policies can be removed by local administrators, and new users or roles might not receive the policy."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Identity and Access Management",
          "services": [
            "Organizations",
            "IAM",
            "Config",
            "CloudFormation"
          ],
          "docs": "https://docs.aws.amazon.com/organizations/latest/userguide/orgs_manage_policies_scps.html",
          "tip": "You need a preventive control that applies across all accounts regardless of each account's local IAM policies.",
          "explanation": "Service Control Policies (SCPs) in AWS Organizations act as guardrails that define the maximum permissions available to all principals in member accounts."
        }
      ],
      "perDomain": {
        "Incident Response": {
          "total": 1,
          "correct": 1,
          "score": 100
        }
      },
      "earlyComplete": true,
      "answeredCount": 1,
      "totalQuestions": 65
    },
    {
      "attemptId": "3a57b2f7-7ae4-4ebf-81e5-e116b5d1cf97",
      "userId": "9255a4e4-20f1-7010-8a80-17c43ca141e3",
      "examCode": "SCS-C03",
      "examVersion": null,
      "s3VersionId": null,
      "attemptSchemaVersion": 1,
      "startedAt": "2026-02-18T14:40:08.710Z",
      "finishedAt": "2026-02-18T14:40:16.007Z",
      "score": 100,
      "answers": [
        {
          "questionId": "SCS-C03-0019",
          "selectedChoiceId": "c1",
          "selectedChoiceIds": null,
          "selectedIndex": null,
          "selectedIndices": null,
          "correct": true,
          "timeMs": 0,
          "showTip": false,
          "createdAt": "2026-02-18T14:40:12.582Z"
        }
      ],
      "metadata": {
        "serviceKeywords": [],
        "domains": [],
        "services": []
      },
      "questions": [
        {
          "id": "SCS-C03-0019",
          "question": "A financial services firm must store audit logs for seven years in a manner that no user, including root, can delete or modify them before the retention period expires. Regulators require proof of immutability. Which S3 feature satisfies these requirements?",
          "choices": [
            {
              "id": "c2",
              "text": "S3 Object Lock in Governance mode with a seven-year retention period",
              "isCorrect": false,
              "explanation": "Governance mode allows users with the s3:BypassGovernanceRetention permission to delete objects before the retention period ends, which does not meet the absolute immutability requirement."
            },
            {
              "id": "c4",
              "text": "Enable MFA Delete on the S3 bucket to require MFA for all delete operations",
              "isCorrect": false,
              "explanation": "MFA Delete requires an additional authentication step but does not make objects truly immutable. A user with MFA can still delete them at any time."
            },
            {
              "id": "c1",
              "text": "S3 Object Lock in Compliance mode with a seven-year retention period",
              "isCorrect": true,
              "explanation": "Compliance mode prevents anyone, including the root user, from deleting or overwriting an object version until the retention date passes. This satisfies regulatory immutability requirements."
            },
            {
              "id": "c3",
              "text": "S3 Versioning with an S3 Lifecycle rule to transition objects to Glacier after 30 days",
              "isCorrect": false,
              "explanation": "Versioning preserves prior versions but does not prevent deletion of version markers. Glacier transition reduces cost but does not enforce immutability."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Data Protection",
          "services": [
            "S3",
            "S3 Object Lock",
            "Glacier",
            "Backup"
          ],
          "docs": "https://docs.aws.amazon.com/AmazonS3/latest/userguide/object-lock.html",
          "tip": "Some retention features prevent even highly privileged users from removing locks; verify retention enforcement models.",
          "explanation": "S3 Object Lock Compliance mode creates a WORM (Write Once Read Many) storage model. Once set, neither the object nor its retention settings can be altered or deleted by any principal until the retention period expires, meeting SEC 17a-4(f) and similar regulatory requirements."
        },
        {
          "id": "SCS-C03-0057",
          "question": "Which approach supports zero-downtime TLS certificate renewal for multiple subdomains?",
          "choices": [
            {
              "id": "c2",
              "text": "Use self-signed certs rotated manually via SSH",
              "isCorrect": false,
              "explanation": "Manual self-signed rotation risks downtime and trust issues."
            },
            {
              "id": "c1",
              "text": "Use ACM certificates with DNS validation and attach to ALB listeners",
              "isCorrect": true,
              "explanation": "ACM issues public certificates that renew automatically when DNS validation is used; ALB integration ensures rotation without downtime."
            },
            {
              "id": "c3",
              "text": "Use a wildcard cert imported into each instance",
              "isCorrect": false,
              "explanation": "Importing certificates to instances complicates automation and rotation compared to ACM."
            },
            {
              "id": "c4",
              "text": "Disable TLS and rely on internal network controls",
              "isCorrect": false,
              "explanation": "TLS should be used; ACM simplifies automated renewals."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Data Protection",
          "services": [
            "ACM",
            "Route 53",
            "ALB"
          ],
          "docs": "https://docs.aws.amazon.com/acm/latest/userguide/acm-certificate.html",
          "tip": "Prefer provider-issued certificates with an automated validation method for renewals.",
          "explanation": "ACM manages the lifecycle of certificates it issues and integrates with ALB/CloudFront to rotate certificates transparently."
        },
        {
          "id": "SCS-C03-0040",
          "question": "Which combination of practices best secures the AWS account root user while preserving necessary break-glass access?",
          "choices": [
            {
              "id": "c4",
              "text": "Keep root access enabled for all admins but log usage to CloudTrail",
              "isCorrect": false,
              "explanation": "Allowing easy root access contradicts best practices even if logged; the preferred pattern is delegation and protected root credentials."
            },
            {
              "id": "c1",
              "text": "Enable MFA on the root account, store credentials in a secure offline vault, and use IAM administrative roles for daily operations",
              "isCorrect": true,
              "explanation": "Enforcing MFA, securing root credentials offline, and delegating daily administrative tasks to IAM roles minimizes root usage while preserving a secured break-glass path."
            },
            {
              "id": "c3",
              "text": "Remove MFA and rely on a complex password rotated monthly",
              "isCorrect": false,
              "explanation": "Removing MFA weakens security; passwords alone are insufficient for strong break-glass protections."
            },
            {
              "id": "c2",
              "text": "Share root credentials with the security team to ensure quick access during incidents",
              "isCorrect": false,
              "explanation": "Sharing root credentials increases blast radius and is contrary to least-privilege practices."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Security Foundations and Governance",
          "services": [
            "IAM",
            "Organizations",
            "Secrets Manager"
          ],
          "docs": "https://docs.aws.amazon.com/IAM/latest/UserGuide/id_root-user.html",
          "tip": "Minimize use of highly privileged accounts, enforce MFA, and delegate daily tasks to role-based identities.",
          "explanation": "AWS recommends enabling MFA on the root account, storing root credentials securely (e.g., an offline vault with restricted access), and using IAM roles and delegated administration for routine tasks to reduce risk and provide an auditable break-glass process."
        },
        {
          "id": "SCS-C03-0029",
          "question": "An organisation with 300 member accounts needs to enable GuardDuty in every account and every region, automatically including future accounts. All findings must be viewable from the security account. Which approach achieves this with the least ongoing maintenance?",
          "choices": [
            {
              "id": "c4",
              "text": "Enable Security Hub in the security account and it will automatically enable GuardDuty across all member accounts",
              "isCorrect": false,
              "explanation": "Security Hub aggregates findings from GuardDuty but does not enable or manage GuardDuty. They are independent services with separate enablement processes."
            },
            {
              "id": "c1",
              "text": "Designate a delegated administrator account for GuardDuty through AWS Organizations and enable the auto-enable feature for new member accounts",
              "isCorrect": true,
              "explanation": "The delegated administrator model in GuardDuty with auto-enable automatically activates GuardDuty in all current and future member accounts. Findings from all accounts are aggregated in the administrator account."
            },
            {
              "id": "c3",
              "text": "Deploy GuardDuty via a CloudFormation StackSet targeting all accounts and regions",
              "isCorrect": false,
              "explanation": "StackSets can enable GuardDuty but do not establish the administrator-member relationship needed to aggregate findings centrally, and they require additional work for auto-enabling in new accounts."
            },
            {
              "id": "c2",
              "text": "Send manual invitation requests from the security account to each of the 300 member accounts and accept them individually",
              "isCorrect": false,
              "explanation": "Manual invitations work but require per-account acceptance, do not auto-enrol future accounts, and become unmanageable at scale."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Detection",
          "services": [
            "GuardDuty",
            "Organizations",
            "Security Hub",
            "S3"
          ],
          "docs": "https://docs.aws.amazon.com/guardduty/latest/ug/what-is-guardduty.html",
          "tip": "Organization-level integrations allow services to be enabled and managed centrally across member accounts.",
          "explanation": "GuardDuty's Organizations integration allows a delegated administrator to manage GuardDuty across all member accounts centrally. The auto-enable feature ensures new accounts are automatically enrolled without manual intervention, and all findings flow to the administrator account for consolidated monitoring."
        },
        {
          "id": "SCS-C03-0056",
          "question": "Which mechanism should be used to automatically remediate a non-compliant resource detected by AWS Config?",
          "choices": [
            {
              "id": "c2",
              "text": "Send alerts only to email and wait for manual action",
              "isCorrect": false,
              "explanation": "Manual remediation is slower and does not meet automatic remediation requirements."
            },
            {
              "id": "c3",
              "text": "Use CloudTrail to roll back the resource change",
              "isCorrect": false,
              "explanation": "CloudTrail records events but does not perform automated remediation by itself."
            },
            {
              "id": "c4",
              "text": "Deploy a Lambda that polls Config every 24 hours",
              "isCorrect": false,
              "explanation": "Polling is less efficient and misses near-real-time remediation compared to Config automatic remediation."
            },
            {
              "id": "c1",
              "text": "Configure AWS Config automatic remediation using an SSM Automation document",
              "isCorrect": true,
              "explanation": "Config remediation actions invoke SSM Automation documents to fix identified non-compliance automatically."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Detection",
          "services": [
            "Config",
            "SSM",
            "CloudWatch"
          ],
          "docs": "https://docs.aws.amazon.com/config/latest/developerguide/remediation.html",
          "tip": "Use built-in remediation mechanisms that invoke automation playbooks or documents for fixes.",
          "explanation": "AWS Config's remediation model is designed to trigger SSM Automation documents to correct drift promptly and reliably."
        },
        {
          "id": "SCS-C03-0014",
          "question": "A data lake team manages a single S3 bucket accessed by multiple applications across different VPCs. They need to enforce that each application can only reach the bucket from its own VPC and can only access objects under its designated prefix. Which approach provides the strongest isolation with the least policy complexity?",
          "choices": [
            {
              "id": "c2",
              "text": "Write a single S3 bucket policy with separate statements per application",
              "isCorrect": false,
              "explanation": "A single bucket policy becomes difficult to manage and has size limits."
            },
            {
              "id": "c1",
              "text": "Create a separate S3 Access Point for each application",
              "isCorrect": true,
              "explanation": "S3 Access Points allow per-application network and permission scoping against a shared bucket."
            },
            {
              "id": "c3",
              "text": "Create one VPC endpoint per VPC and use endpoint policies",
              "isCorrect": false,
              "explanation": "Endpoint policies are coarse for prefix-level scoping."
            },
            {
              "id": "c4",
              "text": "Replicate data into separate per-application buckets",
              "isCorrect": false,
              "explanation": "Replication increases cost and complexity."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Data Protection",
          "services": [
            "S3",
            "IAM",
            "VPC",
            "PrivateLink"
          ],
          "docs": "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-points.html",
          "tip": "Think about network-scoped entry points that expose storage through controlled endpoints.",
          "explanation": "S3 Access Points provide named, per-application entry points to a bucket, each with its own policy and optional VPC restriction."
        },
        {
          "id": "SCS-C03-0018",
          "question": "A company runs workloads on Amazon EKS and needs each Kubernetes pod to assume a unique IAM role with fine-grained permissions. The trust policy must ensure only the intended service account in a specific namespace can assume the role. Which trust policy snippet correctly restricts role assumption to the pod's OIDC identity?",
          "choices": [
            {
              "id": "c1",
              "text": "{\"Effect\":\"Allow\",\"Principal\":{\"Federated\":\"arn:aws:iam::123456789012:oidc-provider/oidc.eks.us-east-1.amazonaws.com/id/EXAMPLED539D4633E53DE1B71EXAMPLE\"},\"Action\":\"sts:AssumeRoleWithWebIdentity\",\"Condition\":{\"StringEquals\":{\"oidc.eks.us-east-1.amazonaws.com/id/EXAMPLED539D4633E53DE1B71EXAMPLE:sub\":\"system:serviceaccount:app-ns:app-sa\"}}}",
              "isCorrect": true,
              "explanation": "This uses the EKS OIDC provider as a Federated principal with AssumeRoleWithWebIdentity, and the Condition restricts the sub claim to the exact namespace:serviceaccount pair."
            },
            {
              "id": "c4",
              "text": "{\"Effect\":\"Allow\",\"Principal\":{\"Federated\":\"cognito-identity.amazonaws.com\"},\"Action\":\"sts:AssumeRoleWithWebIdentity\"}",
              "isCorrect": false,
              "explanation": "Cognito Identity is for end-user identity federation, not Kubernetes workload identity. EKS uses its own OIDC provider endpoint."
            },
            {
              "id": "c3",
              "text": "{\"Effect\":\"Allow\",\"Principal\":{\"AWS\":\"arn:aws:iam::123456789012:role/eks-node-role\"},\"Action\":\"sts:AssumeRole\"}",
              "isCorrect": false,
              "explanation": "Trusting the node role lets every pod on that node assume this role, eliminating per-pod isolation."
            },
            {
              "id": "c2",
              "text": "{\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"eks.amazonaws.com\"},\"Action\":\"sts:AssumeRole\"}",
              "isCorrect": false,
              "explanation": "This trusts the EKS service itself (the control plane), not individual pod identities. Any EKS-managed component could assume this role, not just the intended pod."
            }
          ],
          "selectCount": 1,
          "format": "json",
          "domain": "Identity and Access Management",
          "services": [
            "IAM",
            "STS",
            "Cognito",
            "EKS"
          ],
          "docs": "https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_providers_oidc.html",
          "tip": "Use workload identity federation patterns to grant pod-level permissions without node credentials.",
          "explanation": "IRSA projects a signed OIDC token into each pod, and the trust policy uses the cluster OIDC provider as a Federated principal with a Condition on the sub claim (namespace:serviceaccount). This ensures only the precise service account in the correct namespace can assume the role."
        },
        {
          "id": "SCS-C03-0065",
          "question": "Which integration allows custom request inspection logic at the edge before forwarding to the origin?",
          "choices": [
            {
              "id": "c4",
              "text": "Rely on DNS-level filtering for application-layer inspection",
              "isCorrect": false,
              "explanation": "DNS filtering cannot inspect HTTP request content for application-layer threats."
            },
            {
              "id": "c1",
              "text": "Use CloudFront with Lambda@Edge (or CloudFront Functions) to run custom inspection and modify requests",
              "isCorrect": true,
              "explanation": "Lambda@Edge or CloudFront Functions can execute custom logic during request/response flows at the edge to inspect or mutate requests."
            },
            {
              "id": "c3",
              "text": "Only use origin-side web servers to inspect requests",
              "isCorrect": false,
              "explanation": "Origin-side inspection allows attacks to reach the origin and increases bandwidth and processing costs."
            },
            {
              "id": "c2",
              "text": "Use SQS between CloudFront and origin for inspection",
              "isCorrect": false,
              "explanation": "SQS is asynchronous and not suitable for synchronous request inspection at the edge."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Infrastructure Security",
          "services": [
            "WAF",
            "CloudFront",
            "Lambda"
          ],
          "docs": "https://docs.aws.amazon.com/waf/latest/developerguide/waf-rule-statement-type.html",
          "tip": "Use edge compute to execute lightweight request inspection close to the client before reaching the origin.",
          "explanation": "Placing lightweight inspection at the edge reduces origin load and enables early mitigation of malicious requests before they traverse the network to backend systems."
        },
        {
          "id": "SCS-C03-0053",
          "question": "Which strategy enables workload access policies that scale with many teams and dynamic resources in AWS?",
          "choices": [
            {
              "id": "c4",
              "text": "Rely solely on VPC-level security groups for access control",
              "isCorrect": false,
              "explanation": "Security groups operate at network level, not at identity/attribute level."
            },
            {
              "id": "c3",
              "text": "Hardcode permissions into application config files",
              "isCorrect": false,
              "explanation": "Hardcoding is insecure and prevents centralized management and auditing."
            },
            {
              "id": "c2",
              "text": "Create a single monolithic admin role for all teams",
              "isCorrect": false,
              "explanation": "Monolithic roles violate least privilege and do not scale well."
            },
            {
              "id": "c1",
              "text": "Use ABAC with tags to grant permissions based on attributes such as department or environment",
              "isCorrect": true,
              "explanation": "ABAC provides scalable, attribute-based permissions without creating many static IAM policies per resource."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Identity and Access Management",
          "services": [
            "EKS",
            "IAM",
            "KMS"
          ],
          "docs": "https://docs.aws.amazon.com/eks/latest/userguide/security_iam.html",
          "tip": "Use attribute-based access control (ABAC) with tags for scalable permission models.",
          "explanation": "ABAC allows policies to reference resource or principal tags, reducing policy proliferation while enabling fine-grained access control aligned to organizational attributes."
        },
        {
          "id": "SCS-C03-0063",
          "question": "Which practice validates that an incident response runbook will work under real conditions?",
          "choices": [
            {
              "id": "c3",
              "text": "Assume runbooks are valid if written by senior staff",
              "isCorrect": false,
              "explanation": "Assumptions without testing risk undiscovered issues in execution under pressure."
            },
            {
              "id": "c2",
              "text": "Only review runbooks annually without testing",
              "isCorrect": false,
              "explanation": "Reviews without testing may miss operational and technical gaps discovered during live drills."
            },
            {
              "id": "c4",
              "text": "Rely on vendor-provided runbooks without customization",
              "isCorrect": false,
              "explanation": "Vendor runbooks may not match the customer's environment and need adaptation and testing."
            },
            {
              "id": "c1",
              "text": "Conduct tabletop exercises and full-scale simulated incident drills using controlled fault injection",
              "isCorrect": true,
              "explanation": "Tabletops test decision-making; simulated drills and fault injection test technical runbooks and automation under realistic conditions."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Incident Response",
          "services": [
            "Incident Manager",
            "CloudWatch",
            "EventBridge"
          ],
          "docs": "https://docs.aws.amazon.com/whitepapers/latest/aws-security-best-practices/incident-response.html",
          "tip": "Run both tabletop and technical drills to validate people and technical runbooks.",
          "explanation": "Combining tabletop exercises for roles and decisions with full technical drills (injecting faults) validates both human and automated aspects of incident response."
        },
        {
          "id": "SCS-C03-0033",
          "question": "An incident responder has identified a compromised IAM role and needs to immediately invalidate all existing sessions for that role while preserving the role itself for forensic analysis. Which approach revokes all active sessions without deleting the role?",
          "choices": [
            {
              "id": "c3",
              "text": "Change the role's trust policy to deny all principals",
              "isCorrect": false,
              "explanation": "Modifying the trust policy prevents new role assumptions but does not invalidate existing active sessions. Temporary credentials already issued remain valid until they expire."
            },
            {
              "id": "c1",
              "text": "Add an inline deny-all policy to the role with a condition that aws:TokenIssueTime is before the current timestamp:\n{\"Effect\":\"Deny\",\"Action\":\"*\",\"Resource\":\"*\",\"Condition\":{\"DateLessThan\":{\"aws:TokenIssueTime\":\"2026-02-16T12:00:00Z\"}}}",
              "isCorrect": true,
              "explanation": "This technique (Revoke Session) denies all actions for temporary credentials issued before the specified time. New sessions assumed after that time are unaffected, and the role remains intact for investigation."
            },
            {
              "id": "c2",
              "text": "Delete all inline and managed policies from the role to remove its permissions",
              "isCorrect": false,
              "explanation": "Removing policies prevents new actions but also destroys the evidence of what permissions the role had, which is critical for forensic analysis."
            },
            {
              "id": "c4",
              "text": "Contact AWS Support to force-expire the role's temporary credentials",
              "isCorrect": false,
              "explanation": "AWS Support cannot force-expire individual STS tokens. Session revocation must be done through IAM policy mechanisms by the account administrator."
            }
          ],
          "selectCount": 1,
          "format": "json",
          "domain": "Incident Response",
          "services": [
            "STS",
            "IAM",
            "CloudTrail"
          ],
          "docs": "https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_temp_request.html",
          "tip": "Session revocation often uses time-based deny conditions to invalidate earlier issued tokens.",
          "explanation": "STS temporary credentials cannot be individually revoked, but you can render them useless by attaching a deny-all policy with a DateLessThan condition on aws:TokenIssueTime. This is the recommended emergency response for compromised roles because it immediately neutralizes existing sessions while keeping the role and its policies intact for forensic review."
        },
        {
          "id": "SCS-C03-0064",
          "question": "After a GuardDuty finding indicates suspicious API calls from a role, which steps validate scope and impact?",
          "choices": [
            {
              "id": "c2",
              "text": "Temporarily revoke the role's active sessions pending investigation",
              "isCorrect": false,
              "explanation": "Revoking sessions can limit ongoing activity but is disruptive; triage and validation are usually performed first to scope impact before broad actions."
            },
            {
              "id": "c4",
              "text": "Assume GuardDuty is faulty and open a support ticket",
              "isCorrect": false,
              "explanation": "While false positives can occur, perform validation steps before concluding GuardDuty is wrong."
            },
            {
              "id": "c3",
              "text": "Ignore the finding if there are no console alerts",
              "isCorrect": false,
              "explanation": "Findings should be validated; absence of console alerts doesn't mean no impact."
            },
            {
              "id": "c1",
              "text": "Retrieve CloudTrail management events for the role, query related CloudWatch Logs, and inspect resource changes",
              "isCorrect": true,
              "explanation": "Correlate GuardDuty findings with CloudTrail events and application logs to scope the impact and timeline."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Incident Response",
          "services": [
            "GuardDuty",
            "Security Hub",
            "EventBridge"
          ],
          "docs": "https://docs.aws.amazon.com/guardduty/latest/ug/what-is-guardduty.html",
          "tip": "Correlate detection alerts with audit trails and application logs to validate scope and impact.",
          "explanation": "Effective validation uses multiple data sources: CloudTrail shows API callers and timestamps; CloudWatch and application logs show resource-level effects and help identify affected assets."
        },
        {
          "id": "SCS-C03-0061",
          "question": "Which solution ensures centralized, policy-driven backups across RDS and EFS with retention controls?",
          "choices": [
            {
              "id": "c2",
              "text": "Create per-service scripts to snapshot data and copy to S3",
              "isCorrect": false,
              "explanation": "Custom scripts lack centralized policy management and consistent retention enforcement."
            },
            {
              "id": "c1",
              "text": "Use AWS Backup with backup plans and vaults to centrally manage backups and retention",
              "isCorrect": true,
              "explanation": "AWS Backup centralizes backups across supported services and enforces retention and lifecycle rules via backup plans and vaults."
            },
            {
              "id": "c3",
              "text": "Use cross-region replication for S3 only",
              "isCorrect": false,
              "explanation": "S3 replication is specific to S3 and doesn't manage backups for other services like RDS/EFS."
            },
            {
              "id": "c4",
              "text": "Rely on EC2 AMI snapshots for database backups",
              "isCorrect": false,
              "explanation": "AMI snapshots are not suitable for database-consistent backups across services without application-level coordination."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Data Protection",
          "services": [
            "AWS Backup",
            "RDS",
            "S3"
          ],
          "docs": "https://docs.aws.amazon.com/backup/latest/devguide/whatisbackup.html",
          "tip": "Use a centralized backup orchestration service to manage retention and policies across supported resources.",
          "explanation": "AWS Backup simplifies centralized backup orchestration, retention policies, and cross-account/cross-region copy workflows for supported AWS resources."
        },
        {
          "id": "SCS-C03-0009",
          "question": "As a data steward you need to automatically find and classify PII across hundreds of S3 buckets. Which AWS service is built for that task?",
          "choices": [
            {
              "id": "c3",
              "text": "Amazon Inspector",
              "isCorrect": false,
              "explanation": "Inspector focuses on vulnerability scanning for compute workloads, not data classification in S3."
            },
            {
              "id": "c4",
              "text": "AWS Trusted Advisor",
              "isCorrect": false,
              "explanation": "Trusted Advisor provides account-level checks like open security groups, but does not scan S3 object contents."
            },
            {
              "id": "c2",
              "text": "Amazon GuardDuty",
              "isCorrect": false,
              "explanation": "GuardDuty detects threats like unusual API calls to S3 but does not inspect object contents for sensitive data."
            },
            {
              "id": "c1",
              "text": "Amazon Macie",
              "isCorrect": true,
              "explanation": "Macie scans S3 objects for PII, financial data, and credentials using ML-powered classifiers and managed data identifiers."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Data Protection",
          "services": [
            "Macie",
            "GuardDuty",
            "Inspector",
            "Trusted Advisor"
          ],
          "docs": "https://docs.aws.amazon.com/macie/latest/user/what-is-macie.html",
          "tip": "Some services scan stored objects to locate sensitive data and personally identifiable information.",
          "explanation": "Amazon Macie is designed to scan S3 objects and classify sensitive content such as PII and PHI using managed data identifiers."
        },
        {
          "id": "SCS-C03-0031",
          "question": "During an incident investigation, an analyst has shell access to a compromised EC2 instance and needs to determine which IAM identity the instance is currently using to make AWS API calls. Which CLI command reveals this information?",
          "choices": [
            {
              "id": "c1",
              "text": "aws sts get-caller-identity",
              "isCorrect": true,
              "explanation": "This command returns the UserId, Account, and ARN of the IAM identity (user, role, or federated identity) making the request. On an EC2 instance, it reveals the instance profile role."
            },
            {
              "id": "c4",
              "text": "curl http://169.254.169.254/latest/meta-data/iam/security-credentials/",
              "isCorrect": false,
              "explanation": "This metadata endpoint lists the instance profile role name and can retrieve temporary credentials, but it does not show the full ARN or account ID. It also does not detect if the instance is using a different assumed role via manual STS calls."
            },
            {
              "id": "c3",
              "text": "aws ec2 describe-instances --instance-id $(curl -s http://169.254.169.254/latest/meta-data/instance-id)",
              "isCorrect": false,
              "explanation": "describe-instances shows instance metadata including the IamInstanceProfile association, but the response contains the profile ARN, not the currently assumed role ARN with session details. get-caller-identity is more direct."
            },
            {
              "id": "c2",
              "text": "aws iam get-user",
              "isCorrect": false,
              "explanation": "get-user returns information about an IAM user. On an instance using a role (not a user), this command fails because the caller is not an IAM user."
            }
          ],
          "selectCount": 1,
          "format": "cli",
          "domain": "Incident Response",
          "services": [
            "STS",
            "IAM",
            "CloudShell"
          ],
          "docs": "https://docs.aws.amazon.com/cli/latest/reference/sts/get-caller-identity.html",
          "tip": "Use standard identity calls to reveal the effective caller identity across contexts.",
          "explanation": "aws sts get-caller-identity is the quickest and most reliable way to determine the current AWS identity context. It works for all principal types and returns the ARN that appears in CloudTrail logs, making it invaluable during investigations."
        },
        {
          "id": "SCS-C03-0038",
          "question": "Which AWS service automates building, testing, and distributing hardened AMIs with a repeatable pipeline?",
          "choices": [
            {
              "id": "c4",
              "text": "AWS CloudFormation",
              "isCorrect": false,
              "explanation": "CloudFormation deploys infrastructure as code but does not provide an image build-and-test pipeline by itself."
            },
            {
              "id": "c1",
              "text": "EC2 Image Builder",
              "isCorrect": true,
              "explanation": "EC2 Image Builder automates the creation, patching, testing, and distribution of server images according to repeatable pipelines and policies."
            },
            {
              "id": "c3",
              "text": "Amazon Inspector",
              "isCorrect": false,
              "explanation": "Inspector performs vulnerability assessments but does not build or distribute hardened AMIs."
            },
            {
              "id": "c2",
              "text": "AWS Glue",
              "isCorrect": false,
              "explanation": "Glue is an ETL/data integration service, not an image-building pipeline."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Infrastructure Security",
          "services": [
            "EC2 Image Builder",
            "EC2",
            "Systems Manager"
          ],
          "docs": "https://docs.aws.amazon.com/imagebuilder/latest/userguide/what-is-image-builder.html",
          "tip": "Use automated image pipelines that include patching and configuration validation before distribution.",
          "explanation": "EC2 Image Builder provides a repeatable, auditable pipeline to produce hardened AMIs, including testing steps and integration with Systems Manager for patching and compliance verification."
        },
        {
          "id": "SCS-C03-0017",
          "question": "A network security team must capture all accepted and rejected traffic metadata for forensic analysis across 200 VPCs in a multi-account organisation. They need to query weeks of historical data on demand without maintaining always-on infrastructure. Which architecture meets these requirements most cost-effectively?",
          "choices": [
            {
              "id": "c1",
              "text": "Publish VPC Flow Logs to a centralised S3 bucket in the security account and query with Amazon Athena",
              "isCorrect": true,
              "explanation": "S3 storage is inexpensive at scale, and Athena provides serverless on-demand querying with no infrastructure to manage. Flow Logs support direct S3 delivery across accounts via resource policies."
            },
            {
              "id": "c3",
              "text": "Stream Flow Logs to an Amazon OpenSearch cluster for real-time dashboards and historical search",
              "isCorrect": false,
              "explanation": "OpenSearch provides powerful search but requires always-on cluster infrastructure, violating the no-maintained-infrastructure requirement and increasing cost."
            },
            {
              "id": "c2",
              "text": "Send VPC Flow Logs to CloudWatch Logs in each account and use CloudWatch Logs Insights for queries",
              "isCorrect": false,
              "explanation": "CloudWatch Logs Insights works well for recent data but becomes expensive at high volume over weeks, and cross-account querying adds operational complexity compared to a centralised S3 approach."
            },
            {
              "id": "c4",
              "text": "Enable Traffic Mirroring on all ENIs and capture full packets for analysis",
              "isCorrect": false,
              "explanation": "Traffic Mirroring captures full packet payloads, which is vastly more data than flow log metadata, increasing costs dramatically and exceeding what the team requested."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Detection",
          "services": [
            "VPC Flow Logs",
            "CloudWatch Logs",
            "S3",
            "Athena"
          ],
          "docs": "https://docs.aws.amazon.com/vpc/latest/userguide/flow-logs.html",
          "tip": "For large volumes of historical logs, use object storage plus an on-demand query engine for cost-effective analysis.",
          "explanation": "VPC Flow Logs can deliver directly to S3 in Parquet format with Hive-compatible partitioning, and Athena charges only per query scanned. This combination handles cross-account aggregation at scale without provisioning or maintaining any infrastructure."
        },
        {
          "id": "SCS-C03-0062",
          "question": "How should a CI/CD pipeline handle high-severity image vulnerabilities discovered by Inspector to enforce security gates?",
          "choices": [
            {
              "id": "c3",
              "text": "Ignore Inspector findings as false positives",
              "isCorrect": false,
              "explanation": "Blindly ignoring findings removes an important safety mechanism; investigate and triage findings appropriately."
            },
            {
              "id": "c4",
              "text": "Convert vulnerabilities into user stories without blocking releases",
              "isCorrect": false,
              "explanation": "Converting to backlog items without blocking promotion fails to protect production environments."
            },
            {
              "id": "c2",
              "text": "Allow the build but schedule a follow-up ticket",
              "isCorrect": false,
              "explanation": "Allowing promotion undermines enforcement and risks running vulnerable code in production."
            },
            {
              "id": "c1",
              "text": "Fail the build when high-severity vulnerabilities are found and require a remediation PR before promotion",
              "isCorrect": true,
              "explanation": "Blocking promotion of vulnerable images enforces security gates and prevents vulnerable artifacts from reaching production."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Infrastructure Security",
          "services": [
            "Inspector",
            "Security Hub",
            "Lambda"
          ],
          "docs": "https://docs.aws.amazon.com/inspector/latest/userguide/inspector_introduction.html",
          "tip": "Enforce CI gates for critical vulnerabilities and require remediation before promotion.",
          "explanation": "Integrating Inspector into CI/CD and failing builds for critical findings reduces the chance of vulnerable artifacts reaching production and ensures remediation is required."
        },
        {
          "id": "SCS-C03-0012",
          "question": "Which IAM mechanism lets you enforce that ceiling while preserving self-service?",
          "choices": [
            {
              "id": "c1",
              "text": "Require developers to attach a permissions boundary to every role they create",
              "isCorrect": true,
              "explanation": "Permissions boundaries cap the maximum permissions a role can have, even if the role's identity policy grants broader access."
            },
            {
              "id": "c3",
              "text": "Create a single shared Lambda execution role managed by the platform team",
              "isCorrect": false,
              "explanation": "A shared role works but violates least privilege because all functions share the same permissions regardless of their needs."
            },
            {
              "id": "c2",
              "text": "Grant developers iam:CreateRole but restrict the role's trust policy to lambda.amazonaws.com only",
              "isCorrect": false,
              "explanation": "Restricting the trust policy limits who can assume the role, but does not limit what permissions the role itself can have."
            },
            {
              "id": "c4",
              "text": "Use an SCP to deny iam:CreateRole for all developers and have the platform team create roles on request",
              "isCorrect": false,
              "explanation": "This removes developer self-service entirely, creating operational bottlenecks without enabling delegation."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Identity and Access Management",
          "services": [
            "IAM",
            "Organizations",
            "STS"
          ],
          "docs": "https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies_boundaries.html",
          "tip": "Consider permission boundary patterns to limit maximum permissions while enabling self-service.",
          "explanation": "IAM permissions boundaries act as a ceiling on the effective permissions of a role or user."
        },
        {
          "id": "SCS-C03-0037",
          "question": "For a critical service running in an Auto Scaling group behind an ALB, which monitoring approach provides aggregated health metrics and automated alerting for service-level availability?",
          "choices": [
            {
              "id": "c1",
              "text": "Create CloudWatch alarms on aggregated ALB and Auto Scaling metrics and notify via SNS to trigger automated remediation",
              "isCorrect": true,
              "explanation": "CloudWatch aggregates service metrics (ALB and ASG), allows alarm thresholds, and integrates with SNS and automated remediation actions such as scaling or Lambda-driven fixes."
            },
            {
              "id": "c3",
              "text": "Use S3 access logs aggregated into Athena queries to detect failures",
              "isCorrect": false,
              "explanation": "S3 access logs are eventual and not designed for real-time service availability monitoring."
            },
            {
              "id": "c2",
              "text": "Rely on CloudTrail event history to monitor service health and send alerts",
              "isCorrect": false,
              "explanation": "CloudTrail records API activity and is not suitable as a primary source of service health metrics or near-real-time availability alarms."
            },
            {
              "id": "c4",
              "text": "Attach detailed instance metrics to each EC2 instance and rely on manual inspection",
              "isCorrect": false,
              "explanation": "Instance-level metrics are useful but relying on manual inspection does not provide automated alerting or aggregated service-level visibility across an Auto Scaling group."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Detection",
          "services": [
            "CloudWatch",
            "Auto Scaling",
            "Elastic Load Balancing",
            "SNS"
          ],
          "docs": "https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/WhatIsCloudWatch.html",
          "tip": "Aggregate load balancer and auto-scaling metrics into alarms and connect them to alerting or automation for remediation.",
          "explanation": "CloudWatch is the natural aggregation point for service metrics; combining ALB and Auto Scaling metrics with alarms and SNS-driven automation provides both service-level visibility and automatic remediation triggers."
        },
        {
          "id": "SCS-C03-0023",
          "question": "A web application team needs to ensure that TLS certificates on their internet-facing ALBs are renewed automatically without any manual intervention or downtime. Certificates must support multiple subdomain names (e.g., api.example.com, app.example.com). Which approach meets these requirements?",
          "choices": [
            {
              "id": "c2",
              "text": "Purchase a wildcard certificate from a third-party CA, import it into ACM, and set a calendar reminder to renew it annually",
              "isCorrect": false,
              "explanation": "Imported certificates in ACM are not automatically renewed. Manual renewal and re-import is required, which introduces risk of expiration and human error."
            },
            {
              "id": "c1",
              "text": "Request a public ACM certificate with Subject Alternative Names (SANs) for each subdomain using DNS validation, and associate it with the ALB",
              "isCorrect": true,
              "explanation": "ACM public certificates with DNS validation renew automatically as long as the CNAME validation records remain in place. SANs allow multiple subdomains on a single certificate, and ALB natively integrates with ACM for zero-downtime deployment."
            },
            {
              "id": "c3",
              "text": "Use Let's Encrypt with certbot running on the ALB instances to obtain and renew certificates",
              "isCorrect": false,
              "explanation": "ALBs are managed services; you cannot run certbot or any agent on them. Let's Encrypt certificates must be imported into ACM, losing automatic renewal."
            },
            {
              "id": "c4",
              "text": "Generate a self-signed certificate for each subdomain and configure the ALB to present them using SNI",
              "isCorrect": false,
              "explanation": "Self-signed certificates are not trusted by browsers and will produce security warnings. They also require manual rotation, defeating the automation requirement."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Data Protection",
          "services": [
            "ACM",
            "CloudFront",
            "ALB",
            "Route 53"
          ],
          "docs": "https://docs.aws.amazon.com/acm/latest/userguide/acm-overview.html",
          "tip": "Automatic certificate renewal typically requires that the provider issued the certificate and an automated validation method is available.",
          "explanation": "AWS Certificate Manager issues free public certificates that renew automatically when DNS validation is used. By adding SANs for each subdomain, a single certificate covers multiple endpoints. ACM's native integration with ALB means certificate deployment and rotation happen transparently."
        },
        {
          "id": "SCS-C03-0042",
          "question": "Which architecture most cost-effectively stores months of high-volume logs for ad-hoc forensic queries?",
          "choices": [
            {
              "id": "c1",
              "text": "Deliver logs to S3 in partitioned Parquet and query with Athena",
              "isCorrect": true,
              "explanation": "S3 + Parquet + Athena supports low-cost storage and ad-hoc querying without always-on infrastructure."
            },
            {
              "id": "c3",
              "text": "Store logs in DynamoDB single-table design",
              "isCorrect": false,
              "explanation": "DynamoDB is not cost-effective for large historical log volumes and analytics queries."
            },
            {
              "id": "c4",
              "text": "Keep logs only on instance disk for speed",
              "isCorrect": false,
              "explanation": "Instance disks are ephemeral and unsuitable for long-term forensic retention."
            },
            {
              "id": "c2",
              "text": "Stream logs to OpenSearch with 90-day hot storage",
              "isCorrect": false,
              "explanation": "OpenSearch is efficient for real-time searches but expensive for long-term retention at scale."
            }
          ],
          "selectCount": 1,
          "format": "yaml",
          "domain": "Detection",
          "services": [
            "CloudWatch Logs",
            "Athena",
            "S3"
          ],
          "docs": "https://docs.aws.amazon.com/AmazonCloudWatch/latest/logs/WhatIsCloudWatchLogs.html",
          "tip": "Partition logs and use columnar formats to reduce query costs.",
          "explanation": "Exporting log data to S3 in Parquet with partitioning reduces query scan costs and enables scalable ad-hoc analysis via Athena or Lakehouse tools."
        },
        {
          "id": "SCS-C03-0008",
          "question": "You want AWS Config to spot S3 buckets with public read access automatically which CloudFormation snippet defines the correct managed Config rule?",
          "choices": [
            {
              "id": "c3",
              "text": "Use AWS CloudTrail to monitor S3:GetBucketPolicy API calls and alert when public access is detected",
              "isCorrect": false,
              "explanation": "CloudTrail monitors API calls but does not provide continuous compliance evaluation like AWS Config."
            },
            {
              "id": "c2",
              "text": "Type: AWS::Config::ConfigRule\nProperties:\n  ConfigRuleName: s3-bucket-public-read-prohibited\n  Source:\n    Owner: CUSTOM\n    SourceIdentifier: S3_BUCKET_PUBLIC_READ_PROHIBITED",
              "isCorrect": false,
              "explanation": "Owner: CUSTOM is for custom rules backed by Lambda functions, not AWS managed rules."
            },
            {
              "id": "c4",
              "text": "Enable S3 Block Public Access at the account level - this replaces the need for Config rules",
              "isCorrect": false,
              "explanation": "Block Public Access is preventive - it does not detect existing violations like a Config rule does."
            },
            {
              "id": "c1",
              "text": "Type: AWS::Config::ConfigRule\nProperties:\n  ConfigRuleName: s3-bucket-public-read-prohibited\n  Source:\n    Owner: AWS\n    SourceIdentifier: S3_BUCKET_PUBLIC_READ_PROHIBITED",
              "isCorrect": true,
              "explanation": "AWS managed Config rule using Owner: AWS and the standard S3 public read detection identifier."
            }
          ],
          "selectCount": 1,
          "format": "yaml",
          "domain": "Detection",
          "services": [
            "Config",
            "CloudFormation",
            "S3"
          ],
          "docs": "https://docs.aws.amazon.com/config/latest/developerguide/WhatIsConfig.html",
          "tip": "Managed rules often have predefined identifiers and are provided by the cloud provider.",
          "explanation": "AWS Config managed rules are pre-built by AWS and referenced with Owner: AWS plus a SourceIdentifier like S3_BUCKET_PUBLIC_READ_PROHIBITED."
        },
        {
          "id": "SCS-C03-0045",
          "question": "Given an IAM role ARN, which CLI command quickly reveals the caller identity to correlate with CloudTrail events?",
          "choices": [
            {
              "id": "c3",
              "text": "aws cloudtrail lookup-events",
              "isCorrect": false,
              "explanation": "Lookup-events finds historical events but does not directly reveal the current caller context."
            },
            {
              "id": "c1",
              "text": "aws sts get-caller-identity",
              "isCorrect": true,
              "explanation": "This STS call returns the effective principal; useful for correlating with CloudTrail event ARNs."
            },
            {
              "id": "c2",
              "text": "aws iam list-roles",
              "isCorrect": false,
              "explanation": "List-roles enumerates roles but doesn't show the runtime caller identity."
            },
            {
              "id": "c4",
              "text": "aws sts decode-authorization-message",
              "isCorrect": false,
              "explanation": "Decoding auth message requires a message from AWS and is not the general approach for caller identity."
            }
          ],
          "selectCount": 1,
          "format": "cli",
          "domain": "Incident Response",
          "services": [
            "IAM",
            "STS"
          ],
          "docs": "https://docs.aws.amazon.com/iam/latest/UserGuide/id_roles.html",
          "tip": "Use identity-revealing calls to confirm which principal is making API requests.",
          "explanation": "`get-caller-identity` is the simplest way to determine which principal is currently making API calls; pair it with CloudTrail to find related events."
        },
        {
          "id": "SCS-C03-0025",
          "question": "A Lambda function in a private subnet needs to call the Secrets Manager API to retrieve database credentials. The security team prohibits all internet-bound traffic from the VPC. How should the architect configure network access so the Lambda function can reach Secrets Manager without traversing the internet?",
          "choices": [
            {
              "id": "c4",
              "text": "Configure the Lambda function outside the VPC so it can access Secrets Manager over the internet by default",
              "isCorrect": false,
              "explanation": "Placing the function outside the VPC gives it internet access to AWS APIs, but the question states the function is in a private subnet, and moving it out may break access to other VPC resources like the database."
            },
            {
              "id": "c1",
              "text": "Create an interface VPC endpoint (PrivateLink) for Secrets Manager in the same VPC and ensure the Lambda function's security group allows outbound HTTPS to the endpoint",
              "isCorrect": true,
              "explanation": "An interface VPC endpoint creates private ENIs within the VPC that route traffic to the Secrets Manager API entirely over the AWS private network, with no internet path required."
            },
            {
              "id": "c2",
              "text": "Add a NAT Gateway to the VPC and route the Lambda subnet's traffic through it",
              "isCorrect": false,
              "explanation": "A NAT Gateway provides internet access for outbound traffic, which violates the security team's prohibition on internet-bound traffic from the VPC."
            },
            {
              "id": "c3",
              "text": "Attach an Elastic IP to the Lambda function's ENI for direct outbound access",
              "isCorrect": false,
              "explanation": "Lambda functions in a VPC do not support Elastic IPs, and this approach would use the internet gateway, which is prohibited."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Infrastructure Security",
          "services": [
            "Lambda",
            "VPC",
            "NAT Gateway",
            "PrivateLink",
            "Secrets Manager"
          ],
          "docs": "https://docs.aws.amazon.com/lambda/latest/dg/configuration-vpc.html",
          "tip": "Private endpoints can provide service APIs over private network paths when internet access is restricted.",
          "explanation": "Interface VPC endpoints (powered by AWS PrivateLink) create private IP addresses inside the VPC that serve as entry points for AWS service APIs. Traffic never leaves the AWS network, satisfying zero-internet-egress security requirements while allowing Lambda to call Secrets Manager."
        },
        {
          "id": "SCS-C03-0054",
          "question": "What is a key operational difference between imported key material and AWS-generated KMS keys?",
          "choices": [
            {
              "id": "c1",
              "text": "Imported key material may have restrictions on automatic rotation and cannot be exported by AWS; customer manages lifecycle",
              "isCorrect": true,
              "explanation": "Imported key material is under customer control for import/removal and has different rotation/export characteristics than AWS-generated keys."
            },
            {
              "id": "c4",
              "text": "AWS may export imported key material to other customers",
              "isCorrect": false,
              "explanation": "AWS does not export customer-imported key material; it's managed per customer account/CMK."
            },
            {
              "id": "c3",
              "text": "Imported keys are free of charge for cross-region usage",
              "isCorrect": false,
              "explanation": "Billing is not the defining operational difference; cross-region use still requires correct configuration."
            },
            {
              "id": "c2",
              "text": "Imported key material automatically rotates daily",
              "isCorrect": false,
              "explanation": "Automatic daily rotation is not a feature of imported key material; rotation must be managed by the customer."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Data Protection",
          "services": [
            "KMS",
            "CloudHSM",
            "Secrets Manager"
          ],
          "docs": "https://docs.aws.amazon.com/KMS/latest/developerguide/importing-keys.html",
          "tip": "Imported key material imposes additional lifecycle and rotation responsibilities on the customer.",
          "explanation": "Choosing imported key material affects rotation, import windows, and export constraints; plan operational processes accordingly."
        },
        {
          "id": "SCS-C03-0052",
          "question": "Which AWS feature helps simulate a principal's effective permissions to diagnose an unexpected AccessDenied?",
          "choices": [
            {
              "id": "c2",
              "text": "AWS Config",
              "isCorrect": false,
              "explanation": "Config tracks resource configurations but does not simulate policy evaluation for a principal."
            },
            {
              "id": "c4",
              "text": "S3 Access Analyzer",
              "isCorrect": false,
              "explanation": "Access Analyzer inspects resource-based policies for external access, not per-principal simulation of permissions."
            },
            {
              "id": "c1",
              "text": "IAM Policy Simulator",
              "isCorrect": true,
              "explanation": "IAM Policy Simulator evaluates policies to determine whether a given action would be allowed for a principal and helps diagnose AccessDenied errors."
            },
            {
              "id": "c3",
              "text": "CloudTrail data events",
              "isCorrect": false,
              "explanation": "CloudTrail records events but does not simulate policy evaluation prior to the request."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Identity and Access Management",
          "services": [
            "IAM",
            "Access Analyzer",
            "KMS"
          ],
          "docs": "https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies.html",
          "tip": "Use policy simulation tools to reproduce and diagnose access-denied scenarios.",
          "explanation": "Policy Simulator can combine identity and resource policies to explain why a request was denied and recommend policy changes."
        },
        {
          "id": "SCS-C03-0046",
          "question": "Faced with application-layer bot traffic and volumetric DDoS, which combined edge strategy provides layered protection?",
          "choices": [
            {
              "id": "c3",
              "text": "Rely on client-side Captcha only",
              "isCorrect": false,
              "explanation": "Client-side controls can be bypassed and don't handle volumetric network-level attacks."
            },
            {
              "id": "c1",
              "text": "Use AWS Shield Advanced for DDoS and AWS WAF at CloudFront for application-layer filtering",
              "isCorrect": true,
              "explanation": "Shield Advanced mitigates volumetric network attacks while WAF filters application-layer patterns such as bots and OWASP threats."
            },
            {
              "id": "c4",
              "text": "Increase EC2 instance sizes behind the load balancer",
              "isCorrect": false,
              "explanation": "Scaling instances may help capacity but does not stop DDoS or malicious application-layer requests at the edge."
            },
            {
              "id": "c2",
              "text": "Only enable security groups at the origin",
              "isCorrect": false,
              "explanation": "Security groups do not protect the global edge nor mitigate volumetric attacks effectively."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Infrastructure Security",
          "services": [
            "WAF",
            "CloudFront",
            "Shield"
          ],
          "docs": "https://docs.aws.amazon.com/waf/latest/developerguide/waf-chapter.html",
          "tip": "Defence-in-depth at the edge combines network- and application-layer protections.",
          "explanation": "Defence in depth: Shield Advanced for volumetric and network-layer attacks, WAF for application-layer patterns, and CloudFront for caching and geographic distribution."
        },
        {
          "id": "SCS-C03-0006",
          "question": "Your security team needs a single place for findings and strong key management for encrypted data which TWO services should they use together? (Select TWO)",
          "choices": [
            {
              "id": "c3",
              "text": "Amazon SQS",
              "isCorrect": false,
              "explanation": "SQS is a message queuing service, not related to security findings or encryption."
            },
            {
              "id": "c2",
              "text": "AWS KMS",
              "isCorrect": true,
              "explanation": "KMS provides centralized encryption key management for encrypting data at rest."
            },
            {
              "id": "c4",
              "text": "AWS CloudFormation",
              "isCorrect": false,
              "explanation": "CloudFormation is an infrastructure-as-code service, not a security findings tool."
            },
            {
              "id": "c5",
              "text": "Amazon EC2",
              "isCorrect": false,
              "explanation": "EC2 provides virtual machines, not security findings management."
            },
            {
              "id": "c1",
              "text": "AWS Security Hub",
              "isCorrect": true,
              "explanation": "Security Hub provides a comprehensive view of security alerts and compliance status across accounts."
            }
          ],
          "selectCount": 2,
          "format": "text",
          "domain": "Detection",
          "services": [
            "Security Hub",
            "KMS",
            "SQS",
            "CloudFormation",
            "EC2"
          ],
          "docs": "https://docs.aws.amazon.com/securityhub/latest/userguide/what-is-securityhub.html",
          "tip": "Consider centralizing findings and using strong key management practices.",
          "explanation": "Security Hub aggregates and normalizes findings and KMS provides the keys to encrypt sensitive data."
        },
        {
          "id": "SCS-C03-0047",
          "question": "Which practice grants least-privilege permissions to pods running in EKS for accessing AWS APIs?",
          "choices": [
            {
              "id": "c3",
              "text": "Use instance metadata to share credentials across pods",
              "isCorrect": false,
              "explanation": "Instance metadata exposes node credentials and is not recommended for per-pod least-privilege."
            },
            {
              "id": "c4",
              "text": "Store AWS keys in pod environment variables at build time",
              "isCorrect": false,
              "explanation": "Hard-coding keys in images is insecure and prevents rotation."
            },
            {
              "id": "c1",
              "text": "Use IRSA (IAM Roles for Service Accounts) to map service accounts to IAM roles with narrow permissions",
              "isCorrect": true,
              "explanation": "IRSA ties an IAM role to a Kubernetes service account, allowing fine-grained, pod-level permissions."
            },
            {
              "id": "c2",
              "text": "Attach a broad IAM role to all worker nodes",
              "isCorrect": false,
              "explanation": "Node roles provide host-level permissions and risk privilege escalation from any pod to node-level permissions."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Identity and Access Management",
          "services": [
            "EKS",
            "IAM",
            "STS"
          ],
          "docs": "https://docs.aws.amazon.com/eks/latest/userguide/iam-roles-for-service-accounts.html",
          "tip": "Use workload-scoped identity mechanisms to grant narrow, auditable pod permissions.",
          "explanation": "IRSA provides workload identity that limits permissions to the specific service account and namespace, reducing blast radius and improving auditability."
        },
        {
          "id": "SCS-C03-0044",
          "question": "Which log sources are most relevant when troubleshooting intermittent 502 responses from an ALB?",
          "choices": [
            {
              "id": "c3",
              "text": "Route 53 DNS query logs",
              "isCorrect": false,
              "explanation": "DNS logs don't provide HTTP backend error details."
            },
            {
              "id": "c4",
              "text": "IAM access logs",
              "isCorrect": false,
              "explanation": "IAM logs are unrelated to HTTP 502 responses."
            },
            {
              "id": "c2",
              "text": "S3 server access logs only",
              "isCorrect": false,
              "explanation": "S3 logs are irrelevant to ALB 502s unless the origin is S3, which is uncommon for dynamic backends."
            },
            {
              "id": "c1",
              "text": "ALB access logs, target group health checks, and CloudWatch metrics for targets",
              "isCorrect": true,
              "explanation": "ALB access logs show request/response details; target health and metrics reveal backend errors that cause 502s."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Detection",
          "services": [
            "ALB",
            "Target Groups",
            "Auto Scaling"
          ],
          "docs": "https://docs.aws.amazon.com/elasticloadbalancing/latest/application/load-balancer-target-groups.html",
          "tip": "Correlate access logs with backend health and metrics when investigating HTTP errors.",
          "explanation": "Investigations into 502 errors should include ALB access logs (to see upstream responses), backend target health and metrics (to spot crashes), and application logs where possible."
        },
        {
          "id": "SCS-C03-0026",
          "question": "A company with 50 AWS accounts wants to enforce a baseline set of preventive and detective security controls (e.g., disallow public S3 buckets, require CloudTrail in all regions) across all accounts. They need a managed landing zone that automatically applies these controls to new accounts as they are created. Which service provides this capability?",
          "choices": [
            {
              "id": "c3",
              "text": "AWS Security Hub with the AWS Foundational Security Best Practices standard",
              "isCorrect": false,
              "explanation": "Security Hub detects deviations from best practices (detective) but does not prevent them (preventive). It also does not provision or manage accounts or landing zones."
            },
            {
              "id": "c4",
              "text": "AWS Trusted Advisor organisational view",
              "isCorrect": false,
              "explanation": "Trusted Advisor provides recommendations and checks but does not enforce controls or manage account provisioning or landing zones."
            },
            {
              "id": "c2",
              "text": "AWS Organizations with manually written SCPs and Config rules deployed via StackSets",
              "isCorrect": false,
              "explanation": "This approach works but requires manual authoring, testing, and deployment of each control. Control Tower automates this with curated, pre-tested guardrails and handles new-account enrollment automatically."
            },
            {
              "id": "c1",
              "text": "AWS Control Tower with mandatory and elective guardrails",
              "isCorrect": true,
              "explanation": "Control Tower provides a managed landing zone with pre-configured guardrails (implemented as SCPs for preventive controls and Config rules for detective controls) that are automatically applied to accounts enrolled in the landing zone."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Identity and Access Management",
          "services": [
            "Control Tower",
            "Organizations",
            "Config",
            "CloudFormation"
          ],
          "docs": "https://docs.aws.amazon.com/controltower/latest/userguide/guardrails.html",
          "tip": "Managed landing zone patterns enforce guardrails automatically during account provisioning.",
          "explanation": "Control Tower orchestrates Organizations, Config, CloudFormation, and IAM Identity Center to create a governed multi-account environment. Its guardrails are curated controls that are automatically enforced (preventive via SCPs) or monitored (detective via Config rules) across all enrolled accounts, including newly created ones."
        },
        {
          "id": "SCS-C03-0058",
          "question": "To rate-limit abusive clients at the edge while preserving legitimate traffic, which feature combination should be used?",
          "choices": [
            {
              "id": "c1",
              "text": "AWS WAF rate-based rules on CloudFront with CloudFront caching",
              "isCorrect": true,
              "explanation": "WAF rate-based rules block clients over request thresholds while CloudFront caching reduces backend load for legitimate traffic."
            },
            {
              "id": "c3",
              "text": "Increase origin instance capacity",
              "isCorrect": false,
              "explanation": "Scaling origin capacity doesn't stop abusive traffic or reduce edge processing cost."
            },
            {
              "id": "c4",
              "text": "Use Route 53 geolocation routing only",
              "isCorrect": false,
              "explanation": "Geolocation routing doesn't provide rate-limiting or application-layer filtering."
            },
            {
              "id": "c2",
              "text": "NACL rules to block IP ranges",
              "isCorrect": false,
              "explanation": "NACLs are coarse-grained and do not provide application-layer rate limiting."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Infrastructure Security",
          "services": [
            "ALB",
            "WAF",
            "Route 53"
          ],
          "docs": "https://docs.aws.amazon.com/elasticloadbalancing/latest/application/listener-update-rule.html",
          "tip": "Implement edge rate-limiting close to users and combine caching to reduce backend load.",
          "explanation": "WAF's rate-based rules applied at CloudFront prevent abusive clients from reaching origin and, combined with caching, protect backend capacity."
        },
        {
          "id": "SCS-C03-0055",
          "question": "Which pattern centralizes billing, consolidated policies, and delegated security administration across many accounts?",
          "choices": [
            {
              "id": "c2",
              "text": "Manage each account independently with separate billing",
              "isCorrect": false,
              "explanation": "Independent accounts increase operational overhead and hinder centralized policy enforcement."
            },
            {
              "id": "c4",
              "text": "Delegate everything to third-party SaaS governance tools only",
              "isCorrect": false,
              "explanation": "Third-party tools can help but AWS Organizations provides foundational native patterns for central control."
            },
            {
              "id": "c3",
              "text": "Use a single shared AWS account for all teams",
              "isCorrect": false,
              "explanation": "A single account lacks isolation and governance for multiple teams or environments."
            },
            {
              "id": "c1",
              "text": "Use AWS Organizations with an organizational management account, OUs for environment separation, and delegated admin roles",
              "isCorrect": true,
              "explanation": "Organizations centralize management, apply SCPs, and enable delegated admin accounts for service management across member accounts."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Security Foundations and Governance",
          "services": [
            "Organizations",
            "IAM",
            "CloudTrail"
          ],
          "docs": "https://docs.aws.amazon.com/whitepapers/latest/aws-security-best-practices/overview.html",
          "tip": "Organize accounts with OUs and delegated administration for scale and governance.",
          "explanation": "AWS Organizations supports centralized billing, SCPs for guardrails, and delegated admin roles for services such as GuardDuty or Security Hub, enabling scalable governance."
        },
        {
          "id": "SCS-C03-0007",
          "question": "You're locking down access so an IAM role can only reach an S3 bucket via a specific VPC endpoint. Which condition should you add to the policy to enforce this?",
          "choices": [
            {
              "id": "c3",
              "text": "Add the VPC endpoint ID to the IAM role's trust policy as a Principal",
              "isCorrect": false,
              "explanation": "VPC endpoints are not IAM principals and cannot appear in a trust policy's Principal element."
            },
            {
              "id": "c2",
              "text": "{\"Condition\": {\"IpAddress\": {\"aws:SourceIp\": \"10.0.0.0/16\"}}}",
              "isCorrect": false,
              "explanation": "IpAddress/SourceIp restricts by IP range, not by VPC endpoint identity."
            },
            {
              "id": "c4",
              "text": "Attach a security group to the IAM role that only allows traffic from the VPC",
              "isCorrect": false,
              "explanation": "Security groups are network-level controls for ENIs - they cannot be attached to IAM roles."
            },
            {
              "id": "c1",
              "text": "{\"Condition\": {\"StringEquals\": {\"aws:sourceVpce\": \"vpce-certshack123\"}}}",
              "isCorrect": true,
              "explanation": "aws:sourceVpce condition restricts the policy to requests through the specified VPC endpoint."
            }
          ],
          "selectCount": 1,
          "format": "json",
          "domain": "Identity and Access Management",
          "services": [
            "IAM",
            "S3"
          ],
          "docs": "https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies.html",
          "tip": "Restrict access by considering VPC endpoint-based conditions in resource policies.",
          "explanation": "The aws:sourceVpce condition key with StringEquals restricts access to requests that traverse a specific VPC endpoint."
        },
        {
          "id": "SCS-C03-0010",
          "question": "You must prevent any account in your Org from launching EC2 instances outside eu-west-1 and eu-west-2 which preventive control should you apply across the organization?",
          "choices": [
            {
              "id": "c4",
              "text": "Use a CloudFormation StackSet with a hook that blocks ec2:RunInstances in disallowed regions",
              "isCorrect": false,
              "explanation": "CloudFormation hooks validate CloudFormation-managed resources only, not direct API calls or console launches."
            },
            {
              "id": "c2",
              "text": "Create an IAM policy in each account that denies ec2:RunInstances outside eu-west-1 and eu-west-2, and attach it to every IAM user and role",
              "isCorrect": false,
              "explanation": "Per-account IAM policies can be removed by local administrators, and new users or roles might not receive the policy."
            },
            {
              "id": "c3",
              "text": "Deploy an AWS Config rule that evaluates EC2 instances and flags any launched outside the allowed regions as non-compliant",
              "isCorrect": false,
              "explanation": "Config rules are detective, not preventive - the instance would already be running before Config flags it."
            },
            {
              "id": "c1",
              "text": "Attach a Service Control Policy (SCP) to the organisation root or target OUs that denies ec2:RunInstances unless the aws:RequestedRegion condition matches eu-west-1 or eu-west-2",
              "isCorrect": true,
              "explanation": "SCPs set maximum permission boundaries across all accounts in an OU or organisation, overriding any IAM policy within those accounts."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Identity and Access Management",
          "services": [
            "Organizations",
            "IAM",
            "Config",
            "CloudFormation"
          ],
          "docs": "https://docs.aws.amazon.com/organizations/latest/userguide/orgs_manage_policies_scps.html",
          "tip": "When account-wide preventive guardrails are required, use centralized policy mechanisms.",
          "explanation": "Service Control Policies (SCPs) in AWS Organizations act as guardrails that define the maximum permissions available to all principals in member accounts."
        },
        {
          "id": "SCS-C03-0030",
          "question": "A disaster recovery plan requires that all objects in a production S3 bucket encrypted with a customer-managed KMS key be replicated to a bucket in a different region using a different KMS key. Which TWO configurations are required for cross-region replication to work with KMS-encrypted objects? (Select TWO)",
          "choices": [
            {
              "id": "c4",
              "text": "Enable S3 Transfer Acceleration on both buckets to speed up cross-region replication",
              "isCorrect": false,
              "explanation": "Transfer Acceleration optimizes direct uploads via CloudFront edge locations. It is not related to S3 replication, which uses its own internal transfer mechanism."
            },
            {
              "id": "c5",
              "text": "Disable KMS encryption on the destination bucket and use SSE-S3 instead",
              "isCorrect": false,
              "explanation": "Switching to SSE-S3 would avoid KMS complexity but loses the benefits of customer-managed key control, audit via CloudTrail, and compliance requirements that may mandate CMK usage."
            },
            {
              "id": "c1",
              "text": "Specify the destination KMS key ARN in the replication rule configuration",
              "isCorrect": true,
              "explanation": "When replicating KMS-encrypted objects, the replication configuration must specify the destination KMS key so S3 can re-encrypt the objects in the destination region."
            },
            {
              "id": "c3",
              "text": "Use the same KMS key in both the source and destination regions",
              "isCorrect": false,
              "explanation": "KMS keys are regional. A key in us-east-1 cannot be used in eu-west-1. Multi-Region KMS keys exist but are not required; specifying the destination key in the replication rule is sufficient."
            },
            {
              "id": "c2",
              "text": "Grant the S3 replication role kms:Decrypt permission on the source key and kms:Encrypt permission on the destination key",
              "isCorrect": true,
              "explanation": "The replication role must decrypt the objects using the source CMK and then encrypt them with the destination CMK. Without both permissions, replication fails with AccessDenied."
            }
          ],
          "selectCount": 2,
          "format": "text",
          "domain": "Data Protection",
          "services": [
            "S3",
            "KMS",
            "IAM",
            "Organizations"
          ],
          "docs": "https://docs.aws.amazon.com/AmazonS3/latest/userguide/replication-walkthrough-2.html",
          "tip": "Cross-account or cross-region key replication requires careful role permissions and key configuration on both ends.",
          "explanation": "S3 replication with SSE-KMS objects requires two key configurations: the replication rule must specify the destination KMS key ARN (since KMS keys are regional), and the replication IAM role must have kms:Decrypt on the source key plus kms:Encrypt and kms:GenerateDataKey on the destination key."
        },
        {
          "id": "SCS-C03-0013",
          "question": "An organisation wants to automatically isolate an EC2 instance when GuardDuty detects cryptocurrency mining activity. Which architecture achieves automated remediation with the least operational overhead?",
          "choices": [
            {
              "id": "c1",
              "text": "Configure GuardDuty findings to flow into EventBridge and trigger a Lambda that isolates the instance",
              "isCorrect": true,
              "explanation": "EventBridge rules can filter GuardDuty finding types and invoke Lambda for automated remediation."
            },
            {
              "id": "c2",
              "text": "Enable Security Hub automated response playbooks to quarantine instances",
              "isCorrect": false,
              "explanation": "Security Hub aggregates findings but does not have built-in quarantine playbooks."
            },
            {
              "id": "c3",
              "text": "Schedule a Lambda to poll GuardDuty every five minutes and isolate flagged instances",
              "isCorrect": false,
              "explanation": "Polling introduces delay and extra maintenance."
            },
            {
              "id": "c4",
              "text": "Use Systems Manager Automation runbooks triggered by a CPU alarm to stop instances",
              "isCorrect": false,
              "explanation": "CPU alarms are generic and can cause false positives."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Incident Response",
          "services": [
            "GuardDuty",
            "Security Hub",
            "EventBridge",
            "Lambda",
            "Systems Manager"
          ],
          "docs": "https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_finding-types-ec2.html",
          "tip": "Prefer event-driven, near-real-time response systems that require minimal maintenance for detections.",
          "explanation": "GuardDuty publishes findings to EventBridge in near-real-time, enabling immediate Lambda-driven remediation."
        },
        {
          "id": "SCS-C03-0001",
          "question": "You're the security lead for a multi-account AWS environment. Which AWS service helps aggregate and analyze security findings across accounts?",
          "choices": [
            {
              "id": "c3",
              "text": "AWS WAF",
              "isCorrect": false,
              "explanation": "AWS WAF is a web application firewall focused on HTTP(S) protections."
            },
            {
              "id": "c2",
              "text": "AWS Config",
              "isCorrect": false,
              "explanation": "AWS Config tracks resource configuration and compliance, not threat detection."
            },
            {
              "id": "c1",
              "text": "Amazon GuardDuty",
              "isCorrect": true,
              "explanation": "GuardDuty is a threat detection service that continuously monitors for malicious activity and unauthorized behavior."
            },
            {
              "id": "c4",
              "text": "Amazon SNS",
              "isCorrect": false,
              "explanation": "Amazon SNS is a notification service, not a security findings aggregator."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Detection",
          "services": [
            "GuardDuty",
            "Config",
            "WAF",
            "SNS"
          ],
          "docs": "https://docs.aws.amazon.com/guardduty/latest/ug/what-is-guardduty.html",
          "tip": "Consider a managed threat-detection service that finds anomalous activity using threat intelligence and ML.",
          "explanation": "Amazon GuardDuty uses ML models and threat intelligence feeds to continuously detect threats across accounts. The closest wrong answer is AWS Config, which evaluates resource configuration compliance, whereas GuardDuty detects active threats."
        },
        {
          "id": "SCS-C03-0003",
          "question": "You need to block malicious HTTP traffic before it reaches your origin which service should you pair with CloudFront to filter requests at the edge?",
          "choices": [
            {
              "id": "c1",
              "text": "AWS WAF",
              "isCorrect": true,
              "explanation": "AWS WAF is the web application firewall used with CloudFront to filter HTTP(S) traffic."
            },
            {
              "id": "c3",
              "text": "VPC Endpoint",
              "isCorrect": false,
              "explanation": "VPC Endpoints provide private connectivity to services within a VPC, not edge HTTP filtering."
            },
            {
              "id": "c2",
              "text": "Security Groups",
              "isCorrect": false,
              "explanation": "Security Groups control traffic to EC2 at the instance level, not the CloudFront edge."
            },
            {
              "id": "c4",
              "text": "AWS KMS",
              "isCorrect": false,
              "explanation": "AWS KMS is for key management and encryption, not traffic filtering."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Infrastructure Security",
          "services": [
            "WAF",
            "CloudFront",
            "Security Groups"
          ],
          "docs": "https://docs.aws.amazon.com/waf/latest/developerguide/waf-chapter.html",
          "tip": "Consider application-layer filtering at the edge to block common web attack patterns.",
          "explanation": "AWS WAF integrates natively with CloudFront, ALB, and API Gateway to inspect and filter HTTP(S) requests using rules such as rate limiting and SQL injection detection."
        },
        {
          "id": "SCS-C03-0021",
          "question": "A company needs to inspect all egress traffic from its VPC for data exfiltration patterns using Suricata-compatible IDS/IPS rules at the network layer. Security Groups and NACLs are already in place for basic access control. Which service should they deploy?",
          "choices": [
            {
              "id": "c3",
              "text": "Tighten Security Group outbound rules to restrict destination IPs",
              "isCorrect": false,
              "explanation": "Security Groups provide stateful allow/deny by IP and port but cannot perform deep packet inspection or pattern-based detection of data exfiltration."
            },
            {
              "id": "c4",
              "text": "Configure more restrictive NACLs on the VPC subnets",
              "isCorrect": false,
              "explanation": "NACLs are stateless IP/port filters. They cannot inspect packet payloads or apply IDS/IPS signature-based rules."
            },
            {
              "id": "c2",
              "text": "AWS WAF",
              "isCorrect": false,
              "explanation": "WAF operates at Layer 7 (HTTP/HTTPS) and integrates with CloudFront, ALB, and API Gateway. It cannot inspect arbitrary TCP/UDP egress traffic or run Suricata rules."
            },
            {
              "id": "c1",
              "text": "AWS Network Firewall",
              "isCorrect": true,
              "explanation": "Network Firewall is a managed, stateful network firewall that supports Suricata-compatible rules for deep packet inspection, IDS/IPS, and domain-based filtering on both ingress and egress traffic."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Infrastructure Security",
          "services": [
            "Network Firewall",
            "WAF",
            "Security Groups",
            "NACLs"
          ],
          "docs": "https://docs.aws.amazon.com/network-firewall/latest/developerguide/what-is-aws-network-firewall.html",
          "tip": "Deep packet inspection and IDS/IPS operate at different layers than security groups or application firewalls.",
          "explanation": "AWS Network Firewall sits in-line in VPC traffic paths (via Gateway Load Balancer endpoints or firewall subnets) and evaluates packets against stateful Suricata-compatible rule groups. It fills the gap between simple Security Group/NACL controls and full deep-packet inspection requirements."
        },
        {
          "id": "SCS-C03-0028",
          "question": "A data engineering team needs their Lambda function to decrypt objects in an S3 bucket that uses SSE-KMS with a customer-managed key. The function's execution role has s3:GetObject permission. Decryption attempts fail with AccessDeniedException from KMS. Which key policy statement, added to the CMK, resolves this?",
          "choices": [
            {
              "id": "c3",
              "text": "Add kms:Decrypt to the Lambda execution role's IAM policy without changing the key policy",
              "isCorrect": false,
              "explanation": "For customer-managed KMS keys, both the key policy AND the IAM policy must allow the action. If the key policy does not grant access to the principal, the IAM policy alone is insufficient."
            },
            {
              "id": "c4",
              "text": "Change the bucket encryption from SSE-KMS to SSE-S3 to avoid the KMS dependency",
              "isCorrect": false,
              "explanation": "Switching to SSE-S3 would eliminate the error, but it removes the ability to control access through KMS key policies, audit key usage via CloudTrail, and use customer-managed key rotation, which may be required by policy."
            },
            {
              "id": "c1",
              "text": "{\"Sid\":\"AllowLambdaDecrypt\",\"Effect\":\"Allow\",\"Principal\":{\"AWS\":\"arn:aws:iam::123456789012:role/lambda-exec-role\"},\"Action\":[\"kms:Decrypt\",\"kms:DescribeKey\"],\"Resource\":\"*\"}",
              "isCorrect": true,
              "explanation": "The Lambda execution role needs kms:Decrypt (to decrypt the data key protecting the S3 object) and kms:DescribeKey (to validate the key). The key policy must explicitly grant these actions to the role's ARN."
            },
            {
              "id": "c2",
              "text": "{\"Sid\":\"AllowLambdaDecrypt\",\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"lambda.amazonaws.com\"},\"Action\":[\"kms:Decrypt\"],\"Resource\":\"*\"}",
              "isCorrect": false,
              "explanation": "KMS key policies should grant permissions to the IAM role, not to the Lambda service principal. The service principal is used in trust policies, not key policies."
            }
          ],
          "selectCount": 1,
          "format": "json",
          "domain": "Data Protection",
          "services": [
            "KMS",
            "IAM",
            "S3",
            "Lambda"
          ],
          "docs": "https://docs.aws.amazon.com/kms/latest/developerguide/key-policy-modifying.html",
          "tip": "Customer-managed keys often require permissions in both the key's policy and the caller's identity policy.",
          "explanation": "Customer-managed KMS keys use a resource-based policy (key policy) that must explicitly allow principals to perform cryptographic operations. Unlike AWS-managed keys, there is no automatic cross-grant. Both the key policy and the IAM policy on the caller must allow the action for it to succeed."
        },
        {
          "id": "SCS-C03-0016",
          "question": "A development team stores database credentials in environment variables baked into their container images. The security team requires that credentials be rotated every 30 days without redeploying containers and that all credential access be auditable. Which approach best meets these requirements?",
          "choices": [
            {
              "id": "c3",
              "text": "Encrypt the environment variables at build time with a KMS key and decrypt them at container start",
              "isCorrect": false,
              "explanation": "This protects secrets at rest in the image, but rotating requires rebuilding and redeploying the container, which violates the no-redeploy requirement."
            },
            {
              "id": "c1",
              "text": "Store credentials in AWS Secrets Manager with automatic rotation enabled and retrieve them at runtime using the Secrets Manager SDK",
              "isCorrect": true,
              "explanation": "Secrets Manager supports automatic rotation via Lambda, provides versioned secrets so applications always fetch the current value at runtime, and logs all access through CloudTrail."
            },
            {
              "id": "c2",
              "text": "Store credentials in SSM Parameter Store SecureString parameters and write a cron job to update them monthly",
              "isCorrect": false,
              "explanation": "Parameter Store SecureStrings can hold secrets but lack built-in automatic rotation. A cron job is fragile and requires custom coordination with both the parameter and the database."
            },
            {
              "id": "c4",
              "text": "Use IAM database authentication to eliminate passwords entirely",
              "isCorrect": false,
              "explanation": "IAM database authentication works only with supported engines (Aurora MySQL/PostgreSQL, RDS MySQL/PostgreSQL) and may not cover all the team's databases. It also does not address other types of credentials."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Data Protection",
          "services": [
            "Secrets Manager",
            "Parameter Store",
            "KMS",
            "Lambda"
          ],
          "docs": "https://docs.aws.amazon.com/secretsmanager/latest/userguide/intro.html",
          "tip": "To avoid redeploys on rotation, applications should retrieve secrets dynamically at runtime.",
          "explanation": "Secrets Manager is purpose-built for credential lifecycle management. Its rotation feature invokes a Lambda function on a schedule to update both the secret value and the target resource (e.g., RDS password), while applications retrieve the current secret at runtime, eliminating the need for redeployment."
        },
        {
          "id": "SCS-C03-0004",
          "question": "You're designing a system that avoids long-lived keys. Which AWS feature helps enforce least privilege by issuing temporary credentials?",
          "choices": [
            {
              "id": "c4",
              "text": "Amazon Cognito",
              "isCorrect": false,
              "explanation": "Amazon Cognito provides user identity for apps, but the core mechanism for temporary AWS credentials is STS with roles."
            },
            {
              "id": "c3",
              "text": "Security Groups",
              "isCorrect": false,
              "explanation": "Security Groups are network controls, not credential mechanisms."
            },
            {
              "id": "c2",
              "text": "IAM Users with long-term access keys",
              "isCorrect": false,
              "explanation": "IAM Users with long-term keys are not recommended for least-privilege patterns."
            },
            {
              "id": "c1",
              "text": "IAM Roles with STS",
              "isCorrect": true,
              "explanation": "IAM Roles with STS allow issuance of temporary credentials for short-term access."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Identity and Access Management",
          "services": [
            "IAM",
            "STS",
            "Cognito"
          ],
          "docs": "https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles.html",
          "tip": "Prefer short-lived credentials rather than long-lived keys to reduce exposure.",
          "explanation": "IAM Roles combined with AWS STS issue temporary credentials that automatically expire, reducing blast radius if leaked."
        },
        {
          "id": "SCS-C03-0027",
          "question": "A security team has an AWS Config rule that detects S3 buckets without default encryption enabled. They want Config to automatically remediate non-compliant buckets by applying AES-256 server-side encryption. Which CloudFormation snippet correctly defines the auto-remediation action?",
          "choices": [
            {
              "id": "c2",
              "text": "Type: AWS::Config::RemediationConfiguration\nProperties:\n  ConfigRuleName: s3-bucket-server-side-encryption-enabled\n  TargetType: LAMBDA\n  TargetId: arn:aws:lambda:us-east-1:123456789012:function:fix-encryption\n  Automatic: true",
              "isCorrect": false,
              "explanation": "Config remediation currently only supports SSM_DOCUMENT as a TargetType. Lambda functions cannot be used directly as remediation targets in a RemediationConfiguration resource."
            },
            {
              "id": "c3",
              "text": "Add a ComplianceResourceTypes property to the Config rule that triggers an SNS notification, then subscribe a Lambda function to apply encryption",
              "isCorrect": false,
              "explanation": "This creates a notification pipeline, not an automatic remediation. It also requires custom SNS-to-Lambda wiring and does not use Config's built-in remediation feature."
            },
            {
              "id": "c4",
              "text": "Use an EventBridge rule to detect Config compliance change events and invoke a Step Functions workflow",
              "isCorrect": false,
              "explanation": "While this architecture works, it bypasses Config's native remediation capability, introducing more components to build and maintain. The question asks for Config auto-remediation."
            },
            {
              "id": "c1",
              "text": "Type: AWS::Config::RemediationConfiguration\nProperties:\n  ConfigRuleName: s3-bucket-server-side-encryption-enabled\n  TargetType: SSM_DOCUMENT\n  TargetId: AWS-EnableS3BucketEncryption\n  Automatic: true\n  MaximumAutomaticAttempts: 3\n  RetryAttemptSeconds: 60\n  Parameters:\n    BucketName:\n      ResourceValue:\n        Value: RESOURCE_ID",
              "isCorrect": true,
              "explanation": "This uses an AWS-provided SSM Automation document to enable encryption on the non-compliant bucket. TargetType SSM_DOCUMENT and the RESOURCE_ID placeholder correctly bind the remediation to the flagged resource."
            }
          ],
          "selectCount": 1,
          "format": "yaml",
          "domain": "Detection",
          "services": [
            "Config",
            "Systems Manager",
            "S3",
            "Lambda"
          ],
          "docs": "https://docs.aws.amazon.com/config/latest/developerguide/remediation.html",
          "tip": "Automatic remediation mechanisms commonly invoke automation documents or playbooks rather than ad-hoc functions.",
          "explanation": "AWS Config remediation actions invoke SSM Automation documents to fix non-compliant resources. AWS provides pre-built documents like AWS-EnableS3BucketEncryption. Setting Automatic to true and configuring retry parameters ensures Config will apply the fix without manual intervention whenever a drift is detected."
        },
        {
          "id": "SCS-C03-0015",
          "question": "A security team needs to provide shell access to EC2 instances in private subnets without opening SSH ports or managing bastion hosts, while maintaining a full audit trail of every command executed. Which solution meets these requirements?",
          "choices": [
            {
              "id": "c2",
              "text": "Deploy a bastion host with SSH key-based authentication",
              "isCorrect": false,
              "explanation": "Bastion hosts require open SSH ports and add operational burden."
            },
            {
              "id": "c4",
              "text": "VPN to the private subnet and SSH",
              "isCorrect": false,
              "explanation": "VPN plus SSH captures metadata but not command-level audit content."
            },
            {
              "id": "c3",
              "text": "EC2 Instance Connect",
              "isCorrect": false,
              "explanation": "Instance Connect still requires port 22 and does not natively log full session content."
            },
            {
              "id": "c1",
              "text": "Systems Manager Session Manager",
              "isCorrect": true,
              "explanation": "Session Manager establishes encrypted sessions through the SSM agent without opening inbound ports and can log sessions to S3 or CloudWatch Logs."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Infrastructure Security",
          "services": [
            "Systems Manager",
            "EC2",
            "IAM",
            "CloudTrail"
          ],
          "docs": "https://docs.aws.amazon.com/systems-manager/latest/userguide/session-manager.html",
          "tip": "Consider agent-based session access that avoids exposing SSH/RDP ports.",
          "explanation": "Session Manager uses the SSM agent to create encrypted, IAM-authenticated sessions without inbound security group rules and logs session output for auditing."
        },
        {
          "id": "SCS-C03-0005",
          "question": "You've been asked to centralise key management for data-at-rest across services. Which AWS service provides managed encryption keys for this purpose?",
          "choices": [
            {
              "id": "c3",
              "text": "AWS Shield",
              "isCorrect": false,
              "explanation": "AWS Shield protects against DDoS attacks, not key management."
            },
            {
              "id": "c2",
              "text": "AWS IAM",
              "isCorrect": false,
              "explanation": "AWS IAM handles identity and permissions, not key storage or encryption primitives."
            },
            {
              "id": "c1",
              "text": "AWS KMS",
              "isCorrect": true,
              "explanation": "AWS KMS is the managed service for creating and controlling encryption keys."
            },
            {
              "id": "c4",
              "text": "AWS WAF",
              "isCorrect": false,
              "explanation": "AWS WAF is a web application firewall, not key management."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Data Protection",
          "services": [
            "KMS",
            "IAM",
            "Shield",
            "WAF"
          ],
          "docs": "https://docs.aws.amazon.com/kms/latest/developerguide/overview.html",
          "tip": "Use a key management service that supports envelope encryption and key lifecycle controls.",
          "explanation": "AWS KMS provides centralized creation, rotation, and access control of encryption keys used to protect data at rest across services like S3, EBS, and RDS."
        },
        {
          "id": "SCS-C03-0036",
          "question": "A security platform team must deploy a hardened VPC, a set of IAM permission boundaries, and logging configuration to 15 existing AWS accounts. Changes must be automated via CI/CD, deployments must be auditable, and any account drift should be detectable centrally. The team also wants least-privilege for the agents that perform deployments. Which approach best satisfies these requirements?",
          "choices": [
            {
              "id": "c1",
              "text": "Create a parameterized CloudFormation module for the baseline, publish it to a central artifact repository, and deploy via CloudFormation StackSets (service-managed) from a CI/CD pipeline using delegated administrator roles; enable drift detection and record pipeline runs for auditability",
              "isCorrect": true,
              "explanation": "StackSets (service-managed) supports automated, organization-aware deployments driven by CI/CD, delegated admin roles provide least-privilege, and enabling drift detection plus CI/CD run logs provides centralized detection and an audit trail."
            },
            {
              "id": "c2",
              "text": "Let each account run CloudFormation stacks triggered manually by account owners, and collect logs centrally afterwards",
              "isCorrect": false,
              "explanation": "Manual, per-account deployments are not automated or easily auditable and do not provide centralized drift detection or consistent configuration."
            },
            {
              "id": "c3",
              "text": "Use Terraform workspaces stored locally per account and have individual engineers apply changes when notified",
              "isCorrect": false,
              "explanation": "Local, manual Terraform applies lack centralized automation, auditability, and organization-level drift detection; they also increase risk of inconsistent state."
            },
            {
              "id": "c4",
              "text": "Utilise AWS Control Tower guardrails to keep accounts compliant and make manual adjustments via the console for exceptions",
              "isCorrect": false,
              "explanation": "Control Tower provides guardrails and a landing zone but is not a full CI/CD-driven IaC deployment and does not replace an auditable, parameterized IaC pipeline for existing accounts at scale."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Security Foundations and Governance",
          "services": [
            "CloudFormation",
            "StackSets",
            "CI/CD",
            "Organizations"
          ],
          "docs": "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/what-is-cfn.html",
          "tip": "Use organization-aware IaC patterns integrated with CI/CD, delegated roles, and drift detection.",
          "explanation": "For consistent, auditable, and automated deployments across multiple accounts, an org-aware IaC pattern like CloudFormation StackSets driven by a CI/CD pipeline provides parameterized modules, centralized rollout, delegated administration for least-privilege, and drift detection to identify configuration divergence. This pattern satisfies automation, auditability, and centralized management requirements."
        },
        {
          "id": "SCS-C03-0043",
          "question": "Which approach automates security posture checks across new accounts automatically?",
          "choices": [
            {
              "id": "c3",
              "text": "Use S3 replication to copy Templates across accounts",
              "isCorrect": false,
              "explanation": "S3 replication doesn't enforce security posture or run automated assessments."
            },
            {
              "id": "c2",
              "text": "Require each team to run a manual checklist during onboarding",
              "isCorrect": false,
              "explanation": "Manual checklists are error-prone and do not scale automatically for many accounts."
            },
            {
              "id": "c1",
              "text": "Use Organizations with SCPs and automated Config conformance packs deployed on account creation",
              "isCorrect": true,
              "explanation": "Combining Organizations lifecycle hooks with automated Config conformance packs provides automatic posture checks for new accounts."
            },
            {
              "id": "c4",
              "text": "Rely on Control Tower alone without additional automation",
              "isCorrect": false,
              "explanation": "Control Tower helps but combining it with conformance packs and automated policies gives stronger, automated checks."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Detection",
          "services": [
            "Organizations",
            "IAM",
            "SCPs"
          ],
          "docs": "https://docs.aws.amazon.com/organizations/latest/userguide/orgs_manage_policies_scps.html",
          "tip": "Automate posture checks during account provisioning to enforce baselines.",
          "explanation": "Provisioning-time automation that deploys Config rules/conformance packs along with SCP guardrails ensures new accounts meet baseline security posture automatically."
        },
        {
          "id": "SCS-C03-0035",
          "question": "A CISO wants a single dashboard that shows the organisation's compliance posture against the CIS AWS Foundations Benchmark and the AWS Foundational Security Best Practices standard, with automated checks running continuously. Findings from GuardDuty and Inspector should also appear in the same view. Which TWO steps are required? (Select TWO)",
          "choices": [
            {
              "id": "c2",
              "text": "Ensure AWS Config is enabled with recording turned on for all supported resource types",
              "isCorrect": true,
              "explanation": "Security Hub's compliance checks depend on AWS Config rules. If Config recording is not enabled, the automated checks cannot evaluate resource configurations and will produce no findings."
            },
            {
              "id": "c1",
              "text": "Enable AWS Security Hub and activate the CIS and Foundational Security Best Practices security standards",
              "isCorrect": true,
              "explanation": "Security Hub provides the unified dashboard and runs automated compliance checks against the selected standards using AWS Config rules it deploys automatically."
            },
            {
              "id": "c4",
              "text": "Deploy AWS Firewall Manager to enforce compliance checks across all accounts",
              "isCorrect": false,
              "explanation": "Firewall Manager manages WAF, Shield, and security group policies. It does not run CIS or Best Practices compliance checks or aggregate findings from GuardDuty and Inspector."
            },
            {
              "id": "c5",
              "text": "Manually export GuardDuty and Inspector findings to S3 and build QuickSight dashboards",
              "isCorrect": false,
              "explanation": "This creates a custom reporting pipeline but is not necessary. GuardDuty and Inspector integrate natively with Security Hub, sending findings automatically without manual export."
            },
            {
              "id": "c3",
              "text": "Create a custom CloudWatch dashboard aggregating Config, GuardDuty, and Inspector metrics",
              "isCorrect": false,
              "explanation": "CloudWatch dashboards show metrics and alarms, not security findings or compliance posture. Security Hub already provides the unified finding and compliance view."
            }
          ],
          "selectCount": 2,
          "format": "text",
          "domain": "Detection",
          "services": [
            "Security Hub",
            "Config",
            "GuardDuty",
            "Firewall Manager",
            "Inspector"
          ],
          "docs": "https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards.html",
          "tip": "An aggregation service often depends on underlying compliance recording and service integrations to surface continuous checks.",
          "explanation": "Security Hub serves as the central security findings hub. It runs compliance checks by deploying Config rules for each control in the enabled standards, so AWS Config must be recording. GuardDuty and Inspector automatically send findings to Security Hub when both are enabled, providing the unified dashboard the CISO needs."
        },
        {
          "id": "SCS-C03-0032",
          "question": "A security team discovers that malware on compromised EC2 instances is using DNS queries to known command-and-control domains for data exfiltration. They need to block DNS resolution of these domains for all resources in the VPC without deploying custom DNS servers. Which service provides this capability?",
          "choices": [
            {
              "id": "c2",
              "text": "AWS WAF with a custom rule to block DNS traffic patterns",
              "isCorrect": false,
              "explanation": "WAF operates on HTTP/HTTPS traffic at Layer 7. It cannot inspect or block DNS queries (UDP port 53) made by VPC resources to the Route 53 Resolver."
            },
            {
              "id": "c4",
              "text": "Enable GuardDuty DNS resolution monitoring to automatically block malicious domains",
              "isCorrect": false,
              "explanation": "GuardDuty detects and alerts on DNS queries to known malicious domains, but it does not block them. DNS Firewall provides the enforcement (blocking) capability."
            },
            {
              "id": "c3",
              "text": "Create NACL rules to block outbound UDP port 53 to the internet",
              "isCorrect": false,
              "explanation": "Blocking port 53 outbound would break DNS resolution for all VPC resources, not just malicious queries. VPC DNS uses the Route 53 Resolver internally, so NACL rules do not affect VPC-internal DNS resolution."
            },
            {
              "id": "c1",
              "text": "Route 53 Resolver DNS Firewall with a block-list rule group associated to the VPC",
              "isCorrect": true,
              "explanation": "DNS Firewall lets you create domain lists and rule groups that block, allow, or alert on DNS queries made through the Route 53 Resolver. Associating a rule group to a VPC applies the rules to all DNS queries from that VPC."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Infrastructure Security",
          "services": [
            "Route 53",
            "Route 53 Resolver DNS Firewall",
            "VPC",
            "GuardDuty"
          ],
          "docs": "https://docs.aws.amazon.com/Route53/latest/DeveloperGuide/resolver-dns-firewall.html",
          "tip": "Consider pairing detection services with preventive controls to both find and block threats.",
          "explanation": "Route 53 Resolver DNS Firewall provides managed DNS-layer filtering within VPCs. You define domain lists (or import AWS-managed threat lists) and create rule groups with BLOCK, ALLOW, or ALERT actions. Associating the rule group to a VPC applies filtering to all Route 53 Resolver queries from that VPC."
        },
        {
          "id": "SCS-C03-0011",
          "question": "Compliance requires CloudWatch Logs to use a customer-managed CMK and let the service use it what steps achieve this configuration?",
          "choices": [
            {
              "id": "c4",
              "text": "Create an AWS-managed KMS key (alias aws/logs) and it will automatically encrypt all new log groups without any key policy changes",
              "isCorrect": false,
              "explanation": "CloudWatch Logs does not have an AWS-managed key. You must create and configure a customer-managed key explicitly."
            },
            {
              "id": "c1",
              "text": "Create a customer-managed KMS key with a key policy granting logs.<region>.amazonaws.com the kms:Encrypt, kms:Decrypt, kms:GenerateDataKey, and kms:DescribeKey actions, then associate the key with each log group",
              "isCorrect": true,
              "explanation": "CloudWatch Logs requires these four KMS actions in the key policy for the regional service principal to encrypt and decrypt log data."
            },
            {
              "id": "c3",
              "text": "Enable CloudTrail log file encryption with a KMS key and configure CloudWatch Logs as a CloudTrail destination",
              "isCorrect": false,
              "explanation": "CloudTrail encryption covers CloudTrail's own log files delivered to S3, not arbitrary CloudWatch Logs log groups."
            },
            {
              "id": "c2",
              "text": "Enable SSE-S3 default encryption on the S3 bucket where CloudWatch Logs exports data and reference that bucket in each log group's settings",
              "isCorrect": false,
              "explanation": "S3 encryption applies only to exported log data in S3, not to log data stored within the CloudWatch Logs service itself."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Data Protection",
          "services": [
            "CloudWatch Logs",
            "KMS",
            "S3",
            "CloudTrail"
          ],
          "docs": "https://docs.aws.amazon.com/AmazonCloudWatch/latest/logs/encrypt-log-data-kms.html",
          "tip": "Some logging services require customer-managed keys for encryption at rest; verify key management options.",
          "explanation": "CloudWatch Logs supports encryption at rest only with customer-managed KMS keys. You must explicitly grant the regional service principal permission to use the key."
        },
        {
          "id": "SCS-C03-0041",
          "question": "When sizing monitoring for a high-throughput API, which combination of metrics should inform your alarm thresholds for availability and performance?",
          "choices": [
            {
              "id": "c4",
              "text": "S3 bucket size growth",
              "isCorrect": false,
              "explanation": "S3 growth is unrelated to API availability metrics for request handling."
            },
            {
              "id": "c1",
              "text": "Request count, 5xx error rate, and latency percentiles",
              "isCorrect": true,
              "explanation": "Combining request volume, error rates and latency percentiles gives a balanced view of availability and performance under load."
            },
            {
              "id": "c2",
              "text": "Only CPU utilization across EC2 instances",
              "isCorrect": false,
              "explanation": "CPU is useful but insufficient alone to detect request-level failures or latency spikes."
            },
            {
              "id": "c3",
              "text": "Number of open TCP connections to the VPC",
              "isCorrect": false,
              "explanation": "TCP connection counts may be noisy and do not directly indicate application-level errors or latency."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Detection",
          "services": [
            "CloudWatch",
            "CloudWatch Logs",
            "SNS"
          ],
          "docs": "https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/monitoring-overview.html",
          "tip": "Combine throughput, error rates, and latency percentiles to set robust thresholds.",
          "explanation": "A monitoring strategy should include throughput (request count), error rates (5xx), and latency percentiles (p95/p99) to detect degradation under load and trigger appropriate alerts."
        },
        {
          "id": "SCS-C03-0020",
          "question": "After enabling GuardDuty S3 Protection, a security analyst notices a finding of type Policy:S3/BucketAnonymousAccessGranted for a production data bucket. The analyst needs to determine which principal changed the bucket policy and when. Which data source provides this information?",
          "choices": [
            {
              "id": "c4",
              "text": "VPC Flow Logs for the VPC where the analyst is working",
              "isCorrect": false,
              "explanation": "VPC Flow Logs capture network-layer metadata (IP, port, protocol) but not API-level details like which principal called PutBucketPolicy."
            },
            {
              "id": "c1",
              "text": "CloudTrail management events showing the PutBucketPolicy API call",
              "isCorrect": true,
              "explanation": "CloudTrail records the identity (principal), timestamp, source IP, and request parameters for S3 control-plane API calls like PutBucketPolicy. This is the authoritative source for who changed the policy and when."
            },
            {
              "id": "c2",
              "text": "The GuardDuty finding detail itself, which includes the actor and timestamp",
              "isCorrect": false,
              "explanation": "GuardDuty findings identify the affected resource and the anomaly but do not always include the full details of who made the original policy change. CloudTrail provides the definitive audit trail."
            },
            {
              "id": "c3",
              "text": "S3 server access logs for the data bucket",
              "isCorrect": false,
              "explanation": "S3 server access logs capture object-level read/write requests, not bucket policy changes. Control-plane actions like PutBucketPolicy are not recorded in access logs."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Detection",
          "services": [
            "GuardDuty",
            "CloudTrail",
            "S3",
            "Security Hub"
          ],
          "docs": "https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_s3-protection.html",
          "tip": "Differentiate data-plane logs from control-plane audit logs when investigating configuration or policy changes.",
          "explanation": "CloudTrail management events are the single source of truth for AWS API activity. When investigating who changed a resource configuration, always start with CloudTrail, which records the IAM principal, the API action, the request parameters, and the exact timestamp."
        },
        {
          "id": "SCS-C03-0048",
          "question": "Which integration helps ensure container images are scanned for known vulnerabilities before deployment?",
          "choices": [
            {
              "id": "c1",
              "text": "Enable Inspector image scanning for ECR and fail CI on high-severity findings",
              "isCorrect": true,
              "explanation": "Inspector integrates with ECR to scan images and can be used as a gate in CI to prevent deploying vulnerable images."
            },
            {
              "id": "c4",
              "text": "Use S3 object versioning to store old images",
              "isCorrect": false,
              "explanation": "S3 versioning stores objects but does not scan or prevent vulnerable images from running."
            },
            {
              "id": "c3",
              "text": "Scan images manually once per quarter",
              "isCorrect": false,
              "explanation": "Infrequent manual scans miss new vulnerabilities discovered between scans."
            },
            {
              "id": "c2",
              "text": "Rely only on runtime detection like GuardDuty",
              "isCorrect": false,
              "explanation": "Runtime detection is useful but does not prevent vulnerable images from being deployed in the first place."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Infrastructure Security",
          "services": [
            "Inspector",
            "ECR",
            "Lambda"
          ],
          "docs": "https://docs.aws.amazon.com/inspector/latest/userguide/what-is-inspector.html",
          "tip": "Integrate vulnerability scanning into CI/CD and prevent promotion of artifacts with critical findings.",
          "explanation": "Shifting vulnerability scans left (during build) reduces risk; Inspector/ECR scanning plus CI gates prevents deploying images with known critical vulnerabilities."
        },
        {
          "id": "SCS-C03-0050",
          "question": "Which approach meets the requirement: rotate DB credentials every 30 days without redeploying applications?",
          "choices": [
            {
              "id": "c2",
              "text": "Bake credentials into container images and rebuild monthly",
              "isCorrect": false,
              "explanation": "Rebuilding images is operationally heavy and requires redeployment, which the requirement forbids."
            },
            {
              "id": "c1",
              "text": "Use AWS Secrets Manager rotation with a Lambda rotation function and have apps retrieve secrets at runtime",
              "isCorrect": true,
              "explanation": "Secrets Manager supports automatic rotation and applications that fetch secrets at runtime do not need redeployment."
            },
            {
              "id": "c4",
              "text": "Rotate credentials manually and email them to developers",
              "isCorrect": false,
              "explanation": "Manual rotation and distribution is insecure and error-prone."
            },
            {
              "id": "c3",
              "text": "Store credentials in SSM Parameter Store without rotation",
              "isCorrect": false,
              "explanation": "Parameter Store can store secrets but does not provide automated rotation like Secrets Manager."
            }
          ],
          "selectCount": 1,
          "format": "json",
          "domain": "Data Protection",
          "services": [
            "Secrets Manager",
            "IAM",
            "Lambda"
          ],
          "docs": "https://docs.aws.amazon.com/secretsmanager/latest/userguide/intro.html",
          "tip": "Prefer automated rotation and runtime retrieval of secrets to decouple credentials from deployments.",
          "explanation": "Automatic rotation decouples credential lifecycles from deployments; applications should fetch secrets at runtime to benefit from rotation without redeployments."
        },
        {
          "id": "SCS-C03-0051",
          "question": "For secure, performant connectivity between on-premises and multiple AWS regions, which architecture is recommended?",
          "choices": [
            {
              "id": "c2",
              "text": "Create individual Site-to-Site VPNs from on-prem to each VPC",
              "isCorrect": false,
              "explanation": "Multiple VPNs increase operational overhead and complexity for multi-region connectivity."
            },
            {
              "id": "c3",
              "text": "Rely on internet-based VPNs only",
              "isCorrect": false,
              "explanation": "Internet VPNs may not meet performance and security requirements compared to Direct Connect."
            },
            {
              "id": "c1",
              "text": "Use AWS Transit Gateway in each region with Direct Connect and Transit Gateway inter-region peering",
              "isCorrect": true,
              "explanation": "Transit Gateway with Direct Connect and inter-region peering reduces management complexity and centralizes routing at scale."
            },
            {
              "id": "c4",
              "text": "Use S3 transfer acceleration for VPC connectivity",
              "isCorrect": false,
              "explanation": "S3 Transfer Acceleration is for object transfers and not a network topology solution."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Infrastructure Security",
          "services": [
            "VPC",
            "Transit Gateway",
            "VPN"
          ],
          "docs": "https://docs.aws.amazon.com/vpc/latest/userguide/what-is-amazon-vpc.html",
          "tip": "Combine transit routing and dedicated connectivity for scalable, performant hybrid networking.",
          "explanation": "Transit Gateway simplifies routing between many VPCs and on-premises, and Direct Connect improves performance and security over internet VPNs."
        },
        {
          "id": "SCS-C03-0022",
          "question": "An operations team wants to automate incident response when a critical CloudWatch alarm triggers: page the on-call engineer, create a timeline, and start a runbook to collect diagnostic data. They want a single AWS-native service to orchestrate all three actions. Which service should they configure?",
          "choices": [
            {
              "id": "c4",
              "text": "AWS CloudWatch composite alarms with auto-scaling actions",
              "isCorrect": false,
              "explanation": "Composite alarms aggregate alarm states but their actions are limited to SNS, Lambda, or Auto Scaling. They do not provide incident lifecycle management."
            },
            {
              "id": "c3",
              "text": "Amazon SNS with multiple topic subscriptions",
              "isCorrect": false,
              "explanation": "SNS delivers notifications but does not manage incident timelines, runbook execution, or structured escalation workflows."
            },
            {
              "id": "c2",
              "text": "Amazon EventBridge with Lambda targets",
              "isCorrect": false,
              "explanation": "EventBridge plus Lambda can achieve similar automation but requires custom code for paging, timeline tracking, and runbook execution. It is not a single orchestration service purpose-built for incident response."
            },
            {
              "id": "c1",
              "text": "AWS Systems Manager Incident Manager",
              "isCorrect": true,
              "explanation": "Incident Manager automates incident creation with response plans that define escalation contacts, engagement protocols, and runbook automation, all triggered by CloudWatch alarms or EventBridge rules."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Incident Response",
          "services": [
            "Systems Manager Incident Manager",
            "EventBridge",
            "SNS",
            "PagerDuty"
          ],
          "docs": "https://docs.aws.amazon.com/incident-manager/latest/userguide/what-is-incident-manager.html",
          "tip": "Consider incident management tools that integrate alerting, timelines, and automated runbooks.",
          "explanation": "Incident Manager provides structured response plans that automatically engage contacts (via SMS, voice, or email), create incident timelines, and execute SSM Automation runbooks when triggered. This consolidates incident orchestration into one service rather than gluing multiple services together with custom logic."
        },
        {
          "id": "SCS-C03-0024",
          "question": "A security architect wants to continuously detect any S3 buckets, IAM roles, KMS keys, or Lambda functions that are shared with external AWS accounts or public access. The solution must generate findings automatically without requiring custom code. Which service should they enable?",
          "choices": [
            {
              "id": "c1",
              "text": "IAM Access Analyzer",
              "isCorrect": true,
              "explanation": "Access Analyzer uses automated reasoning to analyze resource-based policies and identifies resources that are accessible from outside the zone of trust (account or organisation), generating findings for each."
            },
            {
              "id": "c2",
              "text": "AWS Config with the s3-bucket-public-read-prohibited managed rule",
              "isCorrect": false,
              "explanation": "This Config rule only checks S3 public read access. It does not cover cross-account sharing of IAM roles, KMS keys, or Lambda functions."
            },
            {
              "id": "c3",
              "text": "AWS Trusted Advisor security checks",
              "isCorrect": false,
              "explanation": "Trusted Advisor checks a limited set of security best practices (e.g., open security groups, root MFA) but does not perform policy-level analysis of cross-account resource sharing."
            },
            {
              "id": "c4",
              "text": "Amazon GuardDuty",
              "isCorrect": false,
              "explanation": "GuardDuty detects threats based on anomalous behaviour and threat intelligence. It does not analyze resource policies to find intentional cross-account sharing or public access grants."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Identity and Access Management",
          "services": [
            "IAM Access Analyzer",
            "IAM",
            "S3",
            "Lambda",
            "KMS"
          ],
          "docs": "https://docs.aws.amazon.com/IAM/latest/UserGuide/access-analyzer-getting-started.html",
          "tip": "Some tools perform policy-based analysis using logical reasoning rather than anomaly detection.",
          "explanation": "IAM Access Analyzer applies Zelkova-based automated reasoning to evaluate resource-based policies on S3 buckets, SQS queues, IAM roles, KMS keys, Lambda functions, and Secrets Manager secrets. It produces actionable findings whenever a policy grants access outside the defined zone of trust, with no custom code required."
        },
        {
          "id": "SCS-C03-0002",
          "question": "You're investigating suspicious activity and want to run investigative notebooks to visualise relationships which AWS service provides that investigative workspace?",
          "choices": [
            {
              "id": "c4",
              "text": "AWS CloudTrail",
              "isCorrect": false,
              "explanation": "CloudTrail records API activity and is useful for forensics, but Detective provides investigative workflows."
            },
            {
              "id": "c3",
              "text": "AWS Shield",
              "isCorrect": false,
              "explanation": "AWS Shield provides DDoS protections, not forensic investigation tools."
            },
            {
              "id": "c2",
              "text": "Amazon Detective",
              "isCorrect": true,
              "explanation": "Amazon Detective is designed to analyze, visualize, and conduct investigations into potential security issues."
            },
            {
              "id": "c1",
              "text": "AWS Systems Manager",
              "isCorrect": false,
              "explanation": "Systems Manager helps manage instances but is not focused on security investigation notebooks."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Incident Response",
          "services": [
            "Detective",
            "Systems Manager",
            "Shield",
            "CloudTrail"
          ],
          "docs": "https://docs.aws.amazon.com/detective/latest/adminguide/what-is.html",
          "tip": "Use a central findings aggregator that links related alerts and activity for investigation.",
          "explanation": "Amazon Detective automatically collects log data from VPC Flow Logs, CloudTrail, and GuardDuty, then builds a graph model that links related events so analysts can visually trace activity."
        },
        {
          "id": "SCS-C03-0049",
          "question": "A team must provide audited shell access to instances in private subnets without SSH port exposure. Which solution meets this requirement?",
          "choices": [
            {
              "id": "c1",
              "text": "Use Systems Manager Session Manager with logging to CloudWatch or S3 and IAM-based access controls",
              "isCorrect": true,
              "explanation": "Session Manager provides agent-based access without inbound ports and records sessions for auditing."
            },
            {
              "id": "c3",
              "text": "Use RDP through a bastion host for Linux instances",
              "isCorrect": false,
              "explanation": "RDP is inappropriate for Linux and bastions reintroduce exposed access vectors."
            },
            {
              "id": "c2",
              "text": "Open SSH port 22 and enforce key rotation manually",
              "isCorrect": false,
              "explanation": "Opening SSH ports exposes network surface and complicates auditing compared to agent-based sessions."
            },
            {
              "id": "c4",
              "text": "Embed root credentials in AMI for quick access",
              "isCorrect": false,
              "explanation": "Embedding credentials is insecure and hinders auditing and rotation."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Infrastructure Security",
          "services": [
            "Systems Manager",
            "SSM",
            "CloudTrail"
          ],
          "docs": "https://docs.aws.amazon.com/systems-manager/latest/userguide/session-manager.html",
          "tip": "Agent-based session solutions can record session logs and enforce access via identity policies.",
          "explanation": "Systems Manager's Session Manager avoids bastions and allows session logging to CloudWatch/S3 and control via IAM, meeting audit requirements."
        },
        {
          "id": "SCS-C03-0059",
          "question": "For workforce single sign-on with centralized permission sets, which service provides identity federation and permission management?",
          "choices": [
            {
              "id": "c3",
              "text": "Use local OS accounts on bastion hosts",
              "isCorrect": false,
              "explanation": "Local accounts are not centralized or scalable for enterprise SSO needs."
            },
            {
              "id": "c2",
              "text": "Create IAM Users for each employee",
              "isCorrect": false,
              "explanation": "IAM Users are not ideal for large-scale workforce SSO and federation scenarios."
            },
            {
              "id": "c1",
              "text": "IAM Identity Center (AWS SSO)",
              "isCorrect": true,
              "explanation": "IAM Identity Center provides SSO and centralized permission set management for workforce identities."
            },
            {
              "id": "c4",
              "text": "Use API keys stored in S3 for employees",
              "isCorrect": false,
              "explanation": "API keys are for programmatic access and not suitable for workforce SSO."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Identity and Access Management",
          "services": [
            "IAM",
            "IAM Identity Center"
          ],
          "docs": "https://docs.aws.amazon.com/iam/latest/UserGuide/id_users_create.html",
          "tip": "Use a centralized identity solution with permission sets for workforce SSO.",
          "explanation": "IAM Identity Center integrates with external IdPs and maps users to AWS permission sets, simplifying enterprise SSO and access management."
        },
        {
          "id": "SCS-C03-0039",
          "question": "To ensure all client connections to an internet-facing application use modern TLS ciphers and automated certificate rotation, which configuration should be used on the load balancer?",
          "choices": [
            {
              "id": "c1",
              "text": "Configure an HTTPS listener with an ACM-issued certificate and a recommended TLS security policy",
              "isCorrect": true,
              "explanation": "An HTTPS listener with an ACM-managed certificate ensures automated renewals and pairing with a recommended security policy enforces modern TLS ciphers and protocol versions."
            },
            {
              "id": "c2",
              "text": "Use an HTTP listener and perform TLS termination on backend instances",
              "isCorrect": false,
              "explanation": "Terminating TLS on backend instances increases operational complexity and loses benefits of managed certificate rotation; it also may expose traffic if not configured properly."
            },
            {
              "id": "c4",
              "text": "Use self-signed certificates deployed to each client",
              "isCorrect": false,
              "explanation": "Self-signed certificates are not practical for public internet-facing services and do not support automated rotation and trust by clients."
            },
            {
              "id": "c3",
              "text": "Rely solely on security groups to restrict plaintext access",
              "isCorrect": false,
              "explanation": "Security groups control network access but do not provide TLS encryption or manage certificates."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Data Protection",
          "services": [
            "ALB",
            "ACM",
            "Route 53"
          ],
          "docs": "https://docs.aws.amazon.com/elasticloadbalancing/latest/application/create-https-listener.html",
          "tip": "Terminate TLS at the edge with managed certificates and enforce modern cipher and protocol policies.",
          "explanation": "ACM-managed certificates integrate with ALB listeners for seamless rotation; pairing them with an appropriate security policy ensures modern ciphers and protocol versions without manual certificate management."
        },
        {
          "id": "SCS-C03-0060",
          "question": "Which strategy reduces cost while preserving required retention for infrequently accessed file data?",
          "choices": [
            {
              "id": "c1",
              "text": "Use lifecycle policies to move infrequently accessed data to lower-cost storage tiers such as EFS Infrequent Access or archival destinations",
              "isCorrect": true,
              "explanation": "Lifecycle policies move data automatically to cheaper tiers while retaining access and meeting retention policies."
            },
            {
              "id": "c4",
              "text": "Delete older data to save cost without retention requirements",
              "isCorrect": false,
              "explanation": "Deletion may violate retention and compliance requirements."
            },
            {
              "id": "c2",
              "text": "Keep all data on high-performance SSD tiers indefinitely",
              "isCorrect": false,
              "explanation": "Retaining everything on high-cost tiers is inefficient and expensive."
            },
            {
              "id": "c3",
              "text": "Manually archive files to local tape every quarter",
              "isCorrect": false,
              "explanation": "Manual processes are error-prone and lack automation and auditability."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Data Protection",
          "services": [
            "EFS",
            "Lifecycle",
            "S3 Glacier"
          ],
          "docs": "https://docs.aws.amazon.com/efs/latest/ug/what-is-efs.html",
          "tip": "Automate lifecycle transitions to lower-cost tiers based on access patterns.",
          "explanation": "Automated lifecycle policies balance cost and retention by moving data to appropriate storage classes based on age and access frequency."
        },
        {
          "id": "SCS-C03-0034",
          "question": "A media company serves video content from S3 through CloudFront. They need to ensure users cannot bypass CloudFront and access S3 directly via the bucket URL. The solution must work with SSE-KMS encrypted objects. Which approach correctly restricts S3 access to CloudFront only?",
          "choices": [
            {
              "id": "c2",
              "text": "Create a CloudFront Origin Access Identity (OAI) and grant it read access in the S3 bucket policy",
              "isCorrect": false,
              "explanation": "OAI is the legacy approach and does not support SSE-KMS encrypted objects. CloudFront cannot forward the required SigV4 KMS headers when using OAI."
            },
            {
              "id": "c1",
              "text": "Create a CloudFront Origin Access Control (OAC) and update the S3 bucket policy to allow access only from the OAC",
              "isCorrect": true,
              "explanation": "OAC is the recommended method for restricting S3 access to CloudFront. Unlike the legacy OAI, OAC supports SSE-KMS, S3 Object Lock, and all S3 features. The bucket policy uses aws:SourceArn to allow only the specific CloudFront distribution."
            },
            {
              "id": "c3",
              "text": "Make the S3 bucket a website endpoint origin in CloudFront and restrict access with a Referer header condition in the bucket policy",
              "isCorrect": false,
              "explanation": "Website endpoint origins use HTTP (not the S3 API), don't support SSE-KMS, and Referer headers can be spoofed, making this both incompatible and insecure."
            },
            {
              "id": "c4",
              "text": "Block public access on the bucket and share S3 pre-signed URLs directly with users instead of using CloudFront",
              "isCorrect": false,
              "explanation": "Pre-signed URLs bypass CloudFront entirely, losing edge caching, WAF protection, and geo-restriction capabilities. They also expose direct S3 access."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Infrastructure Security",
          "services": [
            "CloudFront",
            "S3",
            "OAC",
            "WAF"
          ],
          "docs": "https://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/private-content-restricting-access-to-s3.html",
          "tip": "Modern origin access controls replace older mechanisms and are required for certain advanced object features.",
          "explanation": "Origin Access Control (OAC) uses SigV4-signed requests from CloudFront to S3, which supports all S3 encryption modes including SSE-KMS. The S3 bucket policy can use the Condition key aws:SourceArn to restrict access to a specific CloudFront distribution ARN, ensuring no direct S3 access is possible."
        }
      ],
      "perDomain": {
        "Data Protection": {
          "total": 1,
          "correct": 1,
          "score": 100
        }
      },
      "earlyComplete": true,
      "answeredCount": 1,
      "totalQuestions": 65
    },
    {
      "attemptId": "dd6d1f13-663a-450a-bef0-fa249c67c1b2",
      "userId": "9255a4e4-20f1-7010-8a80-17c43ca141e3",
      "examCode": "SCS-C03",
      "examVersion": null,
      "s3VersionId": null,
      "attemptSchemaVersion": 1,
      "startedAt": "2026-02-18T14:44:59.197Z",
      "finishedAt": "2026-02-18T14:45:13.037Z",
      "score": 0,
      "answers": [
        {
          "questionId": "SCS-C03-0019",
          "selectedChoiceId": "c4",
          "selectedChoiceIds": null,
          "selectedIndex": null,
          "selectedIndices": null,
          "correct": false,
          "timeMs": 0,
          "showTip": false,
          "createdAt": "2026-02-18T14:45:05.485Z"
        }
      ],
      "metadata": {
        "serviceKeywords": [],
        "domains": [],
        "services": []
      },
      "questions": [
        {
          "id": "SCS-C03-0019",
          "question": "A financial services firm must store audit logs for seven years in a manner that no user, including root, can delete or modify them before the retention period expires. Regulators require proof of immutability. Which S3 feature satisfies these requirements?",
          "choices": [
            {
              "id": "c4",
              "text": "Enable MFA Delete on the S3 bucket to require MFA for all delete operations",
              "isCorrect": false,
              "explanation": "MFA Delete requires an additional authentication step but does not make objects truly immutable. A user with MFA can still delete them at any time."
            },
            {
              "id": "c1",
              "text": "S3 Object Lock in Compliance mode with a seven-year retention period",
              "isCorrect": true,
              "explanation": "Compliance mode prevents anyone, including the root user, from deleting or overwriting an object version until the retention date passes. This satisfies regulatory immutability requirements."
            },
            {
              "id": "c3",
              "text": "S3 Versioning with an S3 Lifecycle rule to transition objects to Glacier after 30 days",
              "isCorrect": false,
              "explanation": "Versioning preserves prior versions but does not prevent deletion of version markers. Glacier transition reduces cost but does not enforce immutability."
            },
            {
              "id": "c2",
              "text": "S3 Object Lock in Governance mode with a seven-year retention period",
              "isCorrect": false,
              "explanation": "Governance mode allows users with the s3:BypassGovernanceRetention permission to delete objects before the retention period ends, which does not meet the absolute immutability requirement."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Data Protection",
          "services": [
            "S3",
            "S3 Object Lock",
            "Glacier",
            "Backup"
          ],
          "docs": "https://docs.aws.amazon.com/AmazonS3/latest/userguide/object-lock.html",
          "tip": "Some retention features prevent even highly privileged users from removing locks; verify retention enforcement models.",
          "explanation": "S3 Object Lock Compliance mode creates a WORM (Write Once Read Many) storage model. Once set, neither the object nor its retention settings can be altered or deleted by any principal until the retention period expires, meeting SEC 17a-4(f) and similar regulatory requirements."
        },
        {
          "id": "SCS-C03-0033",
          "question": "An incident responder has identified a compromised IAM role and needs to immediately invalidate all existing sessions for that role while preserving the role itself for forensic analysis. Which approach revokes all active sessions without deleting the role?",
          "choices": [
            {
              "id": "c4",
              "text": "Contact AWS Support to force-expire the role's temporary credentials",
              "isCorrect": false,
              "explanation": "AWS Support cannot force-expire individual STS tokens. Session revocation must be done through IAM policy mechanisms by the account administrator."
            },
            {
              "id": "c3",
              "text": "Change the role's trust policy to deny all principals",
              "isCorrect": false,
              "explanation": "Modifying the trust policy prevents new role assumptions but does not invalidate existing active sessions. Temporary credentials already issued remain valid until they expire."
            },
            {
              "id": "c1",
              "text": "Add an inline deny-all policy to the role with a condition that aws:TokenIssueTime is before the current timestamp:\n{\"Effect\":\"Deny\",\"Action\":\"*\",\"Resource\":\"*\",\"Condition\":{\"DateLessThan\":{\"aws:TokenIssueTime\":\"2026-02-16T12:00:00Z\"}}}",
              "isCorrect": true,
              "explanation": "This technique (Revoke Session) denies all actions for temporary credentials issued before the specified time. New sessions assumed after that time are unaffected, and the role remains intact for investigation."
            },
            {
              "id": "c2",
              "text": "Delete all inline and managed policies from the role to remove its permissions",
              "isCorrect": false,
              "explanation": "Removing policies prevents new actions but also destroys the evidence of what permissions the role had, which is critical for forensic analysis."
            }
          ],
          "selectCount": 1,
          "format": "json",
          "domain": "Incident Response",
          "services": [
            "STS",
            "IAM",
            "CloudTrail"
          ],
          "docs": "https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_temp_request.html",
          "tip": "Session revocation often uses time-based deny conditions to invalidate earlier issued tokens.",
          "explanation": "STS temporary credentials cannot be individually revoked, but you can render them useless by attaching a deny-all policy with a DateLessThan condition on aws:TokenIssueTime. This is the recommended emergency response for compromised roles because it immediately neutralizes existing sessions while keeping the role and its policies intact for forensic review."
        },
        {
          "id": "SCS-C03-0023",
          "question": "A web application team needs to ensure that TLS certificates on their internet-facing ALBs are renewed automatically without any manual intervention or downtime. Certificates must support multiple subdomain names (e.g., api.example.com, app.example.com). Which approach meets these requirements?",
          "choices": [
            {
              "id": "c1",
              "text": "Request a public ACM certificate with Subject Alternative Names (SANs) for each subdomain using DNS validation, and associate it with the ALB",
              "isCorrect": true,
              "explanation": "ACM public certificates with DNS validation renew automatically as long as the CNAME validation records remain in place. SANs allow multiple subdomains on a single certificate, and ALB natively integrates with ACM for zero-downtime deployment."
            },
            {
              "id": "c4",
              "text": "Generate a self-signed certificate for each subdomain and configure the ALB to present them using SNI",
              "isCorrect": false,
              "explanation": "Self-signed certificates are not trusted by browsers and will produce security warnings. They also require manual rotation, defeating the automation requirement."
            },
            {
              "id": "c3",
              "text": "Use Let's Encrypt with certbot running on the ALB instances to obtain and renew certificates",
              "isCorrect": false,
              "explanation": "ALBs are managed services; you cannot run certbot or any agent on them. Let's Encrypt certificates must be imported into ACM, losing automatic renewal."
            },
            {
              "id": "c2",
              "text": "Purchase a wildcard certificate from a third-party CA, import it into ACM, and set a calendar reminder to renew it annually",
              "isCorrect": false,
              "explanation": "Imported certificates in ACM are not automatically renewed. Manual renewal and re-import is required, which introduces risk of expiration and human error."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Data Protection",
          "services": [
            "ACM",
            "CloudFront",
            "ALB",
            "Route 53"
          ],
          "docs": "https://docs.aws.amazon.com/acm/latest/userguide/acm-overview.html",
          "tip": "Automatic certificate renewal typically requires that the provider issued the certificate and an automated validation method is available.",
          "explanation": "AWS Certificate Manager issues free public certificates that renew automatically when DNS validation is used. By adding SANs for each subdomain, a single certificate covers multiple endpoints. ACM's native integration with ALB means certificate deployment and rotation happen transparently."
        },
        {
          "id": "SCS-C03-0056",
          "question": "Which mechanism should be used to automatically remediate a non-compliant resource detected by AWS Config?",
          "choices": [
            {
              "id": "c4",
              "text": "Deploy a Lambda that polls Config every 24 hours",
              "isCorrect": false,
              "explanation": "Polling is less efficient and misses near-real-time remediation compared to Config automatic remediation."
            },
            {
              "id": "c3",
              "text": "Use CloudTrail to roll back the resource change",
              "isCorrect": false,
              "explanation": "CloudTrail records events but does not perform automated remediation by itself."
            },
            {
              "id": "c1",
              "text": "Configure AWS Config automatic remediation using an SSM Automation document",
              "isCorrect": true,
              "explanation": "Config remediation actions invoke SSM Automation documents to fix identified non-compliance automatically."
            },
            {
              "id": "c2",
              "text": "Send alerts only to email and wait for manual action",
              "isCorrect": false,
              "explanation": "Manual remediation is slower and does not meet automatic remediation requirements."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Detection",
          "services": [
            "Config",
            "SSM",
            "CloudWatch"
          ],
          "docs": "https://docs.aws.amazon.com/config/latest/developerguide/remediation.html",
          "tip": "Use built-in remediation mechanisms that invoke automation playbooks or documents for fixes.",
          "explanation": "AWS Config's remediation model is designed to trigger SSM Automation documents to correct drift promptly and reliably."
        },
        {
          "id": "SCS-C03-0065",
          "question": "Which integration allows custom request inspection logic at the edge before forwarding to the origin?",
          "choices": [
            {
              "id": "c1",
              "text": "Use CloudFront with Lambda@Edge (or CloudFront Functions) to run custom inspection and modify requests",
              "isCorrect": true,
              "explanation": "Lambda@Edge or CloudFront Functions can execute custom logic during request/response flows at the edge to inspect or mutate requests."
            },
            {
              "id": "c4",
              "text": "Rely on DNS-level filtering for application-layer inspection",
              "isCorrect": false,
              "explanation": "DNS filtering cannot inspect HTTP request content for application-layer threats."
            },
            {
              "id": "c3",
              "text": "Only use origin-side web servers to inspect requests",
              "isCorrect": false,
              "explanation": "Origin-side inspection allows attacks to reach the origin and increases bandwidth and processing costs."
            },
            {
              "id": "c2",
              "text": "Use SQS between CloudFront and origin for inspection",
              "isCorrect": false,
              "explanation": "SQS is asynchronous and not suitable for synchronous request inspection at the edge."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Infrastructure Security",
          "services": [
            "WAF",
            "CloudFront",
            "Lambda"
          ],
          "docs": "https://docs.aws.amazon.com/waf/latest/developerguide/waf-rule-statement-type.html",
          "tip": "Use edge compute to execute lightweight request inspection close to the client before reaching the origin.",
          "explanation": "Placing lightweight inspection at the edge reduces origin load and enables early mitigation of malicious requests before they traverse the network to backend systems."
        },
        {
          "id": "SCS-C03-0048",
          "question": "Which integration helps ensure container images are scanned for known vulnerabilities before deployment?",
          "choices": [
            {
              "id": "c4",
              "text": "Use S3 object versioning to store old images",
              "isCorrect": false,
              "explanation": "S3 versioning stores objects but does not scan or prevent vulnerable images from running."
            },
            {
              "id": "c1",
              "text": "Enable Inspector image scanning for ECR and fail CI on high-severity findings",
              "isCorrect": true,
              "explanation": "Inspector integrates with ECR to scan images and can be used as a gate in CI to prevent deploying vulnerable images."
            },
            {
              "id": "c3",
              "text": "Scan images manually once per quarter",
              "isCorrect": false,
              "explanation": "Infrequent manual scans miss new vulnerabilities discovered between scans."
            },
            {
              "id": "c2",
              "text": "Rely only on runtime detection like GuardDuty",
              "isCorrect": false,
              "explanation": "Runtime detection is useful but does not prevent vulnerable images from being deployed in the first place."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Infrastructure Security",
          "services": [
            "Inspector",
            "ECR",
            "Lambda"
          ],
          "docs": "https://docs.aws.amazon.com/inspector/latest/userguide/what-is-inspector.html",
          "tip": "Integrate vulnerability scanning into CI/CD and prevent promotion of artifacts with critical findings.",
          "explanation": "Shifting vulnerability scans left (during build) reduces risk; Inspector/ECR scanning plus CI gates prevents deploying images with known critical vulnerabilities."
        },
        {
          "id": "SCS-C03-0034",
          "question": "A media company serves video content from S3 through CloudFront. They need to ensure users cannot bypass CloudFront and access S3 directly via the bucket URL. The solution must work with SSE-KMS encrypted objects. Which approach correctly restricts S3 access to CloudFront only?",
          "choices": [
            {
              "id": "c2",
              "text": "Create a CloudFront Origin Access Identity (OAI) and grant it read access in the S3 bucket policy",
              "isCorrect": false,
              "explanation": "OAI is the legacy approach and does not support SSE-KMS encrypted objects. CloudFront cannot forward the required SigV4 KMS headers when using OAI."
            },
            {
              "id": "c3",
              "text": "Make the S3 bucket a website endpoint origin in CloudFront and restrict access with a Referer header condition in the bucket policy",
              "isCorrect": false,
              "explanation": "Website endpoint origins use HTTP (not the S3 API), don't support SSE-KMS, and Referer headers can be spoofed, making this both incompatible and insecure."
            },
            {
              "id": "c4",
              "text": "Block public access on the bucket and share S3 pre-signed URLs directly with users instead of using CloudFront",
              "isCorrect": false,
              "explanation": "Pre-signed URLs bypass CloudFront entirely, losing edge caching, WAF protection, and geo-restriction capabilities. They also expose direct S3 access."
            },
            {
              "id": "c1",
              "text": "Create a CloudFront Origin Access Control (OAC) and update the S3 bucket policy to allow access only from the OAC",
              "isCorrect": true,
              "explanation": "OAC is the recommended method for restricting S3 access to CloudFront. Unlike the legacy OAI, OAC supports SSE-KMS, S3 Object Lock, and all S3 features. The bucket policy uses aws:SourceArn to allow only the specific CloudFront distribution."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Infrastructure Security",
          "services": [
            "CloudFront",
            "S3",
            "OAC",
            "WAF"
          ],
          "docs": "https://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/private-content-restricting-access-to-s3.html",
          "tip": "Modern origin access controls replace older mechanisms and are required for certain advanced object features.",
          "explanation": "Origin Access Control (OAC) uses SigV4-signed requests from CloudFront to S3, which supports all S3 encryption modes including SSE-KMS. The S3 bucket policy can use the Condition key aws:SourceArn to restrict access to a specific CloudFront distribution ARN, ensuring no direct S3 access is possible."
        },
        {
          "id": "SCS-C03-0015",
          "question": "A security team needs to provide shell access to EC2 instances in private subnets without opening SSH ports or managing bastion hosts, while maintaining a full audit trail of every command executed. Which solution meets these requirements?",
          "choices": [
            {
              "id": "c4",
              "text": "VPN to the private subnet and SSH",
              "isCorrect": false,
              "explanation": "VPN plus SSH captures metadata but not command-level audit content."
            },
            {
              "id": "c3",
              "text": "EC2 Instance Connect",
              "isCorrect": false,
              "explanation": "Instance Connect still requires port 22 and does not natively log full session content."
            },
            {
              "id": "c2",
              "text": "Deploy a bastion host with SSH key-based authentication",
              "isCorrect": false,
              "explanation": "Bastion hosts require open SSH ports and add operational burden."
            },
            {
              "id": "c1",
              "text": "Systems Manager Session Manager",
              "isCorrect": true,
              "explanation": "Session Manager establishes encrypted sessions through the SSM agent without opening inbound ports and can log sessions to S3 or CloudWatch Logs."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Infrastructure Security",
          "services": [
            "Systems Manager",
            "EC2",
            "IAM",
            "CloudTrail"
          ],
          "docs": "https://docs.aws.amazon.com/systems-manager/latest/userguide/session-manager.html",
          "tip": "Consider agent-based session access that avoids exposing SSH/RDP ports.",
          "explanation": "Session Manager uses the SSM agent to create encrypted, IAM-authenticated sessions without inbound security group rules and logs session output for auditing."
        },
        {
          "id": "SCS-C03-0025",
          "question": "A Lambda function in a private subnet needs to call the Secrets Manager API to retrieve database credentials. The security team prohibits all internet-bound traffic from the VPC. How should the architect configure network access so the Lambda function can reach Secrets Manager without traversing the internet?",
          "choices": [
            {
              "id": "c2",
              "text": "Add a NAT Gateway to the VPC and route the Lambda subnet's traffic through it",
              "isCorrect": false,
              "explanation": "A NAT Gateway provides internet access for outbound traffic, which violates the security team's prohibition on internet-bound traffic from the VPC."
            },
            {
              "id": "c1",
              "text": "Create an interface VPC endpoint (PrivateLink) for Secrets Manager in the same VPC and ensure the Lambda function's security group allows outbound HTTPS to the endpoint",
              "isCorrect": true,
              "explanation": "An interface VPC endpoint creates private ENIs within the VPC that route traffic to the Secrets Manager API entirely over the AWS private network, with no internet path required."
            },
            {
              "id": "c3",
              "text": "Attach an Elastic IP to the Lambda function's ENI for direct outbound access",
              "isCorrect": false,
              "explanation": "Lambda functions in a VPC do not support Elastic IPs, and this approach would use the internet gateway, which is prohibited."
            },
            {
              "id": "c4",
              "text": "Configure the Lambda function outside the VPC so it can access Secrets Manager over the internet by default",
              "isCorrect": false,
              "explanation": "Placing the function outside the VPC gives it internet access to AWS APIs, but the question states the function is in a private subnet, and moving it out may break access to other VPC resources like the database."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Infrastructure Security",
          "services": [
            "Lambda",
            "VPC",
            "NAT Gateway",
            "PrivateLink",
            "Secrets Manager"
          ],
          "docs": "https://docs.aws.amazon.com/lambda/latest/dg/configuration-vpc.html",
          "tip": "Private endpoints can provide service APIs over private network paths when internet access is restricted.",
          "explanation": "Interface VPC endpoints (powered by AWS PrivateLink) create private IP addresses inside the VPC that serve as entry points for AWS service APIs. Traffic never leaves the AWS network, satisfying zero-internet-egress security requirements while allowing Lambda to call Secrets Manager."
        },
        {
          "id": "SCS-C03-0003",
          "question": "You need to block malicious HTTP traffic before it reaches your origin which service should you pair with CloudFront to filter requests at the edge?",
          "choices": [
            {
              "id": "c1",
              "text": "AWS WAF",
              "isCorrect": true,
              "explanation": "AWS WAF is the web application firewall used with CloudFront to filter HTTP(S) traffic."
            },
            {
              "id": "c4",
              "text": "AWS KMS",
              "isCorrect": false,
              "explanation": "AWS KMS is for key management and encryption, not traffic filtering."
            },
            {
              "id": "c3",
              "text": "VPC Endpoint",
              "isCorrect": false,
              "explanation": "VPC Endpoints provide private connectivity to services within a VPC, not edge HTTP filtering."
            },
            {
              "id": "c2",
              "text": "Security Groups",
              "isCorrect": false,
              "explanation": "Security Groups control traffic to EC2 at the instance level, not the CloudFront edge."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Infrastructure Security",
          "services": [
            "WAF",
            "CloudFront",
            "Security Groups"
          ],
          "docs": "https://docs.aws.amazon.com/waf/latest/developerguide/waf-chapter.html",
          "tip": "Consider application-layer filtering at the edge to block common web attack patterns.",
          "explanation": "AWS WAF integrates natively with CloudFront, ALB, and API Gateway to inspect and filter HTTP(S) requests using rules such as rate limiting and SQL injection detection."
        },
        {
          "id": "SCS-C03-0002",
          "question": "You're investigating suspicious activity and want to run investigative notebooks to visualise relationships which AWS service provides that investigative workspace?",
          "choices": [
            {
              "id": "c1",
              "text": "AWS Systems Manager",
              "isCorrect": false,
              "explanation": "Systems Manager helps manage instances but is not focused on security investigation notebooks."
            },
            {
              "id": "c2",
              "text": "Amazon Detective",
              "isCorrect": true,
              "explanation": "Amazon Detective is designed to analyze, visualize, and conduct investigations into potential security issues."
            },
            {
              "id": "c4",
              "text": "AWS CloudTrail",
              "isCorrect": false,
              "explanation": "CloudTrail records API activity and is useful for forensics, but Detective provides investigative workflows."
            },
            {
              "id": "c3",
              "text": "AWS Shield",
              "isCorrect": false,
              "explanation": "AWS Shield provides DDoS protections, not forensic investigation tools."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Incident Response",
          "services": [
            "Detective",
            "Systems Manager",
            "Shield",
            "CloudTrail"
          ],
          "docs": "https://docs.aws.amazon.com/detective/latest/adminguide/what-is.html",
          "tip": "Use a central findings aggregator that links related alerts and activity for investigation.",
          "explanation": "Amazon Detective automatically collects log data from VPC Flow Logs, CloudTrail, and GuardDuty, then builds a graph model that links related events so analysts can visually trace activity."
        },
        {
          "id": "SCS-C03-0040",
          "question": "Which combination of practices best secures the AWS account root user while preserving necessary break-glass access?",
          "choices": [
            {
              "id": "c2",
              "text": "Share root credentials with the security team to ensure quick access during incidents",
              "isCorrect": false,
              "explanation": "Sharing root credentials increases blast radius and is contrary to least-privilege practices."
            },
            {
              "id": "c3",
              "text": "Remove MFA and rely on a complex password rotated monthly",
              "isCorrect": false,
              "explanation": "Removing MFA weakens security; passwords alone are insufficient for strong break-glass protections."
            },
            {
              "id": "c1",
              "text": "Enable MFA on the root account, store credentials in a secure offline vault, and use IAM administrative roles for daily operations",
              "isCorrect": true,
              "explanation": "Enforcing MFA, securing root credentials offline, and delegating daily administrative tasks to IAM roles minimizes root usage while preserving a secured break-glass path."
            },
            {
              "id": "c4",
              "text": "Keep root access enabled for all admins but log usage to CloudTrail",
              "isCorrect": false,
              "explanation": "Allowing easy root access contradicts best practices even if logged; the preferred pattern is delegation and protected root credentials."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Security Foundations and Governance",
          "services": [
            "IAM",
            "Organizations",
            "Secrets Manager"
          ],
          "docs": "https://docs.aws.amazon.com/IAM/latest/UserGuide/id_root-user.html",
          "tip": "Minimize use of highly privileged accounts, enforce MFA, and delegate daily tasks to role-based identities.",
          "explanation": "AWS recommends enabling MFA on the root account, storing root credentials securely (e.g., an offline vault with restricted access), and using IAM roles and delegated administration for routine tasks to reduce risk and provide an auditable break-glass process."
        },
        {
          "id": "SCS-C03-0046",
          "question": "Faced with application-layer bot traffic and volumetric DDoS, which combined edge strategy provides layered protection?",
          "choices": [
            {
              "id": "c1",
              "text": "Use AWS Shield Advanced for DDoS and AWS WAF at CloudFront for application-layer filtering",
              "isCorrect": true,
              "explanation": "Shield Advanced mitigates volumetric network attacks while WAF filters application-layer patterns such as bots and OWASP threats."
            },
            {
              "id": "c3",
              "text": "Rely on client-side Captcha only",
              "isCorrect": false,
              "explanation": "Client-side controls can be bypassed and don't handle volumetric network-level attacks."
            },
            {
              "id": "c4",
              "text": "Increase EC2 instance sizes behind the load balancer",
              "isCorrect": false,
              "explanation": "Scaling instances may help capacity but does not stop DDoS or malicious application-layer requests at the edge."
            },
            {
              "id": "c2",
              "text": "Only enable security groups at the origin",
              "isCorrect": false,
              "explanation": "Security groups do not protect the global edge nor mitigate volumetric attacks effectively."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Infrastructure Security",
          "services": [
            "WAF",
            "CloudFront",
            "Shield"
          ],
          "docs": "https://docs.aws.amazon.com/waf/latest/developerguide/waf-chapter.html",
          "tip": "Defence-in-depth at the edge combines network- and application-layer protections.",
          "explanation": "Defence in depth: Shield Advanced for volumetric and network-layer attacks, WAF for application-layer patterns, and CloudFront for caching and geographic distribution."
        },
        {
          "id": "SCS-C03-0016",
          "question": "A development team stores database credentials in environment variables baked into their container images. The security team requires that credentials be rotated every 30 days without redeploying containers and that all credential access be auditable. Which approach best meets these requirements?",
          "choices": [
            {
              "id": "c4",
              "text": "Use IAM database authentication to eliminate passwords entirely",
              "isCorrect": false,
              "explanation": "IAM database authentication works only with supported engines (Aurora MySQL/PostgreSQL, RDS MySQL/PostgreSQL) and may not cover all the team's databases. It also does not address other types of credentials."
            },
            {
              "id": "c1",
              "text": "Store credentials in AWS Secrets Manager with automatic rotation enabled and retrieve them at runtime using the Secrets Manager SDK",
              "isCorrect": true,
              "explanation": "Secrets Manager supports automatic rotation via Lambda, provides versioned secrets so applications always fetch the current value at runtime, and logs all access through CloudTrail."
            },
            {
              "id": "c2",
              "text": "Store credentials in SSM Parameter Store SecureString parameters and write a cron job to update them monthly",
              "isCorrect": false,
              "explanation": "Parameter Store SecureStrings can hold secrets but lack built-in automatic rotation. A cron job is fragile and requires custom coordination with both the parameter and the database."
            },
            {
              "id": "c3",
              "text": "Encrypt the environment variables at build time with a KMS key and decrypt them at container start",
              "isCorrect": false,
              "explanation": "This protects secrets at rest in the image, but rotating requires rebuilding and redeploying the container, which violates the no-redeploy requirement."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Data Protection",
          "services": [
            "Secrets Manager",
            "Parameter Store",
            "KMS",
            "Lambda"
          ],
          "docs": "https://docs.aws.amazon.com/secretsmanager/latest/userguide/intro.html",
          "tip": "To avoid redeploys on rotation, applications should retrieve secrets dynamically at runtime.",
          "explanation": "Secrets Manager is purpose-built for credential lifecycle management. Its rotation feature invokes a Lambda function on a schedule to update both the secret value and the target resource (e.g., RDS password), while applications retrieve the current secret at runtime, eliminating the need for redeployment."
        },
        {
          "id": "SCS-C03-0024",
          "question": "A security architect wants to continuously detect any S3 buckets, IAM roles, KMS keys, or Lambda functions that are shared with external AWS accounts or public access. The solution must generate findings automatically without requiring custom code. Which service should they enable?",
          "choices": [
            {
              "id": "c1",
              "text": "IAM Access Analyzer",
              "isCorrect": true,
              "explanation": "Access Analyzer uses automated reasoning to analyze resource-based policies and identifies resources that are accessible from outside the zone of trust (account or organisation), generating findings for each."
            },
            {
              "id": "c2",
              "text": "AWS Config with the s3-bucket-public-read-prohibited managed rule",
              "isCorrect": false,
              "explanation": "This Config rule only checks S3 public read access. It does not cover cross-account sharing of IAM roles, KMS keys, or Lambda functions."
            },
            {
              "id": "c3",
              "text": "AWS Trusted Advisor security checks",
              "isCorrect": false,
              "explanation": "Trusted Advisor checks a limited set of security best practices (e.g., open security groups, root MFA) but does not perform policy-level analysis of cross-account resource sharing."
            },
            {
              "id": "c4",
              "text": "Amazon GuardDuty",
              "isCorrect": false,
              "explanation": "GuardDuty detects threats based on anomalous behaviour and threat intelligence. It does not analyze resource policies to find intentional cross-account sharing or public access grants."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Identity and Access Management",
          "services": [
            "IAM Access Analyzer",
            "IAM",
            "S3",
            "Lambda",
            "KMS"
          ],
          "docs": "https://docs.aws.amazon.com/IAM/latest/UserGuide/access-analyzer-getting-started.html",
          "tip": "Some tools perform policy-based analysis using logical reasoning rather than anomaly detection.",
          "explanation": "IAM Access Analyzer applies Zelkova-based automated reasoning to evaluate resource-based policies on S3 buckets, SQS queues, IAM roles, KMS keys, Lambda functions, and Secrets Manager secrets. It produces actionable findings whenever a policy grants access outside the defined zone of trust, with no custom code required."
        },
        {
          "id": "SCS-C03-0045",
          "question": "Given an IAM role ARN, which CLI command quickly reveals the caller identity to correlate with CloudTrail events?",
          "choices": [
            {
              "id": "c2",
              "text": "aws iam list-roles",
              "isCorrect": false,
              "explanation": "List-roles enumerates roles but doesn't show the runtime caller identity."
            },
            {
              "id": "c3",
              "text": "aws cloudtrail lookup-events",
              "isCorrect": false,
              "explanation": "Lookup-events finds historical events but does not directly reveal the current caller context."
            },
            {
              "id": "c1",
              "text": "aws sts get-caller-identity",
              "isCorrect": true,
              "explanation": "This STS call returns the effective principal; useful for correlating with CloudTrail event ARNs."
            },
            {
              "id": "c4",
              "text": "aws sts decode-authorization-message",
              "isCorrect": false,
              "explanation": "Decoding auth message requires a message from AWS and is not the general approach for caller identity."
            }
          ],
          "selectCount": 1,
          "format": "cli",
          "domain": "Incident Response",
          "services": [
            "IAM",
            "STS"
          ],
          "docs": "https://docs.aws.amazon.com/iam/latest/UserGuide/id_roles.html",
          "tip": "Use identity-revealing calls to confirm which principal is making API requests.",
          "explanation": "`get-caller-identity` is the simplest way to determine which principal is currently making API calls; pair it with CloudTrail to find related events."
        },
        {
          "id": "SCS-C03-0026",
          "question": "A company with 50 AWS accounts wants to enforce a baseline set of preventive and detective security controls (e.g., disallow public S3 buckets, require CloudTrail in all regions) across all accounts. They need a managed landing zone that automatically applies these controls to new accounts as they are created. Which service provides this capability?",
          "choices": [
            {
              "id": "c1",
              "text": "AWS Control Tower with mandatory and elective guardrails",
              "isCorrect": true,
              "explanation": "Control Tower provides a managed landing zone with pre-configured guardrails (implemented as SCPs for preventive controls and Config rules for detective controls) that are automatically applied to accounts enrolled in the landing zone."
            },
            {
              "id": "c4",
              "text": "AWS Trusted Advisor organisational view",
              "isCorrect": false,
              "explanation": "Trusted Advisor provides recommendations and checks but does not enforce controls or manage account provisioning or landing zones."
            },
            {
              "id": "c3",
              "text": "AWS Security Hub with the AWS Foundational Security Best Practices standard",
              "isCorrect": false,
              "explanation": "Security Hub detects deviations from best practices (detective) but does not prevent them (preventive). It also does not provision or manage accounts or landing zones."
            },
            {
              "id": "c2",
              "text": "AWS Organizations with manually written SCPs and Config rules deployed via StackSets",
              "isCorrect": false,
              "explanation": "This approach works but requires manual authoring, testing, and deployment of each control. Control Tower automates this with curated, pre-tested guardrails and handles new-account enrollment automatically."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Identity and Access Management",
          "services": [
            "Control Tower",
            "Organizations",
            "Config",
            "CloudFormation"
          ],
          "docs": "https://docs.aws.amazon.com/controltower/latest/userguide/guardrails.html",
          "tip": "Managed landing zone patterns enforce guardrails automatically during account provisioning.",
          "explanation": "Control Tower orchestrates Organizations, Config, CloudFormation, and IAM Identity Center to create a governed multi-account environment. Its guardrails are curated controls that are automatically enforced (preventive via SCPs) or monitored (detective via Config rules) across all enrolled accounts, including newly created ones."
        },
        {
          "id": "SCS-C03-0001",
          "question": "You're the security lead for a multi-account AWS environment. Which AWS service helps aggregate and analyze security findings across accounts?",
          "choices": [
            {
              "id": "c1",
              "text": "Amazon GuardDuty",
              "isCorrect": true,
              "explanation": "GuardDuty is a threat detection service that continuously monitors for malicious activity and unauthorized behavior."
            },
            {
              "id": "c2",
              "text": "AWS Config",
              "isCorrect": false,
              "explanation": "AWS Config tracks resource configuration and compliance, not threat detection."
            },
            {
              "id": "c3",
              "text": "AWS WAF",
              "isCorrect": false,
              "explanation": "AWS WAF is a web application firewall focused on HTTP(S) protections."
            },
            {
              "id": "c4",
              "text": "Amazon SNS",
              "isCorrect": false,
              "explanation": "Amazon SNS is a notification service, not a security findings aggregator."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Detection",
          "services": [
            "GuardDuty",
            "Config",
            "WAF",
            "SNS"
          ],
          "docs": "https://docs.aws.amazon.com/guardduty/latest/ug/what-is-guardduty.html",
          "tip": "Consider a managed threat-detection service that finds anomalous activity using threat intelligence and ML.",
          "explanation": "Amazon GuardDuty uses ML models and threat intelligence feeds to continuously detect threats across accounts. The closest wrong answer is AWS Config, which evaluates resource configuration compliance, whereas GuardDuty detects active threats."
        },
        {
          "id": "SCS-C03-0053",
          "question": "Which strategy enables workload access policies that scale with many teams and dynamic resources in AWS?",
          "choices": [
            {
              "id": "c2",
              "text": "Create a single monolithic admin role for all teams",
              "isCorrect": false,
              "explanation": "Monolithic roles violate least privilege and do not scale well."
            },
            {
              "id": "c1",
              "text": "Use ABAC with tags to grant permissions based on attributes such as department or environment",
              "isCorrect": true,
              "explanation": "ABAC provides scalable, attribute-based permissions without creating many static IAM policies per resource."
            },
            {
              "id": "c3",
              "text": "Hardcode permissions into application config files",
              "isCorrect": false,
              "explanation": "Hardcoding is insecure and prevents centralized management and auditing."
            },
            {
              "id": "c4",
              "text": "Rely solely on VPC-level security groups for access control",
              "isCorrect": false,
              "explanation": "Security groups operate at network level, not at identity/attribute level."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Identity and Access Management",
          "services": [
            "EKS",
            "IAM",
            "KMS"
          ],
          "docs": "https://docs.aws.amazon.com/eks/latest/userguide/security_iam.html",
          "tip": "Use attribute-based access control (ABAC) with tags for scalable permission models.",
          "explanation": "ABAC allows policies to reference resource or principal tags, reducing policy proliferation while enabling fine-grained access control aligned to organizational attributes."
        },
        {
          "id": "SCS-C03-0030",
          "question": "A disaster recovery plan requires that all objects in a production S3 bucket encrypted with a customer-managed KMS key be replicated to a bucket in a different region using a different KMS key. Which TWO configurations are required for cross-region replication to work with KMS-encrypted objects? (Select TWO)",
          "choices": [
            {
              "id": "c3",
              "text": "Use the same KMS key in both the source and destination regions",
              "isCorrect": false,
              "explanation": "KMS keys are regional. A key in us-east-1 cannot be used in eu-west-1. Multi-Region KMS keys exist but are not required; specifying the destination key in the replication rule is sufficient."
            },
            {
              "id": "c2",
              "text": "Grant the S3 replication role kms:Decrypt permission on the source key and kms:Encrypt permission on the destination key",
              "isCorrect": true,
              "explanation": "The replication role must decrypt the objects using the source CMK and then encrypt them with the destination CMK. Without both permissions, replication fails with AccessDenied."
            },
            {
              "id": "c5",
              "text": "Disable KMS encryption on the destination bucket and use SSE-S3 instead",
              "isCorrect": false,
              "explanation": "Switching to SSE-S3 would avoid KMS complexity but loses the benefits of customer-managed key control, audit via CloudTrail, and compliance requirements that may mandate CMK usage."
            },
            {
              "id": "c4",
              "text": "Enable S3 Transfer Acceleration on both buckets to speed up cross-region replication",
              "isCorrect": false,
              "explanation": "Transfer Acceleration optimizes direct uploads via CloudFront edge locations. It is not related to S3 replication, which uses its own internal transfer mechanism."
            },
            {
              "id": "c1",
              "text": "Specify the destination KMS key ARN in the replication rule configuration",
              "isCorrect": true,
              "explanation": "When replicating KMS-encrypted objects, the replication configuration must specify the destination KMS key so S3 can re-encrypt the objects in the destination region."
            }
          ],
          "selectCount": 2,
          "format": "text",
          "domain": "Data Protection",
          "services": [
            "S3",
            "KMS",
            "IAM",
            "Organizations"
          ],
          "docs": "https://docs.aws.amazon.com/AmazonS3/latest/userguide/replication-walkthrough-2.html",
          "tip": "Cross-account or cross-region key replication requires careful role permissions and key configuration on both ends.",
          "explanation": "S3 replication with SSE-KMS objects requires two key configurations: the replication rule must specify the destination KMS key ARN (since KMS keys are regional), and the replication IAM role must have kms:Decrypt on the source key plus kms:Encrypt and kms:GenerateDataKey on the destination key."
        },
        {
          "id": "SCS-C03-0050",
          "question": "Which approach meets the requirement: rotate DB credentials every 30 days without redeploying applications?",
          "choices": [
            {
              "id": "c4",
              "text": "Rotate credentials manually and email them to developers",
              "isCorrect": false,
              "explanation": "Manual rotation and distribution is insecure and error-prone."
            },
            {
              "id": "c2",
              "text": "Bake credentials into container images and rebuild monthly",
              "isCorrect": false,
              "explanation": "Rebuilding images is operationally heavy and requires redeployment, which the requirement forbids."
            },
            {
              "id": "c1",
              "text": "Use AWS Secrets Manager rotation with a Lambda rotation function and have apps retrieve secrets at runtime",
              "isCorrect": true,
              "explanation": "Secrets Manager supports automatic rotation and applications that fetch secrets at runtime do not need redeployment."
            },
            {
              "id": "c3",
              "text": "Store credentials in SSM Parameter Store without rotation",
              "isCorrect": false,
              "explanation": "Parameter Store can store secrets but does not provide automated rotation like Secrets Manager."
            }
          ],
          "selectCount": 1,
          "format": "json",
          "domain": "Data Protection",
          "services": [
            "Secrets Manager",
            "IAM",
            "Lambda"
          ],
          "docs": "https://docs.aws.amazon.com/secretsmanager/latest/userguide/intro.html",
          "tip": "Prefer automated rotation and runtime retrieval of secrets to decouple credentials from deployments.",
          "explanation": "Automatic rotation decouples credential lifecycles from deployments; applications should fetch secrets at runtime to benefit from rotation without redeployments."
        },
        {
          "id": "SCS-C03-0031",
          "question": "During an incident investigation, an analyst has shell access to a compromised EC2 instance and needs to determine which IAM identity the instance is currently using to make AWS API calls. Which CLI command reveals this information?",
          "choices": [
            {
              "id": "c4",
              "text": "curl http://169.254.169.254/latest/meta-data/iam/security-credentials/",
              "isCorrect": false,
              "explanation": "This metadata endpoint lists the instance profile role name and can retrieve temporary credentials, but it does not show the full ARN or account ID. It also does not detect if the instance is using a different assumed role via manual STS calls."
            },
            {
              "id": "c3",
              "text": "aws ec2 describe-instances --instance-id $(curl -s http://169.254.169.254/latest/meta-data/instance-id)",
              "isCorrect": false,
              "explanation": "describe-instances shows instance metadata including the IamInstanceProfile association, but the response contains the profile ARN, not the currently assumed role ARN with session details. get-caller-identity is more direct."
            },
            {
              "id": "c2",
              "text": "aws iam get-user",
              "isCorrect": false,
              "explanation": "get-user returns information about an IAM user. On an instance using a role (not a user), this command fails because the caller is not an IAM user."
            },
            {
              "id": "c1",
              "text": "aws sts get-caller-identity",
              "isCorrect": true,
              "explanation": "This command returns the UserId, Account, and ARN of the IAM identity (user, role, or federated identity) making the request. On an EC2 instance, it reveals the instance profile role."
            }
          ],
          "selectCount": 1,
          "format": "cli",
          "domain": "Incident Response",
          "services": [
            "STS",
            "IAM",
            "CloudShell"
          ],
          "docs": "https://docs.aws.amazon.com/cli/latest/reference/sts/get-caller-identity.html",
          "tip": "Use standard identity calls to reveal the effective caller identity across contexts.",
          "explanation": "aws sts get-caller-identity is the quickest and most reliable way to determine the current AWS identity context. It works for all principal types and returns the ARN that appears in CloudTrail logs, making it invaluable during investigations."
        },
        {
          "id": "SCS-C03-0006",
          "question": "Your security team needs a single place for findings and strong key management for encrypted data which TWO services should they use together? (Select TWO)",
          "choices": [
            {
              "id": "c2",
              "text": "AWS KMS",
              "isCorrect": true,
              "explanation": "KMS provides centralized encryption key management for encrypting data at rest."
            },
            {
              "id": "c4",
              "text": "AWS CloudFormation",
              "isCorrect": false,
              "explanation": "CloudFormation is an infrastructure-as-code service, not a security findings tool."
            },
            {
              "id": "c3",
              "text": "Amazon SQS",
              "isCorrect": false,
              "explanation": "SQS is a message queuing service, not related to security findings or encryption."
            },
            {
              "id": "c5",
              "text": "Amazon EC2",
              "isCorrect": false,
              "explanation": "EC2 provides virtual machines, not security findings management."
            },
            {
              "id": "c1",
              "text": "AWS Security Hub",
              "isCorrect": true,
              "explanation": "Security Hub provides a comprehensive view of security alerts and compliance status across accounts."
            }
          ],
          "selectCount": 2,
          "format": "text",
          "domain": "Detection",
          "services": [
            "Security Hub",
            "KMS",
            "SQS",
            "CloudFormation",
            "EC2"
          ],
          "docs": "https://docs.aws.amazon.com/securityhub/latest/userguide/what-is-securityhub.html",
          "tip": "Consider centralizing findings and using strong key management practices.",
          "explanation": "Security Hub aggregates and normalizes findings and KMS provides the keys to encrypt sensitive data."
        },
        {
          "id": "SCS-C03-0020",
          "question": "After enabling GuardDuty S3 Protection, a security analyst notices a finding of type Policy:S3/BucketAnonymousAccessGranted for a production data bucket. The analyst needs to determine which principal changed the bucket policy and when. Which data source provides this information?",
          "choices": [
            {
              "id": "c4",
              "text": "VPC Flow Logs for the VPC where the analyst is working",
              "isCorrect": false,
              "explanation": "VPC Flow Logs capture network-layer metadata (IP, port, protocol) but not API-level details like which principal called PutBucketPolicy."
            },
            {
              "id": "c2",
              "text": "The GuardDuty finding detail itself, which includes the actor and timestamp",
              "isCorrect": false,
              "explanation": "GuardDuty findings identify the affected resource and the anomaly but do not always include the full details of who made the original policy change. CloudTrail provides the definitive audit trail."
            },
            {
              "id": "c1",
              "text": "CloudTrail management events showing the PutBucketPolicy API call",
              "isCorrect": true,
              "explanation": "CloudTrail records the identity (principal), timestamp, source IP, and request parameters for S3 control-plane API calls like PutBucketPolicy. This is the authoritative source for who changed the policy and when."
            },
            {
              "id": "c3",
              "text": "S3 server access logs for the data bucket",
              "isCorrect": false,
              "explanation": "S3 server access logs capture object-level read/write requests, not bucket policy changes. Control-plane actions like PutBucketPolicy are not recorded in access logs."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Detection",
          "services": [
            "GuardDuty",
            "CloudTrail",
            "S3",
            "Security Hub"
          ],
          "docs": "https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_s3-protection.html",
          "tip": "Differentiate data-plane logs from control-plane audit logs when investigating configuration or policy changes.",
          "explanation": "CloudTrail management events are the single source of truth for AWS API activity. When investigating who changed a resource configuration, always start with CloudTrail, which records the IAM principal, the API action, the request parameters, and the exact timestamp."
        },
        {
          "id": "SCS-C03-0039",
          "question": "To ensure all client connections to an internet-facing application use modern TLS ciphers and automated certificate rotation, which configuration should be used on the load balancer?",
          "choices": [
            {
              "id": "c2",
              "text": "Use an HTTP listener and perform TLS termination on backend instances",
              "isCorrect": false,
              "explanation": "Terminating TLS on backend instances increases operational complexity and loses benefits of managed certificate rotation; it also may expose traffic if not configured properly."
            },
            {
              "id": "c4",
              "text": "Use self-signed certificates deployed to each client",
              "isCorrect": false,
              "explanation": "Self-signed certificates are not practical for public internet-facing services and do not support automated rotation and trust by clients."
            },
            {
              "id": "c3",
              "text": "Rely solely on security groups to restrict plaintext access",
              "isCorrect": false,
              "explanation": "Security groups control network access but do not provide TLS encryption or manage certificates."
            },
            {
              "id": "c1",
              "text": "Configure an HTTPS listener with an ACM-issued certificate and a recommended TLS security policy",
              "isCorrect": true,
              "explanation": "An HTTPS listener with an ACM-managed certificate ensures automated renewals and pairing with a recommended security policy enforces modern TLS ciphers and protocol versions."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Data Protection",
          "services": [
            "ALB",
            "ACM",
            "Route 53"
          ],
          "docs": "https://docs.aws.amazon.com/elasticloadbalancing/latest/application/create-https-listener.html",
          "tip": "Terminate TLS at the edge with managed certificates and enforce modern cipher and protocol policies.",
          "explanation": "ACM-managed certificates integrate with ALB listeners for seamless rotation; pairing them with an appropriate security policy ensures modern ciphers and protocol versions without manual certificate management."
        },
        {
          "id": "SCS-C03-0018",
          "question": "A company runs workloads on Amazon EKS and needs each Kubernetes pod to assume a unique IAM role with fine-grained permissions. The trust policy must ensure only the intended service account in a specific namespace can assume the role. Which trust policy snippet correctly restricts role assumption to the pod's OIDC identity?",
          "choices": [
            {
              "id": "c2",
              "text": "{\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"eks.amazonaws.com\"},\"Action\":\"sts:AssumeRole\"}",
              "isCorrect": false,
              "explanation": "This trusts the EKS service itself (the control plane), not individual pod identities. Any EKS-managed component could assume this role, not just the intended pod."
            },
            {
              "id": "c3",
              "text": "{\"Effect\":\"Allow\",\"Principal\":{\"AWS\":\"arn:aws:iam::123456789012:role/eks-node-role\"},\"Action\":\"sts:AssumeRole\"}",
              "isCorrect": false,
              "explanation": "Trusting the node role lets every pod on that node assume this role, eliminating per-pod isolation."
            },
            {
              "id": "c1",
              "text": "{\"Effect\":\"Allow\",\"Principal\":{\"Federated\":\"arn:aws:iam::123456789012:oidc-provider/oidc.eks.us-east-1.amazonaws.com/id/EXAMPLED539D4633E53DE1B71EXAMPLE\"},\"Action\":\"sts:AssumeRoleWithWebIdentity\",\"Condition\":{\"StringEquals\":{\"oidc.eks.us-east-1.amazonaws.com/id/EXAMPLED539D4633E53DE1B71EXAMPLE:sub\":\"system:serviceaccount:app-ns:app-sa\"}}}",
              "isCorrect": true,
              "explanation": "This uses the EKS OIDC provider as a Federated principal with AssumeRoleWithWebIdentity, and the Condition restricts the sub claim to the exact namespace:serviceaccount pair."
            },
            {
              "id": "c4",
              "text": "{\"Effect\":\"Allow\",\"Principal\":{\"Federated\":\"cognito-identity.amazonaws.com\"},\"Action\":\"sts:AssumeRoleWithWebIdentity\"}",
              "isCorrect": false,
              "explanation": "Cognito Identity is for end-user identity federation, not Kubernetes workload identity. EKS uses its own OIDC provider endpoint."
            }
          ],
          "selectCount": 1,
          "format": "json",
          "domain": "Identity and Access Management",
          "services": [
            "IAM",
            "STS",
            "Cognito",
            "EKS"
          ],
          "docs": "https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_providers_oidc.html",
          "tip": "Use workload identity federation patterns to grant pod-level permissions without node credentials.",
          "explanation": "IRSA projects a signed OIDC token into each pod, and the trust policy uses the cluster OIDC provider as a Federated principal with a Condition on the sub claim (namespace:serviceaccount). This ensures only the precise service account in the correct namespace can assume the role."
        },
        {
          "id": "SCS-C03-0061",
          "question": "Which solution ensures centralized, policy-driven backups across RDS and EFS with retention controls?",
          "choices": [
            {
              "id": "c1",
              "text": "Use AWS Backup with backup plans and vaults to centrally manage backups and retention",
              "isCorrect": true,
              "explanation": "AWS Backup centralizes backups across supported services and enforces retention and lifecycle rules via backup plans and vaults."
            },
            {
              "id": "c3",
              "text": "Use cross-region replication for S3 only",
              "isCorrect": false,
              "explanation": "S3 replication is specific to S3 and doesn't manage backups for other services like RDS/EFS."
            },
            {
              "id": "c2",
              "text": "Create per-service scripts to snapshot data and copy to S3",
              "isCorrect": false,
              "explanation": "Custom scripts lack centralized policy management and consistent retention enforcement."
            },
            {
              "id": "c4",
              "text": "Rely on EC2 AMI snapshots for database backups",
              "isCorrect": false,
              "explanation": "AMI snapshots are not suitable for database-consistent backups across services without application-level coordination."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Data Protection",
          "services": [
            "AWS Backup",
            "RDS",
            "S3"
          ],
          "docs": "https://docs.aws.amazon.com/backup/latest/devguide/whatisbackup.html",
          "tip": "Use a centralized backup orchestration service to manage retention and policies across supported resources.",
          "explanation": "AWS Backup simplifies centralized backup orchestration, retention policies, and cross-account/cross-region copy workflows for supported AWS resources."
        },
        {
          "id": "SCS-C03-0028",
          "question": "A data engineering team needs their Lambda function to decrypt objects in an S3 bucket that uses SSE-KMS with a customer-managed key. The function's execution role has s3:GetObject permission. Decryption attempts fail with AccessDeniedException from KMS. Which key policy statement, added to the CMK, resolves this?",
          "choices": [
            {
              "id": "c3",
              "text": "Add kms:Decrypt to the Lambda execution role's IAM policy without changing the key policy",
              "isCorrect": false,
              "explanation": "For customer-managed KMS keys, both the key policy AND the IAM policy must allow the action. If the key policy does not grant access to the principal, the IAM policy alone is insufficient."
            },
            {
              "id": "c4",
              "text": "Change the bucket encryption from SSE-KMS to SSE-S3 to avoid the KMS dependency",
              "isCorrect": false,
              "explanation": "Switching to SSE-S3 would eliminate the error, but it removes the ability to control access through KMS key policies, audit key usage via CloudTrail, and use customer-managed key rotation, which may be required by policy."
            },
            {
              "id": "c2",
              "text": "{\"Sid\":\"AllowLambdaDecrypt\",\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"lambda.amazonaws.com\"},\"Action\":[\"kms:Decrypt\"],\"Resource\":\"*\"}",
              "isCorrect": false,
              "explanation": "KMS key policies should grant permissions to the IAM role, not to the Lambda service principal. The service principal is used in trust policies, not key policies."
            },
            {
              "id": "c1",
              "text": "{\"Sid\":\"AllowLambdaDecrypt\",\"Effect\":\"Allow\",\"Principal\":{\"AWS\":\"arn:aws:iam::123456789012:role/lambda-exec-role\"},\"Action\":[\"kms:Decrypt\",\"kms:DescribeKey\"],\"Resource\":\"*\"}",
              "isCorrect": true,
              "explanation": "The Lambda execution role needs kms:Decrypt (to decrypt the data key protecting the S3 object) and kms:DescribeKey (to validate the key). The key policy must explicitly grant these actions to the role's ARN."
            }
          ],
          "selectCount": 1,
          "format": "json",
          "domain": "Data Protection",
          "services": [
            "KMS",
            "IAM",
            "S3",
            "Lambda"
          ],
          "docs": "https://docs.aws.amazon.com/kms/latest/developerguide/key-policy-modifying.html",
          "tip": "Customer-managed keys often require permissions in both the key's policy and the caller's identity policy.",
          "explanation": "Customer-managed KMS keys use a resource-based policy (key policy) that must explicitly allow principals to perform cryptographic operations. Unlike AWS-managed keys, there is no automatic cross-grant. Both the key policy and the IAM policy on the caller must allow the action for it to succeed."
        },
        {
          "id": "SCS-C03-0059",
          "question": "For workforce single sign-on with centralized permission sets, which service provides identity federation and permission management?",
          "choices": [
            {
              "id": "c1",
              "text": "IAM Identity Center (AWS SSO)",
              "isCorrect": true,
              "explanation": "IAM Identity Center provides SSO and centralized permission set management for workforce identities."
            },
            {
              "id": "c2",
              "text": "Create IAM Users for each employee",
              "isCorrect": false,
              "explanation": "IAM Users are not ideal for large-scale workforce SSO and federation scenarios."
            },
            {
              "id": "c3",
              "text": "Use local OS accounts on bastion hosts",
              "isCorrect": false,
              "explanation": "Local accounts are not centralized or scalable for enterprise SSO needs."
            },
            {
              "id": "c4",
              "text": "Use API keys stored in S3 for employees",
              "isCorrect": false,
              "explanation": "API keys are for programmatic access and not suitable for workforce SSO."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Identity and Access Management",
          "services": [
            "IAM",
            "IAM Identity Center"
          ],
          "docs": "https://docs.aws.amazon.com/iam/latest/UserGuide/id_users_create.html",
          "tip": "Use a centralized identity solution with permission sets for workforce SSO.",
          "explanation": "IAM Identity Center integrates with external IdPs and maps users to AWS permission sets, simplifying enterprise SSO and access management."
        },
        {
          "id": "SCS-C03-0054",
          "question": "What is a key operational difference between imported key material and AWS-generated KMS keys?",
          "choices": [
            {
              "id": "c1",
              "text": "Imported key material may have restrictions on automatic rotation and cannot be exported by AWS; customer manages lifecycle",
              "isCorrect": true,
              "explanation": "Imported key material is under customer control for import/removal and has different rotation/export characteristics than AWS-generated keys."
            },
            {
              "id": "c2",
              "text": "Imported key material automatically rotates daily",
              "isCorrect": false,
              "explanation": "Automatic daily rotation is not a feature of imported key material; rotation must be managed by the customer."
            },
            {
              "id": "c3",
              "text": "Imported keys are free of charge for cross-region usage",
              "isCorrect": false,
              "explanation": "Billing is not the defining operational difference; cross-region use still requires correct configuration."
            },
            {
              "id": "c4",
              "text": "AWS may export imported key material to other customers",
              "isCorrect": false,
              "explanation": "AWS does not export customer-imported key material; it's managed per customer account/CMK."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Data Protection",
          "services": [
            "KMS",
            "CloudHSM",
            "Secrets Manager"
          ],
          "docs": "https://docs.aws.amazon.com/KMS/latest/developerguide/importing-keys.html",
          "tip": "Imported key material imposes additional lifecycle and rotation responsibilities on the customer.",
          "explanation": "Choosing imported key material affects rotation, import windows, and export constraints; plan operational processes accordingly."
        },
        {
          "id": "SCS-C03-0058",
          "question": "To rate-limit abusive clients at the edge while preserving legitimate traffic, which feature combination should be used?",
          "choices": [
            {
              "id": "c1",
              "text": "AWS WAF rate-based rules on CloudFront with CloudFront caching",
              "isCorrect": true,
              "explanation": "WAF rate-based rules block clients over request thresholds while CloudFront caching reduces backend load for legitimate traffic."
            },
            {
              "id": "c2",
              "text": "NACL rules to block IP ranges",
              "isCorrect": false,
              "explanation": "NACLs are coarse-grained and do not provide application-layer rate limiting."
            },
            {
              "id": "c3",
              "text": "Increase origin instance capacity",
              "isCorrect": false,
              "explanation": "Scaling origin capacity doesn't stop abusive traffic or reduce edge processing cost."
            },
            {
              "id": "c4",
              "text": "Use Route 53 geolocation routing only",
              "isCorrect": false,
              "explanation": "Geolocation routing doesn't provide rate-limiting or application-layer filtering."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Infrastructure Security",
          "services": [
            "ALB",
            "WAF",
            "Route 53"
          ],
          "docs": "https://docs.aws.amazon.com/elasticloadbalancing/latest/application/listener-update-rule.html",
          "tip": "Implement edge rate-limiting close to users and combine caching to reduce backend load.",
          "explanation": "WAF's rate-based rules applied at CloudFront prevent abusive clients from reaching origin and, combined with caching, protect backend capacity."
        },
        {
          "id": "SCS-C03-0017",
          "question": "A network security team must capture all accepted and rejected traffic metadata for forensic analysis across 200 VPCs in a multi-account organisation. They need to query weeks of historical data on demand without maintaining always-on infrastructure. Which architecture meets these requirements most cost-effectively?",
          "choices": [
            {
              "id": "c1",
              "text": "Publish VPC Flow Logs to a centralised S3 bucket in the security account and query with Amazon Athena",
              "isCorrect": true,
              "explanation": "S3 storage is inexpensive at scale, and Athena provides serverless on-demand querying with no infrastructure to manage. Flow Logs support direct S3 delivery across accounts via resource policies."
            },
            {
              "id": "c4",
              "text": "Enable Traffic Mirroring on all ENIs and capture full packets for analysis",
              "isCorrect": false,
              "explanation": "Traffic Mirroring captures full packet payloads, which is vastly more data than flow log metadata, increasing costs dramatically and exceeding what the team requested."
            },
            {
              "id": "c3",
              "text": "Stream Flow Logs to an Amazon OpenSearch cluster for real-time dashboards and historical search",
              "isCorrect": false,
              "explanation": "OpenSearch provides powerful search but requires always-on cluster infrastructure, violating the no-maintained-infrastructure requirement and increasing cost."
            },
            {
              "id": "c2",
              "text": "Send VPC Flow Logs to CloudWatch Logs in each account and use CloudWatch Logs Insights for queries",
              "isCorrect": false,
              "explanation": "CloudWatch Logs Insights works well for recent data but becomes expensive at high volume over weeks, and cross-account querying adds operational complexity compared to a centralised S3 approach."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Detection",
          "services": [
            "VPC Flow Logs",
            "CloudWatch Logs",
            "S3",
            "Athena"
          ],
          "docs": "https://docs.aws.amazon.com/vpc/latest/userguide/flow-logs.html",
          "tip": "For large volumes of historical logs, use object storage plus an on-demand query engine for cost-effective analysis.",
          "explanation": "VPC Flow Logs can deliver directly to S3 in Parquet format with Hive-compatible partitioning, and Athena charges only per query scanned. This combination handles cross-account aggregation at scale without provisioning or maintaining any infrastructure."
        },
        {
          "id": "SCS-C03-0062",
          "question": "How should a CI/CD pipeline handle high-severity image vulnerabilities discovered by Inspector to enforce security gates?",
          "choices": [
            {
              "id": "c1",
              "text": "Fail the build when high-severity vulnerabilities are found and require a remediation PR before promotion",
              "isCorrect": true,
              "explanation": "Blocking promotion of vulnerable images enforces security gates and prevents vulnerable artifacts from reaching production."
            },
            {
              "id": "c3",
              "text": "Ignore Inspector findings as false positives",
              "isCorrect": false,
              "explanation": "Blindly ignoring findings removes an important safety mechanism; investigate and triage findings appropriately."
            },
            {
              "id": "c4",
              "text": "Convert vulnerabilities into user stories without blocking releases",
              "isCorrect": false,
              "explanation": "Converting to backlog items without blocking promotion fails to protect production environments."
            },
            {
              "id": "c2",
              "text": "Allow the build but schedule a follow-up ticket",
              "isCorrect": false,
              "explanation": "Allowing promotion undermines enforcement and risks running vulnerable code in production."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Infrastructure Security",
          "services": [
            "Inspector",
            "Security Hub",
            "Lambda"
          ],
          "docs": "https://docs.aws.amazon.com/inspector/latest/userguide/inspector_introduction.html",
          "tip": "Enforce CI gates for critical vulnerabilities and require remediation before promotion.",
          "explanation": "Integrating Inspector into CI/CD and failing builds for critical findings reduces the chance of vulnerable artifacts reaching production and ensures remediation is required."
        },
        {
          "id": "SCS-C03-0014",
          "question": "A data lake team manages a single S3 bucket accessed by multiple applications across different VPCs. They need to enforce that each application can only reach the bucket from its own VPC and can only access objects under its designated prefix. Which approach provides the strongest isolation with the least policy complexity?",
          "choices": [
            {
              "id": "c4",
              "text": "Replicate data into separate per-application buckets",
              "isCorrect": false,
              "explanation": "Replication increases cost and complexity."
            },
            {
              "id": "c1",
              "text": "Create a separate S3 Access Point for each application",
              "isCorrect": true,
              "explanation": "S3 Access Points allow per-application network and permission scoping against a shared bucket."
            },
            {
              "id": "c3",
              "text": "Create one VPC endpoint per VPC and use endpoint policies",
              "isCorrect": false,
              "explanation": "Endpoint policies are coarse for prefix-level scoping."
            },
            {
              "id": "c2",
              "text": "Write a single S3 bucket policy with separate statements per application",
              "isCorrect": false,
              "explanation": "A single bucket policy becomes difficult to manage and has size limits."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Data Protection",
          "services": [
            "S3",
            "IAM",
            "VPC",
            "PrivateLink"
          ],
          "docs": "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-points.html",
          "tip": "Think about network-scoped entry points that expose storage through controlled endpoints.",
          "explanation": "S3 Access Points provide named, per-application entry points to a bucket, each with its own policy and optional VPC restriction."
        },
        {
          "id": "SCS-C03-0032",
          "question": "A security team discovers that malware on compromised EC2 instances is using DNS queries to known command-and-control domains for data exfiltration. They need to block DNS resolution of these domains for all resources in the VPC without deploying custom DNS servers. Which service provides this capability?",
          "choices": [
            {
              "id": "c4",
              "text": "Enable GuardDuty DNS resolution monitoring to automatically block malicious domains",
              "isCorrect": false,
              "explanation": "GuardDuty detects and alerts on DNS queries to known malicious domains, but it does not block them. DNS Firewall provides the enforcement (blocking) capability."
            },
            {
              "id": "c3",
              "text": "Create NACL rules to block outbound UDP port 53 to the internet",
              "isCorrect": false,
              "explanation": "Blocking port 53 outbound would break DNS resolution for all VPC resources, not just malicious queries. VPC DNS uses the Route 53 Resolver internally, so NACL rules do not affect VPC-internal DNS resolution."
            },
            {
              "id": "c1",
              "text": "Route 53 Resolver DNS Firewall with a block-list rule group associated to the VPC",
              "isCorrect": true,
              "explanation": "DNS Firewall lets you create domain lists and rule groups that block, allow, or alert on DNS queries made through the Route 53 Resolver. Associating a rule group to a VPC applies the rules to all DNS queries from that VPC."
            },
            {
              "id": "c2",
              "text": "AWS WAF with a custom rule to block DNS traffic patterns",
              "isCorrect": false,
              "explanation": "WAF operates on HTTP/HTTPS traffic at Layer 7. It cannot inspect or block DNS queries (UDP port 53) made by VPC resources to the Route 53 Resolver."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Infrastructure Security",
          "services": [
            "Route 53",
            "Route 53 Resolver DNS Firewall",
            "VPC",
            "GuardDuty"
          ],
          "docs": "https://docs.aws.amazon.com/Route53/latest/DeveloperGuide/resolver-dns-firewall.html",
          "tip": "Consider pairing detection services with preventive controls to both find and block threats.",
          "explanation": "Route 53 Resolver DNS Firewall provides managed DNS-layer filtering within VPCs. You define domain lists (or import AWS-managed threat lists) and create rule groups with BLOCK, ALLOW, or ALERT actions. Associating the rule group to a VPC applies filtering to all Route 53 Resolver queries from that VPC."
        },
        {
          "id": "SCS-C03-0010",
          "question": "You must prevent any account in your Org from launching EC2 instances outside eu-west-1 and eu-west-2 which preventive control should you apply across the organization?",
          "choices": [
            {
              "id": "c1",
              "text": "Attach a Service Control Policy (SCP) to the organisation root or target OUs that denies ec2:RunInstances unless the aws:RequestedRegion condition matches eu-west-1 or eu-west-2",
              "isCorrect": true,
              "explanation": "SCPs set maximum permission boundaries across all accounts in an OU or organisation, overriding any IAM policy within those accounts."
            },
            {
              "id": "c4",
              "text": "Use a CloudFormation StackSet with a hook that blocks ec2:RunInstances in disallowed regions",
              "isCorrect": false,
              "explanation": "CloudFormation hooks validate CloudFormation-managed resources only, not direct API calls or console launches."
            },
            {
              "id": "c3",
              "text": "Deploy an AWS Config rule that evaluates EC2 instances and flags any launched outside the allowed regions as non-compliant",
              "isCorrect": false,
              "explanation": "Config rules are detective, not preventive - the instance would already be running before Config flags it."
            },
            {
              "id": "c2",
              "text": "Create an IAM policy in each account that denies ec2:RunInstances outside eu-west-1 and eu-west-2, and attach it to every IAM user and role",
              "isCorrect": false,
              "explanation": "Per-account IAM policies can be removed by local administrators, and new users or roles might not receive the policy."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Identity and Access Management",
          "services": [
            "Organizations",
            "IAM",
            "Config",
            "CloudFormation"
          ],
          "docs": "https://docs.aws.amazon.com/organizations/latest/userguide/orgs_manage_policies_scps.html",
          "tip": "When account-wide preventive guardrails are required, use centralized policy mechanisms.",
          "explanation": "Service Control Policies (SCPs) in AWS Organizations act as guardrails that define the maximum permissions available to all principals in member accounts."
        },
        {
          "id": "SCS-C03-0047",
          "question": "Which practice grants least-privilege permissions to pods running in EKS for accessing AWS APIs?",
          "choices": [
            {
              "id": "c4",
              "text": "Store AWS keys in pod environment variables at build time",
              "isCorrect": false,
              "explanation": "Hard-coding keys in images is insecure and prevents rotation."
            },
            {
              "id": "c1",
              "text": "Use IRSA (IAM Roles for Service Accounts) to map service accounts to IAM roles with narrow permissions",
              "isCorrect": true,
              "explanation": "IRSA ties an IAM role to a Kubernetes service account, allowing fine-grained, pod-level permissions."
            },
            {
              "id": "c3",
              "text": "Use instance metadata to share credentials across pods",
              "isCorrect": false,
              "explanation": "Instance metadata exposes node credentials and is not recommended for per-pod least-privilege."
            },
            {
              "id": "c2",
              "text": "Attach a broad IAM role to all worker nodes",
              "isCorrect": false,
              "explanation": "Node roles provide host-level permissions and risk privilege escalation from any pod to node-level permissions."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Identity and Access Management",
          "services": [
            "EKS",
            "IAM",
            "STS"
          ],
          "docs": "https://docs.aws.amazon.com/eks/latest/userguide/iam-roles-for-service-accounts.html",
          "tip": "Use workload-scoped identity mechanisms to grant narrow, auditable pod permissions.",
          "explanation": "IRSA provides workload identity that limits permissions to the specific service account and namespace, reducing blast radius and improving auditability."
        },
        {
          "id": "SCS-C03-0052",
          "question": "Which AWS feature helps simulate a principal's effective permissions to diagnose an unexpected AccessDenied?",
          "choices": [
            {
              "id": "c2",
              "text": "AWS Config",
              "isCorrect": false,
              "explanation": "Config tracks resource configurations but does not simulate policy evaluation for a principal."
            },
            {
              "id": "c3",
              "text": "CloudTrail data events",
              "isCorrect": false,
              "explanation": "CloudTrail records events but does not simulate policy evaluation prior to the request."
            },
            {
              "id": "c4",
              "text": "S3 Access Analyzer",
              "isCorrect": false,
              "explanation": "Access Analyzer inspects resource-based policies for external access, not per-principal simulation of permissions."
            },
            {
              "id": "c1",
              "text": "IAM Policy Simulator",
              "isCorrect": true,
              "explanation": "IAM Policy Simulator evaluates policies to determine whether a given action would be allowed for a principal and helps diagnose AccessDenied errors."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Identity and Access Management",
          "services": [
            "IAM",
            "Access Analyzer",
            "KMS"
          ],
          "docs": "https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies.html",
          "tip": "Use policy simulation tools to reproduce and diagnose access-denied scenarios.",
          "explanation": "Policy Simulator can combine identity and resource policies to explain why a request was denied and recommend policy changes."
        },
        {
          "id": "SCS-C03-0037",
          "question": "For a critical service running in an Auto Scaling group behind an ALB, which monitoring approach provides aggregated health metrics and automated alerting for service-level availability?",
          "choices": [
            {
              "id": "c1",
              "text": "Create CloudWatch alarms on aggregated ALB and Auto Scaling metrics and notify via SNS to trigger automated remediation",
              "isCorrect": true,
              "explanation": "CloudWatch aggregates service metrics (ALB and ASG), allows alarm thresholds, and integrates with SNS and automated remediation actions such as scaling or Lambda-driven fixes."
            },
            {
              "id": "c4",
              "text": "Attach detailed instance metrics to each EC2 instance and rely on manual inspection",
              "isCorrect": false,
              "explanation": "Instance-level metrics are useful but relying on manual inspection does not provide automated alerting or aggregated service-level visibility across an Auto Scaling group."
            },
            {
              "id": "c2",
              "text": "Rely on CloudTrail event history to monitor service health and send alerts",
              "isCorrect": false,
              "explanation": "CloudTrail records API activity and is not suitable as a primary source of service health metrics or near-real-time availability alarms."
            },
            {
              "id": "c3",
              "text": "Use S3 access logs aggregated into Athena queries to detect failures",
              "isCorrect": false,
              "explanation": "S3 access logs are eventual and not designed for real-time service availability monitoring."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Detection",
          "services": [
            "CloudWatch",
            "Auto Scaling",
            "Elastic Load Balancing",
            "SNS"
          ],
          "docs": "https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/WhatIsCloudWatch.html",
          "tip": "Aggregate load balancer and auto-scaling metrics into alarms and connect them to alerting or automation for remediation.",
          "explanation": "CloudWatch is the natural aggregation point for service metrics; combining ALB and Auto Scaling metrics with alarms and SNS-driven automation provides both service-level visibility and automatic remediation triggers."
        },
        {
          "id": "SCS-C03-0041",
          "question": "When sizing monitoring for a high-throughput API, which combination of metrics should inform your alarm thresholds for availability and performance?",
          "choices": [
            {
              "id": "c4",
              "text": "S3 bucket size growth",
              "isCorrect": false,
              "explanation": "S3 growth is unrelated to API availability metrics for request handling."
            },
            {
              "id": "c2",
              "text": "Only CPU utilization across EC2 instances",
              "isCorrect": false,
              "explanation": "CPU is useful but insufficient alone to detect request-level failures or latency spikes."
            },
            {
              "id": "c3",
              "text": "Number of open TCP connections to the VPC",
              "isCorrect": false,
              "explanation": "TCP connection counts may be noisy and do not directly indicate application-level errors or latency."
            },
            {
              "id": "c1",
              "text": "Request count, 5xx error rate, and latency percentiles",
              "isCorrect": true,
              "explanation": "Combining request volume, error rates and latency percentiles gives a balanced view of availability and performance under load."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Detection",
          "services": [
            "CloudWatch",
            "CloudWatch Logs",
            "SNS"
          ],
          "docs": "https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/monitoring-overview.html",
          "tip": "Combine throughput, error rates, and latency percentiles to set robust thresholds.",
          "explanation": "A monitoring strategy should include throughput (request count), error rates (5xx), and latency percentiles (p95/p99) to detect degradation under load and trigger appropriate alerts."
        },
        {
          "id": "SCS-C03-0049",
          "question": "A team must provide audited shell access to instances in private subnets without SSH port exposure. Which solution meets this requirement?",
          "choices": [
            {
              "id": "c1",
              "text": "Use Systems Manager Session Manager with logging to CloudWatch or S3 and IAM-based access controls",
              "isCorrect": true,
              "explanation": "Session Manager provides agent-based access without inbound ports and records sessions for auditing."
            },
            {
              "id": "c4",
              "text": "Embed root credentials in AMI for quick access",
              "isCorrect": false,
              "explanation": "Embedding credentials is insecure and hinders auditing and rotation."
            },
            {
              "id": "c2",
              "text": "Open SSH port 22 and enforce key rotation manually",
              "isCorrect": false,
              "explanation": "Opening SSH ports exposes network surface and complicates auditing compared to agent-based sessions."
            },
            {
              "id": "c3",
              "text": "Use RDP through a bastion host for Linux instances",
              "isCorrect": false,
              "explanation": "RDP is inappropriate for Linux and bastions reintroduce exposed access vectors."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Infrastructure Security",
          "services": [
            "Systems Manager",
            "SSM",
            "CloudTrail"
          ],
          "docs": "https://docs.aws.amazon.com/systems-manager/latest/userguide/session-manager.html",
          "tip": "Agent-based session solutions can record session logs and enforce access via identity policies.",
          "explanation": "Systems Manager's Session Manager avoids bastions and allows session logging to CloudWatch/S3 and control via IAM, meeting audit requirements."
        },
        {
          "id": "SCS-C03-0029",
          "question": "An organisation with 300 member accounts needs to enable GuardDuty in every account and every region, automatically including future accounts. All findings must be viewable from the security account. Which approach achieves this with the least ongoing maintenance?",
          "choices": [
            {
              "id": "c2",
              "text": "Send manual invitation requests from the security account to each of the 300 member accounts and accept them individually",
              "isCorrect": false,
              "explanation": "Manual invitations work but require per-account acceptance, do not auto-enrol future accounts, and become unmanageable at scale."
            },
            {
              "id": "c1",
              "text": "Designate a delegated administrator account for GuardDuty through AWS Organizations and enable the auto-enable feature for new member accounts",
              "isCorrect": true,
              "explanation": "The delegated administrator model in GuardDuty with auto-enable automatically activates GuardDuty in all current and future member accounts. Findings from all accounts are aggregated in the administrator account."
            },
            {
              "id": "c4",
              "text": "Enable Security Hub in the security account and it will automatically enable GuardDuty across all member accounts",
              "isCorrect": false,
              "explanation": "Security Hub aggregates findings from GuardDuty but does not enable or manage GuardDuty. They are independent services with separate enablement processes."
            },
            {
              "id": "c3",
              "text": "Deploy GuardDuty via a CloudFormation StackSet targeting all accounts and regions",
              "isCorrect": false,
              "explanation": "StackSets can enable GuardDuty but do not establish the administrator-member relationship needed to aggregate findings centrally, and they require additional work for auto-enabling in new accounts."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Detection",
          "services": [
            "GuardDuty",
            "Organizations",
            "Security Hub",
            "S3"
          ],
          "docs": "https://docs.aws.amazon.com/guardduty/latest/ug/what-is-guardduty.html",
          "tip": "Organization-level integrations allow services to be enabled and managed centrally across member accounts.",
          "explanation": "GuardDuty's Organizations integration allows a delegated administrator to manage GuardDuty across all member accounts centrally. The auto-enable feature ensures new accounts are automatically enrolled without manual intervention, and all findings flow to the administrator account for consolidated monitoring."
        },
        {
          "id": "SCS-C03-0051",
          "question": "For secure, performant connectivity between on-premises and multiple AWS regions, which architecture is recommended?",
          "choices": [
            {
              "id": "c2",
              "text": "Create individual Site-to-Site VPNs from on-prem to each VPC",
              "isCorrect": false,
              "explanation": "Multiple VPNs increase operational overhead and complexity for multi-region connectivity."
            },
            {
              "id": "c1",
              "text": "Use AWS Transit Gateway in each region with Direct Connect and Transit Gateway inter-region peering",
              "isCorrect": true,
              "explanation": "Transit Gateway with Direct Connect and inter-region peering reduces management complexity and centralizes routing at scale."
            },
            {
              "id": "c3",
              "text": "Rely on internet-based VPNs only",
              "isCorrect": false,
              "explanation": "Internet VPNs may not meet performance and security requirements compared to Direct Connect."
            },
            {
              "id": "c4",
              "text": "Use S3 transfer acceleration for VPC connectivity",
              "isCorrect": false,
              "explanation": "S3 Transfer Acceleration is for object transfers and not a network topology solution."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Infrastructure Security",
          "services": [
            "VPC",
            "Transit Gateway",
            "VPN"
          ],
          "docs": "https://docs.aws.amazon.com/vpc/latest/userguide/what-is-amazon-vpc.html",
          "tip": "Combine transit routing and dedicated connectivity for scalable, performant hybrid networking.",
          "explanation": "Transit Gateway simplifies routing between many VPCs and on-premises, and Direct Connect improves performance and security over internet VPNs."
        },
        {
          "id": "SCS-C03-0022",
          "question": "An operations team wants to automate incident response when a critical CloudWatch alarm triggers: page the on-call engineer, create a timeline, and start a runbook to collect diagnostic data. They want a single AWS-native service to orchestrate all three actions. Which service should they configure?",
          "choices": [
            {
              "id": "c1",
              "text": "AWS Systems Manager Incident Manager",
              "isCorrect": true,
              "explanation": "Incident Manager automates incident creation with response plans that define escalation contacts, engagement protocols, and runbook automation, all triggered by CloudWatch alarms or EventBridge rules."
            },
            {
              "id": "c4",
              "text": "AWS CloudWatch composite alarms with auto-scaling actions",
              "isCorrect": false,
              "explanation": "Composite alarms aggregate alarm states but their actions are limited to SNS, Lambda, or Auto Scaling. They do not provide incident lifecycle management."
            },
            {
              "id": "c2",
              "text": "Amazon EventBridge with Lambda targets",
              "isCorrect": false,
              "explanation": "EventBridge plus Lambda can achieve similar automation but requires custom code for paging, timeline tracking, and runbook execution. It is not a single orchestration service purpose-built for incident response."
            },
            {
              "id": "c3",
              "text": "Amazon SNS with multiple topic subscriptions",
              "isCorrect": false,
              "explanation": "SNS delivers notifications but does not manage incident timelines, runbook execution, or structured escalation workflows."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Incident Response",
          "services": [
            "Systems Manager Incident Manager",
            "EventBridge",
            "SNS",
            "PagerDuty"
          ],
          "docs": "https://docs.aws.amazon.com/incident-manager/latest/userguide/what-is-incident-manager.html",
          "tip": "Consider incident management tools that integrate alerting, timelines, and automated runbooks.",
          "explanation": "Incident Manager provides structured response plans that automatically engage contacts (via SMS, voice, or email), create incident timelines, and execute SSM Automation runbooks when triggered. This consolidates incident orchestration into one service rather than gluing multiple services together with custom logic."
        },
        {
          "id": "SCS-C03-0011",
          "question": "Compliance requires CloudWatch Logs to use a customer-managed CMK and let the service use it what steps achieve this configuration?",
          "choices": [
            {
              "id": "c4",
              "text": "Create an AWS-managed KMS key (alias aws/logs) and it will automatically encrypt all new log groups without any key policy changes",
              "isCorrect": false,
              "explanation": "CloudWatch Logs does not have an AWS-managed key. You must create and configure a customer-managed key explicitly."
            },
            {
              "id": "c3",
              "text": "Enable CloudTrail log file encryption with a KMS key and configure CloudWatch Logs as a CloudTrail destination",
              "isCorrect": false,
              "explanation": "CloudTrail encryption covers CloudTrail's own log files delivered to S3, not arbitrary CloudWatch Logs log groups."
            },
            {
              "id": "c1",
              "text": "Create a customer-managed KMS key with a key policy granting logs.<region>.amazonaws.com the kms:Encrypt, kms:Decrypt, kms:GenerateDataKey, and kms:DescribeKey actions, then associate the key with each log group",
              "isCorrect": true,
              "explanation": "CloudWatch Logs requires these four KMS actions in the key policy for the regional service principal to encrypt and decrypt log data."
            },
            {
              "id": "c2",
              "text": "Enable SSE-S3 default encryption on the S3 bucket where CloudWatch Logs exports data and reference that bucket in each log group's settings",
              "isCorrect": false,
              "explanation": "S3 encryption applies only to exported log data in S3, not to log data stored within the CloudWatch Logs service itself."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Data Protection",
          "services": [
            "CloudWatch Logs",
            "KMS",
            "S3",
            "CloudTrail"
          ],
          "docs": "https://docs.aws.amazon.com/AmazonCloudWatch/latest/logs/encrypt-log-data-kms.html",
          "tip": "Some logging services require customer-managed keys for encryption at rest; verify key management options.",
          "explanation": "CloudWatch Logs supports encryption at rest only with customer-managed KMS keys. You must explicitly grant the regional service principal permission to use the key."
        },
        {
          "id": "SCS-C03-0055",
          "question": "Which pattern centralizes billing, consolidated policies, and delegated security administration across many accounts?",
          "choices": [
            {
              "id": "c3",
              "text": "Use a single shared AWS account for all teams",
              "isCorrect": false,
              "explanation": "A single account lacks isolation and governance for multiple teams or environments."
            },
            {
              "id": "c2",
              "text": "Manage each account independently with separate billing",
              "isCorrect": false,
              "explanation": "Independent accounts increase operational overhead and hinder centralized policy enforcement."
            },
            {
              "id": "c1",
              "text": "Use AWS Organizations with an organizational management account, OUs for environment separation, and delegated admin roles",
              "isCorrect": true,
              "explanation": "Organizations centralize management, apply SCPs, and enable delegated admin accounts for service management across member accounts."
            },
            {
              "id": "c4",
              "text": "Delegate everything to third-party SaaS governance tools only",
              "isCorrect": false,
              "explanation": "Third-party tools can help but AWS Organizations provides foundational native patterns for central control."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Security Foundations and Governance",
          "services": [
            "Organizations",
            "IAM",
            "CloudTrail"
          ],
          "docs": "https://docs.aws.amazon.com/whitepapers/latest/aws-security-best-practices/overview.html",
          "tip": "Organize accounts with OUs and delegated administration for scale and governance.",
          "explanation": "AWS Organizations supports centralized billing, SCPs for guardrails, and delegated admin roles for services such as GuardDuty or Security Hub, enabling scalable governance."
        },
        {
          "id": "SCS-C03-0021",
          "question": "A company needs to inspect all egress traffic from its VPC for data exfiltration patterns using Suricata-compatible IDS/IPS rules at the network layer. Security Groups and NACLs are already in place for basic access control. Which service should they deploy?",
          "choices": [
            {
              "id": "c3",
              "text": "Tighten Security Group outbound rules to restrict destination IPs",
              "isCorrect": false,
              "explanation": "Security Groups provide stateful allow/deny by IP and port but cannot perform deep packet inspection or pattern-based detection of data exfiltration."
            },
            {
              "id": "c2",
              "text": "AWS WAF",
              "isCorrect": false,
              "explanation": "WAF operates at Layer 7 (HTTP/HTTPS) and integrates with CloudFront, ALB, and API Gateway. It cannot inspect arbitrary TCP/UDP egress traffic or run Suricata rules."
            },
            {
              "id": "c1",
              "text": "AWS Network Firewall",
              "isCorrect": true,
              "explanation": "Network Firewall is a managed, stateful network firewall that supports Suricata-compatible rules for deep packet inspection, IDS/IPS, and domain-based filtering on both ingress and egress traffic."
            },
            {
              "id": "c4",
              "text": "Configure more restrictive NACLs on the VPC subnets",
              "isCorrect": false,
              "explanation": "NACLs are stateless IP/port filters. They cannot inspect packet payloads or apply IDS/IPS signature-based rules."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Infrastructure Security",
          "services": [
            "Network Firewall",
            "WAF",
            "Security Groups",
            "NACLs"
          ],
          "docs": "https://docs.aws.amazon.com/network-firewall/latest/developerguide/what-is-aws-network-firewall.html",
          "tip": "Deep packet inspection and IDS/IPS operate at different layers than security groups or application firewalls.",
          "explanation": "AWS Network Firewall sits in-line in VPC traffic paths (via Gateway Load Balancer endpoints or firewall subnets) and evaluates packets against stateful Suricata-compatible rule groups. It fills the gap between simple Security Group/NACL controls and full deep-packet inspection requirements."
        },
        {
          "id": "SCS-C03-0036",
          "question": "A security platform team must deploy a hardened VPC, a set of IAM permission boundaries, and logging configuration to 15 existing AWS accounts. Changes must be automated via CI/CD, deployments must be auditable, and any account drift should be detectable centrally. The team also wants least-privilege for the agents that perform deployments. Which approach best satisfies these requirements?",
          "choices": [
            {
              "id": "c4",
              "text": "Utilise AWS Control Tower guardrails to keep accounts compliant and make manual adjustments via the console for exceptions",
              "isCorrect": false,
              "explanation": "Control Tower provides guardrails and a landing zone but is not a full CI/CD-driven IaC deployment and does not replace an auditable, parameterized IaC pipeline for existing accounts at scale."
            },
            {
              "id": "c1",
              "text": "Create a parameterized CloudFormation module for the baseline, publish it to a central artifact repository, and deploy via CloudFormation StackSets (service-managed) from a CI/CD pipeline using delegated administrator roles; enable drift detection and record pipeline runs for auditability",
              "isCorrect": true,
              "explanation": "StackSets (service-managed) supports automated, organization-aware deployments driven by CI/CD, delegated admin roles provide least-privilege, and enabling drift detection plus CI/CD run logs provides centralized detection and an audit trail."
            },
            {
              "id": "c3",
              "text": "Use Terraform workspaces stored locally per account and have individual engineers apply changes when notified",
              "isCorrect": false,
              "explanation": "Local, manual Terraform applies lack centralized automation, auditability, and organization-level drift detection; they also increase risk of inconsistent state."
            },
            {
              "id": "c2",
              "text": "Let each account run CloudFormation stacks triggered manually by account owners, and collect logs centrally afterwards",
              "isCorrect": false,
              "explanation": "Manual, per-account deployments are not automated or easily auditable and do not provide centralized drift detection or consistent configuration."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Security Foundations and Governance",
          "services": [
            "CloudFormation",
            "StackSets",
            "CI/CD",
            "Organizations"
          ],
          "docs": "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/what-is-cfn.html",
          "tip": "Use organization-aware IaC patterns integrated with CI/CD, delegated roles, and drift detection.",
          "explanation": "For consistent, auditable, and automated deployments across multiple accounts, an org-aware IaC pattern like CloudFormation StackSets driven by a CI/CD pipeline provides parameterized modules, centralized rollout, delegated administration for least-privilege, and drift detection to identify configuration divergence. This pattern satisfies automation, auditability, and centralized management requirements."
        },
        {
          "id": "SCS-C03-0060",
          "question": "Which strategy reduces cost while preserving required retention for infrequently accessed file data?",
          "choices": [
            {
              "id": "c4",
              "text": "Delete older data to save cost without retention requirements",
              "isCorrect": false,
              "explanation": "Deletion may violate retention and compliance requirements."
            },
            {
              "id": "c1",
              "text": "Use lifecycle policies to move infrequently accessed data to lower-cost storage tiers such as EFS Infrequent Access or archival destinations",
              "isCorrect": true,
              "explanation": "Lifecycle policies move data automatically to cheaper tiers while retaining access and meeting retention policies."
            },
            {
              "id": "c3",
              "text": "Manually archive files to local tape every quarter",
              "isCorrect": false,
              "explanation": "Manual processes are error-prone and lack automation and auditability."
            },
            {
              "id": "c2",
              "text": "Keep all data on high-performance SSD tiers indefinitely",
              "isCorrect": false,
              "explanation": "Retaining everything on high-cost tiers is inefficient and expensive."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Data Protection",
          "services": [
            "EFS",
            "Lifecycle",
            "S3 Glacier"
          ],
          "docs": "https://docs.aws.amazon.com/efs/latest/ug/what-is-efs.html",
          "tip": "Automate lifecycle transitions to lower-cost tiers based on access patterns.",
          "explanation": "Automated lifecycle policies balance cost and retention by moving data to appropriate storage classes based on age and access frequency."
        },
        {
          "id": "SCS-C03-0027",
          "question": "A security team has an AWS Config rule that detects S3 buckets without default encryption enabled. They want Config to automatically remediate non-compliant buckets by applying AES-256 server-side encryption. Which CloudFormation snippet correctly defines the auto-remediation action?",
          "choices": [
            {
              "id": "c2",
              "text": "Type: AWS::Config::RemediationConfiguration\nProperties:\n  ConfigRuleName: s3-bucket-server-side-encryption-enabled\n  TargetType: LAMBDA\n  TargetId: arn:aws:lambda:us-east-1:123456789012:function:fix-encryption\n  Automatic: true",
              "isCorrect": false,
              "explanation": "Config remediation currently only supports SSM_DOCUMENT as a TargetType. Lambda functions cannot be used directly as remediation targets in a RemediationConfiguration resource."
            },
            {
              "id": "c3",
              "text": "Add a ComplianceResourceTypes property to the Config rule that triggers an SNS notification, then subscribe a Lambda function to apply encryption",
              "isCorrect": false,
              "explanation": "This creates a notification pipeline, not an automatic remediation. It also requires custom SNS-to-Lambda wiring and does not use Config's built-in remediation feature."
            },
            {
              "id": "c4",
              "text": "Use an EventBridge rule to detect Config compliance change events and invoke a Step Functions workflow",
              "isCorrect": false,
              "explanation": "While this architecture works, it bypasses Config's native remediation capability, introducing more components to build and maintain. The question asks for Config auto-remediation."
            },
            {
              "id": "c1",
              "text": "Type: AWS::Config::RemediationConfiguration\nProperties:\n  ConfigRuleName: s3-bucket-server-side-encryption-enabled\n  TargetType: SSM_DOCUMENT\n  TargetId: AWS-EnableS3BucketEncryption\n  Automatic: true\n  MaximumAutomaticAttempts: 3\n  RetryAttemptSeconds: 60\n  Parameters:\n    BucketName:\n      ResourceValue:\n        Value: RESOURCE_ID",
              "isCorrect": true,
              "explanation": "This uses an AWS-provided SSM Automation document to enable encryption on the non-compliant bucket. TargetType SSM_DOCUMENT and the RESOURCE_ID placeholder correctly bind the remediation to the flagged resource."
            }
          ],
          "selectCount": 1,
          "format": "yaml",
          "domain": "Detection",
          "services": [
            "Config",
            "Systems Manager",
            "S3",
            "Lambda"
          ],
          "docs": "https://docs.aws.amazon.com/config/latest/developerguide/remediation.html",
          "tip": "Automatic remediation mechanisms commonly invoke automation documents or playbooks rather than ad-hoc functions.",
          "explanation": "AWS Config remediation actions invoke SSM Automation documents to fix non-compliant resources. AWS provides pre-built documents like AWS-EnableS3BucketEncryption. Setting Automatic to true and configuring retry parameters ensures Config will apply the fix without manual intervention whenever a drift is detected."
        },
        {
          "id": "SCS-C03-0063",
          "question": "Which practice validates that an incident response runbook will work under real conditions?",
          "choices": [
            {
              "id": "c3",
              "text": "Assume runbooks are valid if written by senior staff",
              "isCorrect": false,
              "explanation": "Assumptions without testing risk undiscovered issues in execution under pressure."
            },
            {
              "id": "c2",
              "text": "Only review runbooks annually without testing",
              "isCorrect": false,
              "explanation": "Reviews without testing may miss operational and technical gaps discovered during live drills."
            },
            {
              "id": "c1",
              "text": "Conduct tabletop exercises and full-scale simulated incident drills using controlled fault injection",
              "isCorrect": true,
              "explanation": "Tabletops test decision-making; simulated drills and fault injection test technical runbooks and automation under realistic conditions."
            },
            {
              "id": "c4",
              "text": "Rely on vendor-provided runbooks without customization",
              "isCorrect": false,
              "explanation": "Vendor runbooks may not match the customer's environment and need adaptation and testing."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Incident Response",
          "services": [
            "Incident Manager",
            "CloudWatch",
            "EventBridge"
          ],
          "docs": "https://docs.aws.amazon.com/whitepapers/latest/aws-security-best-practices/incident-response.html",
          "tip": "Run both tabletop and technical drills to validate people and technical runbooks.",
          "explanation": "Combining tabletop exercises for roles and decisions with full technical drills (injecting faults) validates both human and automated aspects of incident response."
        },
        {
          "id": "SCS-C03-0012",
          "question": "Which IAM mechanism lets you enforce that ceiling while preserving self-service?",
          "choices": [
            {
              "id": "c1",
              "text": "Require developers to attach a permissions boundary to every role they create",
              "isCorrect": true,
              "explanation": "Permissions boundaries cap the maximum permissions a role can have, even if the role's identity policy grants broader access."
            },
            {
              "id": "c4",
              "text": "Use an SCP to deny iam:CreateRole for all developers and have the platform team create roles on request",
              "isCorrect": false,
              "explanation": "This removes developer self-service entirely, creating operational bottlenecks without enabling delegation."
            },
            {
              "id": "c2",
              "text": "Grant developers iam:CreateRole but restrict the role's trust policy to lambda.amazonaws.com only",
              "isCorrect": false,
              "explanation": "Restricting the trust policy limits who can assume the role, but does not limit what permissions the role itself can have."
            },
            {
              "id": "c3",
              "text": "Create a single shared Lambda execution role managed by the platform team",
              "isCorrect": false,
              "explanation": "A shared role works but violates least privilege because all functions share the same permissions regardless of their needs."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Identity and Access Management",
          "services": [
            "IAM",
            "Organizations",
            "STS"
          ],
          "docs": "https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies_boundaries.html",
          "tip": "Consider permission boundary patterns to limit maximum permissions while enabling self-service.",
          "explanation": "IAM permissions boundaries act as a ceiling on the effective permissions of a role or user."
        },
        {
          "id": "SCS-C03-0042",
          "question": "Which architecture most cost-effectively stores months of high-volume logs for ad-hoc forensic queries?",
          "choices": [
            {
              "id": "c3",
              "text": "Store logs in DynamoDB single-table design",
              "isCorrect": false,
              "explanation": "DynamoDB is not cost-effective for large historical log volumes and analytics queries."
            },
            {
              "id": "c2",
              "text": "Stream logs to OpenSearch with 90-day hot storage",
              "isCorrect": false,
              "explanation": "OpenSearch is efficient for real-time searches but expensive for long-term retention at scale."
            },
            {
              "id": "c1",
              "text": "Deliver logs to S3 in partitioned Parquet and query with Athena",
              "isCorrect": true,
              "explanation": "S3 + Parquet + Athena supports low-cost storage and ad-hoc querying without always-on infrastructure."
            },
            {
              "id": "c4",
              "text": "Keep logs only on instance disk for speed",
              "isCorrect": false,
              "explanation": "Instance disks are ephemeral and unsuitable for long-term forensic retention."
            }
          ],
          "selectCount": 1,
          "format": "yaml",
          "domain": "Detection",
          "services": [
            "CloudWatch Logs",
            "Athena",
            "S3"
          ],
          "docs": "https://docs.aws.amazon.com/AmazonCloudWatch/latest/logs/WhatIsCloudWatchLogs.html",
          "tip": "Partition logs and use columnar formats to reduce query costs.",
          "explanation": "Exporting log data to S3 in Parquet with partitioning reduces query scan costs and enables scalable ad-hoc analysis via Athena or Lakehouse tools."
        },
        {
          "id": "SCS-C03-0064",
          "question": "After a GuardDuty finding indicates suspicious API calls from a role, which steps validate scope and impact?",
          "choices": [
            {
              "id": "c4",
              "text": "Assume GuardDuty is faulty and open a support ticket",
              "isCorrect": false,
              "explanation": "While false positives can occur, perform validation steps before concluding GuardDuty is wrong."
            },
            {
              "id": "c1",
              "text": "Retrieve CloudTrail management events for the role, query related CloudWatch Logs, and inspect resource changes",
              "isCorrect": true,
              "explanation": "Correlate GuardDuty findings with CloudTrail events and application logs to scope the impact and timeline."
            },
            {
              "id": "c3",
              "text": "Ignore the finding if there are no console alerts",
              "isCorrect": false,
              "explanation": "Findings should be validated; absence of console alerts doesn't mean no impact."
            },
            {
              "id": "c2",
              "text": "Temporarily revoke the role's active sessions pending investigation",
              "isCorrect": false,
              "explanation": "Revoking sessions can limit ongoing activity but is disruptive; triage and validation are usually performed first to scope impact before broad actions."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Incident Response",
          "services": [
            "GuardDuty",
            "Security Hub",
            "EventBridge"
          ],
          "docs": "https://docs.aws.amazon.com/guardduty/latest/ug/what-is-guardduty.html",
          "tip": "Correlate detection alerts with audit trails and application logs to validate scope and impact.",
          "explanation": "Effective validation uses multiple data sources: CloudTrail shows API callers and timestamps; CloudWatch and application logs show resource-level effects and help identify affected assets."
        },
        {
          "id": "SCS-C03-0009",
          "question": "As a data steward you need to automatically find and classify PII across hundreds of S3 buckets. Which AWS service is built for that task?",
          "choices": [
            {
              "id": "c2",
              "text": "Amazon GuardDuty",
              "isCorrect": false,
              "explanation": "GuardDuty detects threats like unusual API calls to S3 but does not inspect object contents for sensitive data."
            },
            {
              "id": "c4",
              "text": "AWS Trusted Advisor",
              "isCorrect": false,
              "explanation": "Trusted Advisor provides account-level checks like open security groups, but does not scan S3 object contents."
            },
            {
              "id": "c1",
              "text": "Amazon Macie",
              "isCorrect": true,
              "explanation": "Macie scans S3 objects for PII, financial data, and credentials using ML-powered classifiers and managed data identifiers."
            },
            {
              "id": "c3",
              "text": "Amazon Inspector",
              "isCorrect": false,
              "explanation": "Inspector focuses on vulnerability scanning for compute workloads, not data classification in S3."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Data Protection",
          "services": [
            "Macie",
            "GuardDuty",
            "Inspector",
            "Trusted Advisor"
          ],
          "docs": "https://docs.aws.amazon.com/macie/latest/user/what-is-macie.html",
          "tip": "Some services scan stored objects to locate sensitive data and personally identifiable information.",
          "explanation": "Amazon Macie is designed to scan S3 objects and classify sensitive content such as PII and PHI using managed data identifiers."
        },
        {
          "id": "SCS-C03-0044",
          "question": "Which log sources are most relevant when troubleshooting intermittent 502 responses from an ALB?",
          "choices": [
            {
              "id": "c1",
              "text": "ALB access logs, target group health checks, and CloudWatch metrics for targets",
              "isCorrect": true,
              "explanation": "ALB access logs show request/response details; target health and metrics reveal backend errors that cause 502s."
            },
            {
              "id": "c4",
              "text": "IAM access logs",
              "isCorrect": false,
              "explanation": "IAM logs are unrelated to HTTP 502 responses."
            },
            {
              "id": "c2",
              "text": "S3 server access logs only",
              "isCorrect": false,
              "explanation": "S3 logs are irrelevant to ALB 502s unless the origin is S3, which is uncommon for dynamic backends."
            },
            {
              "id": "c3",
              "text": "Route 53 DNS query logs",
              "isCorrect": false,
              "explanation": "DNS logs don't provide HTTP backend error details."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Detection",
          "services": [
            "ALB",
            "Target Groups",
            "Auto Scaling"
          ],
          "docs": "https://docs.aws.amazon.com/elasticloadbalancing/latest/application/load-balancer-target-groups.html",
          "tip": "Correlate access logs with backend health and metrics when investigating HTTP errors.",
          "explanation": "Investigations into 502 errors should include ALB access logs (to see upstream responses), backend target health and metrics (to spot crashes), and application logs where possible."
        },
        {
          "id": "SCS-C03-0007",
          "question": "You're locking down access so an IAM role can only reach an S3 bucket via a specific VPC endpoint. Which condition should you add to the policy to enforce this?",
          "choices": [
            {
              "id": "c1",
              "text": "{\"Condition\": {\"StringEquals\": {\"aws:sourceVpce\": \"vpce-certshack123\"}}}",
              "isCorrect": true,
              "explanation": "aws:sourceVpce condition restricts the policy to requests through the specified VPC endpoint."
            },
            {
              "id": "c3",
              "text": "Add the VPC endpoint ID to the IAM role's trust policy as a Principal",
              "isCorrect": false,
              "explanation": "VPC endpoints are not IAM principals and cannot appear in a trust policy's Principal element."
            },
            {
              "id": "c4",
              "text": "Attach a security group to the IAM role that only allows traffic from the VPC",
              "isCorrect": false,
              "explanation": "Security groups are network-level controls for ENIs - they cannot be attached to IAM roles."
            },
            {
              "id": "c2",
              "text": "{\"Condition\": {\"IpAddress\": {\"aws:SourceIp\": \"10.0.0.0/16\"}}}",
              "isCorrect": false,
              "explanation": "IpAddress/SourceIp restricts by IP range, not by VPC endpoint identity."
            }
          ],
          "selectCount": 1,
          "format": "json",
          "domain": "Identity and Access Management",
          "services": [
            "IAM",
            "S3"
          ],
          "docs": "https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies.html",
          "tip": "Restrict access by considering VPC endpoint-based conditions in resource policies.",
          "explanation": "The aws:sourceVpce condition key with StringEquals restricts access to requests that traverse a specific VPC endpoint."
        },
        {
          "id": "SCS-C03-0005",
          "question": "You've been asked to centralise key management for data-at-rest across services. Which AWS service provides managed encryption keys for this purpose?",
          "choices": [
            {
              "id": "c2",
              "text": "AWS IAM",
              "isCorrect": false,
              "explanation": "AWS IAM handles identity and permissions, not key storage or encryption primitives."
            },
            {
              "id": "c4",
              "text": "AWS WAF",
              "isCorrect": false,
              "explanation": "AWS WAF is a web application firewall, not key management."
            },
            {
              "id": "c3",
              "text": "AWS Shield",
              "isCorrect": false,
              "explanation": "AWS Shield protects against DDoS attacks, not key management."
            },
            {
              "id": "c1",
              "text": "AWS KMS",
              "isCorrect": true,
              "explanation": "AWS KMS is the managed service for creating and controlling encryption keys."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Data Protection",
          "services": [
            "KMS",
            "IAM",
            "Shield",
            "WAF"
          ],
          "docs": "https://docs.aws.amazon.com/kms/latest/developerguide/overview.html",
          "tip": "Use a key management service that supports envelope encryption and key lifecycle controls.",
          "explanation": "AWS KMS provides centralized creation, rotation, and access control of encryption keys used to protect data at rest across services like S3, EBS, and RDS."
        },
        {
          "id": "SCS-C03-0038",
          "question": "Which AWS service automates building, testing, and distributing hardened AMIs with a repeatable pipeline?",
          "choices": [
            {
              "id": "c4",
              "text": "AWS CloudFormation",
              "isCorrect": false,
              "explanation": "CloudFormation deploys infrastructure as code but does not provide an image build-and-test pipeline by itself."
            },
            {
              "id": "c1",
              "text": "EC2 Image Builder",
              "isCorrect": true,
              "explanation": "EC2 Image Builder automates the creation, patching, testing, and distribution of server images according to repeatable pipelines and policies."
            },
            {
              "id": "c3",
              "text": "Amazon Inspector",
              "isCorrect": false,
              "explanation": "Inspector performs vulnerability assessments but does not build or distribute hardened AMIs."
            },
            {
              "id": "c2",
              "text": "AWS Glue",
              "isCorrect": false,
              "explanation": "Glue is an ETL/data integration service, not an image-building pipeline."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Infrastructure Security",
          "services": [
            "EC2 Image Builder",
            "EC2",
            "Systems Manager"
          ],
          "docs": "https://docs.aws.amazon.com/imagebuilder/latest/userguide/what-is-image-builder.html",
          "tip": "Use automated image pipelines that include patching and configuration validation before distribution.",
          "explanation": "EC2 Image Builder provides a repeatable, auditable pipeline to produce hardened AMIs, including testing steps and integration with Systems Manager for patching and compliance verification."
        },
        {
          "id": "SCS-C03-0004",
          "question": "You're designing a system that avoids long-lived keys. Which AWS feature helps enforce least privilege by issuing temporary credentials?",
          "choices": [
            {
              "id": "c2",
              "text": "IAM Users with long-term access keys",
              "isCorrect": false,
              "explanation": "IAM Users with long-term keys are not recommended for least-privilege patterns."
            },
            {
              "id": "c1",
              "text": "IAM Roles with STS",
              "isCorrect": true,
              "explanation": "IAM Roles with STS allow issuance of temporary credentials for short-term access."
            },
            {
              "id": "c4",
              "text": "Amazon Cognito",
              "isCorrect": false,
              "explanation": "Amazon Cognito provides user identity for apps, but the core mechanism for temporary AWS credentials is STS with roles."
            },
            {
              "id": "c3",
              "text": "Security Groups",
              "isCorrect": false,
              "explanation": "Security Groups are network controls, not credential mechanisms."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Identity and Access Management",
          "services": [
            "IAM",
            "STS",
            "Cognito"
          ],
          "docs": "https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles.html",
          "tip": "Prefer short-lived credentials rather than long-lived keys to reduce exposure.",
          "explanation": "IAM Roles combined with AWS STS issue temporary credentials that automatically expire, reducing blast radius if leaked."
        },
        {
          "id": "SCS-C03-0008",
          "question": "You want AWS Config to spot S3 buckets with public read access automatically which CloudFormation snippet defines the correct managed Config rule?",
          "choices": [
            {
              "id": "c4",
              "text": "Enable S3 Block Public Access at the account level - this replaces the need for Config rules",
              "isCorrect": false,
              "explanation": "Block Public Access is preventive - it does not detect existing violations like a Config rule does."
            },
            {
              "id": "c3",
              "text": "Use AWS CloudTrail to monitor S3:GetBucketPolicy API calls and alert when public access is detected",
              "isCorrect": false,
              "explanation": "CloudTrail monitors API calls but does not provide continuous compliance evaluation like AWS Config."
            },
            {
              "id": "c2",
              "text": "Type: AWS::Config::ConfigRule\nProperties:\n  ConfigRuleName: s3-bucket-public-read-prohibited\n  Source:\n    Owner: CUSTOM\n    SourceIdentifier: S3_BUCKET_PUBLIC_READ_PROHIBITED",
              "isCorrect": false,
              "explanation": "Owner: CUSTOM is for custom rules backed by Lambda functions, not AWS managed rules."
            },
            {
              "id": "c1",
              "text": "Type: AWS::Config::ConfigRule\nProperties:\n  ConfigRuleName: s3-bucket-public-read-prohibited\n  Source:\n    Owner: AWS\n    SourceIdentifier: S3_BUCKET_PUBLIC_READ_PROHIBITED",
              "isCorrect": true,
              "explanation": "AWS managed Config rule using Owner: AWS and the standard S3 public read detection identifier."
            }
          ],
          "selectCount": 1,
          "format": "yaml",
          "domain": "Detection",
          "services": [
            "Config",
            "CloudFormation",
            "S3"
          ],
          "docs": "https://docs.aws.amazon.com/config/latest/developerguide/WhatIsConfig.html",
          "tip": "Managed rules often have predefined identifiers and are provided by the cloud provider.",
          "explanation": "AWS Config managed rules are pre-built by AWS and referenced with Owner: AWS plus a SourceIdentifier like S3_BUCKET_PUBLIC_READ_PROHIBITED."
        },
        {
          "id": "SCS-C03-0035",
          "question": "A CISO wants a single dashboard that shows the organisation's compliance posture against the CIS AWS Foundations Benchmark and the AWS Foundational Security Best Practices standard, with automated checks running continuously. Findings from GuardDuty and Inspector should also appear in the same view. Which TWO steps are required? (Select TWO)",
          "choices": [
            {
              "id": "c1",
              "text": "Enable AWS Security Hub and activate the CIS and Foundational Security Best Practices security standards",
              "isCorrect": true,
              "explanation": "Security Hub provides the unified dashboard and runs automated compliance checks against the selected standards using AWS Config rules it deploys automatically."
            },
            {
              "id": "c5",
              "text": "Manually export GuardDuty and Inspector findings to S3 and build QuickSight dashboards",
              "isCorrect": false,
              "explanation": "This creates a custom reporting pipeline but is not necessary. GuardDuty and Inspector integrate natively with Security Hub, sending findings automatically without manual export."
            },
            {
              "id": "c2",
              "text": "Ensure AWS Config is enabled with recording turned on for all supported resource types",
              "isCorrect": true,
              "explanation": "Security Hub's compliance checks depend on AWS Config rules. If Config recording is not enabled, the automated checks cannot evaluate resource configurations and will produce no findings."
            },
            {
              "id": "c3",
              "text": "Create a custom CloudWatch dashboard aggregating Config, GuardDuty, and Inspector metrics",
              "isCorrect": false,
              "explanation": "CloudWatch dashboards show metrics and alarms, not security findings or compliance posture. Security Hub already provides the unified finding and compliance view."
            },
            {
              "id": "c4",
              "text": "Deploy AWS Firewall Manager to enforce compliance checks across all accounts",
              "isCorrect": false,
              "explanation": "Firewall Manager manages WAF, Shield, and security group policies. It does not run CIS or Best Practices compliance checks or aggregate findings from GuardDuty and Inspector."
            }
          ],
          "selectCount": 2,
          "format": "text",
          "domain": "Detection",
          "services": [
            "Security Hub",
            "Config",
            "GuardDuty",
            "Firewall Manager",
            "Inspector"
          ],
          "docs": "https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards.html",
          "tip": "An aggregation service often depends on underlying compliance recording and service integrations to surface continuous checks.",
          "explanation": "Security Hub serves as the central security findings hub. It runs compliance checks by deploying Config rules for each control in the enabled standards, so AWS Config must be recording. GuardDuty and Inspector automatically send findings to Security Hub when both are enabled, providing the unified dashboard the CISO needs."
        },
        {
          "id": "SCS-C03-0013",
          "question": "An organisation wants to automatically isolate an EC2 instance when GuardDuty detects cryptocurrency mining activity. Which architecture achieves automated remediation with the least operational overhead?",
          "choices": [
            {
              "id": "c2",
              "text": "Enable Security Hub automated response playbooks to quarantine instances",
              "isCorrect": false,
              "explanation": "Security Hub aggregates findings but does not have built-in quarantine playbooks."
            },
            {
              "id": "c1",
              "text": "Configure GuardDuty findings to flow into EventBridge and trigger a Lambda that isolates the instance",
              "isCorrect": true,
              "explanation": "EventBridge rules can filter GuardDuty finding types and invoke Lambda for automated remediation."
            },
            {
              "id": "c3",
              "text": "Schedule a Lambda to poll GuardDuty every five minutes and isolate flagged instances",
              "isCorrect": false,
              "explanation": "Polling introduces delay and extra maintenance."
            },
            {
              "id": "c4",
              "text": "Use Systems Manager Automation runbooks triggered by a CPU alarm to stop instances",
              "isCorrect": false,
              "explanation": "CPU alarms are generic and can cause false positives."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Incident Response",
          "services": [
            "GuardDuty",
            "Security Hub",
            "EventBridge",
            "Lambda",
            "Systems Manager"
          ],
          "docs": "https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_finding-types-ec2.html",
          "tip": "Prefer event-driven, near-real-time response systems that require minimal maintenance for detections.",
          "explanation": "GuardDuty publishes findings to EventBridge in near-real-time, enabling immediate Lambda-driven remediation."
        },
        {
          "id": "SCS-C03-0057",
          "question": "Which approach supports zero-downtime TLS certificate renewal for multiple subdomains?",
          "choices": [
            {
              "id": "c2",
              "text": "Use self-signed certs rotated manually via SSH",
              "isCorrect": false,
              "explanation": "Manual self-signed rotation risks downtime and trust issues."
            },
            {
              "id": "c3",
              "text": "Use a wildcard cert imported into each instance",
              "isCorrect": false,
              "explanation": "Importing certificates to instances complicates automation and rotation compared to ACM."
            },
            {
              "id": "c1",
              "text": "Use ACM certificates with DNS validation and attach to ALB listeners",
              "isCorrect": true,
              "explanation": "ACM issues public certificates that renew automatically when DNS validation is used; ALB integration ensures rotation without downtime."
            },
            {
              "id": "c4",
              "text": "Disable TLS and rely on internal network controls",
              "isCorrect": false,
              "explanation": "TLS should be used; ACM simplifies automated renewals."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Data Protection",
          "services": [
            "ACM",
            "Route 53",
            "ALB"
          ],
          "docs": "https://docs.aws.amazon.com/acm/latest/userguide/acm-certificate.html",
          "tip": "Prefer provider-issued certificates with an automated validation method for renewals.",
          "explanation": "ACM manages the lifecycle of certificates it issues and integrates with ALB/CloudFront to rotate certificates transparently."
        },
        {
          "id": "SCS-C03-0043",
          "question": "Which approach automates security posture checks across new accounts automatically?",
          "choices": [
            {
              "id": "c4",
              "text": "Rely on Control Tower alone without additional automation",
              "isCorrect": false,
              "explanation": "Control Tower helps but combining it with conformance packs and automated policies gives stronger, automated checks."
            },
            {
              "id": "c3",
              "text": "Use S3 replication to copy Templates across accounts",
              "isCorrect": false,
              "explanation": "S3 replication doesn't enforce security posture or run automated assessments."
            },
            {
              "id": "c2",
              "text": "Require each team to run a manual checklist during onboarding",
              "isCorrect": false,
              "explanation": "Manual checklists are error-prone and do not scale automatically for many accounts."
            },
            {
              "id": "c1",
              "text": "Use Organizations with SCPs and automated Config conformance packs deployed on account creation",
              "isCorrect": true,
              "explanation": "Combining Organizations lifecycle hooks with automated Config conformance packs provides automatic posture checks for new accounts."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Detection",
          "services": [
            "Organizations",
            "IAM",
            "SCPs"
          ],
          "docs": "https://docs.aws.amazon.com/organizations/latest/userguide/orgs_manage_policies_scps.html",
          "tip": "Automate posture checks during account provisioning to enforce baselines.",
          "explanation": "Provisioning-time automation that deploys Config rules/conformance packs along with SCP guardrails ensures new accounts meet baseline security posture automatically."
        }
      ],
      "perDomain": {
        "Data Protection": {
          "total": 1,
          "correct": 0,
          "score": 0
        }
      },
      "earlyComplete": true,
      "answeredCount": 1,
      "totalQuestions": 65
    },
    {
      "attemptId": "9783cf3f-f324-42e5-a73f-093965453f99",
      "userId": "9255a4e4-20f1-7010-8a80-17c43ca141e3",
      "examCode": "SCS-C03",
      "examVersion": null,
      "s3VersionId": null,
      "attemptSchemaVersion": 1,
      "startedAt": "2026-02-18T14:54:16.877Z",
      "finishedAt": "2026-02-18T14:55:28.447Z",
      "score": 100,
      "answers": [
        {
          "questionId": "SCS-C03-0028",
          "selectedChoiceId": "c1",
          "selectedChoiceIds": null,
          "selectedIndex": null,
          "selectedIndices": null,
          "correct": true,
          "timeMs": 0,
          "showTip": false,
          "createdAt": "2026-02-18T14:55:09.474Z"
        }
      ],
      "metadata": {
        "serviceKeywords": [],
        "domains": [],
        "services": []
      },
      "questions": [
        {
          "id": "SCS-C03-0028",
          "question": "A data engineering team needs their Lambda function to decrypt objects in an S3 bucket that uses SSE-KMS with a customer-managed key. The function's execution role has s3:GetObject permission. Decryption attempts fail with AccessDeniedException from KMS. Which key policy statement, added to the CMK, resolves this?",
          "choices": [
            {
              "id": "c2",
              "text": "{\"Sid\":\"AllowLambdaDecrypt\",\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"lambda.amazonaws.com\"},\"Action\":[\"kms:Decrypt\"],\"Resource\":\"*\"}",
              "isCorrect": false,
              "explanation": "KMS key policies should grant permissions to the IAM role, not to the Lambda service principal. The service principal is used in trust policies, not key policies."
            },
            {
              "id": "c4",
              "text": "Change the bucket encryption from SSE-KMS to SSE-S3 to avoid the KMS dependency",
              "isCorrect": false,
              "explanation": "Switching to SSE-S3 would eliminate the error, but it removes the ability to control access through KMS key policies, audit key usage via CloudTrail, and use customer-managed key rotation, which may be required by policy."
            },
            {
              "id": "c1",
              "text": "{\"Sid\":\"AllowLambdaDecrypt\",\"Effect\":\"Allow\",\"Principal\":{\"AWS\":\"arn:aws:iam::123456789012:role/lambda-exec-role\"},\"Action\":[\"kms:Decrypt\",\"kms:DescribeKey\"],\"Resource\":\"*\"}",
              "isCorrect": true,
              "explanation": "The Lambda execution role needs kms:Decrypt (to decrypt the data key protecting the S3 object) and kms:DescribeKey (to validate the key). The key policy must explicitly grant these actions to the role's ARN."
            },
            {
              "id": "c3",
              "text": "Add kms:Decrypt to the Lambda execution role's IAM policy without changing the key policy",
              "isCorrect": false,
              "explanation": "For customer-managed KMS keys, both the key policy AND the IAM policy must allow the action. If the key policy does not grant access to the principal, the IAM policy alone is insufficient."
            }
          ],
          "selectCount": 1,
          "format": "json",
          "domain": "Data Protection",
          "services": [
            "KMS",
            "IAM",
            "S3",
            "Lambda"
          ],
          "docs": "https://docs.aws.amazon.com/kms/latest/developerguide/key-policy-modifying.html",
          "tip": "Customer-managed keys often require permissions in both the key's policy and the caller's identity policy.",
          "explanation": "Customer-managed KMS keys use a resource-based policy (key policy) that must explicitly allow principals to perform cryptographic operations. Unlike AWS-managed keys, there is no automatic cross-grant. Both the key policy and the IAM policy on the caller must allow the action for it to succeed."
        },
        {
          "id": "SCS-C03-0011",
          "question": "Compliance requires CloudWatch Logs to use a customer-managed CMK and let the service use it what steps achieve this configuration?",
          "choices": [
            {
              "id": "c4",
              "text": "Create an AWS-managed KMS key (alias aws/logs) and it will automatically encrypt all new log groups without any key policy changes",
              "isCorrect": false,
              "explanation": "CloudWatch Logs does not have an AWS-managed key. You must create and configure a customer-managed key explicitly."
            },
            {
              "id": "c2",
              "text": "Enable SSE-S3 default encryption on the S3 bucket where CloudWatch Logs exports data and reference that bucket in each log group's settings",
              "isCorrect": false,
              "explanation": "S3 encryption applies only to exported log data in S3, not to log data stored within the CloudWatch Logs service itself."
            },
            {
              "id": "c1",
              "text": "Create a customer-managed KMS key with a key policy granting logs.<region>.amazonaws.com the kms:Encrypt, kms:Decrypt, kms:GenerateDataKey, and kms:DescribeKey actions, then associate the key with each log group",
              "isCorrect": true,
              "explanation": "CloudWatch Logs requires these four KMS actions in the key policy for the regional service principal to encrypt and decrypt log data."
            },
            {
              "id": "c3",
              "text": "Enable CloudTrail log file encryption with a KMS key and configure CloudWatch Logs as a CloudTrail destination",
              "isCorrect": false,
              "explanation": "CloudTrail encryption covers CloudTrail's own log files delivered to S3, not arbitrary CloudWatch Logs log groups."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Data Protection",
          "services": [
            "CloudWatch Logs",
            "KMS",
            "S3",
            "CloudTrail"
          ],
          "docs": "https://docs.aws.amazon.com/AmazonCloudWatch/latest/logs/encrypt-log-data-kms.html",
          "tip": "Some logging services require customer-managed keys for encryption at rest; verify key management options.",
          "explanation": "CloudWatch Logs supports encryption at rest only with customer-managed KMS keys. You must explicitly grant the regional service principal permission to use the key."
        },
        {
          "id": "SCS-C03-0012",
          "question": "Which IAM mechanism lets you enforce that ceiling while preserving self-service?",
          "choices": [
            {
              "id": "c2",
              "text": "Grant developers iam:CreateRole but restrict the role's trust policy to lambda.amazonaws.com only",
              "isCorrect": false,
              "explanation": "Restricting the trust policy limits who can assume the role, but does not limit what permissions the role itself can have."
            },
            {
              "id": "c3",
              "text": "Create a single shared Lambda execution role managed by the platform team",
              "isCorrect": false,
              "explanation": "A shared role works but violates least privilege because all functions share the same permissions regardless of their needs."
            },
            {
              "id": "c4",
              "text": "Use an SCP to deny iam:CreateRole for all developers and have the platform team create roles on request",
              "isCorrect": false,
              "explanation": "This removes developer self-service entirely, creating operational bottlenecks without enabling delegation."
            },
            {
              "id": "c1",
              "text": "Require developers to attach a permissions boundary to every role they create",
              "isCorrect": true,
              "explanation": "Permissions boundaries cap the maximum permissions a role can have, even if the role's identity policy grants broader access."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Identity and Access Management",
          "services": [
            "IAM",
            "Organizations",
            "STS"
          ],
          "docs": "https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies_boundaries.html",
          "tip": "Consider permission boundary patterns to limit maximum permissions while enabling self-service.",
          "explanation": "IAM permissions boundaries act as a ceiling on the effective permissions of a role or user."
        },
        {
          "id": "SCS-C03-0065",
          "question": "Which integration allows custom request inspection logic at the edge before forwarding to the origin?",
          "choices": [
            {
              "id": "c1",
              "text": "Use CloudFront with Lambda@Edge (or CloudFront Functions) to run custom inspection and modify requests",
              "isCorrect": true,
              "explanation": "Lambda@Edge or CloudFront Functions can execute custom logic during request/response flows at the edge to inspect or mutate requests."
            },
            {
              "id": "c2",
              "text": "Use SQS between CloudFront and origin for inspection",
              "isCorrect": false,
              "explanation": "SQS is asynchronous and not suitable for synchronous request inspection at the edge."
            },
            {
              "id": "c4",
              "text": "Rely on DNS-level filtering for application-layer inspection",
              "isCorrect": false,
              "explanation": "DNS filtering cannot inspect HTTP request content for application-layer threats."
            },
            {
              "id": "c3",
              "text": "Only use origin-side web servers to inspect requests",
              "isCorrect": false,
              "explanation": "Origin-side inspection allows attacks to reach the origin and increases bandwidth and processing costs."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Infrastructure Security",
          "services": [
            "WAF",
            "CloudFront",
            "Lambda"
          ],
          "docs": "https://docs.aws.amazon.com/waf/latest/developerguide/waf-rule-statement-type.html",
          "tip": "Use edge compute to execute lightweight request inspection close to the client before reaching the origin.",
          "explanation": "Placing lightweight inspection at the edge reduces origin load and enables early mitigation of malicious requests before they traverse the network to backend systems."
        },
        {
          "id": "SCS-C03-0029",
          "question": "An organisation with 300 member accounts needs to enable GuardDuty in every account and every region, automatically including future accounts. All findings must be viewable from the security account. Which approach achieves this with the least ongoing maintenance?",
          "choices": [
            {
              "id": "c1",
              "text": "Designate a delegated administrator account for GuardDuty through AWS Organizations and enable the auto-enable feature for new member accounts",
              "isCorrect": true,
              "explanation": "The delegated administrator model in GuardDuty with auto-enable automatically activates GuardDuty in all current and future member accounts. Findings from all accounts are aggregated in the administrator account."
            },
            {
              "id": "c4",
              "text": "Enable Security Hub in the security account and it will automatically enable GuardDuty across all member accounts",
              "isCorrect": false,
              "explanation": "Security Hub aggregates findings from GuardDuty but does not enable or manage GuardDuty. They are independent services with separate enablement processes."
            },
            {
              "id": "c2",
              "text": "Send manual invitation requests from the security account to each of the 300 member accounts and accept them individually",
              "isCorrect": false,
              "explanation": "Manual invitations work but require per-account acceptance, do not auto-enrol future accounts, and become unmanageable at scale."
            },
            {
              "id": "c3",
              "text": "Deploy GuardDuty via a CloudFormation StackSet targeting all accounts and regions",
              "isCorrect": false,
              "explanation": "StackSets can enable GuardDuty but do not establish the administrator-member relationship needed to aggregate findings centrally, and they require additional work for auto-enabling in new accounts."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Detection",
          "services": [
            "GuardDuty",
            "Organizations",
            "Security Hub",
            "S3"
          ],
          "docs": "https://docs.aws.amazon.com/guardduty/latest/ug/what-is-guardduty.html",
          "tip": "Organization-level integrations allow services to be enabled and managed centrally across member accounts.",
          "explanation": "GuardDuty's Organizations integration allows a delegated administrator to manage GuardDuty across all member accounts centrally. The auto-enable feature ensures new accounts are automatically enrolled without manual intervention, and all findings flow to the administrator account for consolidated monitoring."
        },
        {
          "id": "SCS-C03-0002",
          "question": "You're investigating suspicious activity and want to run investigative notebooks to visualise relationships which AWS service provides that investigative workspace?",
          "choices": [
            {
              "id": "c1",
              "text": "AWS Systems Manager",
              "isCorrect": false,
              "explanation": "Systems Manager helps manage instances but is not focused on security investigation notebooks."
            },
            {
              "id": "c3",
              "text": "AWS Shield",
              "isCorrect": false,
              "explanation": "AWS Shield provides DDoS protections, not forensic investigation tools."
            },
            {
              "id": "c4",
              "text": "AWS CloudTrail",
              "isCorrect": false,
              "explanation": "CloudTrail records API activity and is useful for forensics, but Detective provides investigative workflows."
            },
            {
              "id": "c2",
              "text": "Amazon Detective",
              "isCorrect": true,
              "explanation": "Amazon Detective is designed to analyze, visualize, and conduct investigations into potential security issues."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Incident Response",
          "services": [
            "Detective",
            "Systems Manager",
            "Shield",
            "CloudTrail"
          ],
          "docs": "https://docs.aws.amazon.com/detective/latest/adminguide/what-is.html",
          "tip": "Use a central findings aggregator that links related alerts and activity for investigation.",
          "explanation": "Amazon Detective automatically collects log data from VPC Flow Logs, CloudTrail, and GuardDuty, then builds a graph model that links related events so analysts can visually trace activity."
        },
        {
          "id": "SCS-C03-0020",
          "question": "After enabling GuardDuty S3 Protection, a security analyst notices a finding of type Policy:S3/BucketAnonymousAccessGranted for a production data bucket. The analyst needs to determine which principal changed the bucket policy and when. Which data source provides this information?",
          "choices": [
            {
              "id": "c1",
              "text": "CloudTrail management events showing the PutBucketPolicy API call",
              "isCorrect": true,
              "explanation": "CloudTrail records the identity (principal), timestamp, source IP, and request parameters for S3 control-plane API calls like PutBucketPolicy. This is the authoritative source for who changed the policy and when."
            },
            {
              "id": "c2",
              "text": "The GuardDuty finding detail itself, which includes the actor and timestamp",
              "isCorrect": false,
              "explanation": "GuardDuty findings identify the affected resource and the anomaly but do not always include the full details of who made the original policy change. CloudTrail provides the definitive audit trail."
            },
            {
              "id": "c3",
              "text": "S3 server access logs for the data bucket",
              "isCorrect": false,
              "explanation": "S3 server access logs capture object-level read/write requests, not bucket policy changes. Control-plane actions like PutBucketPolicy are not recorded in access logs."
            },
            {
              "id": "c4",
              "text": "VPC Flow Logs for the VPC where the analyst is working",
              "isCorrect": false,
              "explanation": "VPC Flow Logs capture network-layer metadata (IP, port, protocol) but not API-level details like which principal called PutBucketPolicy."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Detection",
          "services": [
            "GuardDuty",
            "CloudTrail",
            "S3",
            "Security Hub"
          ],
          "docs": "https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_s3-protection.html",
          "tip": "Differentiate data-plane logs from control-plane audit logs when investigating configuration or policy changes.",
          "explanation": "CloudTrail management events are the single source of truth for AWS API activity. When investigating who changed a resource configuration, always start with CloudTrail, which records the IAM principal, the API action, the request parameters, and the exact timestamp."
        },
        {
          "id": "SCS-C03-0001",
          "question": "You're the security lead for a multi-account AWS environment. Which AWS service helps aggregate and analyze security findings across accounts?",
          "choices": [
            {
              "id": "c2",
              "text": "AWS Config",
              "isCorrect": false,
              "explanation": "AWS Config tracks resource configuration and compliance, not threat detection."
            },
            {
              "id": "c4",
              "text": "Amazon SNS",
              "isCorrect": false,
              "explanation": "Amazon SNS is a notification service, not a security findings aggregator."
            },
            {
              "id": "c3",
              "text": "AWS WAF",
              "isCorrect": false,
              "explanation": "AWS WAF is a web application firewall focused on HTTP(S) protections."
            },
            {
              "id": "c1",
              "text": "Amazon GuardDuty",
              "isCorrect": true,
              "explanation": "GuardDuty is a threat detection service that continuously monitors for malicious activity and unauthorized behavior."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Detection",
          "services": [
            "GuardDuty",
            "Config",
            "WAF",
            "SNS"
          ],
          "docs": "https://docs.aws.amazon.com/guardduty/latest/ug/what-is-guardduty.html",
          "tip": "Consider a managed threat-detection service that finds anomalous activity using threat intelligence and ML.",
          "explanation": "Amazon GuardDuty uses ML models and threat intelligence feeds to continuously detect threats across accounts. The closest wrong answer is AWS Config, which evaluates resource configuration compliance, whereas GuardDuty detects active threats."
        },
        {
          "id": "SCS-C03-0036",
          "question": "A security platform team must deploy a hardened VPC, a set of IAM permission boundaries, and logging configuration to 15 existing AWS accounts. Changes must be automated via CI/CD, deployments must be auditable, and any account drift should be detectable centrally. The team also wants least-privilege for the agents that perform deployments. Which approach best satisfies these requirements?",
          "choices": [
            {
              "id": "c4",
              "text": "Utilise AWS Control Tower guardrails to keep accounts compliant and make manual adjustments via the console for exceptions",
              "isCorrect": false,
              "explanation": "Control Tower provides guardrails and a landing zone but is not a full CI/CD-driven IaC deployment and does not replace an auditable, parameterized IaC pipeline for existing accounts at scale."
            },
            {
              "id": "c1",
              "text": "Create a parameterized CloudFormation module for the baseline, publish it to a central artifact repository, and deploy via CloudFormation StackSets (service-managed) from a CI/CD pipeline using delegated administrator roles; enable drift detection and record pipeline runs for auditability",
              "isCorrect": true,
              "explanation": "StackSets (service-managed) supports automated, organization-aware deployments driven by CI/CD, delegated admin roles provide least-privilege, and enabling drift detection plus CI/CD run logs provides centralized detection and an audit trail."
            },
            {
              "id": "c2",
              "text": "Let each account run CloudFormation stacks triggered manually by account owners, and collect logs centrally afterwards",
              "isCorrect": false,
              "explanation": "Manual, per-account deployments are not automated or easily auditable and do not provide centralized drift detection or consistent configuration."
            },
            {
              "id": "c3",
              "text": "Use Terraform workspaces stored locally per account and have individual engineers apply changes when notified",
              "isCorrect": false,
              "explanation": "Local, manual Terraform applies lack centralized automation, auditability, and organization-level drift detection; they also increase risk of inconsistent state."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Security Foundations and Governance",
          "services": [
            "CloudFormation",
            "StackSets",
            "CI/CD",
            "Organizations"
          ],
          "docs": "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/what-is-cfn.html",
          "tip": "Use organization-aware IaC patterns integrated with CI/CD, delegated roles, and drift detection.",
          "explanation": "For consistent, auditable, and automated deployments across multiple accounts, an org-aware IaC pattern like CloudFormation StackSets driven by a CI/CD pipeline provides parameterized modules, centralized rollout, delegated administration for least-privilege, and drift detection to identify configuration divergence. This pattern satisfies automation, auditability, and centralized management requirements."
        },
        {
          "id": "SCS-C03-0034",
          "question": "A media company serves video content from S3 through CloudFront. They need to ensure users cannot bypass CloudFront and access S3 directly via the bucket URL. The solution must work with SSE-KMS encrypted objects. Which approach correctly restricts S3 access to CloudFront only?",
          "choices": [
            {
              "id": "c3",
              "text": "Make the S3 bucket a website endpoint origin in CloudFront and restrict access with a Referer header condition in the bucket policy",
              "isCorrect": false,
              "explanation": "Website endpoint origins use HTTP (not the S3 API), don't support SSE-KMS, and Referer headers can be spoofed, making this both incompatible and insecure."
            },
            {
              "id": "c1",
              "text": "Create a CloudFront Origin Access Control (OAC) and update the S3 bucket policy to allow access only from the OAC",
              "isCorrect": true,
              "explanation": "OAC is the recommended method for restricting S3 access to CloudFront. Unlike the legacy OAI, OAC supports SSE-KMS, S3 Object Lock, and all S3 features. The bucket policy uses aws:SourceArn to allow only the specific CloudFront distribution."
            },
            {
              "id": "c2",
              "text": "Create a CloudFront Origin Access Identity (OAI) and grant it read access in the S3 bucket policy",
              "isCorrect": false,
              "explanation": "OAI is the legacy approach and does not support SSE-KMS encrypted objects. CloudFront cannot forward the required SigV4 KMS headers when using OAI."
            },
            {
              "id": "c4",
              "text": "Block public access on the bucket and share S3 pre-signed URLs directly with users instead of using CloudFront",
              "isCorrect": false,
              "explanation": "Pre-signed URLs bypass CloudFront entirely, losing edge caching, WAF protection, and geo-restriction capabilities. They also expose direct S3 access."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Infrastructure Security",
          "services": [
            "CloudFront",
            "S3",
            "OAC",
            "WAF"
          ],
          "docs": "https://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/private-content-restricting-access-to-s3.html",
          "tip": "Modern origin access controls replace older mechanisms and are required for certain advanced object features.",
          "explanation": "Origin Access Control (OAC) uses SigV4-signed requests from CloudFront to S3, which supports all S3 encryption modes including SSE-KMS. The S3 bucket policy can use the Condition key aws:SourceArn to restrict access to a specific CloudFront distribution ARN, ensuring no direct S3 access is possible."
        },
        {
          "id": "SCS-C03-0030",
          "question": "A disaster recovery plan requires that all objects in a production S3 bucket encrypted with a customer-managed KMS key be replicated to a bucket in a different region using a different KMS key. Which TWO configurations are required for cross-region replication to work with KMS-encrypted objects? (Select TWO)",
          "choices": [
            {
              "id": "c3",
              "text": "Use the same KMS key in both the source and destination regions",
              "isCorrect": false,
              "explanation": "KMS keys are regional. A key in us-east-1 cannot be used in eu-west-1. Multi-Region KMS keys exist but are not required; specifying the destination key in the replication rule is sufficient."
            },
            {
              "id": "c5",
              "text": "Disable KMS encryption on the destination bucket and use SSE-S3 instead",
              "isCorrect": false,
              "explanation": "Switching to SSE-S3 would avoid KMS complexity but loses the benefits of customer-managed key control, audit via CloudTrail, and compliance requirements that may mandate CMK usage."
            },
            {
              "id": "c1",
              "text": "Specify the destination KMS key ARN in the replication rule configuration",
              "isCorrect": true,
              "explanation": "When replicating KMS-encrypted objects, the replication configuration must specify the destination KMS key so S3 can re-encrypt the objects in the destination region."
            },
            {
              "id": "c2",
              "text": "Grant the S3 replication role kms:Decrypt permission on the source key and kms:Encrypt permission on the destination key",
              "isCorrect": true,
              "explanation": "The replication role must decrypt the objects using the source CMK and then encrypt them with the destination CMK. Without both permissions, replication fails with AccessDenied."
            },
            {
              "id": "c4",
              "text": "Enable S3 Transfer Acceleration on both buckets to speed up cross-region replication",
              "isCorrect": false,
              "explanation": "Transfer Acceleration optimizes direct uploads via CloudFront edge locations. It is not related to S3 replication, which uses its own internal transfer mechanism."
            }
          ],
          "selectCount": 2,
          "format": "text",
          "domain": "Data Protection",
          "services": [
            "S3",
            "KMS",
            "IAM",
            "Organizations"
          ],
          "docs": "https://docs.aws.amazon.com/AmazonS3/latest/userguide/replication-walkthrough-2.html",
          "tip": "Cross-account or cross-region key replication requires careful role permissions and key configuration on both ends.",
          "explanation": "S3 replication with SSE-KMS objects requires two key configurations: the replication rule must specify the destination KMS key ARN (since KMS keys are regional), and the replication IAM role must have kms:Decrypt on the source key plus kms:Encrypt and kms:GenerateDataKey on the destination key."
        },
        {
          "id": "SCS-C03-0060",
          "question": "Which strategy reduces cost while preserving required retention for infrequently accessed file data?",
          "choices": [
            {
              "id": "c4",
              "text": "Delete older data to save cost without retention requirements",
              "isCorrect": false,
              "explanation": "Deletion may violate retention and compliance requirements."
            },
            {
              "id": "c3",
              "text": "Manually archive files to local tape every quarter",
              "isCorrect": false,
              "explanation": "Manual processes are error-prone and lack automation and auditability."
            },
            {
              "id": "c2",
              "text": "Keep all data on high-performance SSD tiers indefinitely",
              "isCorrect": false,
              "explanation": "Retaining everything on high-cost tiers is inefficient and expensive."
            },
            {
              "id": "c1",
              "text": "Use lifecycle policies to move infrequently accessed data to lower-cost storage tiers such as EFS Infrequent Access or archival destinations",
              "isCorrect": true,
              "explanation": "Lifecycle policies move data automatically to cheaper tiers while retaining access and meeting retention policies."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Data Protection",
          "services": [
            "EFS",
            "Lifecycle",
            "S3 Glacier"
          ],
          "docs": "https://docs.aws.amazon.com/efs/latest/ug/what-is-efs.html",
          "tip": "Automate lifecycle transitions to lower-cost tiers based on access patterns.",
          "explanation": "Automated lifecycle policies balance cost and retention by moving data to appropriate storage classes based on age and access frequency."
        },
        {
          "id": "SCS-C03-0022",
          "question": "An operations team wants to automate incident response when a critical CloudWatch alarm triggers: page the on-call engineer, create a timeline, and start a runbook to collect diagnostic data. They want a single AWS-native service to orchestrate all three actions. Which service should they configure?",
          "choices": [
            {
              "id": "c1",
              "text": "AWS Systems Manager Incident Manager",
              "isCorrect": true,
              "explanation": "Incident Manager automates incident creation with response plans that define escalation contacts, engagement protocols, and runbook automation, all triggered by CloudWatch alarms or EventBridge rules."
            },
            {
              "id": "c2",
              "text": "Amazon EventBridge with Lambda targets",
              "isCorrect": false,
              "explanation": "EventBridge plus Lambda can achieve similar automation but requires custom code for paging, timeline tracking, and runbook execution. It is not a single orchestration service purpose-built for incident response."
            },
            {
              "id": "c4",
              "text": "AWS CloudWatch composite alarms with auto-scaling actions",
              "isCorrect": false,
              "explanation": "Composite alarms aggregate alarm states but their actions are limited to SNS, Lambda, or Auto Scaling. They do not provide incident lifecycle management."
            },
            {
              "id": "c3",
              "text": "Amazon SNS with multiple topic subscriptions",
              "isCorrect": false,
              "explanation": "SNS delivers notifications but does not manage incident timelines, runbook execution, or structured escalation workflows."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Incident Response",
          "services": [
            "Systems Manager Incident Manager",
            "EventBridge",
            "SNS",
            "PagerDuty"
          ],
          "docs": "https://docs.aws.amazon.com/incident-manager/latest/userguide/what-is-incident-manager.html",
          "tip": "Consider incident management tools that integrate alerting, timelines, and automated runbooks.",
          "explanation": "Incident Manager provides structured response plans that automatically engage contacts (via SMS, voice, or email), create incident timelines, and execute SSM Automation runbooks when triggered. This consolidates incident orchestration into one service rather than gluing multiple services together with custom logic."
        },
        {
          "id": "SCS-C03-0006",
          "question": "Your security team needs a single place for findings and strong key management for encrypted data which TWO services should they use together? (Select TWO)",
          "choices": [
            {
              "id": "c3",
              "text": "Amazon SQS",
              "isCorrect": false,
              "explanation": "SQS is a message queuing service, not related to security findings or encryption."
            },
            {
              "id": "c1",
              "text": "AWS Security Hub",
              "isCorrect": true,
              "explanation": "Security Hub provides a comprehensive view of security alerts and compliance status across accounts."
            },
            {
              "id": "c5",
              "text": "Amazon EC2",
              "isCorrect": false,
              "explanation": "EC2 provides virtual machines, not security findings management."
            },
            {
              "id": "c4",
              "text": "AWS CloudFormation",
              "isCorrect": false,
              "explanation": "CloudFormation is an infrastructure-as-code service, not a security findings tool."
            },
            {
              "id": "c2",
              "text": "AWS KMS",
              "isCorrect": true,
              "explanation": "KMS provides centralized encryption key management for encrypting data at rest."
            }
          ],
          "selectCount": 2,
          "format": "text",
          "domain": "Detection",
          "services": [
            "Security Hub",
            "KMS",
            "SQS",
            "CloudFormation",
            "EC2"
          ],
          "docs": "https://docs.aws.amazon.com/securityhub/latest/userguide/what-is-securityhub.html",
          "tip": "Consider centralizing findings and using strong key management practices.",
          "explanation": "Security Hub aggregates and normalizes findings and KMS provides the keys to encrypt sensitive data."
        },
        {
          "id": "SCS-C03-0021",
          "question": "A company needs to inspect all egress traffic from its VPC for data exfiltration patterns using Suricata-compatible IDS/IPS rules at the network layer. Security Groups and NACLs are already in place for basic access control. Which service should they deploy?",
          "choices": [
            {
              "id": "c4",
              "text": "Configure more restrictive NACLs on the VPC subnets",
              "isCorrect": false,
              "explanation": "NACLs are stateless IP/port filters. They cannot inspect packet payloads or apply IDS/IPS signature-based rules."
            },
            {
              "id": "c2",
              "text": "AWS WAF",
              "isCorrect": false,
              "explanation": "WAF operates at Layer 7 (HTTP/HTTPS) and integrates with CloudFront, ALB, and API Gateway. It cannot inspect arbitrary TCP/UDP egress traffic or run Suricata rules."
            },
            {
              "id": "c3",
              "text": "Tighten Security Group outbound rules to restrict destination IPs",
              "isCorrect": false,
              "explanation": "Security Groups provide stateful allow/deny by IP and port but cannot perform deep packet inspection or pattern-based detection of data exfiltration."
            },
            {
              "id": "c1",
              "text": "AWS Network Firewall",
              "isCorrect": true,
              "explanation": "Network Firewall is a managed, stateful network firewall that supports Suricata-compatible rules for deep packet inspection, IDS/IPS, and domain-based filtering on both ingress and egress traffic."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Infrastructure Security",
          "services": [
            "Network Firewall",
            "WAF",
            "Security Groups",
            "NACLs"
          ],
          "docs": "https://docs.aws.amazon.com/network-firewall/latest/developerguide/what-is-aws-network-firewall.html",
          "tip": "Deep packet inspection and IDS/IPS operate at different layers than security groups or application firewalls.",
          "explanation": "AWS Network Firewall sits in-line in VPC traffic paths (via Gateway Load Balancer endpoints or firewall subnets) and evaluates packets against stateful Suricata-compatible rule groups. It fills the gap between simple Security Group/NACL controls and full deep-packet inspection requirements."
        },
        {
          "id": "SCS-C03-0046",
          "question": "Faced with application-layer bot traffic and volumetric DDoS, which combined edge strategy provides layered protection?",
          "choices": [
            {
              "id": "c3",
              "text": "Rely on client-side Captcha only",
              "isCorrect": false,
              "explanation": "Client-side controls can be bypassed and don't handle volumetric network-level attacks."
            },
            {
              "id": "c1",
              "text": "Use AWS Shield Advanced for DDoS and AWS WAF at CloudFront for application-layer filtering",
              "isCorrect": true,
              "explanation": "Shield Advanced mitigates volumetric network attacks while WAF filters application-layer patterns such as bots and OWASP threats."
            },
            {
              "id": "c2",
              "text": "Only enable security groups at the origin",
              "isCorrect": false,
              "explanation": "Security groups do not protect the global edge nor mitigate volumetric attacks effectively."
            },
            {
              "id": "c4",
              "text": "Increase EC2 instance sizes behind the load balancer",
              "isCorrect": false,
              "explanation": "Scaling instances may help capacity but does not stop DDoS or malicious application-layer requests at the edge."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Infrastructure Security",
          "services": [
            "WAF",
            "CloudFront",
            "Shield"
          ],
          "docs": "https://docs.aws.amazon.com/waf/latest/developerguide/waf-chapter.html",
          "tip": "Defence-in-depth at the edge combines network- and application-layer protections.",
          "explanation": "Defence in depth: Shield Advanced for volumetric and network-layer attacks, WAF for application-layer patterns, and CloudFront for caching and geographic distribution."
        },
        {
          "id": "SCS-C03-0032",
          "question": "A security team discovers that malware on compromised EC2 instances is using DNS queries to known command-and-control domains for data exfiltration. They need to block DNS resolution of these domains for all resources in the VPC without deploying custom DNS servers. Which service provides this capability?",
          "choices": [
            {
              "id": "c3",
              "text": "Create NACL rules to block outbound UDP port 53 to the internet",
              "isCorrect": false,
              "explanation": "Blocking port 53 outbound would break DNS resolution for all VPC resources, not just malicious queries. VPC DNS uses the Route 53 Resolver internally, so NACL rules do not affect VPC-internal DNS resolution."
            },
            {
              "id": "c1",
              "text": "Route 53 Resolver DNS Firewall with a block-list rule group associated to the VPC",
              "isCorrect": true,
              "explanation": "DNS Firewall lets you create domain lists and rule groups that block, allow, or alert on DNS queries made through the Route 53 Resolver. Associating a rule group to a VPC applies the rules to all DNS queries from that VPC."
            },
            {
              "id": "c2",
              "text": "AWS WAF with a custom rule to block DNS traffic patterns",
              "isCorrect": false,
              "explanation": "WAF operates on HTTP/HTTPS traffic at Layer 7. It cannot inspect or block DNS queries (UDP port 53) made by VPC resources to the Route 53 Resolver."
            },
            {
              "id": "c4",
              "text": "Enable GuardDuty DNS resolution monitoring to automatically block malicious domains",
              "isCorrect": false,
              "explanation": "GuardDuty detects and alerts on DNS queries to known malicious domains, but it does not block them. DNS Firewall provides the enforcement (blocking) capability."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Infrastructure Security",
          "services": [
            "Route 53",
            "Route 53 Resolver DNS Firewall",
            "VPC",
            "GuardDuty"
          ],
          "docs": "https://docs.aws.amazon.com/Route53/latest/DeveloperGuide/resolver-dns-firewall.html",
          "tip": "Consider pairing detection services with preventive controls to both find and block threats.",
          "explanation": "Route 53 Resolver DNS Firewall provides managed DNS-layer filtering within VPCs. You define domain lists (or import AWS-managed threat lists) and create rule groups with BLOCK, ALLOW, or ALERT actions. Associating the rule group to a VPC applies filtering to all Route 53 Resolver queries from that VPC."
        },
        {
          "id": "SCS-C03-0054",
          "question": "What is a key operational difference between imported key material and AWS-generated KMS keys?",
          "choices": [
            {
              "id": "c3",
              "text": "Imported keys are free of charge for cross-region usage",
              "isCorrect": false,
              "explanation": "Billing is not the defining operational difference; cross-region use still requires correct configuration."
            },
            {
              "id": "c1",
              "text": "Imported key material may have restrictions on automatic rotation and cannot be exported by AWS; customer manages lifecycle",
              "isCorrect": true,
              "explanation": "Imported key material is under customer control for import/removal and has different rotation/export characteristics than AWS-generated keys."
            },
            {
              "id": "c2",
              "text": "Imported key material automatically rotates daily",
              "isCorrect": false,
              "explanation": "Automatic daily rotation is not a feature of imported key material; rotation must be managed by the customer."
            },
            {
              "id": "c4",
              "text": "AWS may export imported key material to other customers",
              "isCorrect": false,
              "explanation": "AWS does not export customer-imported key material; it's managed per customer account/CMK."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Data Protection",
          "services": [
            "KMS",
            "CloudHSM",
            "Secrets Manager"
          ],
          "docs": "https://docs.aws.amazon.com/KMS/latest/developerguide/importing-keys.html",
          "tip": "Imported key material imposes additional lifecycle and rotation responsibilities on the customer.",
          "explanation": "Choosing imported key material affects rotation, import windows, and export constraints; plan operational processes accordingly."
        },
        {
          "id": "SCS-C03-0024",
          "question": "A security architect wants to continuously detect any S3 buckets, IAM roles, KMS keys, or Lambda functions that are shared with external AWS accounts or public access. The solution must generate findings automatically without requiring custom code. Which service should they enable?",
          "choices": [
            {
              "id": "c4",
              "text": "Amazon GuardDuty",
              "isCorrect": false,
              "explanation": "GuardDuty detects threats based on anomalous behaviour and threat intelligence. It does not analyze resource policies to find intentional cross-account sharing or public access grants."
            },
            {
              "id": "c3",
              "text": "AWS Trusted Advisor security checks",
              "isCorrect": false,
              "explanation": "Trusted Advisor checks a limited set of security best practices (e.g., open security groups, root MFA) but does not perform policy-level analysis of cross-account resource sharing."
            },
            {
              "id": "c1",
              "text": "IAM Access Analyzer",
              "isCorrect": true,
              "explanation": "Access Analyzer uses automated reasoning to analyze resource-based policies and identifies resources that are accessible from outside the zone of trust (account or organisation), generating findings for each."
            },
            {
              "id": "c2",
              "text": "AWS Config with the s3-bucket-public-read-prohibited managed rule",
              "isCorrect": false,
              "explanation": "This Config rule only checks S3 public read access. It does not cover cross-account sharing of IAM roles, KMS keys, or Lambda functions."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Identity and Access Management",
          "services": [
            "IAM Access Analyzer",
            "IAM",
            "S3",
            "Lambda",
            "KMS"
          ],
          "docs": "https://docs.aws.amazon.com/IAM/latest/UserGuide/access-analyzer-getting-started.html",
          "tip": "Some tools perform policy-based analysis using logical reasoning rather than anomaly detection.",
          "explanation": "IAM Access Analyzer applies Zelkova-based automated reasoning to evaluate resource-based policies on S3 buckets, SQS queues, IAM roles, KMS keys, Lambda functions, and Secrets Manager secrets. It produces actionable findings whenever a policy grants access outside the defined zone of trust, with no custom code required."
        },
        {
          "id": "SCS-C03-0062",
          "question": "How should a CI/CD pipeline handle high-severity image vulnerabilities discovered by Inspector to enforce security gates?",
          "choices": [
            {
              "id": "c1",
              "text": "Fail the build when high-severity vulnerabilities are found and require a remediation PR before promotion",
              "isCorrect": true,
              "explanation": "Blocking promotion of vulnerable images enforces security gates and prevents vulnerable artifacts from reaching production."
            },
            {
              "id": "c3",
              "text": "Ignore Inspector findings as false positives",
              "isCorrect": false,
              "explanation": "Blindly ignoring findings removes an important safety mechanism; investigate and triage findings appropriately."
            },
            {
              "id": "c2",
              "text": "Allow the build but schedule a follow-up ticket",
              "isCorrect": false,
              "explanation": "Allowing promotion undermines enforcement and risks running vulnerable code in production."
            },
            {
              "id": "c4",
              "text": "Convert vulnerabilities into user stories without blocking releases",
              "isCorrect": false,
              "explanation": "Converting to backlog items without blocking promotion fails to protect production environments."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Infrastructure Security",
          "services": [
            "Inspector",
            "Security Hub",
            "Lambda"
          ],
          "docs": "https://docs.aws.amazon.com/inspector/latest/userguide/inspector_introduction.html",
          "tip": "Enforce CI gates for critical vulnerabilities and require remediation before promotion.",
          "explanation": "Integrating Inspector into CI/CD and failing builds for critical findings reduces the chance of vulnerable artifacts reaching production and ensures remediation is required."
        },
        {
          "id": "SCS-C03-0047",
          "question": "Which practice grants least-privilege permissions to pods running in EKS for accessing AWS APIs?",
          "choices": [
            {
              "id": "c2",
              "text": "Attach a broad IAM role to all worker nodes",
              "isCorrect": false,
              "explanation": "Node roles provide host-level permissions and risk privilege escalation from any pod to node-level permissions."
            },
            {
              "id": "c3",
              "text": "Use instance metadata to share credentials across pods",
              "isCorrect": false,
              "explanation": "Instance metadata exposes node credentials and is not recommended for per-pod least-privilege."
            },
            {
              "id": "c1",
              "text": "Use IRSA (IAM Roles for Service Accounts) to map service accounts to IAM roles with narrow permissions",
              "isCorrect": true,
              "explanation": "IRSA ties an IAM role to a Kubernetes service account, allowing fine-grained, pod-level permissions."
            },
            {
              "id": "c4",
              "text": "Store AWS keys in pod environment variables at build time",
              "isCorrect": false,
              "explanation": "Hard-coding keys in images is insecure and prevents rotation."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Identity and Access Management",
          "services": [
            "EKS",
            "IAM",
            "STS"
          ],
          "docs": "https://docs.aws.amazon.com/eks/latest/userguide/iam-roles-for-service-accounts.html",
          "tip": "Use workload-scoped identity mechanisms to grant narrow, auditable pod permissions.",
          "explanation": "IRSA provides workload identity that limits permissions to the specific service account and namespace, reducing blast radius and improving auditability."
        },
        {
          "id": "SCS-C03-0031",
          "question": "During an incident investigation, an analyst has shell access to a compromised EC2 instance and needs to determine which IAM identity the instance is currently using to make AWS API calls. Which CLI command reveals this information?",
          "choices": [
            {
              "id": "c2",
              "text": "aws iam get-user",
              "isCorrect": false,
              "explanation": "get-user returns information about an IAM user. On an instance using a role (not a user), this command fails because the caller is not an IAM user."
            },
            {
              "id": "c3",
              "text": "aws ec2 describe-instances --instance-id $(curl -s http://169.254.169.254/latest/meta-data/instance-id)",
              "isCorrect": false,
              "explanation": "describe-instances shows instance metadata including the IamInstanceProfile association, but the response contains the profile ARN, not the currently assumed role ARN with session details. get-caller-identity is more direct."
            },
            {
              "id": "c1",
              "text": "aws sts get-caller-identity",
              "isCorrect": true,
              "explanation": "This command returns the UserId, Account, and ARN of the IAM identity (user, role, or federated identity) making the request. On an EC2 instance, it reveals the instance profile role."
            },
            {
              "id": "c4",
              "text": "curl http://169.254.169.254/latest/meta-data/iam/security-credentials/",
              "isCorrect": false,
              "explanation": "This metadata endpoint lists the instance profile role name and can retrieve temporary credentials, but it does not show the full ARN or account ID. It also does not detect if the instance is using a different assumed role via manual STS calls."
            }
          ],
          "selectCount": 1,
          "format": "cli",
          "domain": "Incident Response",
          "services": [
            "STS",
            "IAM",
            "CloudShell"
          ],
          "docs": "https://docs.aws.amazon.com/cli/latest/reference/sts/get-caller-identity.html",
          "tip": "Use standard identity calls to reveal the effective caller identity across contexts.",
          "explanation": "aws sts get-caller-identity is the quickest and most reliable way to determine the current AWS identity context. It works for all principal types and returns the ARN that appears in CloudTrail logs, making it invaluable during investigations."
        },
        {
          "id": "SCS-C03-0037",
          "question": "For a critical service running in an Auto Scaling group behind an ALB, which monitoring approach provides aggregated health metrics and automated alerting for service-level availability?",
          "choices": [
            {
              "id": "c4",
              "text": "Attach detailed instance metrics to each EC2 instance and rely on manual inspection",
              "isCorrect": false,
              "explanation": "Instance-level metrics are useful but relying on manual inspection does not provide automated alerting or aggregated service-level visibility across an Auto Scaling group."
            },
            {
              "id": "c3",
              "text": "Use S3 access logs aggregated into Athena queries to detect failures",
              "isCorrect": false,
              "explanation": "S3 access logs are eventual and not designed for real-time service availability monitoring."
            },
            {
              "id": "c1",
              "text": "Create CloudWatch alarms on aggregated ALB and Auto Scaling metrics and notify via SNS to trigger automated remediation",
              "isCorrect": true,
              "explanation": "CloudWatch aggregates service metrics (ALB and ASG), allows alarm thresholds, and integrates with SNS and automated remediation actions such as scaling or Lambda-driven fixes."
            },
            {
              "id": "c2",
              "text": "Rely on CloudTrail event history to monitor service health and send alerts",
              "isCorrect": false,
              "explanation": "CloudTrail records API activity and is not suitable as a primary source of service health metrics or near-real-time availability alarms."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Detection",
          "services": [
            "CloudWatch",
            "Auto Scaling",
            "Elastic Load Balancing",
            "SNS"
          ],
          "docs": "https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/WhatIsCloudWatch.html",
          "tip": "Aggregate load balancer and auto-scaling metrics into alarms and connect them to alerting or automation for remediation.",
          "explanation": "CloudWatch is the natural aggregation point for service metrics; combining ALB and Auto Scaling metrics with alarms and SNS-driven automation provides both service-level visibility and automatic remediation triggers."
        },
        {
          "id": "SCS-C03-0045",
          "question": "Given an IAM role ARN, which CLI command quickly reveals the caller identity to correlate with CloudTrail events?",
          "choices": [
            {
              "id": "c3",
              "text": "aws cloudtrail lookup-events",
              "isCorrect": false,
              "explanation": "Lookup-events finds historical events but does not directly reveal the current caller context."
            },
            {
              "id": "c2",
              "text": "aws iam list-roles",
              "isCorrect": false,
              "explanation": "List-roles enumerates roles but doesn't show the runtime caller identity."
            },
            {
              "id": "c1",
              "text": "aws sts get-caller-identity",
              "isCorrect": true,
              "explanation": "This STS call returns the effective principal; useful for correlating with CloudTrail event ARNs."
            },
            {
              "id": "c4",
              "text": "aws sts decode-authorization-message",
              "isCorrect": false,
              "explanation": "Decoding auth message requires a message from AWS and is not the general approach for caller identity."
            }
          ],
          "selectCount": 1,
          "format": "cli",
          "domain": "Incident Response",
          "services": [
            "IAM",
            "STS"
          ],
          "docs": "https://docs.aws.amazon.com/iam/latest/UserGuide/id_roles.html",
          "tip": "Use identity-revealing calls to confirm which principal is making API requests.",
          "explanation": "`get-caller-identity` is the simplest way to determine which principal is currently making API calls; pair it with CloudTrail to find related events."
        },
        {
          "id": "SCS-C03-0013",
          "question": "An organisation wants to automatically isolate an EC2 instance when GuardDuty detects cryptocurrency mining activity. Which architecture achieves automated remediation with the least operational overhead?",
          "choices": [
            {
              "id": "c3",
              "text": "Schedule a Lambda to poll GuardDuty every five minutes and isolate flagged instances",
              "isCorrect": false,
              "explanation": "Polling introduces delay and extra maintenance."
            },
            {
              "id": "c2",
              "text": "Enable Security Hub automated response playbooks to quarantine instances",
              "isCorrect": false,
              "explanation": "Security Hub aggregates findings but does not have built-in quarantine playbooks."
            },
            {
              "id": "c1",
              "text": "Configure GuardDuty findings to flow into EventBridge and trigger a Lambda that isolates the instance",
              "isCorrect": true,
              "explanation": "EventBridge rules can filter GuardDuty finding types and invoke Lambda for automated remediation."
            },
            {
              "id": "c4",
              "text": "Use Systems Manager Automation runbooks triggered by a CPU alarm to stop instances",
              "isCorrect": false,
              "explanation": "CPU alarms are generic and can cause false positives."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Incident Response",
          "services": [
            "GuardDuty",
            "Security Hub",
            "EventBridge",
            "Lambda",
            "Systems Manager"
          ],
          "docs": "https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_finding-types-ec2.html",
          "tip": "Prefer event-driven, near-real-time response systems that require minimal maintenance for detections.",
          "explanation": "GuardDuty publishes findings to EventBridge in near-real-time, enabling immediate Lambda-driven remediation."
        },
        {
          "id": "SCS-C03-0057",
          "question": "Which approach supports zero-downtime TLS certificate renewal for multiple subdomains?",
          "choices": [
            {
              "id": "c2",
              "text": "Use self-signed certs rotated manually via SSH",
              "isCorrect": false,
              "explanation": "Manual self-signed rotation risks downtime and trust issues."
            },
            {
              "id": "c3",
              "text": "Use a wildcard cert imported into each instance",
              "isCorrect": false,
              "explanation": "Importing certificates to instances complicates automation and rotation compared to ACM."
            },
            {
              "id": "c1",
              "text": "Use ACM certificates with DNS validation and attach to ALB listeners",
              "isCorrect": true,
              "explanation": "ACM issues public certificates that renew automatically when DNS validation is used; ALB integration ensures rotation without downtime."
            },
            {
              "id": "c4",
              "text": "Disable TLS and rely on internal network controls",
              "isCorrect": false,
              "explanation": "TLS should be used; ACM simplifies automated renewals."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Data Protection",
          "services": [
            "ACM",
            "Route 53",
            "ALB"
          ],
          "docs": "https://docs.aws.amazon.com/acm/latest/userguide/acm-certificate.html",
          "tip": "Prefer provider-issued certificates with an automated validation method for renewals.",
          "explanation": "ACM manages the lifecycle of certificates it issues and integrates with ALB/CloudFront to rotate certificates transparently."
        },
        {
          "id": "SCS-C03-0023",
          "question": "A web application team needs to ensure that TLS certificates on their internet-facing ALBs are renewed automatically without any manual intervention or downtime. Certificates must support multiple subdomain names (e.g., api.example.com, app.example.com). Which approach meets these requirements?",
          "choices": [
            {
              "id": "c4",
              "text": "Generate a self-signed certificate for each subdomain and configure the ALB to present them using SNI",
              "isCorrect": false,
              "explanation": "Self-signed certificates are not trusted by browsers and will produce security warnings. They also require manual rotation, defeating the automation requirement."
            },
            {
              "id": "c1",
              "text": "Request a public ACM certificate with Subject Alternative Names (SANs) for each subdomain using DNS validation, and associate it with the ALB",
              "isCorrect": true,
              "explanation": "ACM public certificates with DNS validation renew automatically as long as the CNAME validation records remain in place. SANs allow multiple subdomains on a single certificate, and ALB natively integrates with ACM for zero-downtime deployment."
            },
            {
              "id": "c2",
              "text": "Purchase a wildcard certificate from a third-party CA, import it into ACM, and set a calendar reminder to renew it annually",
              "isCorrect": false,
              "explanation": "Imported certificates in ACM are not automatically renewed. Manual renewal and re-import is required, which introduces risk of expiration and human error."
            },
            {
              "id": "c3",
              "text": "Use Let's Encrypt with certbot running on the ALB instances to obtain and renew certificates",
              "isCorrect": false,
              "explanation": "ALBs are managed services; you cannot run certbot or any agent on them. Let's Encrypt certificates must be imported into ACM, losing automatic renewal."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Data Protection",
          "services": [
            "ACM",
            "CloudFront",
            "ALB",
            "Route 53"
          ],
          "docs": "https://docs.aws.amazon.com/acm/latest/userguide/acm-overview.html",
          "tip": "Automatic certificate renewal typically requires that the provider issued the certificate and an automated validation method is available.",
          "explanation": "AWS Certificate Manager issues free public certificates that renew automatically when DNS validation is used. By adding SANs for each subdomain, a single certificate covers multiple endpoints. ACM's native integration with ALB means certificate deployment and rotation happen transparently."
        },
        {
          "id": "SCS-C03-0048",
          "question": "Which integration helps ensure container images are scanned for known vulnerabilities before deployment?",
          "choices": [
            {
              "id": "c3",
              "text": "Scan images manually once per quarter",
              "isCorrect": false,
              "explanation": "Infrequent manual scans miss new vulnerabilities discovered between scans."
            },
            {
              "id": "c2",
              "text": "Rely only on runtime detection like GuardDuty",
              "isCorrect": false,
              "explanation": "Runtime detection is useful but does not prevent vulnerable images from being deployed in the first place."
            },
            {
              "id": "c4",
              "text": "Use S3 object versioning to store old images",
              "isCorrect": false,
              "explanation": "S3 versioning stores objects but does not scan or prevent vulnerable images from running."
            },
            {
              "id": "c1",
              "text": "Enable Inspector image scanning for ECR and fail CI on high-severity findings",
              "isCorrect": true,
              "explanation": "Inspector integrates with ECR to scan images and can be used as a gate in CI to prevent deploying vulnerable images."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Infrastructure Security",
          "services": [
            "Inspector",
            "ECR",
            "Lambda"
          ],
          "docs": "https://docs.aws.amazon.com/inspector/latest/userguide/what-is-inspector.html",
          "tip": "Integrate vulnerability scanning into CI/CD and prevent promotion of artifacts with critical findings.",
          "explanation": "Shifting vulnerability scans left (during build) reduces risk; Inspector/ECR scanning plus CI gates prevents deploying images with known critical vulnerabilities."
        },
        {
          "id": "SCS-C03-0042",
          "question": "Which architecture most cost-effectively stores months of high-volume logs for ad-hoc forensic queries?",
          "choices": [
            {
              "id": "c4",
              "text": "Keep logs only on instance disk for speed",
              "isCorrect": false,
              "explanation": "Instance disks are ephemeral and unsuitable for long-term forensic retention."
            },
            {
              "id": "c3",
              "text": "Store logs in DynamoDB single-table design",
              "isCorrect": false,
              "explanation": "DynamoDB is not cost-effective for large historical log volumes and analytics queries."
            },
            {
              "id": "c1",
              "text": "Deliver logs to S3 in partitioned Parquet and query with Athena",
              "isCorrect": true,
              "explanation": "S3 + Parquet + Athena supports low-cost storage and ad-hoc querying without always-on infrastructure."
            },
            {
              "id": "c2",
              "text": "Stream logs to OpenSearch with 90-day hot storage",
              "isCorrect": false,
              "explanation": "OpenSearch is efficient for real-time searches but expensive for long-term retention at scale."
            }
          ],
          "selectCount": 1,
          "format": "yaml",
          "domain": "Detection",
          "services": [
            "CloudWatch Logs",
            "Athena",
            "S3"
          ],
          "docs": "https://docs.aws.amazon.com/AmazonCloudWatch/latest/logs/WhatIsCloudWatchLogs.html",
          "tip": "Partition logs and use columnar formats to reduce query costs.",
          "explanation": "Exporting log data to S3 in Parquet with partitioning reduces query scan costs and enables scalable ad-hoc analysis via Athena or Lakehouse tools."
        },
        {
          "id": "SCS-C03-0033",
          "question": "An incident responder has identified a compromised IAM role and needs to immediately invalidate all existing sessions for that role while preserving the role itself for forensic analysis. Which approach revokes all active sessions without deleting the role?",
          "choices": [
            {
              "id": "c2",
              "text": "Delete all inline and managed policies from the role to remove its permissions",
              "isCorrect": false,
              "explanation": "Removing policies prevents new actions but also destroys the evidence of what permissions the role had, which is critical for forensic analysis."
            },
            {
              "id": "c1",
              "text": "Add an inline deny-all policy to the role with a condition that aws:TokenIssueTime is before the current timestamp:\n{\"Effect\":\"Deny\",\"Action\":\"*\",\"Resource\":\"*\",\"Condition\":{\"DateLessThan\":{\"aws:TokenIssueTime\":\"2026-02-16T12:00:00Z\"}}}",
              "isCorrect": true,
              "explanation": "This technique (Revoke Session) denies all actions for temporary credentials issued before the specified time. New sessions assumed after that time are unaffected, and the role remains intact for investigation."
            },
            {
              "id": "c4",
              "text": "Contact AWS Support to force-expire the role's temporary credentials",
              "isCorrect": false,
              "explanation": "AWS Support cannot force-expire individual STS tokens. Session revocation must be done through IAM policy mechanisms by the account administrator."
            },
            {
              "id": "c3",
              "text": "Change the role's trust policy to deny all principals",
              "isCorrect": false,
              "explanation": "Modifying the trust policy prevents new role assumptions but does not invalidate existing active sessions. Temporary credentials already issued remain valid until they expire."
            }
          ],
          "selectCount": 1,
          "format": "json",
          "domain": "Incident Response",
          "services": [
            "STS",
            "IAM",
            "CloudTrail"
          ],
          "docs": "https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_temp_request.html",
          "tip": "Session revocation often uses time-based deny conditions to invalidate earlier issued tokens.",
          "explanation": "STS temporary credentials cannot be individually revoked, but you can render them useless by attaching a deny-all policy with a DateLessThan condition on aws:TokenIssueTime. This is the recommended emergency response for compromised roles because it immediately neutralizes existing sessions while keeping the role and its policies intact for forensic review."
        },
        {
          "id": "SCS-C03-0004",
          "question": "You're designing a system that avoids long-lived keys. Which AWS feature helps enforce least privilege by issuing temporary credentials?",
          "choices": [
            {
              "id": "c2",
              "text": "IAM Users with long-term access keys",
              "isCorrect": false,
              "explanation": "IAM Users with long-term keys are not recommended for least-privilege patterns."
            },
            {
              "id": "c1",
              "text": "IAM Roles with STS",
              "isCorrect": true,
              "explanation": "IAM Roles with STS allow issuance of temporary credentials for short-term access."
            },
            {
              "id": "c3",
              "text": "Security Groups",
              "isCorrect": false,
              "explanation": "Security Groups are network controls, not credential mechanisms."
            },
            {
              "id": "c4",
              "text": "Amazon Cognito",
              "isCorrect": false,
              "explanation": "Amazon Cognito provides user identity for apps, but the core mechanism for temporary AWS credentials is STS with roles."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Identity and Access Management",
          "services": [
            "IAM",
            "STS",
            "Cognito"
          ],
          "docs": "https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles.html",
          "tip": "Prefer short-lived credentials rather than long-lived keys to reduce exposure.",
          "explanation": "IAM Roles combined with AWS STS issue temporary credentials that automatically expire, reducing blast radius if leaked."
        },
        {
          "id": "SCS-C03-0015",
          "question": "A security team needs to provide shell access to EC2 instances in private subnets without opening SSH ports or managing bastion hosts, while maintaining a full audit trail of every command executed. Which solution meets these requirements?",
          "choices": [
            {
              "id": "c1",
              "text": "Systems Manager Session Manager",
              "isCorrect": true,
              "explanation": "Session Manager establishes encrypted sessions through the SSM agent without opening inbound ports and can log sessions to S3 or CloudWatch Logs."
            },
            {
              "id": "c3",
              "text": "EC2 Instance Connect",
              "isCorrect": false,
              "explanation": "Instance Connect still requires port 22 and does not natively log full session content."
            },
            {
              "id": "c2",
              "text": "Deploy a bastion host with SSH key-based authentication",
              "isCorrect": false,
              "explanation": "Bastion hosts require open SSH ports and add operational burden."
            },
            {
              "id": "c4",
              "text": "VPN to the private subnet and SSH",
              "isCorrect": false,
              "explanation": "VPN plus SSH captures metadata but not command-level audit content."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Infrastructure Security",
          "services": [
            "Systems Manager",
            "EC2",
            "IAM",
            "CloudTrail"
          ],
          "docs": "https://docs.aws.amazon.com/systems-manager/latest/userguide/session-manager.html",
          "tip": "Consider agent-based session access that avoids exposing SSH/RDP ports.",
          "explanation": "Session Manager uses the SSM agent to create encrypted, IAM-authenticated sessions without inbound security group rules and logs session output for auditing."
        },
        {
          "id": "SCS-C03-0019",
          "question": "A financial services firm must store audit logs for seven years in a manner that no user, including root, can delete or modify them before the retention period expires. Regulators require proof of immutability. Which S3 feature satisfies these requirements?",
          "choices": [
            {
              "id": "c1",
              "text": "S3 Object Lock in Compliance mode with a seven-year retention period",
              "isCorrect": true,
              "explanation": "Compliance mode prevents anyone, including the root user, from deleting or overwriting an object version until the retention date passes. This satisfies regulatory immutability requirements."
            },
            {
              "id": "c4",
              "text": "Enable MFA Delete on the S3 bucket to require MFA for all delete operations",
              "isCorrect": false,
              "explanation": "MFA Delete requires an additional authentication step but does not make objects truly immutable. A user with MFA can still delete them at any time."
            },
            {
              "id": "c3",
              "text": "S3 Versioning with an S3 Lifecycle rule to transition objects to Glacier after 30 days",
              "isCorrect": false,
              "explanation": "Versioning preserves prior versions but does not prevent deletion of version markers. Glacier transition reduces cost but does not enforce immutability."
            },
            {
              "id": "c2",
              "text": "S3 Object Lock in Governance mode with a seven-year retention period",
              "isCorrect": false,
              "explanation": "Governance mode allows users with the s3:BypassGovernanceRetention permission to delete objects before the retention period ends, which does not meet the absolute immutability requirement."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Data Protection",
          "services": [
            "S3",
            "S3 Object Lock",
            "Glacier",
            "Backup"
          ],
          "docs": "https://docs.aws.amazon.com/AmazonS3/latest/userguide/object-lock.html",
          "tip": "Some retention features prevent even highly privileged users from removing locks; verify retention enforcement models.",
          "explanation": "S3 Object Lock Compliance mode creates a WORM (Write Once Read Many) storage model. Once set, neither the object nor its retention settings can be altered or deleted by any principal until the retention period expires, meeting SEC 17a-4(f) and similar regulatory requirements."
        },
        {
          "id": "SCS-C03-0026",
          "question": "A company with 50 AWS accounts wants to enforce a baseline set of preventive and detective security controls (e.g., disallow public S3 buckets, require CloudTrail in all regions) across all accounts. They need a managed landing zone that automatically applies these controls to new accounts as they are created. Which service provides this capability?",
          "choices": [
            {
              "id": "c3",
              "text": "AWS Security Hub with the AWS Foundational Security Best Practices standard",
              "isCorrect": false,
              "explanation": "Security Hub detects deviations from best practices (detective) but does not prevent them (preventive). It also does not provision or manage accounts or landing zones."
            },
            {
              "id": "c1",
              "text": "AWS Control Tower with mandatory and elective guardrails",
              "isCorrect": true,
              "explanation": "Control Tower provides a managed landing zone with pre-configured guardrails (implemented as SCPs for preventive controls and Config rules for detective controls) that are automatically applied to accounts enrolled in the landing zone."
            },
            {
              "id": "c2",
              "text": "AWS Organizations with manually written SCPs and Config rules deployed via StackSets",
              "isCorrect": false,
              "explanation": "This approach works but requires manual authoring, testing, and deployment of each control. Control Tower automates this with curated, pre-tested guardrails and handles new-account enrollment automatically."
            },
            {
              "id": "c4",
              "text": "AWS Trusted Advisor organisational view",
              "isCorrect": false,
              "explanation": "Trusted Advisor provides recommendations and checks but does not enforce controls or manage account provisioning or landing zones."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Identity and Access Management",
          "services": [
            "Control Tower",
            "Organizations",
            "Config",
            "CloudFormation"
          ],
          "docs": "https://docs.aws.amazon.com/controltower/latest/userguide/guardrails.html",
          "tip": "Managed landing zone patterns enforce guardrails automatically during account provisioning.",
          "explanation": "Control Tower orchestrates Organizations, Config, CloudFormation, and IAM Identity Center to create a governed multi-account environment. Its guardrails are curated controls that are automatically enforced (preventive via SCPs) or monitored (detective via Config rules) across all enrolled accounts, including newly created ones."
        },
        {
          "id": "SCS-C03-0038",
          "question": "Which AWS service automates building, testing, and distributing hardened AMIs with a repeatable pipeline?",
          "choices": [
            {
              "id": "c3",
              "text": "Amazon Inspector",
              "isCorrect": false,
              "explanation": "Inspector performs vulnerability assessments but does not build or distribute hardened AMIs."
            },
            {
              "id": "c4",
              "text": "AWS CloudFormation",
              "isCorrect": false,
              "explanation": "CloudFormation deploys infrastructure as code but does not provide an image build-and-test pipeline by itself."
            },
            {
              "id": "c2",
              "text": "AWS Glue",
              "isCorrect": false,
              "explanation": "Glue is an ETL/data integration service, not an image-building pipeline."
            },
            {
              "id": "c1",
              "text": "EC2 Image Builder",
              "isCorrect": true,
              "explanation": "EC2 Image Builder automates the creation, patching, testing, and distribution of server images according to repeatable pipelines and policies."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Infrastructure Security",
          "services": [
            "EC2 Image Builder",
            "EC2",
            "Systems Manager"
          ],
          "docs": "https://docs.aws.amazon.com/imagebuilder/latest/userguide/what-is-image-builder.html",
          "tip": "Use automated image pipelines that include patching and configuration validation before distribution.",
          "explanation": "EC2 Image Builder provides a repeatable, auditable pipeline to produce hardened AMIs, including testing steps and integration with Systems Manager for patching and compliance verification."
        },
        {
          "id": "SCS-C03-0017",
          "question": "A network security team must capture all accepted and rejected traffic metadata for forensic analysis across 200 VPCs in a multi-account organisation. They need to query weeks of historical data on demand without maintaining always-on infrastructure. Which architecture meets these requirements most cost-effectively?",
          "choices": [
            {
              "id": "c3",
              "text": "Stream Flow Logs to an Amazon OpenSearch cluster for real-time dashboards and historical search",
              "isCorrect": false,
              "explanation": "OpenSearch provides powerful search but requires always-on cluster infrastructure, violating the no-maintained-infrastructure requirement and increasing cost."
            },
            {
              "id": "c2",
              "text": "Send VPC Flow Logs to CloudWatch Logs in each account and use CloudWatch Logs Insights for queries",
              "isCorrect": false,
              "explanation": "CloudWatch Logs Insights works well for recent data but becomes expensive at high volume over weeks, and cross-account querying adds operational complexity compared to a centralised S3 approach."
            },
            {
              "id": "c1",
              "text": "Publish VPC Flow Logs to a centralised S3 bucket in the security account and query with Amazon Athena",
              "isCorrect": true,
              "explanation": "S3 storage is inexpensive at scale, and Athena provides serverless on-demand querying with no infrastructure to manage. Flow Logs support direct S3 delivery across accounts via resource policies."
            },
            {
              "id": "c4",
              "text": "Enable Traffic Mirroring on all ENIs and capture full packets for analysis",
              "isCorrect": false,
              "explanation": "Traffic Mirroring captures full packet payloads, which is vastly more data than flow log metadata, increasing costs dramatically and exceeding what the team requested."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Detection",
          "services": [
            "VPC Flow Logs",
            "CloudWatch Logs",
            "S3",
            "Athena"
          ],
          "docs": "https://docs.aws.amazon.com/vpc/latest/userguide/flow-logs.html",
          "tip": "For large volumes of historical logs, use object storage plus an on-demand query engine for cost-effective analysis.",
          "explanation": "VPC Flow Logs can deliver directly to S3 in Parquet format with Hive-compatible partitioning, and Athena charges only per query scanned. This combination handles cross-account aggregation at scale without provisioning or maintaining any infrastructure."
        },
        {
          "id": "SCS-C03-0059",
          "question": "For workforce single sign-on with centralized permission sets, which service provides identity federation and permission management?",
          "choices": [
            {
              "id": "c2",
              "text": "Create IAM Users for each employee",
              "isCorrect": false,
              "explanation": "IAM Users are not ideal for large-scale workforce SSO and federation scenarios."
            },
            {
              "id": "c1",
              "text": "IAM Identity Center (AWS SSO)",
              "isCorrect": true,
              "explanation": "IAM Identity Center provides SSO and centralized permission set management for workforce identities."
            },
            {
              "id": "c3",
              "text": "Use local OS accounts on bastion hosts",
              "isCorrect": false,
              "explanation": "Local accounts are not centralized or scalable for enterprise SSO needs."
            },
            {
              "id": "c4",
              "text": "Use API keys stored in S3 for employees",
              "isCorrect": false,
              "explanation": "API keys are for programmatic access and not suitable for workforce SSO."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Identity and Access Management",
          "services": [
            "IAM",
            "IAM Identity Center"
          ],
          "docs": "https://docs.aws.amazon.com/iam/latest/UserGuide/id_users_create.html",
          "tip": "Use a centralized identity solution with permission sets for workforce SSO.",
          "explanation": "IAM Identity Center integrates with external IdPs and maps users to AWS permission sets, simplifying enterprise SSO and access management."
        },
        {
          "id": "SCS-C03-0005",
          "question": "You've been asked to centralise key management for data-at-rest across services. Which AWS service provides managed encryption keys for this purpose?",
          "choices": [
            {
              "id": "c1",
              "text": "AWS KMS",
              "isCorrect": true,
              "explanation": "AWS KMS is the managed service for creating and controlling encryption keys."
            },
            {
              "id": "c4",
              "text": "AWS WAF",
              "isCorrect": false,
              "explanation": "AWS WAF is a web application firewall, not key management."
            },
            {
              "id": "c2",
              "text": "AWS IAM",
              "isCorrect": false,
              "explanation": "AWS IAM handles identity and permissions, not key storage or encryption primitives."
            },
            {
              "id": "c3",
              "text": "AWS Shield",
              "isCorrect": false,
              "explanation": "AWS Shield protects against DDoS attacks, not key management."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Data Protection",
          "services": [
            "KMS",
            "IAM",
            "Shield",
            "WAF"
          ],
          "docs": "https://docs.aws.amazon.com/kms/latest/developerguide/overview.html",
          "tip": "Use a key management service that supports envelope encryption and key lifecycle controls.",
          "explanation": "AWS KMS provides centralized creation, rotation, and access control of encryption keys used to protect data at rest across services like S3, EBS, and RDS."
        },
        {
          "id": "SCS-C03-0043",
          "question": "Which approach automates security posture checks across new accounts automatically?",
          "choices": [
            {
              "id": "c2",
              "text": "Require each team to run a manual checklist during onboarding",
              "isCorrect": false,
              "explanation": "Manual checklists are error-prone and do not scale automatically for many accounts."
            },
            {
              "id": "c1",
              "text": "Use Organizations with SCPs and automated Config conformance packs deployed on account creation",
              "isCorrect": true,
              "explanation": "Combining Organizations lifecycle hooks with automated Config conformance packs provides automatic posture checks for new accounts."
            },
            {
              "id": "c4",
              "text": "Rely on Control Tower alone without additional automation",
              "isCorrect": false,
              "explanation": "Control Tower helps but combining it with conformance packs and automated policies gives stronger, automated checks."
            },
            {
              "id": "c3",
              "text": "Use S3 replication to copy Templates across accounts",
              "isCorrect": false,
              "explanation": "S3 replication doesn't enforce security posture or run automated assessments."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Detection",
          "services": [
            "Organizations",
            "IAM",
            "SCPs"
          ],
          "docs": "https://docs.aws.amazon.com/organizations/latest/userguide/orgs_manage_policies_scps.html",
          "tip": "Automate posture checks during account provisioning to enforce baselines.",
          "explanation": "Provisioning-time automation that deploys Config rules/conformance packs along with SCP guardrails ensures new accounts meet baseline security posture automatically."
        },
        {
          "id": "SCS-C03-0041",
          "question": "When sizing monitoring for a high-throughput API, which combination of metrics should inform your alarm thresholds for availability and performance?",
          "choices": [
            {
              "id": "c1",
              "text": "Request count, 5xx error rate, and latency percentiles",
              "isCorrect": true,
              "explanation": "Combining request volume, error rates and latency percentiles gives a balanced view of availability and performance under load."
            },
            {
              "id": "c2",
              "text": "Only CPU utilization across EC2 instances",
              "isCorrect": false,
              "explanation": "CPU is useful but insufficient alone to detect request-level failures or latency spikes."
            },
            {
              "id": "c3",
              "text": "Number of open TCP connections to the VPC",
              "isCorrect": false,
              "explanation": "TCP connection counts may be noisy and do not directly indicate application-level errors or latency."
            },
            {
              "id": "c4",
              "text": "S3 bucket size growth",
              "isCorrect": false,
              "explanation": "S3 growth is unrelated to API availability metrics for request handling."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Detection",
          "services": [
            "CloudWatch",
            "CloudWatch Logs",
            "SNS"
          ],
          "docs": "https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/monitoring-overview.html",
          "tip": "Combine throughput, error rates, and latency percentiles to set robust thresholds.",
          "explanation": "A monitoring strategy should include throughput (request count), error rates (5xx), and latency percentiles (p95/p99) to detect degradation under load and trigger appropriate alerts."
        },
        {
          "id": "SCS-C03-0064",
          "question": "After a GuardDuty finding indicates suspicious API calls from a role, which steps validate scope and impact?",
          "choices": [
            {
              "id": "c1",
              "text": "Retrieve CloudTrail management events for the role, query related CloudWatch Logs, and inspect resource changes",
              "isCorrect": true,
              "explanation": "Correlate GuardDuty findings with CloudTrail events and application logs to scope the impact and timeline."
            },
            {
              "id": "c2",
              "text": "Temporarily revoke the role's active sessions pending investigation",
              "isCorrect": false,
              "explanation": "Revoking sessions can limit ongoing activity but is disruptive; triage and validation are usually performed first to scope impact before broad actions."
            },
            {
              "id": "c4",
              "text": "Assume GuardDuty is faulty and open a support ticket",
              "isCorrect": false,
              "explanation": "While false positives can occur, perform validation steps before concluding GuardDuty is wrong."
            },
            {
              "id": "c3",
              "text": "Ignore the finding if there are no console alerts",
              "isCorrect": false,
              "explanation": "Findings should be validated; absence of console alerts doesn't mean no impact."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Incident Response",
          "services": [
            "GuardDuty",
            "Security Hub",
            "EventBridge"
          ],
          "docs": "https://docs.aws.amazon.com/guardduty/latest/ug/what-is-guardduty.html",
          "tip": "Correlate detection alerts with audit trails and application logs to validate scope and impact.",
          "explanation": "Effective validation uses multiple data sources: CloudTrail shows API callers and timestamps; CloudWatch and application logs show resource-level effects and help identify affected assets."
        },
        {
          "id": "SCS-C03-0010",
          "question": "You must prevent any account in your Org from launching EC2 instances outside eu-west-1 and eu-west-2 which preventive control should you apply across the organization?",
          "choices": [
            {
              "id": "c1",
              "text": "Attach a Service Control Policy (SCP) to the organisation root or target OUs that denies ec2:RunInstances unless the aws:RequestedRegion condition matches eu-west-1 or eu-west-2",
              "isCorrect": true,
              "explanation": "SCPs set maximum permission boundaries across all accounts in an OU or organisation, overriding any IAM policy within those accounts."
            },
            {
              "id": "c2",
              "text": "Create an IAM policy in each account that denies ec2:RunInstances outside eu-west-1 and eu-west-2, and attach it to every IAM user and role",
              "isCorrect": false,
              "explanation": "Per-account IAM policies can be removed by local administrators, and new users or roles might not receive the policy."
            },
            {
              "id": "c4",
              "text": "Use a CloudFormation StackSet with a hook that blocks ec2:RunInstances in disallowed regions",
              "isCorrect": false,
              "explanation": "CloudFormation hooks validate CloudFormation-managed resources only, not direct API calls or console launches."
            },
            {
              "id": "c3",
              "text": "Deploy an AWS Config rule that evaluates EC2 instances and flags any launched outside the allowed regions as non-compliant",
              "isCorrect": false,
              "explanation": "Config rules are detective, not preventive - the instance would already be running before Config flags it."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Identity and Access Management",
          "services": [
            "Organizations",
            "IAM",
            "Config",
            "CloudFormation"
          ],
          "docs": "https://docs.aws.amazon.com/organizations/latest/userguide/orgs_manage_policies_scps.html",
          "tip": "When account-wide preventive guardrails are required, use centralized policy mechanisms.",
          "explanation": "Service Control Policies (SCPs) in AWS Organizations act as guardrails that define the maximum permissions available to all principals in member accounts."
        },
        {
          "id": "SCS-C03-0052",
          "question": "Which AWS feature helps simulate a principal's effective permissions to diagnose an unexpected AccessDenied?",
          "choices": [
            {
              "id": "c4",
              "text": "S3 Access Analyzer",
              "isCorrect": false,
              "explanation": "Access Analyzer inspects resource-based policies for external access, not per-principal simulation of permissions."
            },
            {
              "id": "c3",
              "text": "CloudTrail data events",
              "isCorrect": false,
              "explanation": "CloudTrail records events but does not simulate policy evaluation prior to the request."
            },
            {
              "id": "c1",
              "text": "IAM Policy Simulator",
              "isCorrect": true,
              "explanation": "IAM Policy Simulator evaluates policies to determine whether a given action would be allowed for a principal and helps diagnose AccessDenied errors."
            },
            {
              "id": "c2",
              "text": "AWS Config",
              "isCorrect": false,
              "explanation": "Config tracks resource configurations but does not simulate policy evaluation for a principal."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Identity and Access Management",
          "services": [
            "IAM",
            "Access Analyzer",
            "KMS"
          ],
          "docs": "https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies.html",
          "tip": "Use policy simulation tools to reproduce and diagnose access-denied scenarios.",
          "explanation": "Policy Simulator can combine identity and resource policies to explain why a request was denied and recommend policy changes."
        },
        {
          "id": "SCS-C03-0055",
          "question": "Which pattern centralizes billing, consolidated policies, and delegated security administration across many accounts?",
          "choices": [
            {
              "id": "c2",
              "text": "Manage each account independently with separate billing",
              "isCorrect": false,
              "explanation": "Independent accounts increase operational overhead and hinder centralized policy enforcement."
            },
            {
              "id": "c4",
              "text": "Delegate everything to third-party SaaS governance tools only",
              "isCorrect": false,
              "explanation": "Third-party tools can help but AWS Organizations provides foundational native patterns for central control."
            },
            {
              "id": "c1",
              "text": "Use AWS Organizations with an organizational management account, OUs for environment separation, and delegated admin roles",
              "isCorrect": true,
              "explanation": "Organizations centralize management, apply SCPs, and enable delegated admin accounts for service management across member accounts."
            },
            {
              "id": "c3",
              "text": "Use a single shared AWS account for all teams",
              "isCorrect": false,
              "explanation": "A single account lacks isolation and governance for multiple teams or environments."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Security Foundations and Governance",
          "services": [
            "Organizations",
            "IAM",
            "CloudTrail"
          ],
          "docs": "https://docs.aws.amazon.com/whitepapers/latest/aws-security-best-practices/overview.html",
          "tip": "Organize accounts with OUs and delegated administration for scale and governance.",
          "explanation": "AWS Organizations supports centralized billing, SCPs for guardrails, and delegated admin roles for services such as GuardDuty or Security Hub, enabling scalable governance."
        },
        {
          "id": "SCS-C03-0035",
          "question": "A CISO wants a single dashboard that shows the organisation's compliance posture against the CIS AWS Foundations Benchmark and the AWS Foundational Security Best Practices standard, with automated checks running continuously. Findings from GuardDuty and Inspector should also appear in the same view. Which TWO steps are required? (Select TWO)",
          "choices": [
            {
              "id": "c2",
              "text": "Ensure AWS Config is enabled with recording turned on for all supported resource types",
              "isCorrect": true,
              "explanation": "Security Hub's compliance checks depend on AWS Config rules. If Config recording is not enabled, the automated checks cannot evaluate resource configurations and will produce no findings."
            },
            {
              "id": "c1",
              "text": "Enable AWS Security Hub and activate the CIS and Foundational Security Best Practices security standards",
              "isCorrect": true,
              "explanation": "Security Hub provides the unified dashboard and runs automated compliance checks against the selected standards using AWS Config rules it deploys automatically."
            },
            {
              "id": "c3",
              "text": "Create a custom CloudWatch dashboard aggregating Config, GuardDuty, and Inspector metrics",
              "isCorrect": false,
              "explanation": "CloudWatch dashboards show metrics and alarms, not security findings or compliance posture. Security Hub already provides the unified finding and compliance view."
            },
            {
              "id": "c5",
              "text": "Manually export GuardDuty and Inspector findings to S3 and build QuickSight dashboards",
              "isCorrect": false,
              "explanation": "This creates a custom reporting pipeline but is not necessary. GuardDuty and Inspector integrate natively with Security Hub, sending findings automatically without manual export."
            },
            {
              "id": "c4",
              "text": "Deploy AWS Firewall Manager to enforce compliance checks across all accounts",
              "isCorrect": false,
              "explanation": "Firewall Manager manages WAF, Shield, and security group policies. It does not run CIS or Best Practices compliance checks or aggregate findings from GuardDuty and Inspector."
            }
          ],
          "selectCount": 2,
          "format": "text",
          "domain": "Detection",
          "services": [
            "Security Hub",
            "Config",
            "GuardDuty",
            "Firewall Manager",
            "Inspector"
          ],
          "docs": "https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards.html",
          "tip": "An aggregation service often depends on underlying compliance recording and service integrations to surface continuous checks.",
          "explanation": "Security Hub serves as the central security findings hub. It runs compliance checks by deploying Config rules for each control in the enabled standards, so AWS Config must be recording. GuardDuty and Inspector automatically send findings to Security Hub when both are enabled, providing the unified dashboard the CISO needs."
        },
        {
          "id": "SCS-C03-0025",
          "question": "A Lambda function in a private subnet needs to call the Secrets Manager API to retrieve database credentials. The security team prohibits all internet-bound traffic from the VPC. How should the architect configure network access so the Lambda function can reach Secrets Manager without traversing the internet?",
          "choices": [
            {
              "id": "c1",
              "text": "Create an interface VPC endpoint (PrivateLink) for Secrets Manager in the same VPC and ensure the Lambda function's security group allows outbound HTTPS to the endpoint",
              "isCorrect": true,
              "explanation": "An interface VPC endpoint creates private ENIs within the VPC that route traffic to the Secrets Manager API entirely over the AWS private network, with no internet path required."
            },
            {
              "id": "c4",
              "text": "Configure the Lambda function outside the VPC so it can access Secrets Manager over the internet by default",
              "isCorrect": false,
              "explanation": "Placing the function outside the VPC gives it internet access to AWS APIs, but the question states the function is in a private subnet, and moving it out may break access to other VPC resources like the database."
            },
            {
              "id": "c3",
              "text": "Attach an Elastic IP to the Lambda function's ENI for direct outbound access",
              "isCorrect": false,
              "explanation": "Lambda functions in a VPC do not support Elastic IPs, and this approach would use the internet gateway, which is prohibited."
            },
            {
              "id": "c2",
              "text": "Add a NAT Gateway to the VPC and route the Lambda subnet's traffic through it",
              "isCorrect": false,
              "explanation": "A NAT Gateway provides internet access for outbound traffic, which violates the security team's prohibition on internet-bound traffic from the VPC."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Infrastructure Security",
          "services": [
            "Lambda",
            "VPC",
            "NAT Gateway",
            "PrivateLink",
            "Secrets Manager"
          ],
          "docs": "https://docs.aws.amazon.com/lambda/latest/dg/configuration-vpc.html",
          "tip": "Private endpoints can provide service APIs over private network paths when internet access is restricted.",
          "explanation": "Interface VPC endpoints (powered by AWS PrivateLink) create private IP addresses inside the VPC that serve as entry points for AWS service APIs. Traffic never leaves the AWS network, satisfying zero-internet-egress security requirements while allowing Lambda to call Secrets Manager."
        },
        {
          "id": "SCS-C03-0039",
          "question": "To ensure all client connections to an internet-facing application use modern TLS ciphers and automated certificate rotation, which configuration should be used on the load balancer?",
          "choices": [
            {
              "id": "c2",
              "text": "Use an HTTP listener and perform TLS termination on backend instances",
              "isCorrect": false,
              "explanation": "Terminating TLS on backend instances increases operational complexity and loses benefits of managed certificate rotation; it also may expose traffic if not configured properly."
            },
            {
              "id": "c1",
              "text": "Configure an HTTPS listener with an ACM-issued certificate and a recommended TLS security policy",
              "isCorrect": true,
              "explanation": "An HTTPS listener with an ACM-managed certificate ensures automated renewals and pairing with a recommended security policy enforces modern TLS ciphers and protocol versions."
            },
            {
              "id": "c3",
              "text": "Rely solely on security groups to restrict plaintext access",
              "isCorrect": false,
              "explanation": "Security groups control network access but do not provide TLS encryption or manage certificates."
            },
            {
              "id": "c4",
              "text": "Use self-signed certificates deployed to each client",
              "isCorrect": false,
              "explanation": "Self-signed certificates are not practical for public internet-facing services and do not support automated rotation and trust by clients."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Data Protection",
          "services": [
            "ALB",
            "ACM",
            "Route 53"
          ],
          "docs": "https://docs.aws.amazon.com/elasticloadbalancing/latest/application/create-https-listener.html",
          "tip": "Terminate TLS at the edge with managed certificates and enforce modern cipher and protocol policies.",
          "explanation": "ACM-managed certificates integrate with ALB listeners for seamless rotation; pairing them with an appropriate security policy ensures modern ciphers and protocol versions without manual certificate management."
        },
        {
          "id": "SCS-C03-0014",
          "question": "A data lake team manages a single S3 bucket accessed by multiple applications across different VPCs. They need to enforce that each application can only reach the bucket from its own VPC and can only access objects under its designated prefix. Which approach provides the strongest isolation with the least policy complexity?",
          "choices": [
            {
              "id": "c3",
              "text": "Create one VPC endpoint per VPC and use endpoint policies",
              "isCorrect": false,
              "explanation": "Endpoint policies are coarse for prefix-level scoping."
            },
            {
              "id": "c2",
              "text": "Write a single S3 bucket policy with separate statements per application",
              "isCorrect": false,
              "explanation": "A single bucket policy becomes difficult to manage and has size limits."
            },
            {
              "id": "c4",
              "text": "Replicate data into separate per-application buckets",
              "isCorrect": false,
              "explanation": "Replication increases cost and complexity."
            },
            {
              "id": "c1",
              "text": "Create a separate S3 Access Point for each application",
              "isCorrect": true,
              "explanation": "S3 Access Points allow per-application network and permission scoping against a shared bucket."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Data Protection",
          "services": [
            "S3",
            "IAM",
            "VPC",
            "PrivateLink"
          ],
          "docs": "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-points.html",
          "tip": "Think about network-scoped entry points that expose storage through controlled endpoints.",
          "explanation": "S3 Access Points provide named, per-application entry points to a bucket, each with its own policy and optional VPC restriction."
        },
        {
          "id": "SCS-C03-0049",
          "question": "A team must provide audited shell access to instances in private subnets without SSH port exposure. Which solution meets this requirement?",
          "choices": [
            {
              "id": "c2",
              "text": "Open SSH port 22 and enforce key rotation manually",
              "isCorrect": false,
              "explanation": "Opening SSH ports exposes network surface and complicates auditing compared to agent-based sessions."
            },
            {
              "id": "c4",
              "text": "Embed root credentials in AMI for quick access",
              "isCorrect": false,
              "explanation": "Embedding credentials is insecure and hinders auditing and rotation."
            },
            {
              "id": "c1",
              "text": "Use Systems Manager Session Manager with logging to CloudWatch or S3 and IAM-based access controls",
              "isCorrect": true,
              "explanation": "Session Manager provides agent-based access without inbound ports and records sessions for auditing."
            },
            {
              "id": "c3",
              "text": "Use RDP through a bastion host for Linux instances",
              "isCorrect": false,
              "explanation": "RDP is inappropriate for Linux and bastions reintroduce exposed access vectors."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Infrastructure Security",
          "services": [
            "Systems Manager",
            "SSM",
            "CloudTrail"
          ],
          "docs": "https://docs.aws.amazon.com/systems-manager/latest/userguide/session-manager.html",
          "tip": "Agent-based session solutions can record session logs and enforce access via identity policies.",
          "explanation": "Systems Manager's Session Manager avoids bastions and allows session logging to CloudWatch/S3 and control via IAM, meeting audit requirements."
        },
        {
          "id": "SCS-C03-0044",
          "question": "Which log sources are most relevant when troubleshooting intermittent 502 responses from an ALB?",
          "choices": [
            {
              "id": "c1",
              "text": "ALB access logs, target group health checks, and CloudWatch metrics for targets",
              "isCorrect": true,
              "explanation": "ALB access logs show request/response details; target health and metrics reveal backend errors that cause 502s."
            },
            {
              "id": "c4",
              "text": "IAM access logs",
              "isCorrect": false,
              "explanation": "IAM logs are unrelated to HTTP 502 responses."
            },
            {
              "id": "c3",
              "text": "Route 53 DNS query logs",
              "isCorrect": false,
              "explanation": "DNS logs don't provide HTTP backend error details."
            },
            {
              "id": "c2",
              "text": "S3 server access logs only",
              "isCorrect": false,
              "explanation": "S3 logs are irrelevant to ALB 502s unless the origin is S3, which is uncommon for dynamic backends."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Detection",
          "services": [
            "ALB",
            "Target Groups",
            "Auto Scaling"
          ],
          "docs": "https://docs.aws.amazon.com/elasticloadbalancing/latest/application/load-balancer-target-groups.html",
          "tip": "Correlate access logs with backend health and metrics when investigating HTTP errors.",
          "explanation": "Investigations into 502 errors should include ALB access logs (to see upstream responses), backend target health and metrics (to spot crashes), and application logs where possible."
        },
        {
          "id": "SCS-C03-0063",
          "question": "Which practice validates that an incident response runbook will work under real conditions?",
          "choices": [
            {
              "id": "c1",
              "text": "Conduct tabletop exercises and full-scale simulated incident drills using controlled fault injection",
              "isCorrect": true,
              "explanation": "Tabletops test decision-making; simulated drills and fault injection test technical runbooks and automation under realistic conditions."
            },
            {
              "id": "c3",
              "text": "Assume runbooks are valid if written by senior staff",
              "isCorrect": false,
              "explanation": "Assumptions without testing risk undiscovered issues in execution under pressure."
            },
            {
              "id": "c2",
              "text": "Only review runbooks annually without testing",
              "isCorrect": false,
              "explanation": "Reviews without testing may miss operational and technical gaps discovered during live drills."
            },
            {
              "id": "c4",
              "text": "Rely on vendor-provided runbooks without customization",
              "isCorrect": false,
              "explanation": "Vendor runbooks may not match the customer's environment and need adaptation and testing."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Incident Response",
          "services": [
            "Incident Manager",
            "CloudWatch",
            "EventBridge"
          ],
          "docs": "https://docs.aws.amazon.com/whitepapers/latest/aws-security-best-practices/incident-response.html",
          "tip": "Run both tabletop and technical drills to validate people and technical runbooks.",
          "explanation": "Combining tabletop exercises for roles and decisions with full technical drills (injecting faults) validates both human and automated aspects of incident response."
        },
        {
          "id": "SCS-C03-0003",
          "question": "You need to block malicious HTTP traffic before it reaches your origin which service should you pair with CloudFront to filter requests at the edge?",
          "choices": [
            {
              "id": "c4",
              "text": "AWS KMS",
              "isCorrect": false,
              "explanation": "AWS KMS is for key management and encryption, not traffic filtering."
            },
            {
              "id": "c2",
              "text": "Security Groups",
              "isCorrect": false,
              "explanation": "Security Groups control traffic to EC2 at the instance level, not the CloudFront edge."
            },
            {
              "id": "c1",
              "text": "AWS WAF",
              "isCorrect": true,
              "explanation": "AWS WAF is the web application firewall used with CloudFront to filter HTTP(S) traffic."
            },
            {
              "id": "c3",
              "text": "VPC Endpoint",
              "isCorrect": false,
              "explanation": "VPC Endpoints provide private connectivity to services within a VPC, not edge HTTP filtering."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Infrastructure Security",
          "services": [
            "WAF",
            "CloudFront",
            "Security Groups"
          ],
          "docs": "https://docs.aws.amazon.com/waf/latest/developerguide/waf-chapter.html",
          "tip": "Consider application-layer filtering at the edge to block common web attack patterns.",
          "explanation": "AWS WAF integrates natively with CloudFront, ALB, and API Gateway to inspect and filter HTTP(S) requests using rules such as rate limiting and SQL injection detection."
        },
        {
          "id": "SCS-C03-0040",
          "question": "Which combination of practices best secures the AWS account root user while preserving necessary break-glass access?",
          "choices": [
            {
              "id": "c1",
              "text": "Enable MFA on the root account, store credentials in a secure offline vault, and use IAM administrative roles for daily operations",
              "isCorrect": true,
              "explanation": "Enforcing MFA, securing root credentials offline, and delegating daily administrative tasks to IAM roles minimizes root usage while preserving a secured break-glass path."
            },
            {
              "id": "c2",
              "text": "Share root credentials with the security team to ensure quick access during incidents",
              "isCorrect": false,
              "explanation": "Sharing root credentials increases blast radius and is contrary to least-privilege practices."
            },
            {
              "id": "c4",
              "text": "Keep root access enabled for all admins but log usage to CloudTrail",
              "isCorrect": false,
              "explanation": "Allowing easy root access contradicts best practices even if logged; the preferred pattern is delegation and protected root credentials."
            },
            {
              "id": "c3",
              "text": "Remove MFA and rely on a complex password rotated monthly",
              "isCorrect": false,
              "explanation": "Removing MFA weakens security; passwords alone are insufficient for strong break-glass protections."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Security Foundations and Governance",
          "services": [
            "IAM",
            "Organizations",
            "Secrets Manager"
          ],
          "docs": "https://docs.aws.amazon.com/IAM/latest/UserGuide/id_root-user.html",
          "tip": "Minimize use of highly privileged accounts, enforce MFA, and delegate daily tasks to role-based identities.",
          "explanation": "AWS recommends enabling MFA on the root account, storing root credentials securely (e.g., an offline vault with restricted access), and using IAM roles and delegated administration for routine tasks to reduce risk and provide an auditable break-glass process."
        },
        {
          "id": "SCS-C03-0009",
          "question": "As a data steward you need to automatically find and classify PII across hundreds of S3 buckets. Which AWS service is built for that task?",
          "choices": [
            {
              "id": "c3",
              "text": "Amazon Inspector",
              "isCorrect": false,
              "explanation": "Inspector focuses on vulnerability scanning for compute workloads, not data classification in S3."
            },
            {
              "id": "c2",
              "text": "Amazon GuardDuty",
              "isCorrect": false,
              "explanation": "GuardDuty detects threats like unusual API calls to S3 but does not inspect object contents for sensitive data."
            },
            {
              "id": "c1",
              "text": "Amazon Macie",
              "isCorrect": true,
              "explanation": "Macie scans S3 objects for PII, financial data, and credentials using ML-powered classifiers and managed data identifiers."
            },
            {
              "id": "c4",
              "text": "AWS Trusted Advisor",
              "isCorrect": false,
              "explanation": "Trusted Advisor provides account-level checks like open security groups, but does not scan S3 object contents."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Data Protection",
          "services": [
            "Macie",
            "GuardDuty",
            "Inspector",
            "Trusted Advisor"
          ],
          "docs": "https://docs.aws.amazon.com/macie/latest/user/what-is-macie.html",
          "tip": "Some services scan stored objects to locate sensitive data and personally identifiable information.",
          "explanation": "Amazon Macie is designed to scan S3 objects and classify sensitive content such as PII and PHI using managed data identifiers."
        },
        {
          "id": "SCS-C03-0051",
          "question": "For secure, performant connectivity between on-premises and multiple AWS regions, which architecture is recommended?",
          "choices": [
            {
              "id": "c2",
              "text": "Create individual Site-to-Site VPNs from on-prem to each VPC",
              "isCorrect": false,
              "explanation": "Multiple VPNs increase operational overhead and complexity for multi-region connectivity."
            },
            {
              "id": "c1",
              "text": "Use AWS Transit Gateway in each region with Direct Connect and Transit Gateway inter-region peering",
              "isCorrect": true,
              "explanation": "Transit Gateway with Direct Connect and inter-region peering reduces management complexity and centralizes routing at scale."
            },
            {
              "id": "c3",
              "text": "Rely on internet-based VPNs only",
              "isCorrect": false,
              "explanation": "Internet VPNs may not meet performance and security requirements compared to Direct Connect."
            },
            {
              "id": "c4",
              "text": "Use S3 transfer acceleration for VPC connectivity",
              "isCorrect": false,
              "explanation": "S3 Transfer Acceleration is for object transfers and not a network topology solution."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Infrastructure Security",
          "services": [
            "VPC",
            "Transit Gateway",
            "VPN"
          ],
          "docs": "https://docs.aws.amazon.com/vpc/latest/userguide/what-is-amazon-vpc.html",
          "tip": "Combine transit routing and dedicated connectivity for scalable, performant hybrid networking.",
          "explanation": "Transit Gateway simplifies routing between many VPCs and on-premises, and Direct Connect improves performance and security over internet VPNs."
        },
        {
          "id": "SCS-C03-0056",
          "question": "Which mechanism should be used to automatically remediate a non-compliant resource detected by AWS Config?",
          "choices": [
            {
              "id": "c1",
              "text": "Configure AWS Config automatic remediation using an SSM Automation document",
              "isCorrect": true,
              "explanation": "Config remediation actions invoke SSM Automation documents to fix identified non-compliance automatically."
            },
            {
              "id": "c4",
              "text": "Deploy a Lambda that polls Config every 24 hours",
              "isCorrect": false,
              "explanation": "Polling is less efficient and misses near-real-time remediation compared to Config automatic remediation."
            },
            {
              "id": "c3",
              "text": "Use CloudTrail to roll back the resource change",
              "isCorrect": false,
              "explanation": "CloudTrail records events but does not perform automated remediation by itself."
            },
            {
              "id": "c2",
              "text": "Send alerts only to email and wait for manual action",
              "isCorrect": false,
              "explanation": "Manual remediation is slower and does not meet automatic remediation requirements."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Detection",
          "services": [
            "Config",
            "SSM",
            "CloudWatch"
          ],
          "docs": "https://docs.aws.amazon.com/config/latest/developerguide/remediation.html",
          "tip": "Use built-in remediation mechanisms that invoke automation playbooks or documents for fixes.",
          "explanation": "AWS Config's remediation model is designed to trigger SSM Automation documents to correct drift promptly and reliably."
        },
        {
          "id": "SCS-C03-0018",
          "question": "A company runs workloads on Amazon EKS and needs each Kubernetes pod to assume a unique IAM role with fine-grained permissions. The trust policy must ensure only the intended service account in a specific namespace can assume the role. Which trust policy snippet correctly restricts role assumption to the pod's OIDC identity?",
          "choices": [
            {
              "id": "c4",
              "text": "{\"Effect\":\"Allow\",\"Principal\":{\"Federated\":\"cognito-identity.amazonaws.com\"},\"Action\":\"sts:AssumeRoleWithWebIdentity\"}",
              "isCorrect": false,
              "explanation": "Cognito Identity is for end-user identity federation, not Kubernetes workload identity. EKS uses its own OIDC provider endpoint."
            },
            {
              "id": "c2",
              "text": "{\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"eks.amazonaws.com\"},\"Action\":\"sts:AssumeRole\"}",
              "isCorrect": false,
              "explanation": "This trusts the EKS service itself (the control plane), not individual pod identities. Any EKS-managed component could assume this role, not just the intended pod."
            },
            {
              "id": "c1",
              "text": "{\"Effect\":\"Allow\",\"Principal\":{\"Federated\":\"arn:aws:iam::123456789012:oidc-provider/oidc.eks.us-east-1.amazonaws.com/id/EXAMPLED539D4633E53DE1B71EXAMPLE\"},\"Action\":\"sts:AssumeRoleWithWebIdentity\",\"Condition\":{\"StringEquals\":{\"oidc.eks.us-east-1.amazonaws.com/id/EXAMPLED539D4633E53DE1B71EXAMPLE:sub\":\"system:serviceaccount:app-ns:app-sa\"}}}",
              "isCorrect": true,
              "explanation": "This uses the EKS OIDC provider as a Federated principal with AssumeRoleWithWebIdentity, and the Condition restricts the sub claim to the exact namespace:serviceaccount pair."
            },
            {
              "id": "c3",
              "text": "{\"Effect\":\"Allow\",\"Principal\":{\"AWS\":\"arn:aws:iam::123456789012:role/eks-node-role\"},\"Action\":\"sts:AssumeRole\"}",
              "isCorrect": false,
              "explanation": "Trusting the node role lets every pod on that node assume this role, eliminating per-pod isolation."
            }
          ],
          "selectCount": 1,
          "format": "json",
          "domain": "Identity and Access Management",
          "services": [
            "IAM",
            "STS",
            "Cognito",
            "EKS"
          ],
          "docs": "https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_providers_oidc.html",
          "tip": "Use workload identity federation patterns to grant pod-level permissions without node credentials.",
          "explanation": "IRSA projects a signed OIDC token into each pod, and the trust policy uses the cluster OIDC provider as a Federated principal with a Condition on the sub claim (namespace:serviceaccount). This ensures only the precise service account in the correct namespace can assume the role."
        },
        {
          "id": "SCS-C03-0007",
          "question": "You're locking down access so an IAM role can only reach an S3 bucket via a specific VPC endpoint. Which condition should you add to the policy to enforce this?",
          "choices": [
            {
              "id": "c3",
              "text": "Add the VPC endpoint ID to the IAM role's trust policy as a Principal",
              "isCorrect": false,
              "explanation": "VPC endpoints are not IAM principals and cannot appear in a trust policy's Principal element."
            },
            {
              "id": "c2",
              "text": "{\"Condition\": {\"IpAddress\": {\"aws:SourceIp\": \"10.0.0.0/16\"}}}",
              "isCorrect": false,
              "explanation": "IpAddress/SourceIp restricts by IP range, not by VPC endpoint identity."
            },
            {
              "id": "c4",
              "text": "Attach a security group to the IAM role that only allows traffic from the VPC",
              "isCorrect": false,
              "explanation": "Security groups are network-level controls for ENIs - they cannot be attached to IAM roles."
            },
            {
              "id": "c1",
              "text": "{\"Condition\": {\"StringEquals\": {\"aws:sourceVpce\": \"vpce-certshack123\"}}}",
              "isCorrect": true,
              "explanation": "aws:sourceVpce condition restricts the policy to requests through the specified VPC endpoint."
            }
          ],
          "selectCount": 1,
          "format": "json",
          "domain": "Identity and Access Management",
          "services": [
            "IAM",
            "S3"
          ],
          "docs": "https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies.html",
          "tip": "Restrict access by considering VPC endpoint-based conditions in resource policies.",
          "explanation": "The aws:sourceVpce condition key with StringEquals restricts access to requests that traverse a specific VPC endpoint."
        },
        {
          "id": "SCS-C03-0016",
          "question": "A development team stores database credentials in environment variables baked into their container images. The security team requires that credentials be rotated every 30 days without redeploying containers and that all credential access be auditable. Which approach best meets these requirements?",
          "choices": [
            {
              "id": "c3",
              "text": "Encrypt the environment variables at build time with a KMS key and decrypt them at container start",
              "isCorrect": false,
              "explanation": "This protects secrets at rest in the image, but rotating requires rebuilding and redeploying the container, which violates the no-redeploy requirement."
            },
            {
              "id": "c4",
              "text": "Use IAM database authentication to eliminate passwords entirely",
              "isCorrect": false,
              "explanation": "IAM database authentication works only with supported engines (Aurora MySQL/PostgreSQL, RDS MySQL/PostgreSQL) and may not cover all the team's databases. It also does not address other types of credentials."
            },
            {
              "id": "c2",
              "text": "Store credentials in SSM Parameter Store SecureString parameters and write a cron job to update them monthly",
              "isCorrect": false,
              "explanation": "Parameter Store SecureStrings can hold secrets but lack built-in automatic rotation. A cron job is fragile and requires custom coordination with both the parameter and the database."
            },
            {
              "id": "c1",
              "text": "Store credentials in AWS Secrets Manager with automatic rotation enabled and retrieve them at runtime using the Secrets Manager SDK",
              "isCorrect": true,
              "explanation": "Secrets Manager supports automatic rotation via Lambda, provides versioned secrets so applications always fetch the current value at runtime, and logs all access through CloudTrail."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Data Protection",
          "services": [
            "Secrets Manager",
            "Parameter Store",
            "KMS",
            "Lambda"
          ],
          "docs": "https://docs.aws.amazon.com/secretsmanager/latest/userguide/intro.html",
          "tip": "To avoid redeploys on rotation, applications should retrieve secrets dynamically at runtime.",
          "explanation": "Secrets Manager is purpose-built for credential lifecycle management. Its rotation feature invokes a Lambda function on a schedule to update both the secret value and the target resource (e.g., RDS password), while applications retrieve the current secret at runtime, eliminating the need for redeployment."
        },
        {
          "id": "SCS-C03-0008",
          "question": "You want AWS Config to spot S3 buckets with public read access automatically which CloudFormation snippet defines the correct managed Config rule?",
          "choices": [
            {
              "id": "c2",
              "text": "Type: AWS::Config::ConfigRule\nProperties:\n  ConfigRuleName: s3-bucket-public-read-prohibited\n  Source:\n    Owner: CUSTOM\n    SourceIdentifier: S3_BUCKET_PUBLIC_READ_PROHIBITED",
              "isCorrect": false,
              "explanation": "Owner: CUSTOM is for custom rules backed by Lambda functions, not AWS managed rules."
            },
            {
              "id": "c3",
              "text": "Use AWS CloudTrail to monitor S3:GetBucketPolicy API calls and alert when public access is detected",
              "isCorrect": false,
              "explanation": "CloudTrail monitors API calls but does not provide continuous compliance evaluation like AWS Config."
            },
            {
              "id": "c4",
              "text": "Enable S3 Block Public Access at the account level - this replaces the need for Config rules",
              "isCorrect": false,
              "explanation": "Block Public Access is preventive - it does not detect existing violations like a Config rule does."
            },
            {
              "id": "c1",
              "text": "Type: AWS::Config::ConfigRule\nProperties:\n  ConfigRuleName: s3-bucket-public-read-prohibited\n  Source:\n    Owner: AWS\n    SourceIdentifier: S3_BUCKET_PUBLIC_READ_PROHIBITED",
              "isCorrect": true,
              "explanation": "AWS managed Config rule using Owner: AWS and the standard S3 public read detection identifier."
            }
          ],
          "selectCount": 1,
          "format": "yaml",
          "domain": "Detection",
          "services": [
            "Config",
            "CloudFormation",
            "S3"
          ],
          "docs": "https://docs.aws.amazon.com/config/latest/developerguide/WhatIsConfig.html",
          "tip": "Managed rules often have predefined identifiers and are provided by the cloud provider.",
          "explanation": "AWS Config managed rules are pre-built by AWS and referenced with Owner: AWS plus a SourceIdentifier like S3_BUCKET_PUBLIC_READ_PROHIBITED."
        },
        {
          "id": "SCS-C03-0061",
          "question": "Which solution ensures centralized, policy-driven backups across RDS and EFS with retention controls?",
          "choices": [
            {
              "id": "c2",
              "text": "Create per-service scripts to snapshot data and copy to S3",
              "isCorrect": false,
              "explanation": "Custom scripts lack centralized policy management and consistent retention enforcement."
            },
            {
              "id": "c4",
              "text": "Rely on EC2 AMI snapshots for database backups",
              "isCorrect": false,
              "explanation": "AMI snapshots are not suitable for database-consistent backups across services without application-level coordination."
            },
            {
              "id": "c1",
              "text": "Use AWS Backup with backup plans and vaults to centrally manage backups and retention",
              "isCorrect": true,
              "explanation": "AWS Backup centralizes backups across supported services and enforces retention and lifecycle rules via backup plans and vaults."
            },
            {
              "id": "c3",
              "text": "Use cross-region replication for S3 only",
              "isCorrect": false,
              "explanation": "S3 replication is specific to S3 and doesn't manage backups for other services like RDS/EFS."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Data Protection",
          "services": [
            "AWS Backup",
            "RDS",
            "S3"
          ],
          "docs": "https://docs.aws.amazon.com/backup/latest/devguide/whatisbackup.html",
          "tip": "Use a centralized backup orchestration service to manage retention and policies across supported resources.",
          "explanation": "AWS Backup simplifies centralized backup orchestration, retention policies, and cross-account/cross-region copy workflows for supported AWS resources."
        },
        {
          "id": "SCS-C03-0053",
          "question": "Which strategy enables workload access policies that scale with many teams and dynamic resources in AWS?",
          "choices": [
            {
              "id": "c1",
              "text": "Use ABAC with tags to grant permissions based on attributes such as department or environment",
              "isCorrect": true,
              "explanation": "ABAC provides scalable, attribute-based permissions without creating many static IAM policies per resource."
            },
            {
              "id": "c4",
              "text": "Rely solely on VPC-level security groups for access control",
              "isCorrect": false,
              "explanation": "Security groups operate at network level, not at identity/attribute level."
            },
            {
              "id": "c2",
              "text": "Create a single monolithic admin role for all teams",
              "isCorrect": false,
              "explanation": "Monolithic roles violate least privilege and do not scale well."
            },
            {
              "id": "c3",
              "text": "Hardcode permissions into application config files",
              "isCorrect": false,
              "explanation": "Hardcoding is insecure and prevents centralized management and auditing."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Identity and Access Management",
          "services": [
            "EKS",
            "IAM",
            "KMS"
          ],
          "docs": "https://docs.aws.amazon.com/eks/latest/userguide/security_iam.html",
          "tip": "Use attribute-based access control (ABAC) with tags for scalable permission models.",
          "explanation": "ABAC allows policies to reference resource or principal tags, reducing policy proliferation while enabling fine-grained access control aligned to organizational attributes."
        },
        {
          "id": "SCS-C03-0058",
          "question": "To rate-limit abusive clients at the edge while preserving legitimate traffic, which feature combination should be used?",
          "choices": [
            {
              "id": "c4",
              "text": "Use Route 53 geolocation routing only",
              "isCorrect": false,
              "explanation": "Geolocation routing doesn't provide rate-limiting or application-layer filtering."
            },
            {
              "id": "c1",
              "text": "AWS WAF rate-based rules on CloudFront with CloudFront caching",
              "isCorrect": true,
              "explanation": "WAF rate-based rules block clients over request thresholds while CloudFront caching reduces backend load for legitimate traffic."
            },
            {
              "id": "c3",
              "text": "Increase origin instance capacity",
              "isCorrect": false,
              "explanation": "Scaling origin capacity doesn't stop abusive traffic or reduce edge processing cost."
            },
            {
              "id": "c2",
              "text": "NACL rules to block IP ranges",
              "isCorrect": false,
              "explanation": "NACLs are coarse-grained and do not provide application-layer rate limiting."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Infrastructure Security",
          "services": [
            "ALB",
            "WAF",
            "Route 53"
          ],
          "docs": "https://docs.aws.amazon.com/elasticloadbalancing/latest/application/listener-update-rule.html",
          "tip": "Implement edge rate-limiting close to users and combine caching to reduce backend load.",
          "explanation": "WAF's rate-based rules applied at CloudFront prevent abusive clients from reaching origin and, combined with caching, protect backend capacity."
        },
        {
          "id": "SCS-C03-0050",
          "question": "Which approach meets the requirement: rotate DB credentials every 30 days without redeploying applications?",
          "choices": [
            {
              "id": "c4",
              "text": "Rotate credentials manually and email them to developers",
              "isCorrect": false,
              "explanation": "Manual rotation and distribution is insecure and error-prone."
            },
            {
              "id": "c3",
              "text": "Store credentials in SSM Parameter Store without rotation",
              "isCorrect": false,
              "explanation": "Parameter Store can store secrets but does not provide automated rotation like Secrets Manager."
            },
            {
              "id": "c1",
              "text": "Use AWS Secrets Manager rotation with a Lambda rotation function and have apps retrieve secrets at runtime",
              "isCorrect": true,
              "explanation": "Secrets Manager supports automatic rotation and applications that fetch secrets at runtime do not need redeployment."
            },
            {
              "id": "c2",
              "text": "Bake credentials into container images and rebuild monthly",
              "isCorrect": false,
              "explanation": "Rebuilding images is operationally heavy and requires redeployment, which the requirement forbids."
            }
          ],
          "selectCount": 1,
          "format": "json",
          "domain": "Data Protection",
          "services": [
            "Secrets Manager",
            "IAM",
            "Lambda"
          ],
          "docs": "https://docs.aws.amazon.com/secretsmanager/latest/userguide/intro.html",
          "tip": "Prefer automated rotation and runtime retrieval of secrets to decouple credentials from deployments.",
          "explanation": "Automatic rotation decouples credential lifecycles from deployments; applications should fetch secrets at runtime to benefit from rotation without redeployments."
        },
        {
          "id": "SCS-C03-0027",
          "question": "A security team has an AWS Config rule that detects S3 buckets without default encryption enabled. They want Config to automatically remediate non-compliant buckets by applying AES-256 server-side encryption. Which CloudFormation snippet correctly defines the auto-remediation action?",
          "choices": [
            {
              "id": "c3",
              "text": "Add a ComplianceResourceTypes property to the Config rule that triggers an SNS notification, then subscribe a Lambda function to apply encryption",
              "isCorrect": false,
              "explanation": "This creates a notification pipeline, not an automatic remediation. It also requires custom SNS-to-Lambda wiring and does not use Config's built-in remediation feature."
            },
            {
              "id": "c1",
              "text": "Type: AWS::Config::RemediationConfiguration\nProperties:\n  ConfigRuleName: s3-bucket-server-side-encryption-enabled\n  TargetType: SSM_DOCUMENT\n  TargetId: AWS-EnableS3BucketEncryption\n  Automatic: true\n  MaximumAutomaticAttempts: 3\n  RetryAttemptSeconds: 60\n  Parameters:\n    BucketName:\n      ResourceValue:\n        Value: RESOURCE_ID",
              "isCorrect": true,
              "explanation": "This uses an AWS-provided SSM Automation document to enable encryption on the non-compliant bucket. TargetType SSM_DOCUMENT and the RESOURCE_ID placeholder correctly bind the remediation to the flagged resource."
            },
            {
              "id": "c4",
              "text": "Use an EventBridge rule to detect Config compliance change events and invoke a Step Functions workflow",
              "isCorrect": false,
              "explanation": "While this architecture works, it bypasses Config's native remediation capability, introducing more components to build and maintain. The question asks for Config auto-remediation."
            },
            {
              "id": "c2",
              "text": "Type: AWS::Config::RemediationConfiguration\nProperties:\n  ConfigRuleName: s3-bucket-server-side-encryption-enabled\n  TargetType: LAMBDA\n  TargetId: arn:aws:lambda:us-east-1:123456789012:function:fix-encryption\n  Automatic: true",
              "isCorrect": false,
              "explanation": "Config remediation currently only supports SSM_DOCUMENT as a TargetType. Lambda functions cannot be used directly as remediation targets in a RemediationConfiguration resource."
            }
          ],
          "selectCount": 1,
          "format": "yaml",
          "domain": "Detection",
          "services": [
            "Config",
            "Systems Manager",
            "S3",
            "Lambda"
          ],
          "docs": "https://docs.aws.amazon.com/config/latest/developerguide/remediation.html",
          "tip": "Automatic remediation mechanisms commonly invoke automation documents or playbooks rather than ad-hoc functions.",
          "explanation": "AWS Config remediation actions invoke SSM Automation documents to fix non-compliant resources. AWS provides pre-built documents like AWS-EnableS3BucketEncryption. Setting Automatic to true and configuring retry parameters ensures Config will apply the fix without manual intervention whenever a drift is detected."
        }
      ],
      "perDomain": {
        "Data Protection": {
          "total": 1,
          "correct": 1,
          "score": 100
        }
      },
      "earlyComplete": true,
      "answeredCount": 1,
      "totalQuestions": 65
    },
    {
      "attemptId": "b7404562-8eef-48c9-8037-4d7e4ba62ab0",
      "userId": "9255a4e4-20f1-7010-8a80-17c43ca141e3",
      "examCode": "SCS-C03",
      "examVersion": null,
      "s3VersionId": null,
      "attemptSchemaVersion": 1,
      "startedAt": "2026-02-18T14:58:47.856Z",
      "finishedAt": "2026-02-18T14:59:06.362Z",
      "score": 100,
      "answers": [
        {
          "questionId": "SCS-C03-0044",
          "selectedChoiceId": "c1",
          "selectedChoiceIds": null,
          "selectedIndex": null,
          "selectedIndices": null,
          "correct": true,
          "timeMs": 0,
          "showTip": false,
          "createdAt": "2026-02-18T14:59:02.582Z"
        }
      ],
      "metadata": {
        "serviceKeywords": [],
        "domains": [],
        "services": []
      },
      "questions": [
        {
          "id": "SCS-C03-0044",
          "question": "Which log sources are most relevant when troubleshooting intermittent 502 responses from an ALB?",
          "choices": [
            {
              "id": "c4",
              "text": "IAM access logs",
              "isCorrect": false,
              "explanation": "IAM logs are unrelated to HTTP 502 responses."
            },
            {
              "id": "c2",
              "text": "S3 server access logs only",
              "isCorrect": false,
              "explanation": "S3 logs are irrelevant to ALB 502s unless the origin is S3, which is uncommon for dynamic backends."
            },
            {
              "id": "c1",
              "text": "ALB access logs, target group health checks, and CloudWatch metrics for targets",
              "isCorrect": true,
              "explanation": "ALB access logs show request/response details; target health and metrics reveal backend errors that cause 502s."
            },
            {
              "id": "c3",
              "text": "Route 53 DNS query logs",
              "isCorrect": false,
              "explanation": "DNS logs don't provide HTTP backend error details."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Detection",
          "services": [
            "ALB",
            "Target Groups",
            "Auto Scaling"
          ],
          "docs": "https://docs.aws.amazon.com/elasticloadbalancing/latest/application/load-balancer-target-groups.html",
          "tip": "Correlate access logs with backend health and metrics when investigating HTTP errors.",
          "explanation": "Investigations into 502 errors should include ALB access logs (to see upstream responses), backend target health and metrics (to spot crashes), and application logs where possible."
        },
        {
          "id": "SCS-C03-0056",
          "question": "Which mechanism should be used to automatically remediate a non-compliant resource detected by AWS Config?",
          "choices": [
            {
              "id": "c2",
              "text": "Send alerts only to email and wait for manual action",
              "isCorrect": false,
              "explanation": "Manual remediation is slower and does not meet automatic remediation requirements."
            },
            {
              "id": "c3",
              "text": "Use CloudTrail to roll back the resource change",
              "isCorrect": false,
              "explanation": "CloudTrail records events but does not perform automated remediation by itself."
            },
            {
              "id": "c4",
              "text": "Deploy a Lambda that polls Config every 24 hours",
              "isCorrect": false,
              "explanation": "Polling is less efficient and misses near-real-time remediation compared to Config automatic remediation."
            },
            {
              "id": "c1",
              "text": "Configure AWS Config automatic remediation using an SSM Automation document",
              "isCorrect": true,
              "explanation": "Config remediation actions invoke SSM Automation documents to fix identified non-compliance automatically."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Detection",
          "services": [
            "Config",
            "SSM",
            "CloudWatch"
          ],
          "docs": "https://docs.aws.amazon.com/config/latest/developerguide/remediation.html",
          "tip": "Use built-in remediation mechanisms that invoke automation playbooks or documents for fixes.",
          "explanation": "AWS Config's remediation model is designed to trigger SSM Automation documents to correct drift promptly and reliably."
        },
        {
          "id": "SCS-C03-0002",
          "question": "You're investigating suspicious activity and want to run investigative notebooks to visualise relationships which AWS service provides that investigative workspace?",
          "choices": [
            {
              "id": "c2",
              "text": "Amazon Detective",
              "isCorrect": true,
              "explanation": "Amazon Detective is designed to analyze, visualize, and conduct investigations into potential security issues."
            },
            {
              "id": "c4",
              "text": "AWS CloudTrail",
              "isCorrect": false,
              "explanation": "CloudTrail records API activity and is useful for forensics, but Detective provides investigative workflows."
            },
            {
              "id": "c3",
              "text": "AWS Shield",
              "isCorrect": false,
              "explanation": "AWS Shield provides DDoS protections, not forensic investigation tools."
            },
            {
              "id": "c1",
              "text": "AWS Systems Manager",
              "isCorrect": false,
              "explanation": "Systems Manager helps manage instances but is not focused on security investigation notebooks."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Incident Response",
          "services": [
            "Detective",
            "Systems Manager",
            "Shield",
            "CloudTrail"
          ],
          "docs": "https://docs.aws.amazon.com/detective/latest/adminguide/what-is.html",
          "tip": "Use a central findings aggregator that links related alerts and activity for investigation.",
          "explanation": "Amazon Detective automatically collects log data from VPC Flow Logs, CloudTrail, and GuardDuty, then builds a graph model that links related events so analysts can visually trace activity."
        },
        {
          "id": "SCS-C03-0038",
          "question": "Which AWS service automates building, testing, and distributing hardened AMIs with a repeatable pipeline?",
          "choices": [
            {
              "id": "c4",
              "text": "AWS CloudFormation",
              "isCorrect": false,
              "explanation": "CloudFormation deploys infrastructure as code but does not provide an image build-and-test pipeline by itself."
            },
            {
              "id": "c3",
              "text": "Amazon Inspector",
              "isCorrect": false,
              "explanation": "Inspector performs vulnerability assessments but does not build or distribute hardened AMIs."
            },
            {
              "id": "c2",
              "text": "AWS Glue",
              "isCorrect": false,
              "explanation": "Glue is an ETL/data integration service, not an image-building pipeline."
            },
            {
              "id": "c1",
              "text": "EC2 Image Builder",
              "isCorrect": true,
              "explanation": "EC2 Image Builder automates the creation, patching, testing, and distribution of server images according to repeatable pipelines and policies."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Infrastructure Security",
          "services": [
            "EC2 Image Builder",
            "EC2",
            "Systems Manager"
          ],
          "docs": "https://docs.aws.amazon.com/imagebuilder/latest/userguide/what-is-image-builder.html",
          "tip": "Use automated image pipelines that include patching and configuration validation before distribution.",
          "explanation": "EC2 Image Builder provides a repeatable, auditable pipeline to produce hardened AMIs, including testing steps and integration with Systems Manager for patching and compliance verification."
        },
        {
          "id": "SCS-C03-0007",
          "question": "You're locking down access so an IAM role can only reach an S3 bucket via a specific VPC endpoint. Which condition should you add to the policy to enforce this?",
          "choices": [
            {
              "id": "c3",
              "text": "Add the VPC endpoint ID to the IAM role's trust policy as a Principal",
              "isCorrect": false,
              "explanation": "VPC endpoints are not IAM principals and cannot appear in a trust policy's Principal element."
            },
            {
              "id": "c1",
              "text": "{\"Condition\": {\"StringEquals\": {\"aws:sourceVpce\": \"vpce-certshack123\"}}}",
              "isCorrect": true,
              "explanation": "aws:sourceVpce condition restricts the policy to requests through the specified VPC endpoint."
            },
            {
              "id": "c2",
              "text": "{\"Condition\": {\"IpAddress\": {\"aws:SourceIp\": \"10.0.0.0/16\"}}}",
              "isCorrect": false,
              "explanation": "IpAddress/SourceIp restricts by IP range, not by VPC endpoint identity."
            },
            {
              "id": "c4",
              "text": "Attach a security group to the IAM role that only allows traffic from the VPC",
              "isCorrect": false,
              "explanation": "Security groups are network-level controls for ENIs - they cannot be attached to IAM roles."
            }
          ],
          "selectCount": 1,
          "format": "json",
          "domain": "Identity and Access Management",
          "services": [
            "IAM",
            "S3"
          ],
          "docs": "https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies.html",
          "tip": "Restrict access by considering VPC endpoint-based conditions in resource policies.",
          "explanation": "The aws:sourceVpce condition key with StringEquals restricts access to requests that traverse a specific VPC endpoint."
        },
        {
          "id": "SCS-C03-0052",
          "question": "Which AWS feature helps simulate a principal's effective permissions to diagnose an unexpected AccessDenied?",
          "choices": [
            {
              "id": "c3",
              "text": "CloudTrail data events",
              "isCorrect": false,
              "explanation": "CloudTrail records events but does not simulate policy evaluation prior to the request."
            },
            {
              "id": "c4",
              "text": "S3 Access Analyzer",
              "isCorrect": false,
              "explanation": "Access Analyzer inspects resource-based policies for external access, not per-principal simulation of permissions."
            },
            {
              "id": "c2",
              "text": "AWS Config",
              "isCorrect": false,
              "explanation": "Config tracks resource configurations but does not simulate policy evaluation for a principal."
            },
            {
              "id": "c1",
              "text": "IAM Policy Simulator",
              "isCorrect": true,
              "explanation": "IAM Policy Simulator evaluates policies to determine whether a given action would be allowed for a principal and helps diagnose AccessDenied errors."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Identity and Access Management",
          "services": [
            "IAM",
            "Access Analyzer",
            "KMS"
          ],
          "docs": "https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies.html",
          "tip": "Use policy simulation tools to reproduce and diagnose access-denied scenarios.",
          "explanation": "Policy Simulator can combine identity and resource policies to explain why a request was denied and recommend policy changes."
        },
        {
          "id": "SCS-C03-0023",
          "question": "A web application team needs to ensure that TLS certificates on their internet-facing ALBs are renewed automatically without any manual intervention or downtime. Certificates must support multiple subdomain names (e.g., api.example.com, app.example.com). Which approach meets these requirements?",
          "choices": [
            {
              "id": "c3",
              "text": "Use Let's Encrypt with certbot running on the ALB instances to obtain and renew certificates",
              "isCorrect": false,
              "explanation": "ALBs are managed services; you cannot run certbot or any agent on them. Let's Encrypt certificates must be imported into ACM, losing automatic renewal."
            },
            {
              "id": "c2",
              "text": "Purchase a wildcard certificate from a third-party CA, import it into ACM, and set a calendar reminder to renew it annually",
              "isCorrect": false,
              "explanation": "Imported certificates in ACM are not automatically renewed. Manual renewal and re-import is required, which introduces risk of expiration and human error."
            },
            {
              "id": "c4",
              "text": "Generate a self-signed certificate for each subdomain and configure the ALB to present them using SNI",
              "isCorrect": false,
              "explanation": "Self-signed certificates are not trusted by browsers and will produce security warnings. They also require manual rotation, defeating the automation requirement."
            },
            {
              "id": "c1",
              "text": "Request a public ACM certificate with Subject Alternative Names (SANs) for each subdomain using DNS validation, and associate it with the ALB",
              "isCorrect": true,
              "explanation": "ACM public certificates with DNS validation renew automatically as long as the CNAME validation records remain in place. SANs allow multiple subdomains on a single certificate, and ALB natively integrates with ACM for zero-downtime deployment."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Data Protection",
          "services": [
            "ACM",
            "CloudFront",
            "ALB",
            "Route 53"
          ],
          "docs": "https://docs.aws.amazon.com/acm/latest/userguide/acm-overview.html",
          "tip": "Automatic certificate renewal typically requires that the provider issued the certificate and an automated validation method is available.",
          "explanation": "AWS Certificate Manager issues free public certificates that renew automatically when DNS validation is used. By adding SANs for each subdomain, a single certificate covers multiple endpoints. ACM's native integration with ALB means certificate deployment and rotation happen transparently."
        },
        {
          "id": "SCS-C03-0051",
          "question": "For secure, performant connectivity between on-premises and multiple AWS regions, which architecture is recommended?",
          "choices": [
            {
              "id": "c1",
              "text": "Use AWS Transit Gateway in each region with Direct Connect and Transit Gateway inter-region peering",
              "isCorrect": true,
              "explanation": "Transit Gateway with Direct Connect and inter-region peering reduces management complexity and centralizes routing at scale."
            },
            {
              "id": "c4",
              "text": "Use S3 transfer acceleration for VPC connectivity",
              "isCorrect": false,
              "explanation": "S3 Transfer Acceleration is for object transfers and not a network topology solution."
            },
            {
              "id": "c2",
              "text": "Create individual Site-to-Site VPNs from on-prem to each VPC",
              "isCorrect": false,
              "explanation": "Multiple VPNs increase operational overhead and complexity for multi-region connectivity."
            },
            {
              "id": "c3",
              "text": "Rely on internet-based VPNs only",
              "isCorrect": false,
              "explanation": "Internet VPNs may not meet performance and security requirements compared to Direct Connect."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Infrastructure Security",
          "services": [
            "VPC",
            "Transit Gateway",
            "VPN"
          ],
          "docs": "https://docs.aws.amazon.com/vpc/latest/userguide/what-is-amazon-vpc.html",
          "tip": "Combine transit routing and dedicated connectivity for scalable, performant hybrid networking.",
          "explanation": "Transit Gateway simplifies routing between many VPCs and on-premises, and Direct Connect improves performance and security over internet VPNs."
        },
        {
          "id": "SCS-C03-0037",
          "question": "For a critical service running in an Auto Scaling group behind an ALB, which monitoring approach provides aggregated health metrics and automated alerting for service-level availability?",
          "choices": [
            {
              "id": "c3",
              "text": "Use S3 access logs aggregated into Athena queries to detect failures",
              "isCorrect": false,
              "explanation": "S3 access logs are eventual and not designed for real-time service availability monitoring."
            },
            {
              "id": "c1",
              "text": "Create CloudWatch alarms on aggregated ALB and Auto Scaling metrics and notify via SNS to trigger automated remediation",
              "isCorrect": true,
              "explanation": "CloudWatch aggregates service metrics (ALB and ASG), allows alarm thresholds, and integrates with SNS and automated remediation actions such as scaling or Lambda-driven fixes."
            },
            {
              "id": "c2",
              "text": "Rely on CloudTrail event history to monitor service health and send alerts",
              "isCorrect": false,
              "explanation": "CloudTrail records API activity and is not suitable as a primary source of service health metrics or near-real-time availability alarms."
            },
            {
              "id": "c4",
              "text": "Attach detailed instance metrics to each EC2 instance and rely on manual inspection",
              "isCorrect": false,
              "explanation": "Instance-level metrics are useful but relying on manual inspection does not provide automated alerting or aggregated service-level visibility across an Auto Scaling group."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Detection",
          "services": [
            "CloudWatch",
            "Auto Scaling",
            "Elastic Load Balancing",
            "SNS"
          ],
          "docs": "https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/WhatIsCloudWatch.html",
          "tip": "Aggregate load balancer and auto-scaling metrics into alarms and connect them to alerting or automation for remediation.",
          "explanation": "CloudWatch is the natural aggregation point for service metrics; combining ALB and Auto Scaling metrics with alarms and SNS-driven automation provides both service-level visibility and automatic remediation triggers."
        },
        {
          "id": "SCS-C03-0033",
          "question": "An incident responder has identified a compromised IAM role and needs to immediately invalidate all existing sessions for that role while preserving the role itself for forensic analysis. Which approach revokes all active sessions without deleting the role?",
          "choices": [
            {
              "id": "c4",
              "text": "Contact AWS Support to force-expire the role's temporary credentials",
              "isCorrect": false,
              "explanation": "AWS Support cannot force-expire individual STS tokens. Session revocation must be done through IAM policy mechanisms by the account administrator."
            },
            {
              "id": "c3",
              "text": "Change the role's trust policy to deny all principals",
              "isCorrect": false,
              "explanation": "Modifying the trust policy prevents new role assumptions but does not invalidate existing active sessions. Temporary credentials already issued remain valid until they expire."
            },
            {
              "id": "c1",
              "text": "Add an inline deny-all policy to the role with a condition that aws:TokenIssueTime is before the current timestamp:\n{\"Effect\":\"Deny\",\"Action\":\"*\",\"Resource\":\"*\",\"Condition\":{\"DateLessThan\":{\"aws:TokenIssueTime\":\"2026-02-16T12:00:00Z\"}}}",
              "isCorrect": true,
              "explanation": "This technique (Revoke Session) denies all actions for temporary credentials issued before the specified time. New sessions assumed after that time are unaffected, and the role remains intact for investigation."
            },
            {
              "id": "c2",
              "text": "Delete all inline and managed policies from the role to remove its permissions",
              "isCorrect": false,
              "explanation": "Removing policies prevents new actions but also destroys the evidence of what permissions the role had, which is critical for forensic analysis."
            }
          ],
          "selectCount": 1,
          "format": "json",
          "domain": "Incident Response",
          "services": [
            "STS",
            "IAM",
            "CloudTrail"
          ],
          "docs": "https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_temp_request.html",
          "tip": "Session revocation often uses time-based deny conditions to invalidate earlier issued tokens.",
          "explanation": "STS temporary credentials cannot be individually revoked, but you can render them useless by attaching a deny-all policy with a DateLessThan condition on aws:TokenIssueTime. This is the recommended emergency response for compromised roles because it immediately neutralizes existing sessions while keeping the role and its policies intact for forensic review."
        },
        {
          "id": "SCS-C03-0064",
          "question": "After a GuardDuty finding indicates suspicious API calls from a role, which steps validate scope and impact?",
          "choices": [
            {
              "id": "c3",
              "text": "Ignore the finding if there are no console alerts",
              "isCorrect": false,
              "explanation": "Findings should be validated; absence of console alerts doesn't mean no impact."
            },
            {
              "id": "c2",
              "text": "Temporarily revoke the role's active sessions pending investigation",
              "isCorrect": false,
              "explanation": "Revoking sessions can limit ongoing activity but is disruptive; triage and validation are usually performed first to scope impact before broad actions."
            },
            {
              "id": "c4",
              "text": "Assume GuardDuty is faulty and open a support ticket",
              "isCorrect": false,
              "explanation": "While false positives can occur, perform validation steps before concluding GuardDuty is wrong."
            },
            {
              "id": "c1",
              "text": "Retrieve CloudTrail management events for the role, query related CloudWatch Logs, and inspect resource changes",
              "isCorrect": true,
              "explanation": "Correlate GuardDuty findings with CloudTrail events and application logs to scope the impact and timeline."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Incident Response",
          "services": [
            "GuardDuty",
            "Security Hub",
            "EventBridge"
          ],
          "docs": "https://docs.aws.amazon.com/guardduty/latest/ug/what-is-guardduty.html",
          "tip": "Correlate detection alerts with audit trails and application logs to validate scope and impact.",
          "explanation": "Effective validation uses multiple data sources: CloudTrail shows API callers and timestamps; CloudWatch and application logs show resource-level effects and help identify affected assets."
        },
        {
          "id": "SCS-C03-0014",
          "question": "A data lake team manages a single S3 bucket accessed by multiple applications across different VPCs. They need to enforce that each application can only reach the bucket from its own VPC and can only access objects under its designated prefix. Which approach provides the strongest isolation with the least policy complexity?",
          "choices": [
            {
              "id": "c3",
              "text": "Create one VPC endpoint per VPC and use endpoint policies",
              "isCorrect": false,
              "explanation": "Endpoint policies are coarse for prefix-level scoping."
            },
            {
              "id": "c4",
              "text": "Replicate data into separate per-application buckets",
              "isCorrect": false,
              "explanation": "Replication increases cost and complexity."
            },
            {
              "id": "c1",
              "text": "Create a separate S3 Access Point for each application",
              "isCorrect": true,
              "explanation": "S3 Access Points allow per-application network and permission scoping against a shared bucket."
            },
            {
              "id": "c2",
              "text": "Write a single S3 bucket policy with separate statements per application",
              "isCorrect": false,
              "explanation": "A single bucket policy becomes difficult to manage and has size limits."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Data Protection",
          "services": [
            "S3",
            "IAM",
            "VPC",
            "PrivateLink"
          ],
          "docs": "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-points.html",
          "tip": "Think about network-scoped entry points that expose storage through controlled endpoints.",
          "explanation": "S3 Access Points provide named, per-application entry points to a bucket, each with its own policy and optional VPC restriction."
        },
        {
          "id": "SCS-C03-0054",
          "question": "What is a key operational difference between imported key material and AWS-generated KMS keys?",
          "choices": [
            {
              "id": "c3",
              "text": "Imported keys are free of charge for cross-region usage",
              "isCorrect": false,
              "explanation": "Billing is not the defining operational difference; cross-region use still requires correct configuration."
            },
            {
              "id": "c1",
              "text": "Imported key material may have restrictions on automatic rotation and cannot be exported by AWS; customer manages lifecycle",
              "isCorrect": true,
              "explanation": "Imported key material is under customer control for import/removal and has different rotation/export characteristics than AWS-generated keys."
            },
            {
              "id": "c2",
              "text": "Imported key material automatically rotates daily",
              "isCorrect": false,
              "explanation": "Automatic daily rotation is not a feature of imported key material; rotation must be managed by the customer."
            },
            {
              "id": "c4",
              "text": "AWS may export imported key material to other customers",
              "isCorrect": false,
              "explanation": "AWS does not export customer-imported key material; it's managed per customer account/CMK."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Data Protection",
          "services": [
            "KMS",
            "CloudHSM",
            "Secrets Manager"
          ],
          "docs": "https://docs.aws.amazon.com/KMS/latest/developerguide/importing-keys.html",
          "tip": "Imported key material imposes additional lifecycle and rotation responsibilities on the customer.",
          "explanation": "Choosing imported key material affects rotation, import windows, and export constraints; plan operational processes accordingly."
        },
        {
          "id": "SCS-C03-0062",
          "question": "How should a CI/CD pipeline handle high-severity image vulnerabilities discovered by Inspector to enforce security gates?",
          "choices": [
            {
              "id": "c3",
              "text": "Ignore Inspector findings as false positives",
              "isCorrect": false,
              "explanation": "Blindly ignoring findings removes an important safety mechanism; investigate and triage findings appropriately."
            },
            {
              "id": "c1",
              "text": "Fail the build when high-severity vulnerabilities are found and require a remediation PR before promotion",
              "isCorrect": true,
              "explanation": "Blocking promotion of vulnerable images enforces security gates and prevents vulnerable artifacts from reaching production."
            },
            {
              "id": "c2",
              "text": "Allow the build but schedule a follow-up ticket",
              "isCorrect": false,
              "explanation": "Allowing promotion undermines enforcement and risks running vulnerable code in production."
            },
            {
              "id": "c4",
              "text": "Convert vulnerabilities into user stories without blocking releases",
              "isCorrect": false,
              "explanation": "Converting to backlog items without blocking promotion fails to protect production environments."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Infrastructure Security",
          "services": [
            "Inspector",
            "Security Hub",
            "Lambda"
          ],
          "docs": "https://docs.aws.amazon.com/inspector/latest/userguide/inspector_introduction.html",
          "tip": "Enforce CI gates for critical vulnerabilities and require remediation before promotion.",
          "explanation": "Integrating Inspector into CI/CD and failing builds for critical findings reduces the chance of vulnerable artifacts reaching production and ensures remediation is required."
        },
        {
          "id": "SCS-C03-0027",
          "question": "A security team has an AWS Config rule that detects S3 buckets without default encryption enabled. They want Config to automatically remediate non-compliant buckets by applying AES-256 server-side encryption. Which CloudFormation snippet correctly defines the auto-remediation action?",
          "choices": [
            {
              "id": "c3",
              "text": "Add a ComplianceResourceTypes property to the Config rule that triggers an SNS notification, then subscribe a Lambda function to apply encryption",
              "isCorrect": false,
              "explanation": "This creates a notification pipeline, not an automatic remediation. It also requires custom SNS-to-Lambda wiring and does not use Config's built-in remediation feature."
            },
            {
              "id": "c4",
              "text": "Use an EventBridge rule to detect Config compliance change events and invoke a Step Functions workflow",
              "isCorrect": false,
              "explanation": "While this architecture works, it bypasses Config's native remediation capability, introducing more components to build and maintain. The question asks for Config auto-remediation."
            },
            {
              "id": "c1",
              "text": "Type: AWS::Config::RemediationConfiguration\nProperties:\n  ConfigRuleName: s3-bucket-server-side-encryption-enabled\n  TargetType: SSM_DOCUMENT\n  TargetId: AWS-EnableS3BucketEncryption\n  Automatic: true\n  MaximumAutomaticAttempts: 3\n  RetryAttemptSeconds: 60\n  Parameters:\n    BucketName:\n      ResourceValue:\n        Value: RESOURCE_ID",
              "isCorrect": true,
              "explanation": "This uses an AWS-provided SSM Automation document to enable encryption on the non-compliant bucket. TargetType SSM_DOCUMENT and the RESOURCE_ID placeholder correctly bind the remediation to the flagged resource."
            },
            {
              "id": "c2",
              "text": "Type: AWS::Config::RemediationConfiguration\nProperties:\n  ConfigRuleName: s3-bucket-server-side-encryption-enabled\n  TargetType: LAMBDA\n  TargetId: arn:aws:lambda:us-east-1:123456789012:function:fix-encryption\n  Automatic: true",
              "isCorrect": false,
              "explanation": "Config remediation currently only supports SSM_DOCUMENT as a TargetType. Lambda functions cannot be used directly as remediation targets in a RemediationConfiguration resource."
            }
          ],
          "selectCount": 1,
          "format": "yaml",
          "domain": "Detection",
          "services": [
            "Config",
            "Systems Manager",
            "S3",
            "Lambda"
          ],
          "docs": "https://docs.aws.amazon.com/config/latest/developerguide/remediation.html",
          "tip": "Automatic remediation mechanisms commonly invoke automation documents or playbooks rather than ad-hoc functions.",
          "explanation": "AWS Config remediation actions invoke SSM Automation documents to fix non-compliant resources. AWS provides pre-built documents like AWS-EnableS3BucketEncryption. Setting Automatic to true and configuring retry parameters ensures Config will apply the fix without manual intervention whenever a drift is detected."
        },
        {
          "id": "SCS-C03-0055",
          "question": "Which pattern centralizes billing, consolidated policies, and delegated security administration across many accounts?",
          "choices": [
            {
              "id": "c1",
              "text": "Use AWS Organizations with an organizational management account, OUs for environment separation, and delegated admin roles",
              "isCorrect": true,
              "explanation": "Organizations centralize management, apply SCPs, and enable delegated admin accounts for service management across member accounts."
            },
            {
              "id": "c2",
              "text": "Manage each account independently with separate billing",
              "isCorrect": false,
              "explanation": "Independent accounts increase operational overhead and hinder centralized policy enforcement."
            },
            {
              "id": "c4",
              "text": "Delegate everything to third-party SaaS governance tools only",
              "isCorrect": false,
              "explanation": "Third-party tools can help but AWS Organizations provides foundational native patterns for central control."
            },
            {
              "id": "c3",
              "text": "Use a single shared AWS account for all teams",
              "isCorrect": false,
              "explanation": "A single account lacks isolation and governance for multiple teams or environments."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Security Foundations and Governance",
          "services": [
            "Organizations",
            "IAM",
            "CloudTrail"
          ],
          "docs": "https://docs.aws.amazon.com/whitepapers/latest/aws-security-best-practices/overview.html",
          "tip": "Organize accounts with OUs and delegated administration for scale and governance.",
          "explanation": "AWS Organizations supports centralized billing, SCPs for guardrails, and delegated admin roles for services such as GuardDuty or Security Hub, enabling scalable governance."
        },
        {
          "id": "SCS-C03-0010",
          "question": "You must prevent any account in your Org from launching EC2 instances outside eu-west-1 and eu-west-2 which preventive control should you apply across the organization?",
          "choices": [
            {
              "id": "c1",
              "text": "Attach a Service Control Policy (SCP) to the organisation root or target OUs that denies ec2:RunInstances unless the aws:RequestedRegion condition matches eu-west-1 or eu-west-2",
              "isCorrect": true,
              "explanation": "SCPs set maximum permission boundaries across all accounts in an OU or organisation, overriding any IAM policy within those accounts."
            },
            {
              "id": "c4",
              "text": "Use a CloudFormation StackSet with a hook that blocks ec2:RunInstances in disallowed regions",
              "isCorrect": false,
              "explanation": "CloudFormation hooks validate CloudFormation-managed resources only, not direct API calls or console launches."
            },
            {
              "id": "c3",
              "text": "Deploy an AWS Config rule that evaluates EC2 instances and flags any launched outside the allowed regions as non-compliant",
              "isCorrect": false,
              "explanation": "Config rules are detective, not preventive - the instance would already be running before Config flags it."
            },
            {
              "id": "c2",
              "text": "Create an IAM policy in each account that denies ec2:RunInstances outside eu-west-1 and eu-west-2, and attach it to every IAM user and role",
              "isCorrect": false,
              "explanation": "Per-account IAM policies can be removed by local administrators, and new users or roles might not receive the policy."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Identity and Access Management",
          "services": [
            "Organizations",
            "IAM",
            "Config",
            "CloudFormation"
          ],
          "docs": "https://docs.aws.amazon.com/organizations/latest/userguide/orgs_manage_policies_scps.html",
          "tip": "When account-wide preventive guardrails are required, use centralized policy mechanisms.",
          "explanation": "Service Control Policies (SCPs) in AWS Organizations act as guardrails that define the maximum permissions available to all principals in member accounts."
        },
        {
          "id": "SCS-C03-0060",
          "question": "Which strategy reduces cost while preserving required retention for infrequently accessed file data?",
          "choices": [
            {
              "id": "c3",
              "text": "Manually archive files to local tape every quarter",
              "isCorrect": false,
              "explanation": "Manual processes are error-prone and lack automation and auditability."
            },
            {
              "id": "c2",
              "text": "Keep all data on high-performance SSD tiers indefinitely",
              "isCorrect": false,
              "explanation": "Retaining everything on high-cost tiers is inefficient and expensive."
            },
            {
              "id": "c4",
              "text": "Delete older data to save cost without retention requirements",
              "isCorrect": false,
              "explanation": "Deletion may violate retention and compliance requirements."
            },
            {
              "id": "c1",
              "text": "Use lifecycle policies to move infrequently accessed data to lower-cost storage tiers such as EFS Infrequent Access or archival destinations",
              "isCorrect": true,
              "explanation": "Lifecycle policies move data automatically to cheaper tiers while retaining access and meeting retention policies."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Data Protection",
          "services": [
            "EFS",
            "Lifecycle",
            "S3 Glacier"
          ],
          "docs": "https://docs.aws.amazon.com/efs/latest/ug/what-is-efs.html",
          "tip": "Automate lifecycle transitions to lower-cost tiers based on access patterns.",
          "explanation": "Automated lifecycle policies balance cost and retention by moving data to appropriate storage classes based on age and access frequency."
        },
        {
          "id": "SCS-C03-0046",
          "question": "Faced with application-layer bot traffic and volumetric DDoS, which combined edge strategy provides layered protection?",
          "choices": [
            {
              "id": "c2",
              "text": "Only enable security groups at the origin",
              "isCorrect": false,
              "explanation": "Security groups do not protect the global edge nor mitigate volumetric attacks effectively."
            },
            {
              "id": "c3",
              "text": "Rely on client-side Captcha only",
              "isCorrect": false,
              "explanation": "Client-side controls can be bypassed and don't handle volumetric network-level attacks."
            },
            {
              "id": "c1",
              "text": "Use AWS Shield Advanced for DDoS and AWS WAF at CloudFront for application-layer filtering",
              "isCorrect": true,
              "explanation": "Shield Advanced mitigates volumetric network attacks while WAF filters application-layer patterns such as bots and OWASP threats."
            },
            {
              "id": "c4",
              "text": "Increase EC2 instance sizes behind the load balancer",
              "isCorrect": false,
              "explanation": "Scaling instances may help capacity but does not stop DDoS or malicious application-layer requests at the edge."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Infrastructure Security",
          "services": [
            "WAF",
            "CloudFront",
            "Shield"
          ],
          "docs": "https://docs.aws.amazon.com/waf/latest/developerguide/waf-chapter.html",
          "tip": "Defence-in-depth at the edge combines network- and application-layer protections.",
          "explanation": "Defence in depth: Shield Advanced for volumetric and network-layer attacks, WAF for application-layer patterns, and CloudFront for caching and geographic distribution."
        },
        {
          "id": "SCS-C03-0003",
          "question": "You need to block malicious HTTP traffic before it reaches your origin which service should you pair with CloudFront to filter requests at the edge?",
          "choices": [
            {
              "id": "c1",
              "text": "AWS WAF",
              "isCorrect": true,
              "explanation": "AWS WAF is the web application firewall used with CloudFront to filter HTTP(S) traffic."
            },
            {
              "id": "c4",
              "text": "AWS KMS",
              "isCorrect": false,
              "explanation": "AWS KMS is for key management and encryption, not traffic filtering."
            },
            {
              "id": "c2",
              "text": "Security Groups",
              "isCorrect": false,
              "explanation": "Security Groups control traffic to EC2 at the instance level, not the CloudFront edge."
            },
            {
              "id": "c3",
              "text": "VPC Endpoint",
              "isCorrect": false,
              "explanation": "VPC Endpoints provide private connectivity to services within a VPC, not edge HTTP filtering."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Infrastructure Security",
          "services": [
            "WAF",
            "CloudFront",
            "Security Groups"
          ],
          "docs": "https://docs.aws.amazon.com/waf/latest/developerguide/waf-chapter.html",
          "tip": "Consider application-layer filtering at the edge to block common web attack patterns.",
          "explanation": "AWS WAF integrates natively with CloudFront, ALB, and API Gateway to inspect and filter HTTP(S) requests using rules such as rate limiting and SQL injection detection."
        },
        {
          "id": "SCS-C03-0034",
          "question": "A media company serves video content from S3 through CloudFront. They need to ensure users cannot bypass CloudFront and access S3 directly via the bucket URL. The solution must work with SSE-KMS encrypted objects. Which approach correctly restricts S3 access to CloudFront only?",
          "choices": [
            {
              "id": "c1",
              "text": "Create a CloudFront Origin Access Control (OAC) and update the S3 bucket policy to allow access only from the OAC",
              "isCorrect": true,
              "explanation": "OAC is the recommended method for restricting S3 access to CloudFront. Unlike the legacy OAI, OAC supports SSE-KMS, S3 Object Lock, and all S3 features. The bucket policy uses aws:SourceArn to allow only the specific CloudFront distribution."
            },
            {
              "id": "c3",
              "text": "Make the S3 bucket a website endpoint origin in CloudFront and restrict access with a Referer header condition in the bucket policy",
              "isCorrect": false,
              "explanation": "Website endpoint origins use HTTP (not the S3 API), don't support SSE-KMS, and Referer headers can be spoofed, making this both incompatible and insecure."
            },
            {
              "id": "c4",
              "text": "Block public access on the bucket and share S3 pre-signed URLs directly with users instead of using CloudFront",
              "isCorrect": false,
              "explanation": "Pre-signed URLs bypass CloudFront entirely, losing edge caching, WAF protection, and geo-restriction capabilities. They also expose direct S3 access."
            },
            {
              "id": "c2",
              "text": "Create a CloudFront Origin Access Identity (OAI) and grant it read access in the S3 bucket policy",
              "isCorrect": false,
              "explanation": "OAI is the legacy approach and does not support SSE-KMS encrypted objects. CloudFront cannot forward the required SigV4 KMS headers when using OAI."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Infrastructure Security",
          "services": [
            "CloudFront",
            "S3",
            "OAC",
            "WAF"
          ],
          "docs": "https://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/private-content-restricting-access-to-s3.html",
          "tip": "Modern origin access controls replace older mechanisms and are required for certain advanced object features.",
          "explanation": "Origin Access Control (OAC) uses SigV4-signed requests from CloudFront to S3, which supports all S3 encryption modes including SSE-KMS. The S3 bucket policy can use the Condition key aws:SourceArn to restrict access to a specific CloudFront distribution ARN, ensuring no direct S3 access is possible."
        },
        {
          "id": "SCS-C03-0050",
          "question": "Which approach meets the requirement: rotate DB credentials every 30 days without redeploying applications?",
          "choices": [
            {
              "id": "c4",
              "text": "Rotate credentials manually and email them to developers",
              "isCorrect": false,
              "explanation": "Manual rotation and distribution is insecure and error-prone."
            },
            {
              "id": "c2",
              "text": "Bake credentials into container images and rebuild monthly",
              "isCorrect": false,
              "explanation": "Rebuilding images is operationally heavy and requires redeployment, which the requirement forbids."
            },
            {
              "id": "c3",
              "text": "Store credentials in SSM Parameter Store without rotation",
              "isCorrect": false,
              "explanation": "Parameter Store can store secrets but does not provide automated rotation like Secrets Manager."
            },
            {
              "id": "c1",
              "text": "Use AWS Secrets Manager rotation with a Lambda rotation function and have apps retrieve secrets at runtime",
              "isCorrect": true,
              "explanation": "Secrets Manager supports automatic rotation and applications that fetch secrets at runtime do not need redeployment."
            }
          ],
          "selectCount": 1,
          "format": "json",
          "domain": "Data Protection",
          "services": [
            "Secrets Manager",
            "IAM",
            "Lambda"
          ],
          "docs": "https://docs.aws.amazon.com/secretsmanager/latest/userguide/intro.html",
          "tip": "Prefer automated rotation and runtime retrieval of secrets to decouple credentials from deployments.",
          "explanation": "Automatic rotation decouples credential lifecycles from deployments; applications should fetch secrets at runtime to benefit from rotation without redeployments."
        },
        {
          "id": "SCS-C03-0036",
          "question": "A security platform team must deploy a hardened VPC, a set of IAM permission boundaries, and logging configuration to 15 existing AWS accounts. Changes must be automated via CI/CD, deployments must be auditable, and any account drift should be detectable centrally. The team also wants least-privilege for the agents that perform deployments. Which approach best satisfies these requirements?",
          "choices": [
            {
              "id": "c3",
              "text": "Use Terraform workspaces stored locally per account and have individual engineers apply changes when notified",
              "isCorrect": false,
              "explanation": "Local, manual Terraform applies lack centralized automation, auditability, and organization-level drift detection; they also increase risk of inconsistent state."
            },
            {
              "id": "c1",
              "text": "Create a parameterized CloudFormation module for the baseline, publish it to a central artifact repository, and deploy via CloudFormation StackSets (service-managed) from a CI/CD pipeline using delegated administrator roles; enable drift detection and record pipeline runs for auditability",
              "isCorrect": true,
              "explanation": "StackSets (service-managed) supports automated, organization-aware deployments driven by CI/CD, delegated admin roles provide least-privilege, and enabling drift detection plus CI/CD run logs provides centralized detection and an audit trail."
            },
            {
              "id": "c2",
              "text": "Let each account run CloudFormation stacks triggered manually by account owners, and collect logs centrally afterwards",
              "isCorrect": false,
              "explanation": "Manual, per-account deployments are not automated or easily auditable and do not provide centralized drift detection or consistent configuration."
            },
            {
              "id": "c4",
              "text": "Utilise AWS Control Tower guardrails to keep accounts compliant and make manual adjustments via the console for exceptions",
              "isCorrect": false,
              "explanation": "Control Tower provides guardrails and a landing zone but is not a full CI/CD-driven IaC deployment and does not replace an auditable, parameterized IaC pipeline for existing accounts at scale."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Security Foundations and Governance",
          "services": [
            "CloudFormation",
            "StackSets",
            "CI/CD",
            "Organizations"
          ],
          "docs": "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/what-is-cfn.html",
          "tip": "Use organization-aware IaC patterns integrated with CI/CD, delegated roles, and drift detection.",
          "explanation": "For consistent, auditable, and automated deployments across multiple accounts, an org-aware IaC pattern like CloudFormation StackSets driven by a CI/CD pipeline provides parameterized modules, centralized rollout, delegated administration for least-privilege, and drift detection to identify configuration divergence. This pattern satisfies automation, auditability, and centralized management requirements."
        },
        {
          "id": "SCS-C03-0013",
          "question": "An organisation wants to automatically isolate an EC2 instance when GuardDuty detects cryptocurrency mining activity. Which architecture achieves automated remediation with the least operational overhead?",
          "choices": [
            {
              "id": "c4",
              "text": "Use Systems Manager Automation runbooks triggered by a CPU alarm to stop instances",
              "isCorrect": false,
              "explanation": "CPU alarms are generic and can cause false positives."
            },
            {
              "id": "c1",
              "text": "Configure GuardDuty findings to flow into EventBridge and trigger a Lambda that isolates the instance",
              "isCorrect": true,
              "explanation": "EventBridge rules can filter GuardDuty finding types and invoke Lambda for automated remediation."
            },
            {
              "id": "c2",
              "text": "Enable Security Hub automated response playbooks to quarantine instances",
              "isCorrect": false,
              "explanation": "Security Hub aggregates findings but does not have built-in quarantine playbooks."
            },
            {
              "id": "c3",
              "text": "Schedule a Lambda to poll GuardDuty every five minutes and isolate flagged instances",
              "isCorrect": false,
              "explanation": "Polling introduces delay and extra maintenance."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Incident Response",
          "services": [
            "GuardDuty",
            "Security Hub",
            "EventBridge",
            "Lambda",
            "Systems Manager"
          ],
          "docs": "https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_finding-types-ec2.html",
          "tip": "Prefer event-driven, near-real-time response systems that require minimal maintenance for detections.",
          "explanation": "GuardDuty publishes findings to EventBridge in near-real-time, enabling immediate Lambda-driven remediation."
        },
        {
          "id": "SCS-C03-0041",
          "question": "When sizing monitoring for a high-throughput API, which combination of metrics should inform your alarm thresholds for availability and performance?",
          "choices": [
            {
              "id": "c1",
              "text": "Request count, 5xx error rate, and latency percentiles",
              "isCorrect": true,
              "explanation": "Combining request volume, error rates and latency percentiles gives a balanced view of availability and performance under load."
            },
            {
              "id": "c3",
              "text": "Number of open TCP connections to the VPC",
              "isCorrect": false,
              "explanation": "TCP connection counts may be noisy and do not directly indicate application-level errors or latency."
            },
            {
              "id": "c2",
              "text": "Only CPU utilization across EC2 instances",
              "isCorrect": false,
              "explanation": "CPU is useful but insufficient alone to detect request-level failures or latency spikes."
            },
            {
              "id": "c4",
              "text": "S3 bucket size growth",
              "isCorrect": false,
              "explanation": "S3 growth is unrelated to API availability metrics for request handling."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Detection",
          "services": [
            "CloudWatch",
            "CloudWatch Logs",
            "SNS"
          ],
          "docs": "https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/monitoring-overview.html",
          "tip": "Combine throughput, error rates, and latency percentiles to set robust thresholds.",
          "explanation": "A monitoring strategy should include throughput (request count), error rates (5xx), and latency percentiles (p95/p99) to detect degradation under load and trigger appropriate alerts."
        },
        {
          "id": "SCS-C03-0006",
          "question": "Your security team needs a single place for findings and strong key management for encrypted data which TWO services should they use together? (Select TWO)",
          "choices": [
            {
              "id": "c4",
              "text": "AWS CloudFormation",
              "isCorrect": false,
              "explanation": "CloudFormation is an infrastructure-as-code service, not a security findings tool."
            },
            {
              "id": "c3",
              "text": "Amazon SQS",
              "isCorrect": false,
              "explanation": "SQS is a message queuing service, not related to security findings or encryption."
            },
            {
              "id": "c5",
              "text": "Amazon EC2",
              "isCorrect": false,
              "explanation": "EC2 provides virtual machines, not security findings management."
            },
            {
              "id": "c1",
              "text": "AWS Security Hub",
              "isCorrect": true,
              "explanation": "Security Hub provides a comprehensive view of security alerts and compliance status across accounts."
            },
            {
              "id": "c2",
              "text": "AWS KMS",
              "isCorrect": true,
              "explanation": "KMS provides centralized encryption key management for encrypting data at rest."
            }
          ],
          "selectCount": 2,
          "format": "text",
          "domain": "Detection",
          "services": [
            "Security Hub",
            "KMS",
            "SQS",
            "CloudFormation",
            "EC2"
          ],
          "docs": "https://docs.aws.amazon.com/securityhub/latest/userguide/what-is-securityhub.html",
          "tip": "Consider centralizing findings and using strong key management practices.",
          "explanation": "Security Hub aggregates and normalizes findings and KMS provides the keys to encrypt sensitive data."
        },
        {
          "id": "SCS-C03-0040",
          "question": "Which combination of practices best secures the AWS account root user while preserving necessary break-glass access?",
          "choices": [
            {
              "id": "c4",
              "text": "Keep root access enabled for all admins but log usage to CloudTrail",
              "isCorrect": false,
              "explanation": "Allowing easy root access contradicts best practices even if logged; the preferred pattern is delegation and protected root credentials."
            },
            {
              "id": "c1",
              "text": "Enable MFA on the root account, store credentials in a secure offline vault, and use IAM administrative roles for daily operations",
              "isCorrect": true,
              "explanation": "Enforcing MFA, securing root credentials offline, and delegating daily administrative tasks to IAM roles minimizes root usage while preserving a secured break-glass path."
            },
            {
              "id": "c3",
              "text": "Remove MFA and rely on a complex password rotated monthly",
              "isCorrect": false,
              "explanation": "Removing MFA weakens security; passwords alone are insufficient for strong break-glass protections."
            },
            {
              "id": "c2",
              "text": "Share root credentials with the security team to ensure quick access during incidents",
              "isCorrect": false,
              "explanation": "Sharing root credentials increases blast radius and is contrary to least-privilege practices."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Security Foundations and Governance",
          "services": [
            "IAM",
            "Organizations",
            "Secrets Manager"
          ],
          "docs": "https://docs.aws.amazon.com/IAM/latest/UserGuide/id_root-user.html",
          "tip": "Minimize use of highly privileged accounts, enforce MFA, and delegate daily tasks to role-based identities.",
          "explanation": "AWS recommends enabling MFA on the root account, storing root credentials securely (e.g., an offline vault with restricted access), and using IAM roles and delegated administration for routine tasks to reduce risk and provide an auditable break-glass process."
        },
        {
          "id": "SCS-C03-0032",
          "question": "A security team discovers that malware on compromised EC2 instances is using DNS queries to known command-and-control domains for data exfiltration. They need to block DNS resolution of these domains for all resources in the VPC without deploying custom DNS servers. Which service provides this capability?",
          "choices": [
            {
              "id": "c4",
              "text": "Enable GuardDuty DNS resolution monitoring to automatically block malicious domains",
              "isCorrect": false,
              "explanation": "GuardDuty detects and alerts on DNS queries to known malicious domains, but it does not block them. DNS Firewall provides the enforcement (blocking) capability."
            },
            {
              "id": "c1",
              "text": "Route 53 Resolver DNS Firewall with a block-list rule group associated to the VPC",
              "isCorrect": true,
              "explanation": "DNS Firewall lets you create domain lists and rule groups that block, allow, or alert on DNS queries made through the Route 53 Resolver. Associating a rule group to a VPC applies the rules to all DNS queries from that VPC."
            },
            {
              "id": "c2",
              "text": "AWS WAF with a custom rule to block DNS traffic patterns",
              "isCorrect": false,
              "explanation": "WAF operates on HTTP/HTTPS traffic at Layer 7. It cannot inspect or block DNS queries (UDP port 53) made by VPC resources to the Route 53 Resolver."
            },
            {
              "id": "c3",
              "text": "Create NACL rules to block outbound UDP port 53 to the internet",
              "isCorrect": false,
              "explanation": "Blocking port 53 outbound would break DNS resolution for all VPC resources, not just malicious queries. VPC DNS uses the Route 53 Resolver internally, so NACL rules do not affect VPC-internal DNS resolution."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Infrastructure Security",
          "services": [
            "Route 53",
            "Route 53 Resolver DNS Firewall",
            "VPC",
            "GuardDuty"
          ],
          "docs": "https://docs.aws.amazon.com/Route53/latest/DeveloperGuide/resolver-dns-firewall.html",
          "tip": "Consider pairing detection services with preventive controls to both find and block threats.",
          "explanation": "Route 53 Resolver DNS Firewall provides managed DNS-layer filtering within VPCs. You define domain lists (or import AWS-managed threat lists) and create rule groups with BLOCK, ALLOW, or ALERT actions. Associating the rule group to a VPC applies filtering to all Route 53 Resolver queries from that VPC."
        },
        {
          "id": "SCS-C03-0047",
          "question": "Which practice grants least-privilege permissions to pods running in EKS for accessing AWS APIs?",
          "choices": [
            {
              "id": "c3",
              "text": "Use instance metadata to share credentials across pods",
              "isCorrect": false,
              "explanation": "Instance metadata exposes node credentials and is not recommended for per-pod least-privilege."
            },
            {
              "id": "c2",
              "text": "Attach a broad IAM role to all worker nodes",
              "isCorrect": false,
              "explanation": "Node roles provide host-level permissions and risk privilege escalation from any pod to node-level permissions."
            },
            {
              "id": "c4",
              "text": "Store AWS keys in pod environment variables at build time",
              "isCorrect": false,
              "explanation": "Hard-coding keys in images is insecure and prevents rotation."
            },
            {
              "id": "c1",
              "text": "Use IRSA (IAM Roles for Service Accounts) to map service accounts to IAM roles with narrow permissions",
              "isCorrect": true,
              "explanation": "IRSA ties an IAM role to a Kubernetes service account, allowing fine-grained, pod-level permissions."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Identity and Access Management",
          "services": [
            "EKS",
            "IAM",
            "STS"
          ],
          "docs": "https://docs.aws.amazon.com/eks/latest/userguide/iam-roles-for-service-accounts.html",
          "tip": "Use workload-scoped identity mechanisms to grant narrow, auditable pod permissions.",
          "explanation": "IRSA provides workload identity that limits permissions to the specific service account and namespace, reducing blast radius and improving auditability."
        },
        {
          "id": "SCS-C03-0035",
          "question": "A CISO wants a single dashboard that shows the organisation's compliance posture against the CIS AWS Foundations Benchmark and the AWS Foundational Security Best Practices standard, with automated checks running continuously. Findings from GuardDuty and Inspector should also appear in the same view. Which TWO steps are required? (Select TWO)",
          "choices": [
            {
              "id": "c4",
              "text": "Deploy AWS Firewall Manager to enforce compliance checks across all accounts",
              "isCorrect": false,
              "explanation": "Firewall Manager manages WAF, Shield, and security group policies. It does not run CIS or Best Practices compliance checks or aggregate findings from GuardDuty and Inspector."
            },
            {
              "id": "c3",
              "text": "Create a custom CloudWatch dashboard aggregating Config, GuardDuty, and Inspector metrics",
              "isCorrect": false,
              "explanation": "CloudWatch dashboards show metrics and alarms, not security findings or compliance posture. Security Hub already provides the unified finding and compliance view."
            },
            {
              "id": "c2",
              "text": "Ensure AWS Config is enabled with recording turned on for all supported resource types",
              "isCorrect": true,
              "explanation": "Security Hub's compliance checks depend on AWS Config rules. If Config recording is not enabled, the automated checks cannot evaluate resource configurations and will produce no findings."
            },
            {
              "id": "c1",
              "text": "Enable AWS Security Hub and activate the CIS and Foundational Security Best Practices security standards",
              "isCorrect": true,
              "explanation": "Security Hub provides the unified dashboard and runs automated compliance checks against the selected standards using AWS Config rules it deploys automatically."
            },
            {
              "id": "c5",
              "text": "Manually export GuardDuty and Inspector findings to S3 and build QuickSight dashboards",
              "isCorrect": false,
              "explanation": "This creates a custom reporting pipeline but is not necessary. GuardDuty and Inspector integrate natively with Security Hub, sending findings automatically without manual export."
            }
          ],
          "selectCount": 2,
          "format": "text",
          "domain": "Detection",
          "services": [
            "Security Hub",
            "Config",
            "GuardDuty",
            "Firewall Manager",
            "Inspector"
          ],
          "docs": "https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards.html",
          "tip": "An aggregation service often depends on underlying compliance recording and service integrations to surface continuous checks.",
          "explanation": "Security Hub serves as the central security findings hub. It runs compliance checks by deploying Config rules for each control in the enabled standards, so AWS Config must be recording. GuardDuty and Inspector automatically send findings to Security Hub when both are enabled, providing the unified dashboard the CISO needs."
        },
        {
          "id": "SCS-C03-0017",
          "question": "A network security team must capture all accepted and rejected traffic metadata for forensic analysis across 200 VPCs in a multi-account organisation. They need to query weeks of historical data on demand without maintaining always-on infrastructure. Which architecture meets these requirements most cost-effectively?",
          "choices": [
            {
              "id": "c1",
              "text": "Publish VPC Flow Logs to a centralised S3 bucket in the security account and query with Amazon Athena",
              "isCorrect": true,
              "explanation": "S3 storage is inexpensive at scale, and Athena provides serverless on-demand querying with no infrastructure to manage. Flow Logs support direct S3 delivery across accounts via resource policies."
            },
            {
              "id": "c3",
              "text": "Stream Flow Logs to an Amazon OpenSearch cluster for real-time dashboards and historical search",
              "isCorrect": false,
              "explanation": "OpenSearch provides powerful search but requires always-on cluster infrastructure, violating the no-maintained-infrastructure requirement and increasing cost."
            },
            {
              "id": "c4",
              "text": "Enable Traffic Mirroring on all ENIs and capture full packets for analysis",
              "isCorrect": false,
              "explanation": "Traffic Mirroring captures full packet payloads, which is vastly more data than flow log metadata, increasing costs dramatically and exceeding what the team requested."
            },
            {
              "id": "c2",
              "text": "Send VPC Flow Logs to CloudWatch Logs in each account and use CloudWatch Logs Insights for queries",
              "isCorrect": false,
              "explanation": "CloudWatch Logs Insights works well for recent data but becomes expensive at high volume over weeks, and cross-account querying adds operational complexity compared to a centralised S3 approach."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Detection",
          "services": [
            "VPC Flow Logs",
            "CloudWatch Logs",
            "S3",
            "Athena"
          ],
          "docs": "https://docs.aws.amazon.com/vpc/latest/userguide/flow-logs.html",
          "tip": "For large volumes of historical logs, use object storage plus an on-demand query engine for cost-effective analysis.",
          "explanation": "VPC Flow Logs can deliver directly to S3 in Parquet format with Hive-compatible partitioning, and Athena charges only per query scanned. This combination handles cross-account aggregation at scale without provisioning or maintaining any infrastructure."
        },
        {
          "id": "SCS-C03-0015",
          "question": "A security team needs to provide shell access to EC2 instances in private subnets without opening SSH ports or managing bastion hosts, while maintaining a full audit trail of every command executed. Which solution meets these requirements?",
          "choices": [
            {
              "id": "c2",
              "text": "Deploy a bastion host with SSH key-based authentication",
              "isCorrect": false,
              "explanation": "Bastion hosts require open SSH ports and add operational burden."
            },
            {
              "id": "c4",
              "text": "VPN to the private subnet and SSH",
              "isCorrect": false,
              "explanation": "VPN plus SSH captures metadata but not command-level audit content."
            },
            {
              "id": "c3",
              "text": "EC2 Instance Connect",
              "isCorrect": false,
              "explanation": "Instance Connect still requires port 22 and does not natively log full session content."
            },
            {
              "id": "c1",
              "text": "Systems Manager Session Manager",
              "isCorrect": true,
              "explanation": "Session Manager establishes encrypted sessions through the SSM agent without opening inbound ports and can log sessions to S3 or CloudWatch Logs."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Infrastructure Security",
          "services": [
            "Systems Manager",
            "EC2",
            "IAM",
            "CloudTrail"
          ],
          "docs": "https://docs.aws.amazon.com/systems-manager/latest/userguide/session-manager.html",
          "tip": "Consider agent-based session access that avoids exposing SSH/RDP ports.",
          "explanation": "Session Manager uses the SSM agent to create encrypted, IAM-authenticated sessions without inbound security group rules and logs session output for auditing."
        },
        {
          "id": "SCS-C03-0021",
          "question": "A company needs to inspect all egress traffic from its VPC for data exfiltration patterns using Suricata-compatible IDS/IPS rules at the network layer. Security Groups and NACLs are already in place for basic access control. Which service should they deploy?",
          "choices": [
            {
              "id": "c4",
              "text": "Configure more restrictive NACLs on the VPC subnets",
              "isCorrect": false,
              "explanation": "NACLs are stateless IP/port filters. They cannot inspect packet payloads or apply IDS/IPS signature-based rules."
            },
            {
              "id": "c3",
              "text": "Tighten Security Group outbound rules to restrict destination IPs",
              "isCorrect": false,
              "explanation": "Security Groups provide stateful allow/deny by IP and port but cannot perform deep packet inspection or pattern-based detection of data exfiltration."
            },
            {
              "id": "c1",
              "text": "AWS Network Firewall",
              "isCorrect": true,
              "explanation": "Network Firewall is a managed, stateful network firewall that supports Suricata-compatible rules for deep packet inspection, IDS/IPS, and domain-based filtering on both ingress and egress traffic."
            },
            {
              "id": "c2",
              "text": "AWS WAF",
              "isCorrect": false,
              "explanation": "WAF operates at Layer 7 (HTTP/HTTPS) and integrates with CloudFront, ALB, and API Gateway. It cannot inspect arbitrary TCP/UDP egress traffic or run Suricata rules."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Infrastructure Security",
          "services": [
            "Network Firewall",
            "WAF",
            "Security Groups",
            "NACLs"
          ],
          "docs": "https://docs.aws.amazon.com/network-firewall/latest/developerguide/what-is-aws-network-firewall.html",
          "tip": "Deep packet inspection and IDS/IPS operate at different layers than security groups or application firewalls.",
          "explanation": "AWS Network Firewall sits in-line in VPC traffic paths (via Gateway Load Balancer endpoints or firewall subnets) and evaluates packets against stateful Suricata-compatible rule groups. It fills the gap between simple Security Group/NACL controls and full deep-packet inspection requirements."
        },
        {
          "id": "SCS-C03-0001",
          "question": "You're the security lead for a multi-account AWS environment. Which AWS service helps aggregate and analyze security findings across accounts?",
          "choices": [
            {
              "id": "c2",
              "text": "AWS Config",
              "isCorrect": false,
              "explanation": "AWS Config tracks resource configuration and compliance, not threat detection."
            },
            {
              "id": "c3",
              "text": "AWS WAF",
              "isCorrect": false,
              "explanation": "AWS WAF is a web application firewall focused on HTTP(S) protections."
            },
            {
              "id": "c1",
              "text": "Amazon GuardDuty",
              "isCorrect": true,
              "explanation": "GuardDuty is a threat detection service that continuously monitors for malicious activity and unauthorized behavior."
            },
            {
              "id": "c4",
              "text": "Amazon SNS",
              "isCorrect": false,
              "explanation": "Amazon SNS is a notification service, not a security findings aggregator."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Detection",
          "services": [
            "GuardDuty",
            "Config",
            "WAF",
            "SNS"
          ],
          "docs": "https://docs.aws.amazon.com/guardduty/latest/ug/what-is-guardduty.html",
          "tip": "Consider a managed threat-detection service that finds anomalous activity using threat intelligence and ML.",
          "explanation": "Amazon GuardDuty uses ML models and threat intelligence feeds to continuously detect threats across accounts. The closest wrong answer is AWS Config, which evaluates resource configuration compliance, whereas GuardDuty detects active threats."
        },
        {
          "id": "SCS-C03-0024",
          "question": "A security architect wants to continuously detect any S3 buckets, IAM roles, KMS keys, or Lambda functions that are shared with external AWS accounts or public access. The solution must generate findings automatically without requiring custom code. Which service should they enable?",
          "choices": [
            {
              "id": "c4",
              "text": "Amazon GuardDuty",
              "isCorrect": false,
              "explanation": "GuardDuty detects threats based on anomalous behaviour and threat intelligence. It does not analyze resource policies to find intentional cross-account sharing or public access grants."
            },
            {
              "id": "c2",
              "text": "AWS Config with the s3-bucket-public-read-prohibited managed rule",
              "isCorrect": false,
              "explanation": "This Config rule only checks S3 public read access. It does not cover cross-account sharing of IAM roles, KMS keys, or Lambda functions."
            },
            {
              "id": "c3",
              "text": "AWS Trusted Advisor security checks",
              "isCorrect": false,
              "explanation": "Trusted Advisor checks a limited set of security best practices (e.g., open security groups, root MFA) but does not perform policy-level analysis of cross-account resource sharing."
            },
            {
              "id": "c1",
              "text": "IAM Access Analyzer",
              "isCorrect": true,
              "explanation": "Access Analyzer uses automated reasoning to analyze resource-based policies and identifies resources that are accessible from outside the zone of trust (account or organisation), generating findings for each."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Identity and Access Management",
          "services": [
            "IAM Access Analyzer",
            "IAM",
            "S3",
            "Lambda",
            "KMS"
          ],
          "docs": "https://docs.aws.amazon.com/IAM/latest/UserGuide/access-analyzer-getting-started.html",
          "tip": "Some tools perform policy-based analysis using logical reasoning rather than anomaly detection.",
          "explanation": "IAM Access Analyzer applies Zelkova-based automated reasoning to evaluate resource-based policies on S3 buckets, SQS queues, IAM roles, KMS keys, Lambda functions, and Secrets Manager secrets. It produces actionable findings whenever a policy grants access outside the defined zone of trust, with no custom code required."
        },
        {
          "id": "SCS-C03-0012",
          "question": "Which IAM mechanism lets you enforce that ceiling while preserving self-service?",
          "choices": [
            {
              "id": "c4",
              "text": "Use an SCP to deny iam:CreateRole for all developers and have the platform team create roles on request",
              "isCorrect": false,
              "explanation": "This removes developer self-service entirely, creating operational bottlenecks without enabling delegation."
            },
            {
              "id": "c1",
              "text": "Require developers to attach a permissions boundary to every role they create",
              "isCorrect": true,
              "explanation": "Permissions boundaries cap the maximum permissions a role can have, even if the role's identity policy grants broader access."
            },
            {
              "id": "c3",
              "text": "Create a single shared Lambda execution role managed by the platform team",
              "isCorrect": false,
              "explanation": "A shared role works but violates least privilege because all functions share the same permissions regardless of their needs."
            },
            {
              "id": "c2",
              "text": "Grant developers iam:CreateRole but restrict the role's trust policy to lambda.amazonaws.com only",
              "isCorrect": false,
              "explanation": "Restricting the trust policy limits who can assume the role, but does not limit what permissions the role itself can have."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Identity and Access Management",
          "services": [
            "IAM",
            "Organizations",
            "STS"
          ],
          "docs": "https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies_boundaries.html",
          "tip": "Consider permission boundary patterns to limit maximum permissions while enabling self-service.",
          "explanation": "IAM permissions boundaries act as a ceiling on the effective permissions of a role or user."
        },
        {
          "id": "SCS-C03-0065",
          "question": "Which integration allows custom request inspection logic at the edge before forwarding to the origin?",
          "choices": [
            {
              "id": "c4",
              "text": "Rely on DNS-level filtering for application-layer inspection",
              "isCorrect": false,
              "explanation": "DNS filtering cannot inspect HTTP request content for application-layer threats."
            },
            {
              "id": "c3",
              "text": "Only use origin-side web servers to inspect requests",
              "isCorrect": false,
              "explanation": "Origin-side inspection allows attacks to reach the origin and increases bandwidth and processing costs."
            },
            {
              "id": "c2",
              "text": "Use SQS between CloudFront and origin for inspection",
              "isCorrect": false,
              "explanation": "SQS is asynchronous and not suitable for synchronous request inspection at the edge."
            },
            {
              "id": "c1",
              "text": "Use CloudFront with Lambda@Edge (or CloudFront Functions) to run custom inspection and modify requests",
              "isCorrect": true,
              "explanation": "Lambda@Edge or CloudFront Functions can execute custom logic during request/response flows at the edge to inspect or mutate requests."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Infrastructure Security",
          "services": [
            "WAF",
            "CloudFront",
            "Lambda"
          ],
          "docs": "https://docs.aws.amazon.com/waf/latest/developerguide/waf-rule-statement-type.html",
          "tip": "Use edge compute to execute lightweight request inspection close to the client before reaching the origin.",
          "explanation": "Placing lightweight inspection at the edge reduces origin load and enables early mitigation of malicious requests before they traverse the network to backend systems."
        },
        {
          "id": "SCS-C03-0061",
          "question": "Which solution ensures centralized, policy-driven backups across RDS and EFS with retention controls?",
          "choices": [
            {
              "id": "c2",
              "text": "Create per-service scripts to snapshot data and copy to S3",
              "isCorrect": false,
              "explanation": "Custom scripts lack centralized policy management and consistent retention enforcement."
            },
            {
              "id": "c4",
              "text": "Rely on EC2 AMI snapshots for database backups",
              "isCorrect": false,
              "explanation": "AMI snapshots are not suitable for database-consistent backups across services without application-level coordination."
            },
            {
              "id": "c1",
              "text": "Use AWS Backup with backup plans and vaults to centrally manage backups and retention",
              "isCorrect": true,
              "explanation": "AWS Backup centralizes backups across supported services and enforces retention and lifecycle rules via backup plans and vaults."
            },
            {
              "id": "c3",
              "text": "Use cross-region replication for S3 only",
              "isCorrect": false,
              "explanation": "S3 replication is specific to S3 and doesn't manage backups for other services like RDS/EFS."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Data Protection",
          "services": [
            "AWS Backup",
            "RDS",
            "S3"
          ],
          "docs": "https://docs.aws.amazon.com/backup/latest/devguide/whatisbackup.html",
          "tip": "Use a centralized backup orchestration service to manage retention and policies across supported resources.",
          "explanation": "AWS Backup simplifies centralized backup orchestration, retention policies, and cross-account/cross-region copy workflows for supported AWS resources."
        },
        {
          "id": "SCS-C03-0039",
          "question": "To ensure all client connections to an internet-facing application use modern TLS ciphers and automated certificate rotation, which configuration should be used on the load balancer?",
          "choices": [
            {
              "id": "c1",
              "text": "Configure an HTTPS listener with an ACM-issued certificate and a recommended TLS security policy",
              "isCorrect": true,
              "explanation": "An HTTPS listener with an ACM-managed certificate ensures automated renewals and pairing with a recommended security policy enforces modern TLS ciphers and protocol versions."
            },
            {
              "id": "c3",
              "text": "Rely solely on security groups to restrict plaintext access",
              "isCorrect": false,
              "explanation": "Security groups control network access but do not provide TLS encryption or manage certificates."
            },
            {
              "id": "c2",
              "text": "Use an HTTP listener and perform TLS termination on backend instances",
              "isCorrect": false,
              "explanation": "Terminating TLS on backend instances increases operational complexity and loses benefits of managed certificate rotation; it also may expose traffic if not configured properly."
            },
            {
              "id": "c4",
              "text": "Use self-signed certificates deployed to each client",
              "isCorrect": false,
              "explanation": "Self-signed certificates are not practical for public internet-facing services and do not support automated rotation and trust by clients."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Data Protection",
          "services": [
            "ALB",
            "ACM",
            "Route 53"
          ],
          "docs": "https://docs.aws.amazon.com/elasticloadbalancing/latest/application/create-https-listener.html",
          "tip": "Terminate TLS at the edge with managed certificates and enforce modern cipher and protocol policies.",
          "explanation": "ACM-managed certificates integrate with ALB listeners for seamless rotation; pairing them with an appropriate security policy ensures modern ciphers and protocol versions without manual certificate management."
        },
        {
          "id": "SCS-C03-0028",
          "question": "A data engineering team needs their Lambda function to decrypt objects in an S3 bucket that uses SSE-KMS with a customer-managed key. The function's execution role has s3:GetObject permission. Decryption attempts fail with AccessDeniedException from KMS. Which key policy statement, added to the CMK, resolves this?",
          "choices": [
            {
              "id": "c1",
              "text": "{\"Sid\":\"AllowLambdaDecrypt\",\"Effect\":\"Allow\",\"Principal\":{\"AWS\":\"arn:aws:iam::123456789012:role/lambda-exec-role\"},\"Action\":[\"kms:Decrypt\",\"kms:DescribeKey\"],\"Resource\":\"*\"}",
              "isCorrect": true,
              "explanation": "The Lambda execution role needs kms:Decrypt (to decrypt the data key protecting the S3 object) and kms:DescribeKey (to validate the key). The key policy must explicitly grant these actions to the role's ARN."
            },
            {
              "id": "c3",
              "text": "Add kms:Decrypt to the Lambda execution role's IAM policy without changing the key policy",
              "isCorrect": false,
              "explanation": "For customer-managed KMS keys, both the key policy AND the IAM policy must allow the action. If the key policy does not grant access to the principal, the IAM policy alone is insufficient."
            },
            {
              "id": "c4",
              "text": "Change the bucket encryption from SSE-KMS to SSE-S3 to avoid the KMS dependency",
              "isCorrect": false,
              "explanation": "Switching to SSE-S3 would eliminate the error, but it removes the ability to control access through KMS key policies, audit key usage via CloudTrail, and use customer-managed key rotation, which may be required by policy."
            },
            {
              "id": "c2",
              "text": "{\"Sid\":\"AllowLambdaDecrypt\",\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"lambda.amazonaws.com\"},\"Action\":[\"kms:Decrypt\"],\"Resource\":\"*\"}",
              "isCorrect": false,
              "explanation": "KMS key policies should grant permissions to the IAM role, not to the Lambda service principal. The service principal is used in trust policies, not key policies."
            }
          ],
          "selectCount": 1,
          "format": "json",
          "domain": "Data Protection",
          "services": [
            "KMS",
            "IAM",
            "S3",
            "Lambda"
          ],
          "docs": "https://docs.aws.amazon.com/kms/latest/developerguide/key-policy-modifying.html",
          "tip": "Customer-managed keys often require permissions in both the key's policy and the caller's identity policy.",
          "explanation": "Customer-managed KMS keys use a resource-based policy (key policy) that must explicitly allow principals to perform cryptographic operations. Unlike AWS-managed keys, there is no automatic cross-grant. Both the key policy and the IAM policy on the caller must allow the action for it to succeed."
        },
        {
          "id": "SCS-C03-0053",
          "question": "Which strategy enables workload access policies that scale with many teams and dynamic resources in AWS?",
          "choices": [
            {
              "id": "c3",
              "text": "Hardcode permissions into application config files",
              "isCorrect": false,
              "explanation": "Hardcoding is insecure and prevents centralized management and auditing."
            },
            {
              "id": "c4",
              "text": "Rely solely on VPC-level security groups for access control",
              "isCorrect": false,
              "explanation": "Security groups operate at network level, not at identity/attribute level."
            },
            {
              "id": "c2",
              "text": "Create a single monolithic admin role for all teams",
              "isCorrect": false,
              "explanation": "Monolithic roles violate least privilege and do not scale well."
            },
            {
              "id": "c1",
              "text": "Use ABAC with tags to grant permissions based on attributes such as department or environment",
              "isCorrect": true,
              "explanation": "ABAC provides scalable, attribute-based permissions without creating many static IAM policies per resource."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Identity and Access Management",
          "services": [
            "EKS",
            "IAM",
            "KMS"
          ],
          "docs": "https://docs.aws.amazon.com/eks/latest/userguide/security_iam.html",
          "tip": "Use attribute-based access control (ABAC) with tags for scalable permission models.",
          "explanation": "ABAC allows policies to reference resource or principal tags, reducing policy proliferation while enabling fine-grained access control aligned to organizational attributes."
        },
        {
          "id": "SCS-C03-0057",
          "question": "Which approach supports zero-downtime TLS certificate renewal for multiple subdomains?",
          "choices": [
            {
              "id": "c3",
              "text": "Use a wildcard cert imported into each instance",
              "isCorrect": false,
              "explanation": "Importing certificates to instances complicates automation and rotation compared to ACM."
            },
            {
              "id": "c4",
              "text": "Disable TLS and rely on internal network controls",
              "isCorrect": false,
              "explanation": "TLS should be used; ACM simplifies automated renewals."
            },
            {
              "id": "c2",
              "text": "Use self-signed certs rotated manually via SSH",
              "isCorrect": false,
              "explanation": "Manual self-signed rotation risks downtime and trust issues."
            },
            {
              "id": "c1",
              "text": "Use ACM certificates with DNS validation and attach to ALB listeners",
              "isCorrect": true,
              "explanation": "ACM issues public certificates that renew automatically when DNS validation is used; ALB integration ensures rotation without downtime."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Data Protection",
          "services": [
            "ACM",
            "Route 53",
            "ALB"
          ],
          "docs": "https://docs.aws.amazon.com/acm/latest/userguide/acm-certificate.html",
          "tip": "Prefer provider-issued certificates with an automated validation method for renewals.",
          "explanation": "ACM manages the lifecycle of certificates it issues and integrates with ALB/CloudFront to rotate certificates transparently."
        },
        {
          "id": "SCS-C03-0031",
          "question": "During an incident investigation, an analyst has shell access to a compromised EC2 instance and needs to determine which IAM identity the instance is currently using to make AWS API calls. Which CLI command reveals this information?",
          "choices": [
            {
              "id": "c3",
              "text": "aws ec2 describe-instances --instance-id $(curl -s http://169.254.169.254/latest/meta-data/instance-id)",
              "isCorrect": false,
              "explanation": "describe-instances shows instance metadata including the IamInstanceProfile association, but the response contains the profile ARN, not the currently assumed role ARN with session details. get-caller-identity is more direct."
            },
            {
              "id": "c2",
              "text": "aws iam get-user",
              "isCorrect": false,
              "explanation": "get-user returns information about an IAM user. On an instance using a role (not a user), this command fails because the caller is not an IAM user."
            },
            {
              "id": "c1",
              "text": "aws sts get-caller-identity",
              "isCorrect": true,
              "explanation": "This command returns the UserId, Account, and ARN of the IAM identity (user, role, or federated identity) making the request. On an EC2 instance, it reveals the instance profile role."
            },
            {
              "id": "c4",
              "text": "curl http://169.254.169.254/latest/meta-data/iam/security-credentials/",
              "isCorrect": false,
              "explanation": "This metadata endpoint lists the instance profile role name and can retrieve temporary credentials, but it does not show the full ARN or account ID. It also does not detect if the instance is using a different assumed role via manual STS calls."
            }
          ],
          "selectCount": 1,
          "format": "cli",
          "domain": "Incident Response",
          "services": [
            "STS",
            "IAM",
            "CloudShell"
          ],
          "docs": "https://docs.aws.amazon.com/cli/latest/reference/sts/get-caller-identity.html",
          "tip": "Use standard identity calls to reveal the effective caller identity across contexts.",
          "explanation": "aws sts get-caller-identity is the quickest and most reliable way to determine the current AWS identity context. It works for all principal types and returns the ARN that appears in CloudTrail logs, making it invaluable during investigations."
        },
        {
          "id": "SCS-C03-0019",
          "question": "A financial services firm must store audit logs for seven years in a manner that no user, including root, can delete or modify them before the retention period expires. Regulators require proof of immutability. Which S3 feature satisfies these requirements?",
          "choices": [
            {
              "id": "c4",
              "text": "Enable MFA Delete on the S3 bucket to require MFA for all delete operations",
              "isCorrect": false,
              "explanation": "MFA Delete requires an additional authentication step but does not make objects truly immutable. A user with MFA can still delete them at any time."
            },
            {
              "id": "c1",
              "text": "S3 Object Lock in Compliance mode with a seven-year retention period",
              "isCorrect": true,
              "explanation": "Compliance mode prevents anyone, including the root user, from deleting or overwriting an object version until the retention date passes. This satisfies regulatory immutability requirements."
            },
            {
              "id": "c3",
              "text": "S3 Versioning with an S3 Lifecycle rule to transition objects to Glacier after 30 days",
              "isCorrect": false,
              "explanation": "Versioning preserves prior versions but does not prevent deletion of version markers. Glacier transition reduces cost but does not enforce immutability."
            },
            {
              "id": "c2",
              "text": "S3 Object Lock in Governance mode with a seven-year retention period",
              "isCorrect": false,
              "explanation": "Governance mode allows users with the s3:BypassGovernanceRetention permission to delete objects before the retention period ends, which does not meet the absolute immutability requirement."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Data Protection",
          "services": [
            "S3",
            "S3 Object Lock",
            "Glacier",
            "Backup"
          ],
          "docs": "https://docs.aws.amazon.com/AmazonS3/latest/userguide/object-lock.html",
          "tip": "Some retention features prevent even highly privileged users from removing locks; verify retention enforcement models.",
          "explanation": "S3 Object Lock Compliance mode creates a WORM (Write Once Read Many) storage model. Once set, neither the object nor its retention settings can be altered or deleted by any principal until the retention period expires, meeting SEC 17a-4(f) and similar regulatory requirements."
        },
        {
          "id": "SCS-C03-0004",
          "question": "You're designing a system that avoids long-lived keys. Which AWS feature helps enforce least privilege by issuing temporary credentials?",
          "choices": [
            {
              "id": "c4",
              "text": "Amazon Cognito",
              "isCorrect": false,
              "explanation": "Amazon Cognito provides user identity for apps, but the core mechanism for temporary AWS credentials is STS with roles."
            },
            {
              "id": "c1",
              "text": "IAM Roles with STS",
              "isCorrect": true,
              "explanation": "IAM Roles with STS allow issuance of temporary credentials for short-term access."
            },
            {
              "id": "c3",
              "text": "Security Groups",
              "isCorrect": false,
              "explanation": "Security Groups are network controls, not credential mechanisms."
            },
            {
              "id": "c2",
              "text": "IAM Users with long-term access keys",
              "isCorrect": false,
              "explanation": "IAM Users with long-term keys are not recommended for least-privilege patterns."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Identity and Access Management",
          "services": [
            "IAM",
            "STS",
            "Cognito"
          ],
          "docs": "https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles.html",
          "tip": "Prefer short-lived credentials rather than long-lived keys to reduce exposure.",
          "explanation": "IAM Roles combined with AWS STS issue temporary credentials that automatically expire, reducing blast radius if leaked."
        },
        {
          "id": "SCS-C03-0029",
          "question": "An organisation with 300 member accounts needs to enable GuardDuty in every account and every region, automatically including future accounts. All findings must be viewable from the security account. Which approach achieves this with the least ongoing maintenance?",
          "choices": [
            {
              "id": "c1",
              "text": "Designate a delegated administrator account for GuardDuty through AWS Organizations and enable the auto-enable feature for new member accounts",
              "isCorrect": true,
              "explanation": "The delegated administrator model in GuardDuty with auto-enable automatically activates GuardDuty in all current and future member accounts. Findings from all accounts are aggregated in the administrator account."
            },
            {
              "id": "c2",
              "text": "Send manual invitation requests from the security account to each of the 300 member accounts and accept them individually",
              "isCorrect": false,
              "explanation": "Manual invitations work but require per-account acceptance, do not auto-enrol future accounts, and become unmanageable at scale."
            },
            {
              "id": "c3",
              "text": "Deploy GuardDuty via a CloudFormation StackSet targeting all accounts and regions",
              "isCorrect": false,
              "explanation": "StackSets can enable GuardDuty but do not establish the administrator-member relationship needed to aggregate findings centrally, and they require additional work for auto-enabling in new accounts."
            },
            {
              "id": "c4",
              "text": "Enable Security Hub in the security account and it will automatically enable GuardDuty across all member accounts",
              "isCorrect": false,
              "explanation": "Security Hub aggregates findings from GuardDuty but does not enable or manage GuardDuty. They are independent services with separate enablement processes."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Detection",
          "services": [
            "GuardDuty",
            "Organizations",
            "Security Hub",
            "S3"
          ],
          "docs": "https://docs.aws.amazon.com/guardduty/latest/ug/what-is-guardduty.html",
          "tip": "Organization-level integrations allow services to be enabled and managed centrally across member accounts.",
          "explanation": "GuardDuty's Organizations integration allows a delegated administrator to manage GuardDuty across all member accounts centrally. The auto-enable feature ensures new accounts are automatically enrolled without manual intervention, and all findings flow to the administrator account for consolidated monitoring."
        },
        {
          "id": "SCS-C03-0042",
          "question": "Which architecture most cost-effectively stores months of high-volume logs for ad-hoc forensic queries?",
          "choices": [
            {
              "id": "c4",
              "text": "Keep logs only on instance disk for speed",
              "isCorrect": false,
              "explanation": "Instance disks are ephemeral and unsuitable for long-term forensic retention."
            },
            {
              "id": "c1",
              "text": "Deliver logs to S3 in partitioned Parquet and query with Athena",
              "isCorrect": true,
              "explanation": "S3 + Parquet + Athena supports low-cost storage and ad-hoc querying without always-on infrastructure."
            },
            {
              "id": "c3",
              "text": "Store logs in DynamoDB single-table design",
              "isCorrect": false,
              "explanation": "DynamoDB is not cost-effective for large historical log volumes and analytics queries."
            },
            {
              "id": "c2",
              "text": "Stream logs to OpenSearch with 90-day hot storage",
              "isCorrect": false,
              "explanation": "OpenSearch is efficient for real-time searches but expensive for long-term retention at scale."
            }
          ],
          "selectCount": 1,
          "format": "yaml",
          "domain": "Detection",
          "services": [
            "CloudWatch Logs",
            "Athena",
            "S3"
          ],
          "docs": "https://docs.aws.amazon.com/AmazonCloudWatch/latest/logs/WhatIsCloudWatchLogs.html",
          "tip": "Partition logs and use columnar formats to reduce query costs.",
          "explanation": "Exporting log data to S3 in Parquet with partitioning reduces query scan costs and enables scalable ad-hoc analysis via Athena or Lakehouse tools."
        },
        {
          "id": "SCS-C03-0016",
          "question": "A development team stores database credentials in environment variables baked into their container images. The security team requires that credentials be rotated every 30 days without redeploying containers and that all credential access be auditable. Which approach best meets these requirements?",
          "choices": [
            {
              "id": "c4",
              "text": "Use IAM database authentication to eliminate passwords entirely",
              "isCorrect": false,
              "explanation": "IAM database authentication works only with supported engines (Aurora MySQL/PostgreSQL, RDS MySQL/PostgreSQL) and may not cover all the team's databases. It also does not address other types of credentials."
            },
            {
              "id": "c1",
              "text": "Store credentials in AWS Secrets Manager with automatic rotation enabled and retrieve them at runtime using the Secrets Manager SDK",
              "isCorrect": true,
              "explanation": "Secrets Manager supports automatic rotation via Lambda, provides versioned secrets so applications always fetch the current value at runtime, and logs all access through CloudTrail."
            },
            {
              "id": "c3",
              "text": "Encrypt the environment variables at build time with a KMS key and decrypt them at container start",
              "isCorrect": false,
              "explanation": "This protects secrets at rest in the image, but rotating requires rebuilding and redeploying the container, which violates the no-redeploy requirement."
            },
            {
              "id": "c2",
              "text": "Store credentials in SSM Parameter Store SecureString parameters and write a cron job to update them monthly",
              "isCorrect": false,
              "explanation": "Parameter Store SecureStrings can hold secrets but lack built-in automatic rotation. A cron job is fragile and requires custom coordination with both the parameter and the database."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Data Protection",
          "services": [
            "Secrets Manager",
            "Parameter Store",
            "KMS",
            "Lambda"
          ],
          "docs": "https://docs.aws.amazon.com/secretsmanager/latest/userguide/intro.html",
          "tip": "To avoid redeploys on rotation, applications should retrieve secrets dynamically at runtime.",
          "explanation": "Secrets Manager is purpose-built for credential lifecycle management. Its rotation feature invokes a Lambda function on a schedule to update both the secret value and the target resource (e.g., RDS password), while applications retrieve the current secret at runtime, eliminating the need for redeployment."
        },
        {
          "id": "SCS-C03-0058",
          "question": "To rate-limit abusive clients at the edge while preserving legitimate traffic, which feature combination should be used?",
          "choices": [
            {
              "id": "c4",
              "text": "Use Route 53 geolocation routing only",
              "isCorrect": false,
              "explanation": "Geolocation routing doesn't provide rate-limiting or application-layer filtering."
            },
            {
              "id": "c1",
              "text": "AWS WAF rate-based rules on CloudFront with CloudFront caching",
              "isCorrect": true,
              "explanation": "WAF rate-based rules block clients over request thresholds while CloudFront caching reduces backend load for legitimate traffic."
            },
            {
              "id": "c3",
              "text": "Increase origin instance capacity",
              "isCorrect": false,
              "explanation": "Scaling origin capacity doesn't stop abusive traffic or reduce edge processing cost."
            },
            {
              "id": "c2",
              "text": "NACL rules to block IP ranges",
              "isCorrect": false,
              "explanation": "NACLs are coarse-grained and do not provide application-layer rate limiting."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Infrastructure Security",
          "services": [
            "ALB",
            "WAF",
            "Route 53"
          ],
          "docs": "https://docs.aws.amazon.com/elasticloadbalancing/latest/application/listener-update-rule.html",
          "tip": "Implement edge rate-limiting close to users and combine caching to reduce backend load.",
          "explanation": "WAF's rate-based rules applied at CloudFront prevent abusive clients from reaching origin and, combined with caching, protect backend capacity."
        },
        {
          "id": "SCS-C03-0022",
          "question": "An operations team wants to automate incident response when a critical CloudWatch alarm triggers: page the on-call engineer, create a timeline, and start a runbook to collect diagnostic data. They want a single AWS-native service to orchestrate all three actions. Which service should they configure?",
          "choices": [
            {
              "id": "c2",
              "text": "Amazon EventBridge with Lambda targets",
              "isCorrect": false,
              "explanation": "EventBridge plus Lambda can achieve similar automation but requires custom code for paging, timeline tracking, and runbook execution. It is not a single orchestration service purpose-built for incident response."
            },
            {
              "id": "c4",
              "text": "AWS CloudWatch composite alarms with auto-scaling actions",
              "isCorrect": false,
              "explanation": "Composite alarms aggregate alarm states but their actions are limited to SNS, Lambda, or Auto Scaling. They do not provide incident lifecycle management."
            },
            {
              "id": "c3",
              "text": "Amazon SNS with multiple topic subscriptions",
              "isCorrect": false,
              "explanation": "SNS delivers notifications but does not manage incident timelines, runbook execution, or structured escalation workflows."
            },
            {
              "id": "c1",
              "text": "AWS Systems Manager Incident Manager",
              "isCorrect": true,
              "explanation": "Incident Manager automates incident creation with response plans that define escalation contacts, engagement protocols, and runbook automation, all triggered by CloudWatch alarms or EventBridge rules."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Incident Response",
          "services": [
            "Systems Manager Incident Manager",
            "EventBridge",
            "SNS",
            "PagerDuty"
          ],
          "docs": "https://docs.aws.amazon.com/incident-manager/latest/userguide/what-is-incident-manager.html",
          "tip": "Consider incident management tools that integrate alerting, timelines, and automated runbooks.",
          "explanation": "Incident Manager provides structured response plans that automatically engage contacts (via SMS, voice, or email), create incident timelines, and execute SSM Automation runbooks when triggered. This consolidates incident orchestration into one service rather than gluing multiple services together with custom logic."
        },
        {
          "id": "SCS-C03-0043",
          "question": "Which approach automates security posture checks across new accounts automatically?",
          "choices": [
            {
              "id": "c2",
              "text": "Require each team to run a manual checklist during onboarding",
              "isCorrect": false,
              "explanation": "Manual checklists are error-prone and do not scale automatically for many accounts."
            },
            {
              "id": "c1",
              "text": "Use Organizations with SCPs and automated Config conformance packs deployed on account creation",
              "isCorrect": true,
              "explanation": "Combining Organizations lifecycle hooks with automated Config conformance packs provides automatic posture checks for new accounts."
            },
            {
              "id": "c4",
              "text": "Rely on Control Tower alone without additional automation",
              "isCorrect": false,
              "explanation": "Control Tower helps but combining it with conformance packs and automated policies gives stronger, automated checks."
            },
            {
              "id": "c3",
              "text": "Use S3 replication to copy Templates across accounts",
              "isCorrect": false,
              "explanation": "S3 replication doesn't enforce security posture or run automated assessments."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Detection",
          "services": [
            "Organizations",
            "IAM",
            "SCPs"
          ],
          "docs": "https://docs.aws.amazon.com/organizations/latest/userguide/orgs_manage_policies_scps.html",
          "tip": "Automate posture checks during account provisioning to enforce baselines.",
          "explanation": "Provisioning-time automation that deploys Config rules/conformance packs along with SCP guardrails ensures new accounts meet baseline security posture automatically."
        },
        {
          "id": "SCS-C03-0026",
          "question": "A company with 50 AWS accounts wants to enforce a baseline set of preventive and detective security controls (e.g., disallow public S3 buckets, require CloudTrail in all regions) across all accounts. They need a managed landing zone that automatically applies these controls to new accounts as they are created. Which service provides this capability?",
          "choices": [
            {
              "id": "c1",
              "text": "AWS Control Tower with mandatory and elective guardrails",
              "isCorrect": true,
              "explanation": "Control Tower provides a managed landing zone with pre-configured guardrails (implemented as SCPs for preventive controls and Config rules for detective controls) that are automatically applied to accounts enrolled in the landing zone."
            },
            {
              "id": "c3",
              "text": "AWS Security Hub with the AWS Foundational Security Best Practices standard",
              "isCorrect": false,
              "explanation": "Security Hub detects deviations from best practices (detective) but does not prevent them (preventive). It also does not provision or manage accounts or landing zones."
            },
            {
              "id": "c2",
              "text": "AWS Organizations with manually written SCPs and Config rules deployed via StackSets",
              "isCorrect": false,
              "explanation": "This approach works but requires manual authoring, testing, and deployment of each control. Control Tower automates this with curated, pre-tested guardrails and handles new-account enrollment automatically."
            },
            {
              "id": "c4",
              "text": "AWS Trusted Advisor organisational view",
              "isCorrect": false,
              "explanation": "Trusted Advisor provides recommendations and checks but does not enforce controls or manage account provisioning or landing zones."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Identity and Access Management",
          "services": [
            "Control Tower",
            "Organizations",
            "Config",
            "CloudFormation"
          ],
          "docs": "https://docs.aws.amazon.com/controltower/latest/userguide/guardrails.html",
          "tip": "Managed landing zone patterns enforce guardrails automatically during account provisioning.",
          "explanation": "Control Tower orchestrates Organizations, Config, CloudFormation, and IAM Identity Center to create a governed multi-account environment. Its guardrails are curated controls that are automatically enforced (preventive via SCPs) or monitored (detective via Config rules) across all enrolled accounts, including newly created ones."
        },
        {
          "id": "SCS-C03-0009",
          "question": "As a data steward you need to automatically find and classify PII across hundreds of S3 buckets. Which AWS service is built for that task?",
          "choices": [
            {
              "id": "c3",
              "text": "Amazon Inspector",
              "isCorrect": false,
              "explanation": "Inspector focuses on vulnerability scanning for compute workloads, not data classification in S3."
            },
            {
              "id": "c4",
              "text": "AWS Trusted Advisor",
              "isCorrect": false,
              "explanation": "Trusted Advisor provides account-level checks like open security groups, but does not scan S3 object contents."
            },
            {
              "id": "c1",
              "text": "Amazon Macie",
              "isCorrect": true,
              "explanation": "Macie scans S3 objects for PII, financial data, and credentials using ML-powered classifiers and managed data identifiers."
            },
            {
              "id": "c2",
              "text": "Amazon GuardDuty",
              "isCorrect": false,
              "explanation": "GuardDuty detects threats like unusual API calls to S3 but does not inspect object contents for sensitive data."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Data Protection",
          "services": [
            "Macie",
            "GuardDuty",
            "Inspector",
            "Trusted Advisor"
          ],
          "docs": "https://docs.aws.amazon.com/macie/latest/user/what-is-macie.html",
          "tip": "Some services scan stored objects to locate sensitive data and personally identifiable information.",
          "explanation": "Amazon Macie is designed to scan S3 objects and classify sensitive content such as PII and PHI using managed data identifiers."
        },
        {
          "id": "SCS-C03-0059",
          "question": "For workforce single sign-on with centralized permission sets, which service provides identity federation and permission management?",
          "choices": [
            {
              "id": "c1",
              "text": "IAM Identity Center (AWS SSO)",
              "isCorrect": true,
              "explanation": "IAM Identity Center provides SSO and centralized permission set management for workforce identities."
            },
            {
              "id": "c3",
              "text": "Use local OS accounts on bastion hosts",
              "isCorrect": false,
              "explanation": "Local accounts are not centralized or scalable for enterprise SSO needs."
            },
            {
              "id": "c2",
              "text": "Create IAM Users for each employee",
              "isCorrect": false,
              "explanation": "IAM Users are not ideal for large-scale workforce SSO and federation scenarios."
            },
            {
              "id": "c4",
              "text": "Use API keys stored in S3 for employees",
              "isCorrect": false,
              "explanation": "API keys are for programmatic access and not suitable for workforce SSO."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Identity and Access Management",
          "services": [
            "IAM",
            "IAM Identity Center"
          ],
          "docs": "https://docs.aws.amazon.com/iam/latest/UserGuide/id_users_create.html",
          "tip": "Use a centralized identity solution with permission sets for workforce SSO.",
          "explanation": "IAM Identity Center integrates with external IdPs and maps users to AWS permission sets, simplifying enterprise SSO and access management."
        },
        {
          "id": "SCS-C03-0063",
          "question": "Which practice validates that an incident response runbook will work under real conditions?",
          "choices": [
            {
              "id": "c4",
              "text": "Rely on vendor-provided runbooks without customization",
              "isCorrect": false,
              "explanation": "Vendor runbooks may not match the customer's environment and need adaptation and testing."
            },
            {
              "id": "c2",
              "text": "Only review runbooks annually without testing",
              "isCorrect": false,
              "explanation": "Reviews without testing may miss operational and technical gaps discovered during live drills."
            },
            {
              "id": "c3",
              "text": "Assume runbooks are valid if written by senior staff",
              "isCorrect": false,
              "explanation": "Assumptions without testing risk undiscovered issues in execution under pressure."
            },
            {
              "id": "c1",
              "text": "Conduct tabletop exercises and full-scale simulated incident drills using controlled fault injection",
              "isCorrect": true,
              "explanation": "Tabletops test decision-making; simulated drills and fault injection test technical runbooks and automation under realistic conditions."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Incident Response",
          "services": [
            "Incident Manager",
            "CloudWatch",
            "EventBridge"
          ],
          "docs": "https://docs.aws.amazon.com/whitepapers/latest/aws-security-best-practices/incident-response.html",
          "tip": "Run both tabletop and technical drills to validate people and technical runbooks.",
          "explanation": "Combining tabletop exercises for roles and decisions with full technical drills (injecting faults) validates both human and automated aspects of incident response."
        },
        {
          "id": "SCS-C03-0018",
          "question": "A company runs workloads on Amazon EKS and needs each Kubernetes pod to assume a unique IAM role with fine-grained permissions. The trust policy must ensure only the intended service account in a specific namespace can assume the role. Which trust policy snippet correctly restricts role assumption to the pod's OIDC identity?",
          "choices": [
            {
              "id": "c2",
              "text": "{\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"eks.amazonaws.com\"},\"Action\":\"sts:AssumeRole\"}",
              "isCorrect": false,
              "explanation": "This trusts the EKS service itself (the control plane), not individual pod identities. Any EKS-managed component could assume this role, not just the intended pod."
            },
            {
              "id": "c4",
              "text": "{\"Effect\":\"Allow\",\"Principal\":{\"Federated\":\"cognito-identity.amazonaws.com\"},\"Action\":\"sts:AssumeRoleWithWebIdentity\"}",
              "isCorrect": false,
              "explanation": "Cognito Identity is for end-user identity federation, not Kubernetes workload identity. EKS uses its own OIDC provider endpoint."
            },
            {
              "id": "c3",
              "text": "{\"Effect\":\"Allow\",\"Principal\":{\"AWS\":\"arn:aws:iam::123456789012:role/eks-node-role\"},\"Action\":\"sts:AssumeRole\"}",
              "isCorrect": false,
              "explanation": "Trusting the node role lets every pod on that node assume this role, eliminating per-pod isolation."
            },
            {
              "id": "c1",
              "text": "{\"Effect\":\"Allow\",\"Principal\":{\"Federated\":\"arn:aws:iam::123456789012:oidc-provider/oidc.eks.us-east-1.amazonaws.com/id/EXAMPLED539D4633E53DE1B71EXAMPLE\"},\"Action\":\"sts:AssumeRoleWithWebIdentity\",\"Condition\":{\"StringEquals\":{\"oidc.eks.us-east-1.amazonaws.com/id/EXAMPLED539D4633E53DE1B71EXAMPLE:sub\":\"system:serviceaccount:app-ns:app-sa\"}}}",
              "isCorrect": true,
              "explanation": "This uses the EKS OIDC provider as a Federated principal with AssumeRoleWithWebIdentity, and the Condition restricts the sub claim to the exact namespace:serviceaccount pair."
            }
          ],
          "selectCount": 1,
          "format": "json",
          "domain": "Identity and Access Management",
          "services": [
            "IAM",
            "STS",
            "Cognito",
            "EKS"
          ],
          "docs": "https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_providers_oidc.html",
          "tip": "Use workload identity federation patterns to grant pod-level permissions without node credentials.",
          "explanation": "IRSA projects a signed OIDC token into each pod, and the trust policy uses the cluster OIDC provider as a Federated principal with a Condition on the sub claim (namespace:serviceaccount). This ensures only the precise service account in the correct namespace can assume the role."
        },
        {
          "id": "SCS-C03-0008",
          "question": "You want AWS Config to spot S3 buckets with public read access automatically which CloudFormation snippet defines the correct managed Config rule?",
          "choices": [
            {
              "id": "c4",
              "text": "Enable S3 Block Public Access at the account level - this replaces the need for Config rules",
              "isCorrect": false,
              "explanation": "Block Public Access is preventive - it does not detect existing violations like a Config rule does."
            },
            {
              "id": "c3",
              "text": "Use AWS CloudTrail to monitor S3:GetBucketPolicy API calls and alert when public access is detected",
              "isCorrect": false,
              "explanation": "CloudTrail monitors API calls but does not provide continuous compliance evaluation like AWS Config."
            },
            {
              "id": "c1",
              "text": "Type: AWS::Config::ConfigRule\nProperties:\n  ConfigRuleName: s3-bucket-public-read-prohibited\n  Source:\n    Owner: AWS\n    SourceIdentifier: S3_BUCKET_PUBLIC_READ_PROHIBITED",
              "isCorrect": true,
              "explanation": "AWS managed Config rule using Owner: AWS and the standard S3 public read detection identifier."
            },
            {
              "id": "c2",
              "text": "Type: AWS::Config::ConfigRule\nProperties:\n  ConfigRuleName: s3-bucket-public-read-prohibited\n  Source:\n    Owner: CUSTOM\n    SourceIdentifier: S3_BUCKET_PUBLIC_READ_PROHIBITED",
              "isCorrect": false,
              "explanation": "Owner: CUSTOM is for custom rules backed by Lambda functions, not AWS managed rules."
            }
          ],
          "selectCount": 1,
          "format": "yaml",
          "domain": "Detection",
          "services": [
            "Config",
            "CloudFormation",
            "S3"
          ],
          "docs": "https://docs.aws.amazon.com/config/latest/developerguide/WhatIsConfig.html",
          "tip": "Managed rules often have predefined identifiers and are provided by the cloud provider.",
          "explanation": "AWS Config managed rules are pre-built by AWS and referenced with Owner: AWS plus a SourceIdentifier like S3_BUCKET_PUBLIC_READ_PROHIBITED."
        },
        {
          "id": "SCS-C03-0011",
          "question": "Compliance requires CloudWatch Logs to use a customer-managed CMK and let the service use it what steps achieve this configuration?",
          "choices": [
            {
              "id": "c1",
              "text": "Create a customer-managed KMS key with a key policy granting logs.<region>.amazonaws.com the kms:Encrypt, kms:Decrypt, kms:GenerateDataKey, and kms:DescribeKey actions, then associate the key with each log group",
              "isCorrect": true,
              "explanation": "CloudWatch Logs requires these four KMS actions in the key policy for the regional service principal to encrypt and decrypt log data."
            },
            {
              "id": "c3",
              "text": "Enable CloudTrail log file encryption with a KMS key and configure CloudWatch Logs as a CloudTrail destination",
              "isCorrect": false,
              "explanation": "CloudTrail encryption covers CloudTrail's own log files delivered to S3, not arbitrary CloudWatch Logs log groups."
            },
            {
              "id": "c2",
              "text": "Enable SSE-S3 default encryption on the S3 bucket where CloudWatch Logs exports data and reference that bucket in each log group's settings",
              "isCorrect": false,
              "explanation": "S3 encryption applies only to exported log data in S3, not to log data stored within the CloudWatch Logs service itself."
            },
            {
              "id": "c4",
              "text": "Create an AWS-managed KMS key (alias aws/logs) and it will automatically encrypt all new log groups without any key policy changes",
              "isCorrect": false,
              "explanation": "CloudWatch Logs does not have an AWS-managed key. You must create and configure a customer-managed key explicitly."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Data Protection",
          "services": [
            "CloudWatch Logs",
            "KMS",
            "S3",
            "CloudTrail"
          ],
          "docs": "https://docs.aws.amazon.com/AmazonCloudWatch/latest/logs/encrypt-log-data-kms.html",
          "tip": "Some logging services require customer-managed keys for encryption at rest; verify key management options.",
          "explanation": "CloudWatch Logs supports encryption at rest only with customer-managed KMS keys. You must explicitly grant the regional service principal permission to use the key."
        },
        {
          "id": "SCS-C03-0005",
          "question": "You've been asked to centralise key management for data-at-rest across services. Which AWS service provides managed encryption keys for this purpose?",
          "choices": [
            {
              "id": "c4",
              "text": "AWS WAF",
              "isCorrect": false,
              "explanation": "AWS WAF is a web application firewall, not key management."
            },
            {
              "id": "c2",
              "text": "AWS IAM",
              "isCorrect": false,
              "explanation": "AWS IAM handles identity and permissions, not key storage or encryption primitives."
            },
            {
              "id": "c1",
              "text": "AWS KMS",
              "isCorrect": true,
              "explanation": "AWS KMS is the managed service for creating and controlling encryption keys."
            },
            {
              "id": "c3",
              "text": "AWS Shield",
              "isCorrect": false,
              "explanation": "AWS Shield protects against DDoS attacks, not key management."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Data Protection",
          "services": [
            "KMS",
            "IAM",
            "Shield",
            "WAF"
          ],
          "docs": "https://docs.aws.amazon.com/kms/latest/developerguide/overview.html",
          "tip": "Use a key management service that supports envelope encryption and key lifecycle controls.",
          "explanation": "AWS KMS provides centralized creation, rotation, and access control of encryption keys used to protect data at rest across services like S3, EBS, and RDS."
        },
        {
          "id": "SCS-C03-0048",
          "question": "Which integration helps ensure container images are scanned for known vulnerabilities before deployment?",
          "choices": [
            {
              "id": "c1",
              "text": "Enable Inspector image scanning for ECR and fail CI on high-severity findings",
              "isCorrect": true,
              "explanation": "Inspector integrates with ECR to scan images and can be used as a gate in CI to prevent deploying vulnerable images."
            },
            {
              "id": "c3",
              "text": "Scan images manually once per quarter",
              "isCorrect": false,
              "explanation": "Infrequent manual scans miss new vulnerabilities discovered between scans."
            },
            {
              "id": "c4",
              "text": "Use S3 object versioning to store old images",
              "isCorrect": false,
              "explanation": "S3 versioning stores objects but does not scan or prevent vulnerable images from running."
            },
            {
              "id": "c2",
              "text": "Rely only on runtime detection like GuardDuty",
              "isCorrect": false,
              "explanation": "Runtime detection is useful but does not prevent vulnerable images from being deployed in the first place."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Infrastructure Security",
          "services": [
            "Inspector",
            "ECR",
            "Lambda"
          ],
          "docs": "https://docs.aws.amazon.com/inspector/latest/userguide/what-is-inspector.html",
          "tip": "Integrate vulnerability scanning into CI/CD and prevent promotion of artifacts with critical findings.",
          "explanation": "Shifting vulnerability scans left (during build) reduces risk; Inspector/ECR scanning plus CI gates prevents deploying images with known critical vulnerabilities."
        },
        {
          "id": "SCS-C03-0025",
          "question": "A Lambda function in a private subnet needs to call the Secrets Manager API to retrieve database credentials. The security team prohibits all internet-bound traffic from the VPC. How should the architect configure network access so the Lambda function can reach Secrets Manager without traversing the internet?",
          "choices": [
            {
              "id": "c1",
              "text": "Create an interface VPC endpoint (PrivateLink) for Secrets Manager in the same VPC and ensure the Lambda function's security group allows outbound HTTPS to the endpoint",
              "isCorrect": true,
              "explanation": "An interface VPC endpoint creates private ENIs within the VPC that route traffic to the Secrets Manager API entirely over the AWS private network, with no internet path required."
            },
            {
              "id": "c4",
              "text": "Configure the Lambda function outside the VPC so it can access Secrets Manager over the internet by default",
              "isCorrect": false,
              "explanation": "Placing the function outside the VPC gives it internet access to AWS APIs, but the question states the function is in a private subnet, and moving it out may break access to other VPC resources like the database."
            },
            {
              "id": "c3",
              "text": "Attach an Elastic IP to the Lambda function's ENI for direct outbound access",
              "isCorrect": false,
              "explanation": "Lambda functions in a VPC do not support Elastic IPs, and this approach would use the internet gateway, which is prohibited."
            },
            {
              "id": "c2",
              "text": "Add a NAT Gateway to the VPC and route the Lambda subnet's traffic through it",
              "isCorrect": false,
              "explanation": "A NAT Gateway provides internet access for outbound traffic, which violates the security team's prohibition on internet-bound traffic from the VPC."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Infrastructure Security",
          "services": [
            "Lambda",
            "VPC",
            "NAT Gateway",
            "PrivateLink",
            "Secrets Manager"
          ],
          "docs": "https://docs.aws.amazon.com/lambda/latest/dg/configuration-vpc.html",
          "tip": "Private endpoints can provide service APIs over private network paths when internet access is restricted.",
          "explanation": "Interface VPC endpoints (powered by AWS PrivateLink) create private IP addresses inside the VPC that serve as entry points for AWS service APIs. Traffic never leaves the AWS network, satisfying zero-internet-egress security requirements while allowing Lambda to call Secrets Manager."
        },
        {
          "id": "SCS-C03-0020",
          "question": "After enabling GuardDuty S3 Protection, a security analyst notices a finding of type Policy:S3/BucketAnonymousAccessGranted for a production data bucket. The analyst needs to determine which principal changed the bucket policy and when. Which data source provides this information?",
          "choices": [
            {
              "id": "c4",
              "text": "VPC Flow Logs for the VPC where the analyst is working",
              "isCorrect": false,
              "explanation": "VPC Flow Logs capture network-layer metadata (IP, port, protocol) but not API-level details like which principal called PutBucketPolicy."
            },
            {
              "id": "c1",
              "text": "CloudTrail management events showing the PutBucketPolicy API call",
              "isCorrect": true,
              "explanation": "CloudTrail records the identity (principal), timestamp, source IP, and request parameters for S3 control-plane API calls like PutBucketPolicy. This is the authoritative source for who changed the policy and when."
            },
            {
              "id": "c2",
              "text": "The GuardDuty finding detail itself, which includes the actor and timestamp",
              "isCorrect": false,
              "explanation": "GuardDuty findings identify the affected resource and the anomaly but do not always include the full details of who made the original policy change. CloudTrail provides the definitive audit trail."
            },
            {
              "id": "c3",
              "text": "S3 server access logs for the data bucket",
              "isCorrect": false,
              "explanation": "S3 server access logs capture object-level read/write requests, not bucket policy changes. Control-plane actions like PutBucketPolicy are not recorded in access logs."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Detection",
          "services": [
            "GuardDuty",
            "CloudTrail",
            "S3",
            "Security Hub"
          ],
          "docs": "https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_s3-protection.html",
          "tip": "Differentiate data-plane logs from control-plane audit logs when investigating configuration or policy changes.",
          "explanation": "CloudTrail management events are the single source of truth for AWS API activity. When investigating who changed a resource configuration, always start with CloudTrail, which records the IAM principal, the API action, the request parameters, and the exact timestamp."
        },
        {
          "id": "SCS-C03-0049",
          "question": "A team must provide audited shell access to instances in private subnets without SSH port exposure. Which solution meets this requirement?",
          "choices": [
            {
              "id": "c4",
              "text": "Embed root credentials in AMI for quick access",
              "isCorrect": false,
              "explanation": "Embedding credentials is insecure and hinders auditing and rotation."
            },
            {
              "id": "c2",
              "text": "Open SSH port 22 and enforce key rotation manually",
              "isCorrect": false,
              "explanation": "Opening SSH ports exposes network surface and complicates auditing compared to agent-based sessions."
            },
            {
              "id": "c1",
              "text": "Use Systems Manager Session Manager with logging to CloudWatch or S3 and IAM-based access controls",
              "isCorrect": true,
              "explanation": "Session Manager provides agent-based access without inbound ports and records sessions for auditing."
            },
            {
              "id": "c3",
              "text": "Use RDP through a bastion host for Linux instances",
              "isCorrect": false,
              "explanation": "RDP is inappropriate for Linux and bastions reintroduce exposed access vectors."
            }
          ],
          "selectCount": 1,
          "format": "text",
          "domain": "Infrastructure Security",
          "services": [
            "Systems Manager",
            "SSM",
            "CloudTrail"
          ],
          "docs": "https://docs.aws.amazon.com/systems-manager/latest/userguide/session-manager.html",
          "tip": "Agent-based session solutions can record session logs and enforce access via identity policies.",
          "explanation": "Systems Manager's Session Manager avoids bastions and allows session logging to CloudWatch/S3 and control via IAM, meeting audit requirements."
        },
        {
          "id": "SCS-C03-0045",
          "question": "Given an IAM role ARN, which CLI command quickly reveals the caller identity to correlate with CloudTrail events?",
          "choices": [
            {
              "id": "c2",
              "text": "aws iam list-roles",
              "isCorrect": false,
              "explanation": "List-roles enumerates roles but doesn't show the runtime caller identity."
            },
            {
              "id": "c3",
              "text": "aws cloudtrail lookup-events",
              "isCorrect": false,
              "explanation": "Lookup-events finds historical events but does not directly reveal the current caller context."
            },
            {
              "id": "c1",
              "text": "aws sts get-caller-identity",
              "isCorrect": true,
              "explanation": "This STS call returns the effective principal; useful for correlating with CloudTrail event ARNs."
            },
            {
              "id": "c4",
              "text": "aws sts decode-authorization-message",
              "isCorrect": false,
              "explanation": "Decoding auth message requires a message from AWS and is not the general approach for caller identity."
            }
          ],
          "selectCount": 1,
          "format": "cli",
          "domain": "Incident Response",
          "services": [
            "IAM",
            "STS"
          ],
          "docs": "https://docs.aws.amazon.com/iam/latest/UserGuide/id_roles.html",
          "tip": "Use identity-revealing calls to confirm which principal is making API requests.",
          "explanation": "`get-caller-identity` is the simplest way to determine which principal is currently making API calls; pair it with CloudTrail to find related events."
        },
        {
          "id": "SCS-C03-0030",
          "question": "A disaster recovery plan requires that all objects in a production S3 bucket encrypted with a customer-managed KMS key be replicated to a bucket in a different region using a different KMS key. Which TWO configurations are required for cross-region replication to work with KMS-encrypted objects? (Select TWO)",
          "choices": [
            {
              "id": "c2",
              "text": "Grant the S3 replication role kms:Decrypt permission on the source key and kms:Encrypt permission on the destination key",
              "isCorrect": true,
              "explanation": "The replication role must decrypt the objects using the source CMK and then encrypt them with the destination CMK. Without both permissions, replication fails with AccessDenied."
            },
            {
              "id": "c5",
              "text": "Disable KMS encryption on the destination bucket and use SSE-S3 instead",
              "isCorrect": false,
              "explanation": "Switching to SSE-S3 would avoid KMS complexity but loses the benefits of customer-managed key control, audit via CloudTrail, and compliance requirements that may mandate CMK usage."
            },
            {
              "id": "c1",
              "text": "Specify the destination KMS key ARN in the replication rule configuration",
              "isCorrect": true,
              "explanation": "When replicating KMS-encrypted objects, the replication configuration must specify the destination KMS key so S3 can re-encrypt the objects in the destination region."
            },
            {
              "id": "c3",
              "text": "Use the same KMS key in both the source and destination regions",
              "isCorrect": false,
              "explanation": "KMS keys are regional. A key in us-east-1 cannot be used in eu-west-1. Multi-Region KMS keys exist but are not required; specifying the destination key in the replication rule is sufficient."
            },
            {
              "id": "c4",
              "text": "Enable S3 Transfer Acceleration on both buckets to speed up cross-region replication",
              "isCorrect": false,
              "explanation": "Transfer Acceleration optimizes direct uploads via CloudFront edge locations. It is not related to S3 replication, which uses its own internal transfer mechanism."
            }
          ],
          "selectCount": 2,
          "format": "text",
          "domain": "Data Protection",
          "services": [
            "S3",
            "KMS",
            "IAM",
            "Organizations"
          ],
          "docs": "https://docs.aws.amazon.com/AmazonS3/latest/userguide/replication-walkthrough-2.html",
          "tip": "Cross-account or cross-region key replication requires careful role permissions and key configuration on both ends.",
          "explanation": "S3 replication with SSE-KMS objects requires two key configurations: the replication rule must specify the destination KMS key ARN (since KMS keys are regional), and the replication IAM role must have kms:Decrypt on the source key plus kms:Encrypt and kms:GenerateDataKey on the destination key."
        }
      ],
      "perDomain": {
        "Detection": {
          "total": 1,
          "correct": 1,
          "score": 100
        }
      },
      "earlyComplete": true,
      "answeredCount": 1,
      "totalQuestions": 65
    }
  ]
}